{"version":3,"file":"_positionId-ByIEwJ6H.js","sources":["../../src/hooks/usePositionAnalytics.ts","../../src/components/positions/PositionAnalyticsCard.tsx","../../src/routes/_protected/positions/$positionId.tsx?tsr-split=component"],"sourcesContent":["/**\n * TanStack Query Hook: usePositionAnalytics (T042)\n * Fetches usage analytics for a position\n */\n\nimport { useQuery } from '@tanstack/react-query';\nimport { supabase } from '@/lib/supabase';\n\nexport interface PositionAnalytics {\n  position_id: string;\n  view_count: number;\n  attachment_count: number;\n  briefing_pack_count: number;\n  last_viewed_at?: string;\n  last_attached_at?: string;\n  trend_data?: {\n    daily?: { date: string; views: number; attachments: number }[];\n    weekly?: { week: string; views: number; attachments: number }[];\n    monthly?: { month: string; views: number; attachments: number }[];\n  };\n  popularity_score?: number; // Computed weighted score\n  usage_rank?: number; // Rank among all positions\n  updated_at: string;\n}\n\nexport interface UsePositionAnalyticsOptions {\n  positionId: string;\n  enabled?: boolean;\n}\n\nasync function fetchPositionAnalytics(\n  positionId: string\n): Promise<PositionAnalytics> {\n  // Call edge function to get analytics\n  const { data: authData } = await supabase.auth.getSession();\n  const token = authData.session?.access_token;\n\n  if (!token) {\n    throw new Error('Authentication required');\n  }\n\n  const response = await fetch(\n    `${process.env.VITE_SUPABASE_URL}/functions/v1/positions/${positionId}/analytics`,\n    {\n      headers: {\n        'Authorization': `Bearer ${token}`,\n      },\n    }\n  );\n\n  if (!response.ok) {\n    if (response.status === 404) {\n      throw new Error('Position not found');\n    }\n    throw new Error('Failed to fetch position analytics');\n  }\n\n  return await response.json();\n}\n\nexport function usePositionAnalytics(\n  options: UsePositionAnalyticsOptions\n) {\n  const {\n    positionId,\n    enabled = true,\n  } = options;\n\n  const {\n    data,\n    isLoading,\n    isError,\n    error,\n    refetch,\n  } = useQuery({\n    queryKey: ['position-analytics', positionId],\n    queryFn: () => fetchPositionAnalytics(positionId),\n    enabled: enabled && !!positionId,\n    staleTime: 10 * 60 * 1000, // 10 minutes (analytics don't change frequently)\n    gcTime: 30 * 60 * 1000, // 30 minutes\n  });\n\n  return {\n    analytics: data,\n    isLoading,\n    isError,\n    error: error as Error | null,\n    refetch,\n  };\n}\n\n/**\n * Hook to fetch top positions by various metrics\n */\nexport interface TopPositionsOptions {\n  metric?: 'views' | 'attachments' | 'briefings' | 'popularity';\n  timeRange?: '7d' | '30d' | '90d' | 'all';\n  limit?: number;\n  enabled?: boolean;\n}\n\nexport interface TopPosition {\n  position_id: string;\n  position_title: string;\n  position_type: string;\n  metric_value: number;\n  rank: number;\n  trend: 'up' | 'down' | 'stable';\n}\n\nasync function fetchTopPositions(\n  options: TopPositionsOptions\n): Promise<TopPosition[]> {\n  const {\n    metric = 'popularity',\n    timeRange = '30d',\n    limit = 10,\n  } = options;\n\n  const { data: authData } = await supabase.auth.getSession();\n  const token = authData.session?.access_token;\n\n  if (!token) {\n    throw new Error('Authentication required');\n  }\n\n  const response = await fetch(\n    `${process.env.VITE_SUPABASE_URL}/functions/v1/positions/analytics/top?metric=${metric}&time_range=${timeRange}&limit=${limit}`,\n    {\n      headers: {\n        'Authorization': `Bearer ${token}`,\n      },\n    }\n  );\n\n  if (!response.ok) {\n    throw new Error('Failed to fetch top positions');\n  }\n\n  const result = await response.json();\n  return result.data || [];\n}\n\nexport function useTopPositions(\n  options: TopPositionsOptions = {}\n) {\n  const {\n    metric = 'popularity',\n    timeRange = '30d',\n    limit = 10,\n    enabled = true,\n  } = options;\n\n  const {\n    data,\n    isLoading,\n    isError,\n    error,\n    refetch,\n  } = useQuery({\n    queryKey: ['top-positions', metric, timeRange, limit],\n    queryFn: () => fetchTopPositions(options),\n    enabled,\n    staleTime: 15 * 60 * 1000, // 15 minutes\n    gcTime: 30 * 60 * 1000,\n  });\n\n  return {\n    topPositions: data || [],\n    isLoading,\n    isError,\n    error: error as Error | null,\n    refetch,\n  };\n}\n","/**\n * PositionAnalyticsCard Component (T048)\n * Display position usage analytics with trends\n */\n\nimport React from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { TrendingUp, Eye, Link2, FileText, Award } from 'lucide-react';\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { usePositionAnalytics } from '@/hooks/usePositionAnalytics';\nimport { format } from 'date-fns';\nimport { ar, enUS } from 'date-fns/locale';\n\nexport interface PositionAnalyticsCardProps {\n positionId: string;\n className?: string;\n}\n\nexport const PositionAnalyticsCard: React.FC<PositionAnalyticsCardProps> = ({\n positionId,\n className = '',\n}) => {\n const { t, i18n } = useTranslation();\n const locale = i18n.language === 'ar' ? ar : enUS;\n\n const { data: analytics, isLoading, error } = usePositionAnalytics(positionId);\n\n if (isLoading) {\n return (\n <Card className={className}>\n <CardHeader>\n <CardTitle>{t('positions.analytics.title')}</CardTitle>\n </CardHeader>\n <CardContent>\n <div className=\"flex items-center justify-center py-8\">\n <div className=\"h-8 w-8 animate-spin rounded-full border-4 border-primary border-t-transparent\" />\n </div>\n </CardContent>\n </Card>\n );\n }\n\n if (error || !analytics) {\n return (\n <Card className={className}>\n <CardHeader>\n <CardTitle>{t('positions.analytics.title')}</CardTitle>\n </CardHeader>\n <CardContent>\n <p className=\"text-center text-sm text-muted-foreground\">{t('positions.analytics.error')}</p>\n </CardContent>\n </Card>\n );\n }\n\n const {\n view_count,\n attachment_count,\n briefing_pack_count,\n last_viewed_at,\n last_attached_at,\n popularity_score,\n usage_rank,\n trend_data,\n } = analytics;\n\n // Calculate trend direction\n const getTrendDirection = (current: number, previous: number) => {\n if (current > previous) return 'up';\n if (current < previous) return 'down';\n return 'stable';\n };\n\n // Get popularity badge variant\n const getPopularityVariant = (score: number) => {\n if (score >= 0.8) return 'default';\n if (score >= 0.5) return 'secondary';\n return 'outline';\n };\n\n return (\n <Card className={className}>\n <CardHeader>\n <CardTitle className=\"flex items-center gap-2\">\n <TrendingUp className=\"h-5 w-5\" />\n {t('positions.analytics.title')}\n </CardTitle>\n <CardDescription>{t('positions.analytics.description')}</CardDescription>\n </CardHeader>\n\n <CardContent className=\"space-y-6\">\n {/* Popularity Rank */}\n {usage_rank && (\n <div className=\"flex items-center justify-between rounded-lg border bg-primary/5 p-4\">\n <div className=\"flex items-center gap-3\">\n <Award className=\"h-8 w-8 text-primary\" />\n <div>\n <p className=\"text-sm font-medium\">{t('positions.analytics.rank')}</p>\n <p className=\"text-2xl font-bold\">#{usage_rank}</p>\n </div>\n </div>\n <Badge variant={getPopularityVariant(popularity_score || 0)}>\n {t('positions.analytics.popularityScore')}: {((popularity_score || 0) * 100).toFixed(0)}%\n </Badge>\n </div>\n )}\n\n {/* Metrics Grid */}\n <div className=\"grid gap-4 sm:grid-cols-3\">\n {/* Views */}\n <div className=\"space-y-2 rounded-lg border p-4\">\n <div className=\"flex items-center justify-between\">\n <Eye className=\"h-5 w-5 text-muted-foreground\" />\n {trend_data?.views && (\n <TrendIcon direction={getTrendDirection(view_count, trend_data.views.previous)} />\n )}\n </div>\n <p className=\"text-2xl font-bold\">{view_count}</p>\n <p className=\"text-xs text-muted-foreground\">{t('positions.analytics.views')}</p>\n {last_viewed_at && (\n <p className=\"text-xs text-muted-foreground\">\n {t('positions.analytics.lastViewed')}:{' '}\n {format(new Date(last_viewed_at), 'PP', { locale })}\n </p>\n )}\n </div>\n\n {/* Attachments */}\n <div className=\"space-y-2 rounded-lg border p-4\">\n <div className=\"flex items-center justify-between\">\n <Link2 className=\"h-5 w-5 text-muted-foreground\" />\n {trend_data?.attachments && (\n <TrendIcon\n direction={getTrendDirection(attachment_count, trend_data.attachments.previous)}\n />\n )}\n </div>\n <p className=\"text-2xl font-bold\">{attachment_count}</p>\n <p className=\"text-xs text-muted-foreground\">{t('positions.analytics.attachments')}</p>\n {last_attached_at && (\n <p className=\"text-xs text-muted-foreground\">\n {t('positions.analytics.lastAttached')}:{' '}\n {format(new Date(last_attached_at), 'PP', { locale })}\n </p>\n )}\n </div>\n\n {/* Briefing Packs */}\n <div className=\"space-y-2 rounded-lg border p-4\">\n <div className=\"flex items-center justify-between\">\n <FileText className=\"h-5 w-5 text-muted-foreground\" />\n {trend_data?.briefings && (\n <TrendIcon\n direction={getTrendDirection(briefing_pack_count, trend_data.briefings.previous)}\n />\n )}\n </div>\n <p className=\"text-2xl font-bold\">{briefing_pack_count}</p>\n <p className=\"text-xs text-muted-foreground\">{t('positions.analytics.briefingPacks')}</p>\n </div>\n </div>\n\n {/* Trend Chart Placeholder */}\n {trend_data?.daily && trend_data.daily.length > 0 && (\n <div className=\"space-y-2\">\n <p className=\"text-sm font-medium\">{t('positions.analytics.usageTrend')}</p>\n <div className=\"flex h-32 items-end justify-between gap-1 rounded-lg border p-4\">\n {trend_data.daily.slice(-7).map((day: any, i: number) => {\n const maxValue = Math.max(...trend_data.daily.map((d: any) => d.total));\n const height = (day.total / maxValue) * 100;\n return (\n <div\n key={i}\n className=\"flex-1 rounded-t bg-primary transition-all hover:opacity-80\"\n style={{ height: `${height}%`, minHeight: '4px' }}\n title={`${day.date}: ${day.total}`}\n />\n );\n })}\n </div>\n <p className=\"text-xs text-muted-foreground text-center\">\n {t('positions.analytics.last7Days')}\n </p>\n </div>\n )}\n </CardContent>\n </Card>\n );\n};\n\n// Trend Icon Component\nconst TrendIcon: React.FC<{ direction: 'up' | 'down' | 'stable' }> = ({ direction }) => {\n if (direction === 'up') {\n return <TrendingUp className=\"h-4 w-4 text-green-600\" />;\n }\n if (direction === 'down') {\n return <TrendingUp className=\"h-4 w-4 rotate-180 text-red-600\" />;\n }\n return <div className=\"h-4 w-4\" />; // Stable - no icon\n};\n","/**\n * Position Detail Page (T056)\n *\n * Detailed view of a single position with analytics and related engagements\n * Features: Full content display, version history, analytics card, cross-navigation\n * Integration: Accessible from library, dossier, and engagement contexts\n */\n\nimport { createFileRoute, Link, useNavigate } from '@tanstack/react-router';\nimport { useTranslation } from 'react-i18next';\nimport { usePosition } from '../../../hooks/usePosition';\nimport { usePositionAnalytics } from '../../../hooks/usePositionAnalytics';\nimport { useEngagementPositions } from '../../../hooks/useEngagementPositions';\nimport { PositionAnalyticsCard } from '../../../components/positions/PositionAnalyticsCard';\nimport { PositionEditor } from '../../../components/positions/PositionEditor';\nimport { Button } from '../../../components/ui/button';\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '../../../components/ui/card';\nimport { Badge } from '../../../components/ui/badge';\nimport { Skeleton } from '../../../components/ui/skeleton';\nimport { Separator } from '../../../components/ui/separator';\nimport {\n ArrowLeft,\n FileText,\n Calendar,\n User,\n Building,\n Link as LinkIcon,\n Edit,\n Archive,\n TrendingUp,\n} from 'lucide-react';\nimport { format } from 'date-fns';\nimport { ar, enUS } from 'date-fns/locale';\n\nexport const Route = createFileRoute('/_protected/positions/$positionId')({\n component: PositionDetailPage,\n});\n\nfunction PositionDetailPage() {\n const { positionId } = Route.useParams();\n const navigate = useNavigate();\n const { t, i18n } = useTranslation(['positions', 'common']);\n const isRTL = i18n.language === 'ar';\n const locale = isRTL ? ar : enUS;\n\n // Fetch position data\n const {\n data: position,\n isLoading,\n error,\n } = usePosition(positionId);\n\n // Fetch analytics\n const { data: analytics } = usePositionAnalytics(positionId);\n\n // Fetch related engagements (where this position is attached)\n // Note: This would need a new endpoint or query parameter\n // For now, we'll show a placeholder\n\n if (isLoading) {\n return (\n <div className=\"container mx-auto p-6 space-y-6\">\n <Skeleton className=\"h-8 w-64\" />\n <Skeleton className=\"h-96 w-full\" />\n <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n <Skeleton className=\"lg:col-span-2 h-64\" />\n <Skeleton className=\"h-64\" />\n </div>\n </div>\n );\n }\n\n if (error) {\n return (\n <div className=\"container mx-auto p-6\">\n <Card className=\"border-destructive\">\n <CardHeader>\n <CardTitle className=\"text-destructive flex items-center gap-2\">\n <FileText className=\"h-5 w-5\" />\n {t('common:error')}\n </CardTitle>\n <CardDescription>\n {error instanceof Error && error.message.includes('404')\n ? t('positions:detail.not_found')\n : t('positions:detail.error_loading')}\n </CardDescription>\n </CardHeader>\n <CardContent>\n <Button onClick={() => navigate({ to: '/positions' })} variant=\"outline\">\n <ArrowLeft className={`h-4 w-4 ${isRTL ? 'rotate-180' : ''}`} />\n {t('positions:detail.back_to_library')}\n </Button>\n </CardContent>\n </Card>\n </div>\n );\n }\n\n if (!position) return null;\n\n const statusColors = {\n draft: 'bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-200',\n review: 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-200',\n approved: 'bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-200',\n published: 'bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-200',\n archived: 'bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-200',\n };\n\n return (\n <div className={`min-h-screen bg-gray-50 dark:bg-gray-900 ${isRTL ? 'rtl' : 'ltr'}`}>\n {/* Header */}\n <div className=\"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700\">\n <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6\">\n <div className=\"flex items-start justify-between gap-4\">\n <div className=\"flex-1 min-w-0\">\n {/* Back Button */}\n <Button\n variant=\"ghost\"\n size=\"sm\"\n onClick={() => navigate({ to: '/positions' })}\n className=\"mb-4\"\n >\n <ArrowLeft className={`h-4 w-4 ${isRTL ? 'rotate-180' : ''}`} />\n {t('positions:detail.back_to_library')}\n </Button>\n\n {/* Title and Metadata */}\n <div className=\"space-y-2\">\n <div className=\"flex items-center gap-2 flex-wrap\">\n <h1 className=\"text-3xl font-bold text-gray-900 dark:text-gray-100\">\n {isRTL ? position.title_ar : position.title_en}\n </h1>\n <Badge className={statusColors[position.status]}>\n {t(`positions:status.${position.status}`)}\n </Badge>\n <Badge variant=\"outline\">\n {t(`positions:type.${position.type}`)}\n </Badge>\n </div>\n <div className=\"flex items-center gap-4 text-sm text-gray-500 dark:text-gray-400\">\n <span className=\"flex items-center gap-1\">\n <Calendar className=\"h-4 w-4\" />\n {format(new Date(position.updated_at), 'PPP', { locale })}\n </span>\n {position.created_by && (\n <span className=\"flex items-center gap-1\">\n <User className=\"h-4 w-4\" />\n {position.created_by}\n </span>\n )}\n </div>\n </div>\n </div>\n\n {/* Action Buttons */}\n <div className=\"flex items-center gap-2\">\n {position.status !== 'archived' && (\n <Button variant=\"outline\" size=\"sm\">\n <Edit className=\"h-4 w-4\" />\n {t('positions:detail.edit')}\n </Button>\n )}\n <Button variant=\"outline\" size=\"sm\">\n <Archive className=\"h-4 w-4\" />\n {position.status === 'archived'\n ? t('positions:detail.restore')\n : t('positions:detail.archive')}\n </Button>\n </div>\n </div>\n </div>\n </div>\n\n {/* Main Content */}\n <main className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\n <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n {/* Main Column - Position Content */}\n <div className=\"lg:col-span-2 space-y-6\">\n {/* Position Content */}\n <Card>\n <CardHeader>\n <CardTitle>{t('positions:detail.content_title')}</CardTitle>\n <CardDescription>\n {t('positions:detail.content_description')}\n </CardDescription>\n </CardHeader>\n <CardContent>\n <div className=\"prose dark:prose-invert max-w-none\">\n {/* English Content */}\n <div className=\"space-y-4\">\n <h3 className=\"text-lg font-semibold\">\n {t('positions:detail.english_version')}\n </h3>\n <div className=\"whitespace-pre-wrap\">{position.content_en}</div>\n </div>\n\n <Separator className=\"my-6\" />\n\n {/* Arabic Content */}\n <div className=\"space-y-4 text-end\" dir=\"rtl\">\n <h3 className=\"text-lg font-semibold\">\n {t('positions:detail.arabic_version')}\n </h3>\n <div className=\"whitespace-pre-wrap\">{position.content_ar}</div>\n </div>\n </div>\n </CardContent>\n </Card>\n\n {/* Related Engagements */}\n <Card>\n <CardHeader>\n <CardTitle className=\"flex items-center gap-2\">\n <LinkIcon className=\"h-5 w-5\" />\n {t('positions:detail.related_engagements')}\n </CardTitle>\n <CardDescription>\n {t('positions:detail.related_engagements_description')}\n </CardDescription>\n </CardHeader>\n <CardContent>\n {/* This would be populated with actual engagement data */}\n <div className=\"text-center py-8 text-gray-500 dark:text-gray-400\">\n <Building className=\"h-12 w-12 mx-auto mb-4 opacity-50\" />\n <p className=\"text-sm\">\n {t('positions:detail.no_related_engagements')}\n </p>\n </div>\n </CardContent>\n </Card>\n </div>\n\n {/* Sidebar - Analytics and Metadata */}\n <div className=\"space-y-6\">\n {/* Analytics Card */}\n {analytics && (\n <PositionAnalyticsCard positionId={positionId} analytics={analytics} />\n )}\n\n {/* Metadata Card */}\n <Card>\n <CardHeader>\n <CardTitle>{t('positions:detail.metadata_title')}</CardTitle>\n </CardHeader>\n <CardContent className=\"space-y-4\">\n <div>\n <p className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\n {t('positions:detail.dossier')}\n </p>\n {position.dossier_id ? (\n <Link\n to=\"/dossiers/$dossierId\"\n params={{ dossierId: position.dossier_id }}\n className=\"text-sm text-blue-600 dark:text-blue-400 hover:underline\"\n >\n {t('positions:detail.view_dossier')}\n </Link>\n ) : (\n <p className=\"text-sm text-gray-900 dark:text-gray-100\">\n {t('positions:detail.no_dossier')}\n </p>\n )}\n </div>\n\n <Separator />\n\n <div>\n <p className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\n {t('positions:detail.created')}\n </p>\n <p className=\"text-sm text-gray-900 dark:text-gray-100\">\n {format(new Date(position.created_at), 'PPP', { locale })}\n </p>\n </div>\n\n <div>\n <p className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\n {t('positions:detail.last_updated')}\n </p>\n <p className=\"text-sm text-gray-900 dark:text-gray-100\">\n {format(new Date(position.updated_at), 'PPP', { locale })}\n </p>\n </div>\n\n {position.version && (\n <>\n <Separator />\n <div>\n <p className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\n {t('positions:detail.version')}\n </p>\n <p className=\"text-sm text-gray-900 dark:text-gray-100\">\n v{position.version}\n </p>\n </div>\n </>\n )}\n </CardContent>\n </Card>\n </div>\n </div>\n </main>\n </div>\n );\n}\n"],"names":["fetchPositionAnalytics","positionId","authData","supabase","token","response","define_process_env_default","usePositionAnalytics","options","enabled","data","isLoading","isError","error","refetch","useQuery","PositionAnalyticsCard","className","t","i18n","useTranslation","locale","ar","enUS","analytics","jsxs","Card","jsx","CardHeader","CardTitle","CardContent","view_count","attachment_count","briefing_pack_count","last_viewed_at","last_attached_at","popularity_score","usage_rank","trend_data","getTrendDirection","current","previous","getPopularityVariant","score","TrendingUp","CardDescription","Award","Badge","Eye","TrendIcon","format","Link2","FileText","day","i","maxValue","d","height","direction","PositionDetailPage","Route","useParams","navigate","useNavigate","isRTL","language","position","usePosition","Skeleton","Error","message","includes","Button","to","ArrowLeft","statusColors","draft","review","approved","published","archived","title_ar","title_en","status","type","Calendar","Date","updated_at","created_by","User","Edit","Archive","content_en","Separator","content_ar","LinkIcon","Building","dossier_id","Link","dossierId","created_at","version","Fragment"],"mappings":"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"}