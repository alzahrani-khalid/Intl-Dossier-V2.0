{"version":3,"file":"delegations-CiYSCmWd.js","sources":["../../src/components/delegation/DelegationCard.tsx","../../src/services/user-management-api.ts","../../src/hooks/use-delegation.ts","../../src/components/delegation/RevokeDelegationDialog.tsx","../../src/components/delegation/DelegationList.tsx","../../src/components/delegation/CreateDelegationDialog.tsx","../../src/components/delegation/DelegationExpiryBanner.tsx","../../src/pages/delegations/DelegationManagementPage.tsx","../../src/routes/_protected/delegations.tsx?tsr-split=component"],"sourcesContent":["/**\n * DelegationCard Component\n * Displays a single delegation item with status, dates, and actions\n *\n * Feature: delegation-management\n */\n\nimport { useTranslation } from 'react-i18next';\nimport { format, differenceInDays, isPast, isFuture } from 'date-fns';\nimport { ar, enUS } from 'date-fns/locale';\nimport { Card, CardContent, CardHeader } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { Button } from '@/components/ui/button';\nimport { Avatar, AvatarFallback } from '@/components/ui/avatar';\nimport {\n  ArrowRight,\n  Calendar,\n  Clock,\n  XCircle,\n  AlertTriangle,\n  User,\n  FileText,\n} from 'lucide-react';\nimport type { Delegation } from '@/services/user-management-api';\n\ninterface DelegationCardProps {\n  delegation: Delegation;\n  type: 'granted' | 'received';\n  onRevoke?: (delegationId: string) => void;\n  isRevoking?: boolean;\n}\n\nexport function DelegationCard({\n  delegation,\n  type,\n  onRevoke,\n  isRevoking = false,\n}: DelegationCardProps) {\n  const { t, i18n } = useTranslation('delegation');\n  const isRTL = i18n.language === 'ar';\n  const dateLocale = isRTL ? ar : enUS;\n\n  // Calculate status and expiry info\n  const now = new Date();\n  const expiresAt = new Date(delegation.valid_until);\n  const startsAt = new Date(delegation.valid_from);\n  const daysUntilExpiry = differenceInDays(expiresAt, now);\n  const isExpired = isPast(expiresAt);\n  const isNotStarted = isFuture(startsAt);\n  const isRevoked = !!delegation.revoked_at;\n  const isExpiringSoon = !isExpired && !isRevoked && daysUntilExpiry <= 7;\n\n  // Determine badge status\n  const getStatus = () => {\n    if (isRevoked) return { label: t('badge.revoked'), variant: 'destructive' as const };\n    if (isExpired) return { label: t('badge.expired'), variant: 'secondary' as const };\n    if (isExpiringSoon) return { label: t('badge.expiringSoon'), variant: 'outline' as const };\n    return { label: t('badge.active'), variant: 'default' as const };\n  };\n\n  const status = getStatus();\n\n  // Get expiry text\n  const getExpiryText = () => {\n    if (isExpired) {\n      const daysAgo = Math.abs(daysUntilExpiry);\n      return t('card.expired', { days: daysAgo });\n    }\n    if (daysUntilExpiry === 0) return t('card.expiresToday');\n    if (daysUntilExpiry === 1) return t('card.expiresTomorrow');\n    return t('card.expiresIn', { days: daysUntilExpiry });\n  };\n\n  // Get initials for avatar\n  const getInitials = (email: string) => {\n    const parts = email.split('@')[0].split(/[._-]/);\n    if (parts.length >= 2) {\n      return `${parts[0][0]}${parts[1][0]}`.toUpperCase();\n    }\n    return email.slice(0, 2).toUpperCase();\n  };\n\n  const displayUser = type === 'granted' ? delegation.grantee_email : delegation.grantor_email;\n\n  return (\n    <Card\n      className={`transition-all ${isRevoked || isExpired ? 'opacity-60' : ''} ${\n        isExpiringSoon ? 'border-yellow-500/50' : ''\n      }`}\n    >\n      <CardHeader className=\"pb-3\">\n        <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-3\">\n          {/* User Info */}\n          <div className=\"flex items-center gap-3\">\n            <Avatar className=\"h-10 w-10\">\n              <AvatarFallback>{getInitials(displayUser)}</AvatarFallback>\n            </Avatar>\n            <div className=\"flex-1 min-w-0\">\n              <div className=\"flex items-center gap-2\">\n                <span className=\"text-sm text-muted-foreground\">\n                  {type === 'granted' ? t('card.to') : t('card.from')}\n                </span>\n                <ArrowRight\n                  className={`h-3 w-3 text-muted-foreground ${isRTL ? 'rotate-180' : ''}`}\n                />\n              </div>\n              <p className=\"font-medium truncate\">{displayUser}</p>\n            </div>\n          </div>\n\n          {/* Status Badge */}\n          <div className=\"flex items-center gap-2\">\n            <Badge variant={status.variant} className=\"min-h-6\">\n              {status.label}\n            </Badge>\n            {isExpiringSoon && !isRevoked && (\n              <AlertTriangle className=\"h-4 w-4 text-yellow-500\" />\n            )}\n          </div>\n        </div>\n      </CardHeader>\n\n      <CardContent className=\"space-y-4\">\n        {/* Dates */}\n        <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-3\">\n          <div className=\"flex items-center gap-2 text-sm\">\n            <Calendar className=\"h-4 w-4 text-muted-foreground flex-shrink-0\" />\n            <span className=\"text-muted-foreground\">{t('card.validFrom')}:</span>\n            <span className=\"font-medium\">\n              {format(startsAt, 'PP', { locale: dateLocale })}\n            </span>\n          </div>\n          <div className=\"flex items-center gap-2 text-sm\">\n            <Calendar className=\"h-4 w-4 text-muted-foreground flex-shrink-0\" />\n            <span className=\"text-muted-foreground\">{t('card.validUntil')}:</span>\n            <span className=\"font-medium\">\n              {format(expiresAt, 'PP', { locale: dateLocale })}\n            </span>\n          </div>\n        </div>\n\n        {/* Expiry indicator */}\n        {!isRevoked && (\n          <div\n            className={`flex items-center gap-2 text-sm ${\n              isExpired\n                ? 'text-destructive'\n                : isExpiringSoon\n                ? 'text-yellow-600 dark:text-yellow-500'\n                : 'text-muted-foreground'\n            }`}\n          >\n            <Clock className=\"h-4 w-4 flex-shrink-0\" />\n            <span>{getExpiryText()}</span>\n          </div>\n        )}\n\n        {/* Reason */}\n        {delegation.reason && (\n          <div className=\"flex items-start gap-2 text-sm\">\n            <FileText className=\"h-4 w-4 text-muted-foreground flex-shrink-0 mt-0.5\" />\n            <div>\n              <span className=\"text-muted-foreground\">{t('card.reason')}: </span>\n              <span>{delegation.reason}</span>\n            </div>\n          </div>\n        )}\n\n        {/* Resource scope */}\n        {(delegation.resource_type || delegation.resource_id) && (\n          <div className=\"flex items-center gap-2 text-sm\">\n            <User className=\"h-4 w-4 text-muted-foreground flex-shrink-0\" />\n            <span className=\"text-muted-foreground\">{t('card.resourceType')}: </span>\n            <Badge variant=\"outline\" className=\"text-xs\">\n              {delegation.resource_type\n                ? t(`resourceTypes.${delegation.resource_type}`)\n                : t('card.allResources')}\n            </Badge>\n          </div>\n        )}\n\n        {/* Revocation info */}\n        {isRevoked && delegation.revoked_at && (\n          <div className=\"pt-3 border-t space-y-2\">\n            <div className=\"flex items-center gap-2 text-sm text-destructive\">\n              <XCircle className=\"h-4 w-4 flex-shrink-0\" />\n              <span>{t('card.revokedAt')}: </span>\n              <span className=\"font-medium\">\n                {format(new Date(delegation.revoked_at), 'PP', { locale: dateLocale })}\n              </span>\n            </div>\n          </div>\n        )}\n\n        {/* Actions */}\n        {type === 'granted' && !isRevoked && !isExpired && onRevoke && (\n          <div className=\"pt-3 border-t\">\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              onClick={() => onRevoke(delegation.id)}\n              disabled={isRevoking}\n              className={`w-full sm:w-auto min-h-9 text-destructive hover:text-destructive ${\n                isRTL ? 'flex-row-reverse' : ''\n              }`}\n            >\n              <XCircle className={`h-4 w-4 ${isRTL ? 'ms-2' : 'me-2'}`} />\n              {isRevoking ? t('common:common.loading') : t('actions.revoke')}\n            </Button>\n          </div>\n        )}\n      </CardContent>\n    </Card>\n  );\n}\n","/**\n * User Management API Client\n * Provides methods for user lifecycle management operations\n */\n\nimport { supabase } from '@/lib/supabase';\n\n// ============================================================================\n// Types\n// ============================================================================\n\nexport interface CreateUserRequest {\n  email: string;\n  username: string;\n  full_name: string;\n  role: 'admin' | 'editor' | 'viewer';\n  user_type?: 'employee' | 'guest';\n  expires_at?: string; // ISO date string (required for guest)\n  allowed_resources?: string[]; // Array of resource UUIDs (required for guest)\n}\n\nexport interface CreateUserResponse {\n  success: boolean;\n  user_id: string;\n  activation_sent: boolean;\n  activation_expires_at: string;\n}\n\nexport interface ActivateAccountRequest {\n  activation_token: string;\n  password: string;\n}\n\nexport interface ActivateAccountResponse {\n  success: boolean;\n  message: string;\n}\n\nexport interface ApiError {\n  error: string;\n  code: string;\n  details?: string[];\n}\n\nexport interface AssignRoleRequest {\n  user_id: string;\n  new_role: 'admin' | 'editor' | 'viewer';\n  reason?: string;\n}\n\nexport interface AssignRoleImmediateResponse {\n  success: boolean;\n  role_changed: boolean;\n  new_role: string;\n  sessions_terminated: number;\n}\n\nexport interface AssignRoleApprovalResponse {\n  success: boolean;\n  requires_approval: boolean;\n  approval_request_id: string;\n  pending_approvals: number;\n}\n\nexport type AssignRoleResponse = AssignRoleImmediateResponse | AssignRoleApprovalResponse;\n\nexport interface ApproveRoleChangeRequest {\n  approval_request_id: string;\n  approved: boolean;\n  rejection_reason?: string;\n}\n\nexport interface ApproveRoleFirstResponse {\n  success: boolean;\n  status: 'first_approved';\n  remaining_approvals: number;\n}\n\nexport interface ApproveRoleAppliedResponse {\n  success: boolean;\n  status: 'approved';\n  role_applied: boolean;\n  user_id: string;\n  new_role: string;\n}\n\nexport interface ApproveRoleRejectedResponse {\n  success: boolean;\n  status: 'rejected';\n  rejection_reason: string;\n}\n\nexport type ApproveRoleChangeResponse =\n  | ApproveRoleFirstResponse\n  | ApproveRoleAppliedResponse\n  | ApproveRoleRejectedResponse;\n\nexport interface PendingApproval {\n  id: string;\n  user_id: string;\n  user_email: string;\n  requested_role: string;\n  requester_id: string;\n  requester_email: string;\n  status: 'pending' | 'first_approved' | 'approved' | 'rejected';\n  first_approver_email?: string;\n  first_approved_at?: string;\n  created_at: string;\n}\n\nexport interface PendingApprovalsResponse {\n  approvals: PendingApproval[];\n  total: number;\n  limit: number;\n  offset: number;\n}\n\nexport interface DelegationSummary {\n  id: string;\n  grantor_email: string;\n  resource_type: string;\n  resource_id: string;\n  valid_until: string;\n}\n\nexport interface UserPermissionsResponse {\n  user_id: string;\n  email: string;\n  primary_role: string;\n  active_delegations: DelegationSummary[];\n  effective_permissions: {\n    can_create_dossiers: boolean;\n    can_edit_dossiers: boolean;\n    can_manage_users: boolean;\n    accessible_resources: string[];\n  };\n}\n\nexport interface DeactivateUserRequest {\n  userId: string;\n  reason?: string;\n}\n\nexport interface OrphanedItemsSummary {\n  dossiers: number;\n  assignments: number;\n  delegations: number;\n  approvals: number;\n}\n\nexport interface DeactivateUserResponse {\n  success: boolean;\n  orphanedItems?: OrphanedItemsSummary;\n  sessionsTerminated?: number;\n  delegationsRevoked?: number;\n}\n\nexport interface ReactivateUserRequest {\n  userId: string;\n  securityReviewApproval?: string;\n  reason?: string;\n}\n\nexport interface ReactivateUserResponse {\n  success: boolean;\n  roleRestored?: string;\n}\n\n// Delegation types\nexport interface DelegatePermissionsRequest {\n  grantee_id: string;\n  resource_type?: string | null;\n  resource_id?: string | null;\n  valid_from?: string;\n  valid_until: string;\n  reason: string;\n}\n\nexport interface DelegatePermissionsResponse {\n  success: boolean;\n  delegation_id: string;\n  grantor_id: string;\n  grantee_id: string;\n  valid_from: string;\n  valid_until: string;\n  expires_in_days: number;\n}\n\nexport interface RevokeDelegationRequest {\n  delegation_id: string;\n  reason?: string;\n}\n\nexport interface RevokeDelegationResponse {\n  success: boolean;\n  delegation_id: string;\n  revoked_at: string;\n  revoked_by: string;\n}\n\nexport interface ValidateDelegationRequest {\n  grantee_id: string;\n  resource_type?: string;\n  resource_id?: string;\n}\n\nexport interface ValidationIssue {\n  code: string;\n  message: string;\n}\n\nexport interface DelegationChainNode {\n  from_user: string;\n  to_user: string;\n  resource: string;\n}\n\nexport interface ValidateDelegationResponse {\n  valid: boolean;\n  can_delegate: boolean;\n  issues: ValidationIssue[];\n  delegation_chain: DelegationChainNode[];\n}\n\nexport interface Delegation {\n  id: string;\n  grantor_id: string;\n  grantor_email: string;\n  grantee_id: string;\n  grantee_email: string;\n  source: string;\n  resource_type: string | null;\n  resource_id: string | null;\n  reason: string;\n  is_active: boolean;\n  valid_from: string;\n  valid_until: string;\n  revoked_at: string | null;\n  revoked_by: string | null;\n  expires_in_days: number;\n  created_at: string;\n}\n\nexport interface MyDelegationsResponse {\n  granted: Delegation[];\n  received: Delegation[];\n  total: number;\n}\n\n// ============================================================================\n// API Client Methods\n// ============================================================================\n\n/**\n * Create a new user account (admin only)\n *\n * @param data - User creation data\n * @returns Promise with user creation response\n * @throws ApiError if creation fails\n */\nexport async function createUser(data: CreateUserRequest): Promise<CreateUserResponse> {\n  const { data: result, error } = await supabase.functions.invoke<CreateUserResponse>('create-user', {\n    body: data,\n  });\n\n  if (error) {\n    throw error;\n  }\n\n  if (!result) {\n    throw new Error('No response from create-user function');\n  }\n\n  return result;\n}\n\n/**\n * Activate a user account with activation token and password\n *\n * @param data - Activation data (token and password)\n * @returns Promise with activation response\n * @throws ApiError if activation fails\n */\nexport async function activateAccount(data: ActivateAccountRequest): Promise<ActivateAccountResponse> {\n  const { data: result, error } = await supabase.functions.invoke<ActivateAccountResponse>('activate-account', {\n    body: data,\n  });\n\n  if (error) {\n    throw error;\n  }\n\n  if (!result) {\n    throw new Error('No response from activate-account function');\n  }\n\n  return result;\n}\n\n/**\n * Assign or change user role (admin only)\n *\n * Admin role assignments require dual approval workflow.\n * Non-admin role changes (viewer â†” editor) take effect immediately.\n *\n * @param data - Role assignment data\n * @returns Promise with role assignment response\n * @throws ApiError if assignment fails\n */\nexport async function assignRole(data: AssignRoleRequest): Promise<AssignRoleResponse> {\n  const { data: result, error } = await supabase.functions.invoke<AssignRoleResponse>('assign-role', {\n    body: data,\n  });\n\n  if (error) {\n    throw error;\n  }\n\n  if (!result) {\n    throw new Error('No response from assign-role function');\n  }\n\n  return result;\n}\n\n/**\n * Approve or reject a pending admin role assignment (admin only)\n *\n * Requires two distinct administrators. Second approval automatically applies the role change.\n *\n * @param data - Approval request data\n * @returns Promise with approval response\n * @throws ApiError if approval fails\n */\nexport async function approveRoleChange(data: ApproveRoleChangeRequest): Promise<ApproveRoleChangeResponse> {\n  const { data: result, error } = await supabase.functions.invoke<ApproveRoleChangeResponse>('approve-role-change', {\n    body: data,\n  });\n\n  if (error) {\n    throw error;\n  }\n\n  if (!result) {\n    throw new Error('No response from approve-role-change function');\n  }\n\n  return result;\n}\n\n/**\n * Get list of pending role approval requests (admin only)\n *\n * @param params - Query parameters (status, limit, offset)\n * @returns Promise with pending approvals list\n * @throws ApiError if request fails\n */\nexport async function getPendingApprovals(params?: {\n  status?: 'pending' | 'first_approved' | 'approved' | 'rejected';\n  limit?: number;\n  offset?: number;\n}): Promise<PendingApprovalsResponse> {\n  const queryParams = new URLSearchParams();\n  if (params?.status) queryParams.set('status', params.status);\n  if (params?.limit) queryParams.set('limit', params.limit.toString());\n  if (params?.offset) queryParams.set('offset', params.offset.toString());\n\n  const { data: result, error } = await supabase.functions.invoke<PendingApprovalsResponse>('pending-approvals', {\n    method: 'GET',\n  });\n\n  if (error) {\n    throw error;\n  }\n\n  if (!result) {\n    throw new Error('No response from pending-approvals function');\n  }\n\n  return result;\n}\n\n/**\n * Get comprehensive user permissions (role + delegations)\n *\n * Authenticated user can view own permissions, admin can view any user.\n *\n * @param userId - User ID to retrieve permissions for\n * @returns Promise with user permissions response\n * @throws ApiError if request fails\n */\nexport async function getUserPermissions(userId: string): Promise<UserPermissionsResponse> {\n  const { data: result, error } = await supabase.functions.invoke<UserPermissionsResponse>('user-permissions', {\n    method: 'GET',\n    body: { user_id: userId },\n  });\n\n  if (error) {\n    throw error;\n  }\n\n  if (!result) {\n    throw new Error('No response from user-permissions function');\n  }\n\n  return result;\n}\n\n/**\n * Deactivate a user account (admin only)\n *\n * Terminates all active sessions, revokes delegations, and marks work items as orphaned.\n * Requires deactivation reason for audit trail.\n *\n * @param data - Deactivation request data\n * @returns Promise with deactivation response including orphaned items summary\n * @throws ApiError if deactivation fails\n */\nexport async function deactivateUser(data: DeactivateUserRequest): Promise<DeactivateUserResponse> {\n  const { data: result, error } = await supabase.functions.invoke<DeactivateUserResponse>('deactivate-user', {\n    body: data,\n  });\n\n  if (error) {\n    throw error;\n  }\n\n  if (!result) {\n    throw new Error('No response from deactivate-user function');\n  }\n\n  return result;\n}\n\n/**\n * Reactivate a deactivated user account (admin only)\n *\n * Restores user status to active. Admin role reactivation requires security review approval.\n *\n * @param data - Reactivation request data\n * @returns Promise with reactivation response\n * @throws ApiError if reactivation fails\n */\nexport async function reactivateUser(data: ReactivateUserRequest): Promise<ReactivateUserResponse> {\n  const { data: result, error } = await supabase.functions.invoke<ReactivateUserResponse>('reactivate-user', {\n    body: data,\n  });\n\n  if (error) {\n    throw error;\n  }\n\n  if (!result) {\n    throw new Error('No response from reactivate-user function');\n  }\n\n  return result;\n}\n\n/**\n * Delegate permissions to another user for a time period\n *\n * Creates a time-bound delegation from current user to grantee. Validates permissions,\n * prevents circular delegations, and enforces non-transitive delegation rules.\n *\n * @param data - Delegation request data\n * @returns Promise with delegation response\n * @throws ApiError if delegation fails\n */\nexport async function delegatePermissions(data: DelegatePermissionsRequest): Promise<DelegatePermissionsResponse> {\n  const { data: result, error } = await supabase.functions.invoke<DelegatePermissionsResponse>('delegate-permissions', {\n    body: data,\n  });\n\n  if (error) {\n    throw error;\n  }\n\n  if (!result) {\n    throw new Error('No response from delegate-permissions function');\n  }\n\n  return result;\n}\n\n/**\n * Manually revoke an active delegation\n *\n * Revokes delegation before its expiration date. Only the grantor or an admin can revoke.\n *\n * @param data - Revocation request data\n * @returns Promise with revocation response\n * @throws ApiError if revocation fails\n */\nexport async function revokeDelegation(data: RevokeDelegationRequest): Promise<RevokeDelegationResponse> {\n  const { data: result, error } = await supabase.functions.invoke<RevokeDelegationResponse>('revoke-delegation', {\n    body: data,\n  });\n\n  if (error) {\n    throw error;\n  }\n\n  if (!result) {\n    throw new Error('No response from revoke-delegation function');\n  }\n\n  return result;\n}\n\n/**\n * Validate if user can delegate to another user\n *\n * Pre-validation check before creating delegation. Checks permissions, circular references,\n * and transitive delegation rules.\n *\n * @param data - Validation request data\n * @returns Promise with validation response\n * @throws ApiError if validation fails\n */\nexport async function validateDelegation(data: ValidateDelegationRequest): Promise<ValidateDelegationResponse> {\n  const { data: result, error } = await supabase.functions.invoke<ValidateDelegationResponse>('validate-delegation', {\n    body: data,\n  });\n\n  if (error) {\n    throw error;\n  }\n\n  if (!result) {\n    throw new Error('No response from validate-delegation function');\n  }\n\n  return result;\n}\n\n/**\n * Get user's delegations (granted and received)\n *\n * Retrieves delegations where user is grantor (granted) or grantee (received).\n * Supports filtering by type, active status, and expiration timeframe.\n *\n * @param params - Query parameters (type, active_only, expiring_within_days)\n * @returns Promise with delegations response\n * @throws ApiError if request fails\n */\nexport async function getMyDelegations(params?: {\n  type?: 'granted' | 'received' | 'all';\n  active_only?: boolean;\n  expiring_within_days?: number;\n}): Promise<MyDelegationsResponse> {\n  const queryParams = new URLSearchParams();\n  if (params?.type) queryParams.set('type', params.type);\n  if (params?.active_only !== undefined) queryParams.set('active_only', params.active_only.toString());\n  if (params?.expiring_within_days) queryParams.set('expiring_within_days', params.expiring_within_days.toString());\n\n  const url = `my-delegations${queryParams.toString() ? `?${queryParams.toString()}` : ''}`;\n\n  const { data: result, error } = await supabase.functions.invoke<MyDelegationsResponse>(url, {\n    method: 'GET',\n  });\n\n  if (error) {\n    throw error;\n  }\n\n  if (!result) {\n    throw new Error('No response from my-delegations function');\n  }\n\n  return result;\n}\n\n// ============================================================================\n// Access Review Types\n// ============================================================================\n\nexport interface GenerateAccessReviewRequest {\n  review_name: string;\n  review_scope: 'all_users' | 'department' | 'role' | 'custom';\n  department?: string;\n  role?: 'admin' | 'editor' | 'viewer';\n  user_ids?: string[];\n  include_inactive_threshold_days?: number;\n}\n\nexport interface FindingsSummary {\n  inactive_users: number;\n  excessive_permissions: number;\n  guest_accounts_expiring: number;\n  orphaned_delegations: number;\n}\n\nexport interface GenerateAccessReviewResponse {\n  success: boolean;\n  review_id: string;\n  review_name: string;\n  users_reviewed: number;\n  findings_summary: FindingsSummary;\n  generation_time_ms: number;\n}\n\nexport interface ReviewFinding {\n  user_id: string;\n  email: string;\n  full_name: string;\n  primary_role: string;\n  issues: string[];\n  recommendations: string[];\n  last_login_at: string | null;\n  days_since_login: number | null;\n  active_delegations: Array<{\n    id: string;\n    grantor_email: string;\n    resource_type: string;\n    valid_until: string;\n  }>;\n  certified_by: string | null;\n  certified_at: string | null;\n}\n\nexport interface AccessReviewDetailResponse {\n  id: string;\n  review_name: string;\n  review_scope: string;\n  reviewer_email: string;\n  status: 'in_progress' | 'completed';\n  review_date: string;\n  completed_at: string | null;\n  findings: ReviewFinding[];\n  summary: {\n    total_users: number;\n    issues_identified: number;\n    recommendations_count: number;\n  };\n}\n\nexport interface CertifyUserAccessRequest {\n  review_id: string;\n  user_id: string;\n  certified: boolean;\n  requested_changes?: Array<{\n    change_type: 'reduce_role' | 'remove_delegation' | 'deactivate' | 'other';\n    reason: string;\n  }>;\n}\n\nexport interface CertifyUserAccessResponse {\n  success: boolean;\n  review_id: string;\n  user_id: string;\n  certified: boolean;\n  certified_at: string;\n}\n\nexport interface CompleteAccessReviewRequest {\n  review_id: string;\n  notes?: string;\n}\n\nexport interface CompleteAccessReviewResponse {\n  success: boolean;\n  review_id: string;\n  completed_at: string;\n  compliance_report_url: string;\n}\n\nexport interface InactiveUser {\n  user_id: string;\n  email: string;\n  full_name: string;\n  role: string;\n  last_login_at: string | null;\n  days_since_login: number;\n  active_delegations: number;\n  owned_dossiers: number;\n}\n\nexport interface InactiveUsersResponse {\n  users: InactiveUser[];\n  total: number;\n}\n\nexport interface ScheduleAccessReviewRequest {\n  schedule_type: 'automatic_quarterly' | 'manual_override' | 'disable';\n  next_review_date?: string;\n  review_scope?: 'all_users' | 'department' | 'role';\n  auto_assign_reviewer?: string;\n}\n\nexport interface ScheduleAccessReviewResponse {\n  success: boolean;\n  schedule_type: string;\n  next_scheduled_review: string;\n  cron_expression: string;\n}\n\n// ============================================================================\n// Access Review API Methods\n// ============================================================================\n\n/**\n * Generate comprehensive access review report (admin only)\n *\n * Creates access review with findings for specified user scope.\n * Uses materialized view for performance (<10s for 1000+ users).\n *\n * @param data - Access review generation request\n * @returns Promise with review generation response\n * @throws ApiError if generation fails\n */\nexport async function generateAccessReview(data: GenerateAccessReviewRequest): Promise<GenerateAccessReviewResponse> {\n  const { data: result, error } = await supabase.functions.invoke<GenerateAccessReviewResponse>('generate-access-review', {\n    body: data,\n  });\n\n  if (error) {\n    throw error;\n  }\n\n  if (!result) {\n    throw new Error('No response from generate-access-review function');\n  }\n\n  return result;\n}\n\n/**\n * Get detailed access review findings (admin only)\n *\n * Retrieves review details with optional finding type filter.\n *\n * @param reviewId - Access review ID\n * @param findingType - Optional filter (all, inactive_users, excessive_permissions, expiring_guests, orphaned_delegations)\n * @returns Promise with review detail response\n * @throws ApiError if request fails\n */\nexport async function getAccessReviewDetail(\n  reviewId: string,\n  findingType?: 'all' | 'inactive_users' | 'excessive_permissions' | 'expiring_guests' | 'orphaned_delegations'\n): Promise<AccessReviewDetailResponse> {\n  const queryParams = new URLSearchParams();\n  if (findingType) queryParams.set('finding_type', findingType);\n\n  const url = `access-review-detail/${reviewId}${queryParams.toString() ? `?${queryParams.toString()}` : ''}`;\n\n  const { data: result, error } = await supabase.functions.invoke<AccessReviewDetailResponse>(url, {\n    method: 'GET',\n  });\n\n  if (error) {\n    throw error;\n  }\n\n  if (!result) {\n    throw new Error('No response from access-review-detail function');\n  }\n\n  return result;\n}\n\n/**\n * Certify user access as appropriate or request changes (admin/manager only)\n *\n * Records certification decision for user in access review.\n *\n * @param data - Certification request data\n * @returns Promise with certification response\n * @throws ApiError if certification fails\n */\nexport async function certifyUserAccess(data: CertifyUserAccessRequest): Promise<CertifyUserAccessResponse> {\n  const { data: result, error } = await supabase.functions.invoke<CertifyUserAccessResponse>('certify-user-access', {\n    body: data,\n  });\n\n  if (error) {\n    throw error;\n  }\n\n  if (!result) {\n    throw new Error('No response from certify-user-access function');\n  }\n\n  return result;\n}\n\n/**\n * Mark access review as completed and generate compliance report (admin only)\n *\n * Finalizes review, locks findings, generates compliance report.\n * Must be the assigned reviewer.\n *\n * @param data - Completion request data\n * @returns Promise with completion response\n * @throws ApiError if completion fails\n */\nexport async function completeAccessReview(data: CompleteAccessReviewRequest): Promise<CompleteAccessReviewResponse> {\n  const { data: result, error } = await supabase.functions.invoke<CompleteAccessReviewResponse>('complete-access-review', {\n    body: data,\n  });\n\n  if (error) {\n    throw error;\n  }\n\n  if (!result) {\n    throw new Error('No response from complete-access-review function');\n  }\n\n  return result;\n}\n\n/**\n * Get list of inactive users flagged for review (admin only)\n *\n * Retrieves users who haven't logged in for specified threshold period.\n *\n * @param inactiveDays - Minimum days of inactivity (default: 90)\n * @param limit - Maximum results to return (default: 100, max: 500)\n * @returns Promise with inactive users list\n * @throws ApiError if request fails\n */\nexport async function getInactiveUsers(\n  inactiveDays: number = 90,\n  limit: number = 100\n): Promise<InactiveUsersResponse> {\n  const queryParams = new URLSearchParams();\n  queryParams.set('inactive_days', inactiveDays.toString());\n  queryParams.set('limit', limit.toString());\n\n  const url = `inactive-users?${queryParams.toString()}`;\n\n  const { data: result, error } = await supabase.functions.invoke<InactiveUsersResponse>(url, {\n    method: 'GET',\n  });\n\n  if (error) {\n    throw error;\n  }\n\n  if (!result) {\n    throw new Error('No response from inactive-users function');\n  }\n\n  return result;\n}\n\n/**\n * Configure automatic access review scheduling (admin only)\n *\n * Sets up quarterly automatic reviews or manual override scheduling.\n *\n * @param data - Schedule configuration request\n * @returns Promise with schedule configuration response\n * @throws ApiError if configuration fails\n */\nexport async function scheduleAccessReview(data: ScheduleAccessReviewRequest): Promise<ScheduleAccessReviewResponse> {\n  const { data: result, error } = await supabase.functions.invoke<ScheduleAccessReviewResponse>('schedule-access-review', {\n    body: data,\n  });\n\n  if (error) {\n    throw error;\n  }\n\n  if (!result) {\n    throw new Error('No response from schedule-access-review function');\n  }\n\n  return result;\n}\n","/**\n * Delegation Management Hooks\n * TanStack Query hooks for delegation operations\n *\n * Feature: 019-user-management-access\n * Task: T053\n */\n\nimport { useMutation, useQuery, useQueryClient } from '@tanstack/react-query';\nimport {\n  delegatePermissions,\n  revokeDelegation,\n  validateDelegation,\n  getMyDelegations,\n  type DelegatePermissionsRequest,\n  type DelegatePermissionsResponse,\n  type RevokeDelegationRequest,\n  type RevokeDelegationResponse,\n  type ValidateDelegationRequest,\n  type ValidateDelegationResponse,\n  type MyDelegationsResponse,\n} from '@/services/user-management-api';\n\n// ============================================================================\n// Query Keys\n// ============================================================================\n\nexport const delegationKeys = {\n  all: ['delegations'] as const,\n  myDelegations: (params?: {\n    type?: 'granted' | 'received' | 'all';\n    active_only?: boolean;\n    expiring_within_days?: number;\n  }) => ['delegations', 'my', params] as const,\n  validate: (granteeId: string, resourceType?: string, resourceId?: string) =>\n    ['delegations', 'validate', granteeId, resourceType, resourceId] as const,\n};\n\n// ============================================================================\n// Hooks\n// ============================================================================\n\n/**\n * Hook to create a new delegation\n *\n * @returns Mutation for creating delegation\n *\n * @example\n * ```tsx\n * const { mutate: delegate, isPending } = useDelegatePermissions();\n *\n * delegate({\n *   grantee_id: 'user-uuid',\n *   valid_until: '2025-12-31T23:59:59Z',\n *   reason: 'Vacation coverage',\n * });\n * ```\n */\nexport function useDelegatePermissions() {\n  const queryClient = useQueryClient();\n\n  return useMutation<DelegatePermissionsResponse, Error, DelegatePermissionsRequest>({\n    mutationFn: delegatePermissions,\n    onSuccess: () => {\n      // Invalidate my delegations query to refetch updated list\n      queryClient.invalidateQueries({\n        queryKey: delegationKeys.all,\n      });\n    },\n  });\n}\n\n/**\n * Hook to revoke an active delegation\n *\n * @returns Mutation for revoking delegation\n *\n * @example\n * ```tsx\n * const { mutate: revoke, isPending } = useRevokeDelegation();\n *\n * revoke({\n *   delegation_id: 'delegation-uuid',\n *   reason: 'User returned early',\n * });\n * ```\n */\nexport function useRevokeDelegation() {\n  const queryClient = useQueryClient();\n\n  return useMutation<RevokeDelegationResponse, Error, RevokeDelegationRequest>({\n    mutationFn: revokeDelegation,\n    onSuccess: () => {\n      // Invalidate my delegations query to refetch updated list\n      queryClient.invalidateQueries({\n        queryKey: delegationKeys.all,\n      });\n    },\n  });\n}\n\n/**\n * Hook to validate if delegation can be created\n *\n * @param data - Validation request data\n * @param options - Query options (enabled, etc.)\n * @returns Query with validation result\n *\n * @example\n * ```tsx\n * const { data: validation, isLoading } = useValidateDelegation({\n *   grantee_id: 'user-uuid',\n * }, {\n *   enabled: !!granteeId, // Only validate when grantee is selected\n * });\n *\n * if (validation?.valid) {\n *   // Show delegation form\n * } else {\n *   // Show validation errors\n * }\n * ```\n */\nexport function useValidateDelegation(\n  data: ValidateDelegationRequest,\n  options?: {\n    enabled?: boolean;\n  }\n) {\n  return useQuery<ValidateDelegationResponse, Error>({\n    queryKey: delegationKeys.validate(data.grantee_id, data.resource_type, data.resource_id),\n    queryFn: () => validateDelegation(data),\n    enabled: options?.enabled ?? !!data.grantee_id,\n    staleTime: 30000, // 30 seconds - validation should be relatively fresh\n  });\n}\n\n/**\n * Hook to get user's delegations (granted and received)\n *\n * @param params - Query parameters (type, active_only, expiring_within_days)\n * @param options - Query options (enabled, etc.)\n * @returns Query with delegations list\n *\n * @example\n * ```tsx\n * // Get all active delegations\n * const { data: delegations } = useMyDelegations({\n *   active_only: true,\n * });\n *\n * // Get delegations expiring within 7 days\n * const { data: expiring } = useMyDelegations({\n *   active_only: true,\n *   expiring_within_days: 7,\n * });\n *\n * // Get only granted delegations\n * const { data: granted } = useMyDelegations({\n *   type: 'granted',\n * });\n * ```\n */\nexport function useMyDelegations(\n  params?: {\n    type?: 'granted' | 'received' | 'all';\n    active_only?: boolean;\n    expiring_within_days?: number;\n  },\n  options?: {\n    enabled?: boolean;\n    refetchInterval?: number;\n  }\n) {\n  return useQuery<MyDelegationsResponse, Error>({\n    queryKey: delegationKeys.myDelegations(params),\n    queryFn: () => getMyDelegations(params),\n    enabled: options?.enabled ?? true,\n    refetchInterval: options?.refetchInterval, // Optional auto-refresh for expiry warnings\n    staleTime: 60000, // 1 minute - allow some staleness for better UX\n  });\n}\n\n/**\n * Hook to get delegations expiring soon (within 7 days)\n *\n * Convenience hook that auto-refetches every 5 minutes to keep expiry warnings fresh.\n *\n * @returns Query with delegations expiring soon\n *\n * @example\n * ```tsx\n * const { data: expiringSoon, isLoading } = useDelegationsExpiringSoon();\n *\n * if (expiringSoon && expiringSoon.total > 0) {\n *   // Show expiry warning banner\n * }\n * ```\n */\nexport function useDelegationsExpiringSoon() {\n  return useMyDelegations(\n    {\n      active_only: true,\n      expiring_within_days: 7,\n    },\n    {\n      refetchInterval: 300000, // Refetch every 5 minutes\n    }\n  );\n}\n","/**\n * RevokeDelegationDialog Component\n * Dialog for revoking an existing delegation\n *\n * Feature: delegation-management\n */\n\nimport { useState } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n} from '@/components/ui/dialog';\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n} from '@/components/ui/alert-dialog';\nimport { Button } from '@/components/ui/button';\nimport { Textarea } from '@/components/ui/textarea';\nimport { Label } from '@/components/ui/label';\nimport { Loader2, XCircle, AlertTriangle } from 'lucide-react';\nimport { useRevokeDelegation } from '@/hooks/use-delegation';\nimport { useToast } from '@/hooks/use-toast';\n\ninterface RevokeDelegationDialogProps {\n  open: boolean;\n  onOpenChange: (open: boolean) => void;\n  delegationId: string;\n  granteeEmail: string;\n  onSuccess?: () => void;\n}\n\nexport function RevokeDelegationDialog({\n  open,\n  onOpenChange,\n  delegationId,\n  granteeEmail,\n  onSuccess,\n}: RevokeDelegationDialogProps) {\n  const { t, i18n } = useTranslation('delegation');\n  const { toast } = useToast();\n  const isRTL = i18n.language === 'ar';\n\n  const [reason, setReason] = useState('');\n  const [showConfirm, setShowConfirm] = useState(false);\n\n  const revokeMutation = useRevokeDelegation();\n\n  const handleRevoke = async () => {\n    try {\n      await revokeMutation.mutateAsync({\n        delegation_id: delegationId,\n        reason: reason || undefined,\n      });\n      toast({\n        title: t('revoke.success'),\n        variant: 'default',\n      });\n      onOpenChange(false);\n      setShowConfirm(false);\n      setReason('');\n      onSuccess?.();\n    } catch (error) {\n      toast({\n        title: t('revoke.error'),\n        description: error instanceof Error ? error.message : undefined,\n        variant: 'destructive',\n      });\n    }\n  };\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    setShowConfirm(true);\n  };\n\n  return (\n    <>\n      <Dialog open={open} onOpenChange={onOpenChange}>\n        <DialogContent className=\"sm:max-w-[425px]\" dir={isRTL ? 'rtl' : 'ltr'}>\n          <DialogHeader>\n            <DialogTitle className=\"flex items-center gap-2 text-destructive\">\n              <XCircle className=\"h-5 w-5\" />\n              {t('revoke.title')}\n            </DialogTitle>\n            <DialogDescription>\n              {t('revoke.description')}\n            </DialogDescription>\n          </DialogHeader>\n\n          <form onSubmit={handleSubmit} className=\"space-y-4 py-4\">\n            {/* Info about who we're revoking from */}\n            <div className=\"bg-muted/50 rounded-lg p-4\">\n              <p className=\"text-sm\">\n                <span className=\"text-muted-foreground\">{t('card.to')}: </span>\n                <span className=\"font-medium\">{granteeEmail}</span>\n              </p>\n            </div>\n\n            {/* Reason (optional) */}\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"revoke-reason\">{t('revoke.form.reason')}</Label>\n              <Textarea\n                id=\"revoke-reason\"\n                value={reason}\n                onChange={(e) => setReason(e.target.value)}\n                placeholder={t('revoke.form.reasonPlaceholder')}\n                className=\"min-h-[80px] resize-none\"\n              />\n            </div>\n          </form>\n\n          <DialogFooter className=\"gap-2 sm:gap-0\">\n            <Button\n              type=\"button\"\n              variant=\"outline\"\n              onClick={() => onOpenChange(false)}\n              className=\"min-h-11\"\n            >\n              {t('common:common.cancel')}\n            </Button>\n            <Button\n              type=\"submit\"\n              variant=\"destructive\"\n              onClick={handleSubmit}\n              disabled={revokeMutation.isPending}\n              className=\"min-h-11\"\n            >\n              {revokeMutation.isPending ? (\n                <>\n                  <Loader2 className={`h-4 w-4 animate-spin ${isRTL ? 'ms-2' : 'me-2'}`} />\n                  {t('common:common.loading')}\n                </>\n              ) : (\n                <>\n                  <XCircle className={`h-4 w-4 ${isRTL ? 'ms-2' : 'me-2'}`} />\n                  {t('revoke.buttonText')}\n                </>\n              )}\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n\n      {/* Confirmation Dialog */}\n      <AlertDialog open={showConfirm} onOpenChange={setShowConfirm}>\n        <AlertDialogContent dir={isRTL ? 'rtl' : 'ltr'}>\n          <AlertDialogHeader>\n            <AlertDialogTitle className=\"flex items-center gap-2\">\n              <AlertTriangle className=\"h-5 w-5 text-destructive\" />\n              {t('revoke.title')}\n            </AlertDialogTitle>\n            <AlertDialogDescription>\n              {t('revoke.description')}\n            </AlertDialogDescription>\n          </AlertDialogHeader>\n          <AlertDialogFooter className=\"gap-2 sm:gap-0\">\n            <AlertDialogCancel className=\"min-h-11\">\n              {t('common:common.cancel')}\n            </AlertDialogCancel>\n            <AlertDialogAction\n              onClick={handleRevoke}\n              className=\"min-h-11 bg-destructive text-destructive-foreground hover:bg-destructive/90\"\n            >\n              {revokeMutation.isPending ? (\n                <>\n                  <Loader2 className={`h-4 w-4 animate-spin ${isRTL ? 'ms-2' : 'me-2'}`} />\n                  {t('common:common.loading')}\n                </>\n              ) : (\n                t('revoke.confirm')\n              )}\n            </AlertDialogAction>\n          </AlertDialogFooter>\n        </AlertDialogContent>\n      </AlertDialog>\n    </>\n  );\n}\n","/**\n * DelegationList Component\n * Displays a list of delegations with filtering and empty states\n *\n * Feature: delegation-management\n */\n\nimport { useState } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Skeleton } from '@/components/ui/skeleton';\nimport { DelegationCard } from './DelegationCard';\nimport { RevokeDelegationDialog } from './RevokeDelegationDialog';\nimport { FileX2, Users, ArrowDownToLine } from 'lucide-react';\nimport type { Delegation } from '@/services/user-management-api';\n\ninterface DelegationListProps {\n  delegations: Delegation[];\n  type: 'granted' | 'received' | 'all';\n  isLoading?: boolean;\n  onRefresh?: () => void;\n}\n\nexport function DelegationList({\n  delegations,\n  type,\n  isLoading = false,\n  onRefresh,\n}: DelegationListProps) {\n  const { t, i18n } = useTranslation('delegation');\n  const isRTL = i18n.language === 'ar';\n\n  const [revokeDialogOpen, setRevokeDialogOpen] = useState(false);\n  const [selectedDelegation, setSelectedDelegation] = useState<Delegation | null>(null);\n\n  const handleRevoke = (delegationId: string) => {\n    const delegation = delegations.find((d) => d.id === delegationId);\n    if (delegation) {\n      setSelectedDelegation(delegation);\n      setRevokeDialogOpen(true);\n    }\n  };\n\n  const handleRevokeSuccess = () => {\n    setSelectedDelegation(null);\n    onRefresh?.();\n  };\n\n  // Loading skeleton\n  if (isLoading) {\n    return (\n      <div className=\"space-y-4\">\n        {[...Array(3)].map((_, i) => (\n          <div key={i} className=\"border rounded-lg p-4 space-y-3\">\n            <div className=\"flex items-center gap-3\">\n              <Skeleton className=\"h-10 w-10 rounded-full\" />\n              <div className=\"flex-1 space-y-2\">\n                <Skeleton className=\"h-4 w-24\" />\n                <Skeleton className=\"h-4 w-40\" />\n              </div>\n              <Skeleton className=\"h-6 w-16\" />\n            </div>\n            <div className=\"grid grid-cols-2 gap-3\">\n              <Skeleton className=\"h-4 w-32\" />\n              <Skeleton className=\"h-4 w-32\" />\n            </div>\n            <Skeleton className=\"h-4 w-full\" />\n          </div>\n        ))}\n      </div>\n    );\n  }\n\n  // Empty state\n  if (delegations.length === 0) {\n    const EmptyIcon =\n      type === 'granted' ? ArrowDownToLine : type === 'received' ? Users : FileX2;\n\n    return (\n      <div\n        className=\"flex flex-col items-center justify-center py-12 px-4 text-center\"\n        dir={isRTL ? 'rtl' : 'ltr'}\n      >\n        <div className=\"rounded-full bg-muted p-4 mb-4\">\n          <EmptyIcon className=\"h-8 w-8 text-muted-foreground\" />\n        </div>\n        <h3 className=\"text-lg font-semibold mb-2\">\n          {t(`list.empty.${type}`)}\n        </h3>\n        <p className=\"text-sm text-muted-foreground max-w-md\">\n          {t(`list.emptyDescription.${type}`)}\n        </p>\n      </div>\n    );\n  }\n\n  // Determine card type based on list type and delegation\n  const getCardType = (delegation: Delegation): 'granted' | 'received' => {\n    // For 'all' type, we need to check the delegation's relationship\n    if (type === 'all') {\n      // If the current user is the grantor, show as 'granted'\n      // This is a simplification - in real implementation, compare with current user ID\n      return 'granted';\n    }\n    return type;\n  };\n\n  return (\n    <>\n      <div className=\"space-y-4\">\n        {delegations.map((delegation) => (\n          <DelegationCard\n            key={delegation.id}\n            delegation={delegation}\n            type={type === 'all' ? getCardType(delegation) : type}\n            onRevoke={type === 'granted' || type === 'all' ? handleRevoke : undefined}\n          />\n        ))}\n      </div>\n\n      {/* Revoke Dialog */}\n      {selectedDelegation && (\n        <RevokeDelegationDialog\n          open={revokeDialogOpen}\n          onOpenChange={setRevokeDialogOpen}\n          delegationId={selectedDelegation.id}\n          granteeEmail={selectedDelegation.grantee_email}\n          onSuccess={handleRevokeSuccess}\n        />\n      )}\n    </>\n  );\n}\n","/**\n * CreateDelegationDialog Component\n * Dialog for creating a new permission delegation\n *\n * Feature: delegation-management\n */\n\nimport { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { useForm } from 'react-hook-form';\nimport { format, addDays, addMonths } from 'date-fns';\nimport { ar, enUS } from 'date-fns/locale';\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n} from '@/components/ui/dialog';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { Textarea } from '@/components/ui/textarea';\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from '@/components/ui/select';\nimport { Calendar } from '@/components/ui/calendar';\nimport { Popover, PopoverContent, PopoverTrigger } from '@/components/ui/popover';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport { Badge } from '@/components/ui/badge';\nimport {\n  CalendarIcon,\n  Loader2,\n  AlertCircle,\n  CheckCircle2,\n  UserPlus,\n} from 'lucide-react';\nimport { cn } from '@/lib/utils';\nimport { useDelegatePermissions, useValidateDelegation } from '@/hooks/use-delegation';\nimport { useToast } from '@/hooks/use-toast';\nimport type { DelegatePermissionsRequest } from '@/services/user-management-api';\n\ninterface CreateDelegationDialogProps {\n  open: boolean;\n  onOpenChange: (open: boolean) => void;\n  onSuccess?: () => void;\n  users?: Array<{ id: string; email: string; full_name: string }>;\n}\n\ninterface FormData {\n  grantee_id: string;\n  valid_until: Date | undefined;\n  reason: string;\n  resource_type: string;\n  resource_id: string;\n}\n\nconst RESOURCE_TYPES = [\n  'dossier',\n  'country',\n  'organization',\n  'mou',\n  'forum',\n  'brief',\n  'intelligence_report',\n  'data_library_item',\n];\n\nexport function CreateDelegationDialog({\n  open,\n  onOpenChange,\n  onSuccess,\n  users = [],\n}: CreateDelegationDialogProps) {\n  const { t, i18n } = useTranslation('delegation');\n  const { toast } = useToast();\n  const isRTL = i18n.language === 'ar';\n  const dateLocale = isRTL ? ar : enUS;\n\n  const [selectedGranteeId, setSelectedGranteeId] = useState<string>('');\n  const [startDate] = useState<Date>(new Date());\n  const [endDate, setEndDate] = useState<Date | undefined>(undefined);\n  const [reason, setReason] = useState('');\n  const [resourceType, setResourceType] = useState<string>('');\n  const [resourceId, setResourceId] = useState('');\n\n  // Mutations and queries\n  const delegateMutation = useDelegatePermissions();\n\n  const { data: validation, isLoading: isValidating } = useValidateDelegation(\n    {\n      grantee_id: selectedGranteeId,\n      resource_type: resourceType || undefined,\n      resource_id: resourceId || undefined,\n    },\n    { enabled: !!selectedGranteeId }\n  );\n\n  // Reset form when dialog closes\n  useEffect(() => {\n    if (!open) {\n      setSelectedGranteeId('');\n      setEndDate(undefined);\n      setReason('');\n      setResourceType('');\n      setResourceId('');\n    }\n  }, [open]);\n\n  // Calculate max end date (90 days)\n  const maxEndDate = addMonths(new Date(), 3);\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n\n    if (!selectedGranteeId) {\n      toast({\n        title: t('create.validation.selectGrant'),\n        variant: 'destructive',\n      });\n      return;\n    }\n\n    if (!endDate) {\n      toast({\n        title: t('create.validation.selectEndDate'),\n        variant: 'destructive',\n      });\n      return;\n    }\n\n    if (reason.length < 10) {\n      toast({\n        title: t('create.validation.reasonMinLength'),\n        variant: 'destructive',\n      });\n      return;\n    }\n\n    const request: DelegatePermissionsRequest = {\n      grantee_id: selectedGranteeId,\n      valid_from: startDate.toISOString(),\n      valid_until: endDate.toISOString(),\n      reason,\n      resource_type: resourceType || null,\n      resource_id: resourceId || null,\n    };\n\n    try {\n      await delegateMutation.mutateAsync(request);\n      toast({\n        title: t('create.success'),\n        variant: 'default',\n      });\n      onOpenChange(false);\n      onSuccess?.();\n    } catch (error) {\n      toast({\n        title: t('create.error'),\n        description: error instanceof Error ? error.message : undefined,\n        variant: 'destructive',\n      });\n    }\n  };\n\n  return (\n    <Dialog open={open} onOpenChange={onOpenChange}>\n      <DialogContent\n        className=\"sm:max-w-[500px] max-h-[90vh] overflow-y-auto\"\n        dir={isRTL ? 'rtl' : 'ltr'}\n      >\n        <DialogHeader>\n          <DialogTitle className=\"flex items-center gap-2\">\n            <UserPlus className={`h-5 w-5 ${isRTL ? 'ms-0 me-2' : 'me-0 ms-0'}`} />\n            {t('create.title')}\n          </DialogTitle>\n          <DialogDescription>{t('create.description')}</DialogDescription>\n        </DialogHeader>\n\n        <form onSubmit={handleSubmit} className=\"space-y-4 py-4\">\n          {/* Grantee Selection */}\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"grantee\">{t('create.form.grantee')}</Label>\n            <Select value={selectedGranteeId} onValueChange={setSelectedGranteeId}>\n              <SelectTrigger className=\"min-h-11\">\n                <SelectValue placeholder={t('create.form.granteePlaceholder')} />\n              </SelectTrigger>\n              <SelectContent>\n                {users.map((user) => (\n                  <SelectItem key={user.id} value={user.id}>\n                    <div className=\"flex flex-col\">\n                      <span>{user.full_name}</span>\n                      <span className=\"text-xs text-muted-foreground\">{user.email}</span>\n                    </div>\n                  </SelectItem>\n                ))}\n              </SelectContent>\n            </Select>\n            <p className=\"text-xs text-muted-foreground\">\n              {t('create.form.granteeDescription')}\n            </p>\n          </div>\n\n          {/* Validation Status */}\n          {selectedGranteeId && (\n            <div className=\"py-2\">\n              {isValidating ? (\n                <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\n                  <Loader2 className=\"h-4 w-4 animate-spin\" />\n                  {t('validation.checking')}\n                </div>\n              ) : validation ? (\n                validation.valid ? (\n                  <div className=\"flex items-center gap-2 text-sm text-green-600\">\n                    <CheckCircle2 className=\"h-4 w-4\" />\n                    {t('validation.valid')}\n                  </div>\n                ) : (\n                  <Alert variant=\"destructive\" className=\"py-2\">\n                    <AlertCircle className=\"h-4 w-4\" />\n                    <AlertDescription>\n                      {t('validation.invalid')}\n                      {validation.issues?.map((issue, i) => (\n                        <div key={i} className=\"mt-1 text-xs\">\n                          {t(`validation.issues.${issue.code}`, issue.message)}\n                        </div>\n                      ))}\n                    </AlertDescription>\n                  </Alert>\n                )\n              ) : null}\n            </div>\n          )}\n\n          {/* End Date */}\n          <div className=\"space-y-2\">\n            <Label>{t('create.form.validUntil')}</Label>\n            <Popover>\n              <PopoverTrigger asChild>\n                <Button\n                  variant=\"outline\"\n                  className={cn(\n                    'w-full min-h-11 justify-start text-start font-normal',\n                    !endDate && 'text-muted-foreground'\n                  )}\n                >\n                  <CalendarIcon className={`h-4 w-4 ${isRTL ? 'ms-2' : 'me-2'}`} />\n                  {endDate\n                    ? format(endDate, 'PPP', { locale: dateLocale })\n                    : t('create.form.validUntilPlaceholder')}\n                </Button>\n              </PopoverTrigger>\n              <PopoverContent className=\"w-auto p-0\" align={isRTL ? 'end' : 'start'}>\n                <Calendar\n                  mode=\"single\"\n                  selected={endDate}\n                  onSelect={setEndDate}\n                  disabled={(date) => date < new Date() || date > maxEndDate}\n                  initialFocus\n                />\n              </PopoverContent>\n            </Popover>\n            <p className=\"text-xs text-muted-foreground\">\n              {t('create.form.validUntilDescription')}\n            </p>\n          </div>\n\n          {/* Reason */}\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"reason\">{t('create.form.reason')}</Label>\n            <Textarea\n              id=\"reason\"\n              value={reason}\n              onChange={(e) => setReason(e.target.value)}\n              placeholder={t('create.form.reasonPlaceholder')}\n              className=\"min-h-[80px] resize-none\"\n            />\n            <div className=\"flex justify-between items-center\">\n              <p className=\"text-xs text-muted-foreground\">\n                {t('create.form.reasonDescription')}\n              </p>\n              <Badge\n                variant={reason.length >= 10 ? 'default' : 'outline'}\n                className=\"text-xs\"\n              >\n                {reason.length}/10\n              </Badge>\n            </div>\n          </div>\n\n          {/* Resource Type (Optional) */}\n          <div className=\"space-y-2\">\n            <Label>{t('create.form.resourceType')}</Label>\n            <Select\n              value={resourceType || '__all__'}\n              onValueChange={(value) => setResourceType(value === '__all__' ? '' : value)}\n            >\n              <SelectTrigger className=\"min-h-11\">\n                <SelectValue placeholder={t('create.form.resourceTypePlaceholder')} />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"__all__\">{t('resourceTypes.all')}</SelectItem>\n                {RESOURCE_TYPES.map((type) => (\n                  <SelectItem key={type} value={type}>\n                    {t(`resourceTypes.${type}`)}\n                  </SelectItem>\n                ))}\n              </SelectContent>\n            </Select>\n            <p className=\"text-xs text-muted-foreground\">\n              {t('create.form.resourceTypeDescription')}\n            </p>\n          </div>\n\n          {/* Resource ID (Optional - only if resource type selected) */}\n          {resourceType && (\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"resourceId\">{t('create.form.resourceId')}</Label>\n              <Input\n                id=\"resourceId\"\n                value={resourceId}\n                onChange={(e) => setResourceId(e.target.value)}\n                placeholder={t('create.form.resourceIdPlaceholder')}\n                className=\"min-h-11\"\n              />\n              <p className=\"text-xs text-muted-foreground\">\n                {t('create.form.resourceIdDescription')}\n              </p>\n            </div>\n          )}\n        </form>\n\n        <DialogFooter className=\"gap-2 sm:gap-0\">\n          <Button\n            type=\"button\"\n            variant=\"outline\"\n            onClick={() => onOpenChange(false)}\n            className=\"min-h-11\"\n          >\n            {t('common:common.cancel')}\n          </Button>\n          <Button\n            type=\"submit\"\n            onClick={handleSubmit}\n            disabled={\n              delegateMutation.isPending ||\n              !selectedGranteeId ||\n              !endDate ||\n              reason.length < 10 ||\n              (validation && !validation.valid)\n            }\n            className=\"min-h-11\"\n          >\n            {delegateMutation.isPending ? (\n              <>\n                <Loader2 className={`h-4 w-4 animate-spin ${isRTL ? 'ms-2' : 'me-2'}`} />\n                {t('common:common.loading')}\n              </>\n            ) : (\n              t('create.buttonText')\n            )}\n          </Button>\n        </DialogFooter>\n      </DialogContent>\n    </Dialog>\n  );\n}\n","/**\n * DelegationExpiryBanner Component\n * Shows a notification banner when delegations are expiring soon\n *\n * Feature: delegation-management\n */\n\nimport { useState } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Link } from '@tanstack/react-router';\nimport { Alert, AlertDescription, AlertTitle } from '@/components/ui/alert';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { X, AlertTriangle, ChevronRight, Clock } from 'lucide-react';\nimport { useDelegationsExpiringSoon } from '@/hooks/use-delegation';\n\ninterface DelegationExpiryBannerProps {\n  className?: string;\n}\n\nexport function DelegationExpiryBanner({ className }: DelegationExpiryBannerProps) {\n  const { t, i18n } = useTranslation('delegation');\n  const isRTL = i18n.language === 'ar';\n\n  const [isDismissed, setIsDismissed] = useState(false);\n\n  const { data: expiringSoon, isLoading } = useDelegationsExpiringSoon();\n\n  // Don't show if loading, dismissed, or no expiring delegations\n  if (isLoading || isDismissed || !expiringSoon || expiringSoon.total === 0) {\n    return null;\n  }\n\n  const count = expiringSoon.total;\n\n  return (\n    <Alert\n      variant=\"default\"\n      className={`border-yellow-500/50 bg-yellow-50/50 dark:bg-yellow-950/20 ${className}`}\n      dir={isRTL ? 'rtl' : 'ltr'}\n    >\n      <AlertTriangle className=\"h-4 w-4 text-yellow-600\" />\n      <AlertTitle className=\"flex items-center gap-2 text-yellow-800 dark:text-yellow-400\">\n        <Clock className=\"h-4 w-4\" />\n        {t('notification.expiringTitle')}\n        <Badge variant=\"outline\" className=\"ms-2 text-yellow-700 border-yellow-600\">\n          {count}\n        </Badge>\n      </AlertTitle>\n      <AlertDescription className=\"mt-2 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3\">\n        <span className=\"text-yellow-700 dark:text-yellow-300\">\n          {count === 1\n            ? t('notification.expiringDescriptionSingle')\n            : t('notification.expiringDescription', { count })}\n        </span>\n        <div className=\"flex items-center gap-2\">\n          <Button\n            variant=\"outline\"\n            size=\"sm\"\n            asChild\n            className={`min-h-9 border-yellow-600/50 hover:bg-yellow-100 dark:hover:bg-yellow-900/30 ${\n              isRTL ? 'flex-row-reverse' : ''\n            }`}\n          >\n            <Link to=\"/delegations\">\n              {t('notification.viewAll')}\n              <ChevronRight\n                className={`h-4 w-4 ${isRTL ? 'me-1 rotate-180' : 'ms-1'}`}\n              />\n            </Link>\n          </Button>\n          <Button\n            variant=\"ghost\"\n            size=\"icon\"\n            onClick={() => setIsDismissed(true)}\n            className=\"h-8 w-8 text-yellow-700 hover:text-yellow-800 hover:bg-yellow-100 dark:hover:bg-yellow-900/30\"\n            aria-label={t('notification.dismiss')}\n          >\n            <X className=\"h-4 w-4\" />\n          </Button>\n        </div>\n      </AlertDescription>\n    </Alert>\n  );\n}\n","/**\n * DelegationManagementPage Component\n * Main page for managing delegation permissions\n *\n * Features:\n * - View delegations I've granted (permissions I shared)\n * - View delegations I've received (permissions shared with me)\n * - Create new delegations\n * - Revoke existing delegations\n * - Filter by status (active, expired, revoked)\n * - Expiring soon notifications\n *\n * Mobile-first design with RTL support\n *\n * Feature: delegation-management\n */\n\nimport { useState, useMemo } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { useQuery } from '@tanstack/react-query';\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\nimport { Switch } from '@/components/ui/switch';\nimport { Label } from '@/components/ui/label';\nimport { Skeleton } from '@/components/ui/skeleton';\nimport {\n  DelegationList,\n  CreateDelegationDialog,\n  DelegationExpiryBanner,\n} from '@/components/delegation';\nimport { useMyDelegations, useDelegationsExpiringSoon } from '@/hooks/use-delegation';\nimport { supabase } from '@/lib/supabase';\nimport {\n  Plus,\n  Users,\n  ArrowDownToLine,\n  ArrowUpFromLine,\n  Clock,\n  Shield,\n  AlertTriangle,\n} from 'lucide-react';\n\ntype TabValue = 'granted' | 'received';\n\nexport function DelegationManagementPage() {\n  const { t, i18n } = useTranslation('delegation');\n  const isRTL = i18n.language === 'ar';\n\n  // State\n  const [activeTab, setActiveTab] = useState<TabValue>('granted');\n  const [showActiveOnly, setShowActiveOnly] = useState(true);\n  const [createDialogOpen, setCreateDialogOpen] = useState(false);\n\n  // Fetch delegations\n  const {\n    data: delegations,\n    isLoading,\n    refetch,\n  } = useMyDelegations({\n    type: 'all',\n    active_only: showActiveOnly,\n  });\n\n  // Fetch expiring delegations for badge\n  const { data: expiringSoon } = useDelegationsExpiringSoon();\n\n  // Fetch available users for delegation (simplified - in production, use search)\n  const { data: usersData } = useQuery({\n    queryKey: ['users-for-delegation'],\n    queryFn: async () => {\n      const { data, error } = await supabase\n        .from('users')\n        .select('id, email, full_name')\n        .eq('is_active', true)\n        .order('full_name')\n        .limit(100);\n\n      if (error) throw error;\n      return data || [];\n    },\n    staleTime: 60000, // 1 minute\n  });\n\n  // Filter delegations by tab\n  const filteredDelegations = useMemo(() => {\n    if (!delegations) return [];\n\n    if (activeTab === 'granted') {\n      return delegations.granted || [];\n    }\n    return delegations.received || [];\n  }, [delegations, activeTab]);\n\n  // Stats\n  const stats = useMemo(() => {\n    if (!delegations) {\n      return { granted: 0, received: 0, expiring: 0 };\n    }\n    return {\n      granted: delegations.granted?.length || 0,\n      received: delegations.received?.length || 0,\n      expiring: expiringSoon?.total || 0,\n    };\n  }, [delegations, expiringSoon]);\n\n  return (\n    <div\n      className=\"container mx-auto px-4 sm:px-6 lg:px-8 py-4 sm:py-6 space-y-6\"\n      dir={isRTL ? 'rtl' : 'ltr'}\n    >\n      {/* Expiring Soon Banner */}\n      <DelegationExpiryBanner />\n\n      {/* Header */}\n      <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4\">\n        <div>\n          <h1 className=\"text-2xl sm:text-3xl font-bold text-start flex items-center gap-3\">\n            <Shield className={`h-7 w-7 sm:h-8 sm:w-8 ${isRTL ? 'ms-0' : 'me-0'}`} />\n            {t('title')}\n          </h1>\n          <p className=\"text-sm sm:text-base text-muted-foreground text-start mt-1\">\n            {t('description')}\n          </p>\n        </div>\n\n        <Button\n          onClick={() => setCreateDialogOpen(true)}\n          className={`w-full sm:w-auto min-h-11 ${isRTL ? 'flex-row-reverse' : ''}`}\n        >\n          <Plus className={`h-4 w-4 ${isRTL ? 'ms-2' : 'me-2'}`} />\n          {t('actions.create')}\n        </Button>\n      </div>\n\n      {/* Stats Cards */}\n      <div className=\"grid grid-cols-1 sm:grid-cols-3 gap-4\">\n        <Card>\n          <CardHeader className=\"pb-2\">\n            <CardDescription className=\"flex items-center gap-2\">\n              <ArrowUpFromLine className=\"h-4 w-4\" />\n              {t('list.granted')}\n            </CardDescription>\n          </CardHeader>\n          <CardContent>\n            {isLoading ? (\n              <Skeleton className=\"h-8 w-12\" />\n            ) : (\n              <p className=\"text-2xl font-bold\">{stats.granted}</p>\n            )}\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader className=\"pb-2\">\n            <CardDescription className=\"flex items-center gap-2\">\n              <ArrowDownToLine className=\"h-4 w-4\" />\n              {t('list.received')}\n            </CardDescription>\n          </CardHeader>\n          <CardContent>\n            {isLoading ? (\n              <Skeleton className=\"h-8 w-12\" />\n            ) : (\n              <p className=\"text-2xl font-bold\">{stats.received}</p>\n            )}\n          </CardContent>\n        </Card>\n\n        <Card className={stats.expiring > 0 ? 'border-yellow-500/50' : ''}>\n          <CardHeader className=\"pb-2\">\n            <CardDescription className=\"flex items-center gap-2\">\n              {stats.expiring > 0 ? (\n                <AlertTriangle className=\"h-4 w-4 text-yellow-600\" />\n              ) : (\n                <Clock className=\"h-4 w-4\" />\n              )}\n              {t('list.showExpiring')}\n            </CardDescription>\n          </CardHeader>\n          <CardContent>\n            {isLoading ? (\n              <Skeleton className=\"h-8 w-12\" />\n            ) : (\n              <p\n                className={`text-2xl font-bold ${\n                  stats.expiring > 0 ? 'text-yellow-600' : ''\n                }`}\n              >\n                {stats.expiring}\n              </p>\n            )}\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Main Content */}\n      <Card>\n        <CardHeader>\n          <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4\">\n            <CardTitle className=\"text-lg\">{t('list.title')}</CardTitle>\n\n            {/* Active Only Toggle */}\n            <div className=\"flex items-center gap-2\">\n              <Switch\n                id=\"active-only\"\n                checked={showActiveOnly}\n                onCheckedChange={setShowActiveOnly}\n              />\n              <Label htmlFor=\"active-only\" className=\"text-sm cursor-pointer\">\n                {t('list.showActiveOnly')}\n              </Label>\n            </div>\n          </div>\n        </CardHeader>\n\n        <CardContent>\n          <Tabs\n            value={activeTab}\n            onValueChange={(value) => setActiveTab(value as TabValue)}\n            className=\"w-full\"\n          >\n            <TabsList className=\"grid w-full grid-cols-2 mb-6\">\n              <TabsTrigger\n                value=\"granted\"\n                className={`flex items-center gap-2 min-h-10 ${isRTL ? 'flex-row-reverse' : ''}`}\n              >\n                <ArrowUpFromLine className=\"h-4 w-4\" />\n                <span className=\"hidden sm:inline\">{t('tabs.granted')}</span>\n                <span className=\"sm:hidden\">{t('tabs.granted')}</span>\n                {stats.granted > 0 && (\n                  <Badge variant=\"secondary\" className=\"ms-1\">\n                    {stats.granted}\n                  </Badge>\n                )}\n              </TabsTrigger>\n              <TabsTrigger\n                value=\"received\"\n                className={`flex items-center gap-2 min-h-10 ${isRTL ? 'flex-row-reverse' : ''}`}\n              >\n                <ArrowDownToLine className=\"h-4 w-4\" />\n                <span className=\"hidden sm:inline\">{t('tabs.received')}</span>\n                <span className=\"sm:hidden\">{t('tabs.received')}</span>\n                {stats.received > 0 && (\n                  <Badge variant=\"secondary\" className=\"ms-1\">\n                    {stats.received}\n                  </Badge>\n                )}\n              </TabsTrigger>\n            </TabsList>\n\n            <TabsContent value=\"granted\" className=\"mt-0\">\n              <DelegationList\n                delegations={filteredDelegations}\n                type=\"granted\"\n                isLoading={isLoading}\n                onRefresh={refetch}\n              />\n            </TabsContent>\n\n            <TabsContent value=\"received\" className=\"mt-0\">\n              <DelegationList\n                delegations={filteredDelegations}\n                type=\"received\"\n                isLoading={isLoading}\n                onRefresh={refetch}\n              />\n            </TabsContent>\n          </Tabs>\n        </CardContent>\n      </Card>\n\n      {/* Create Delegation Dialog */}\n      <CreateDelegationDialog\n        open={createDialogOpen}\n        onOpenChange={setCreateDialogOpen}\n        onSuccess={refetch}\n        users={usersData || []}\n      />\n    </div>\n  );\n}\n","/**\n * Delegations Route\n * Route for delegation management page\n *\n * Feature: delegation-management\n */\n\nimport { createFileRoute } from '@tanstack/react-router';\nimport { DelegationManagementPage } from '@/pages/delegations';\n\nexport const Route = createFileRoute('/_protected/delegations')({\n  component: DelegationManagementPage,\n});\n"],"names":["DelegationCard","delegation","type","onRevoke","isRevoking","t","i18n","useTranslation","isRTL","dateLocale","ar","enUS","now","expiresAt","startsAt","daysUntilExpiry","differenceInDays","isExpired","isPast","isFuture","isRevoked","isExpiringSoon","status","getExpiryText","daysAgo","getInitials","email","parts","displayUser","jsxs","Card","jsx","CardHeader","Avatar","AvatarFallback","ArrowRight","Badge","AlertTriangle","CardContent","Calendar","format","Clock","FileText","User","XCircle","Button","delegatePermissions","data","result","error","supabase","revokeDelegation","validateDelegation","getMyDelegations","params","queryParams","url","delegationKeys","granteeId","resourceType","resourceId","useDelegatePermissions","queryClient","useQueryClient","useMutation","useRevokeDelegation","useValidateDelegation","options","useQuery","useMyDelegations","useDelegationsExpiringSoon","RevokeDelegationDialog","open","onOpenChange","delegationId","granteeEmail","onSuccess","toast","useToast","reason","setReason","useState","showConfirm","setShowConfirm","revokeMutation","handleRevoke","handleSubmit","e","Fragment","Dialog","DialogContent","DialogHeader","DialogTitle","DialogDescription","Label","Textarea","DialogFooter","Loader2","AlertDialog","AlertDialogContent","AlertDialogHeader","AlertDialogTitle","AlertDialogDescription","AlertDialogFooter","AlertDialogCancel","AlertDialogAction","DelegationList","delegations","isLoading","onRefresh","revokeDialogOpen","setRevokeDialogOpen","selectedDelegation","setSelectedDelegation","d","handleRevokeSuccess","_","i","Skeleton","EmptyIcon","ArrowDownToLine","Users","FileX2","getCardType","RESOURCE_TYPES","CreateDelegationDialog","users","selectedGranteeId","setSelectedGranteeId","startDate","endDate","setEndDate","setResourceType","setResourceId","delegateMutation","validation","isValidating","useEffect","maxEndDate","addMonths","request","UserPlus","Select","SelectTrigger","SelectValue","SelectContent","user","SelectItem","CheckCircle2","Alert","AlertCircle","AlertDescription","issue","Popover","PopoverTrigger","cn","CalendarIcon","PopoverContent","date","value","Input","DelegationExpiryBanner","className","isDismissed","setIsDismissed","expiringSoon","count","AlertTitle","Link","ChevronRight","X","DelegationManagementPage","activeTab","setActiveTab","showActiveOnly","setShowActiveOnly","createDialogOpen","setCreateDialogOpen","refetch","usersData","filteredDelegations","useMemo","stats","Shield","Plus","CardDescription","ArrowUpFromLine","CardTitle","Switch","Tabs","TabsList","TabsTrigger","TabsContent","SplitComponent"],"mappings":"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"}