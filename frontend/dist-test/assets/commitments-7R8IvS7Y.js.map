{"version":3,"file":"commitments-7R8IvS7Y.js","sources":["../../src/components/commitments/StatusDropdown.tsx","../../src/components/commitments/EvidenceUpload.tsx","../../src/components/commitments/CommitmentCard.tsx","../../src/components/commitments/CommitmentForm.tsx","../../src/components/commitments/CommitmentFilterDrawer.tsx","../../src/components/commitments/FilterChips.tsx","../../src/components/commitments/CommitmentsList.tsx","../../src/components/commitments/StatusTimeline.tsx","../../src/components/commitments/CommitmentDetailDrawer.tsx","../../src/components/commitments/PersonalCommitmentsDashboard.tsx","../../src/routes/_protected/commitments.tsx?tsr-split=component"],"sourcesContent":["/**\n * StatusDropdown Component v1.1\n * Feature: 031-commitments-management\n * Tasks: T031, T034, T035, T036\n *\n * Inline status dropdown for quick status updates with:\n * - Mobile-first design (44x44px touch targets)\n * - RTL support for Arabic\n * - Status transition validation\n * - Optimistic updates with rollback\n * - Toast notifications\n */\n\nimport { useTranslation } from 'react-i18next';\nimport { Badge } from '@/components/ui/badge';\nimport { Button } from '@/components/ui/button';\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuTrigger,\n} from '@/components/ui/dropdown-menu';\nimport {\n  Clock,\n  ArrowRight,\n  CheckCircle,\n  XCircle,\n  ChevronDown,\n  Loader2,\n  AlertTriangle,\n} from 'lucide-react';\nimport {\n  type CommitmentStatus,\n  STATUS_COLORS,\n  VALID_STATUS_TRANSITIONS,\n  isValidStatusTransition,\n} from '@/types/commitment.types';\nimport { useUpdateCommitmentStatus } from '@/hooks/useCommitments';\n\nexport interface StatusDropdownProps {\n  commitmentId: string;\n  currentStatus: CommitmentStatus;\n  disabled?: boolean;\n  compact?: boolean;\n}\n\n// Status icons mapping\nconst statusIcons: Record<CommitmentStatus, React.ReactNode> = {\n  pending: <Clock className=\"size-3.5\" />,\n  in_progress: <ArrowRight className=\"size-3.5\" />,\n  completed: <CheckCircle className=\"size-3.5\" />,\n  cancelled: <XCircle className=\"size-3.5\" />,\n  overdue: <AlertTriangle className=\"size-3.5\" />,\n};\n\nexport function StatusDropdown({\n  commitmentId,\n  currentStatus,\n  disabled = false,\n  compact = false,\n}: StatusDropdownProps) {\n  const { t, i18n } = useTranslation('commitments');\n  const isRTL = i18n.language === 'ar';\n\n  const updateStatusMutation = useUpdateCommitmentStatus();\n\n  // Early return with loading state if currentStatus is not yet available or invalid\n  if (!currentStatus || !STATUS_COLORS[currentStatus]) {\n    return (\n      <Badge variant=\"secondary\" className=\"bg-gray-100 text-gray-500 border flex items-center gap-1 text-xs\">\n        <Clock className=\"size-3.5\" />\n        <span>{t('status.loading', 'Loading...')}</span>\n      </Badge>\n    );\n  }\n\n  // Current status colors - safe after the guard above\n  const statusColors = STATUS_COLORS[currentStatus];\n\n  // T034: Get valid transitions (hide 'overdue' as it's auto-applied)\n  const validTransitions = VALID_STATUS_TRANSITIONS[currentStatus] || [];\n  const availableTransitions = validTransitions.filter(\n    (status) => status !== 'overdue'\n  ) as CommitmentStatus[];\n\n  // Check if dropdown should be disabled\n  const isDisabled =\n    disabled ||\n    updateStatusMutation.isPending ||\n    availableTransitions.length === 0;\n\n  // Handle status change\n  const handleStatusChange = (newStatus: CommitmentStatus) => {\n    // T034: Validate transition before updating\n    if (!isValidStatusTransition(currentStatus, newStatus)) {\n      return;\n    }\n\n    // T033: Optimistic update is handled by the hook\n    updateStatusMutation.mutate({\n      id: commitmentId,\n      status: newStatus,\n    });\n  };\n\n  // Render just a badge if no transitions available\n  if (availableTransitions.length === 0) {\n    return (\n      <Badge\n        variant=\"secondary\"\n        className={`${statusColors.bg} ${statusColors.text} ${statusColors.border} border flex items-center gap-1 text-xs`}\n      >\n        {statusIcons[currentStatus]}\n        <span>{t(`status.${currentStatus}`)}</span>\n      </Badge>\n    );\n  }\n\n  return (\n    <DropdownMenu>\n      <DropdownMenuTrigger asChild>\n        <Button\n          variant=\"ghost\"\n          size=\"sm\"\n          disabled={isDisabled}\n          className={`\n            ${compact ? 'h-8 px-2' : 'min-h-11 px-3'}\n            ${statusColors.bg} ${statusColors.text} ${statusColors.border}\n            border hover:opacity-90 focus:ring-2 focus:ring-offset-2\n            flex items-center gap-1.5\n          `}\n          onClick={(e) => e.stopPropagation()}\n        >\n          {updateStatusMutation.isPending ? (\n            <Loader2 className=\"size-3.5 animate-spin\" />\n          ) : (\n            statusIcons[currentStatus]\n          )}\n          <span className=\"text-xs font-medium\">\n            {t(`status.${currentStatus}`)}\n          </span>\n          <ChevronDown className={`size-3 opacity-70 ${isRTL ? 'rotate-180' : ''}`} />\n        </Button>\n      </DropdownMenuTrigger>\n\n      <DropdownMenuContent\n        align={isRTL ? 'start' : 'end'}\n        className=\"w-44\"\n        onClick={(e) => e.stopPropagation()}\n      >\n        {availableTransitions.map((status) => {\n          const colors = STATUS_COLORS[status];\n          return (\n            <DropdownMenuItem\n              key={status}\n              onClick={() => handleStatusChange(status)}\n              className={`flex items-center gap-2 cursor-pointer min-h-11 ${colors.text}`}\n            >\n              {statusIcons[status]}\n              <span>{t(`status.${status}`)}</span>\n            </DropdownMenuItem>\n          );\n        })}\n      </DropdownMenuContent>\n    </DropdownMenu>\n  );\n}\n\n/**\n * StatusBadge Component\n * A non-interactive status badge for display purposes\n */\nexport function StatusBadge({\n  status,\n  showIcon = true,\n  className = '',\n}: {\n  status: CommitmentStatus;\n  showIcon?: boolean;\n  className?: string;\n}) {\n  const { t } = useTranslation('commitments');\n\n  // Guard against undefined status\n  if (!status) {\n    return (\n      <Badge variant=\"secondary\" className=\"bg-gray-100 text-gray-500 border flex items-center gap-1 text-xs\">\n        <Clock className=\"size-3.5\" />\n        <span>{t('status.loading', 'Loading...')}</span>\n      </Badge>\n    );\n  }\n\n  const statusColors = STATUS_COLORS[status];\n\n  return (\n    <Badge\n      variant=\"secondary\"\n      className={`${statusColors.bg} ${statusColors.text} ${statusColors.border} border flex items-center gap-1 text-xs ${className}`}\n    >\n      {showIcon && statusIcons[status]}\n      <span>{t(`status.${status}`)}</span>\n    </Badge>\n  );\n}\n","/**\n * EvidenceUpload Component v1.1\n * Feature: 031-commitments-management\n * Tasks: T049, T050, T051, T052\n *\n * Evidence upload interface with:\n * - File type validation (PDF, JPG, PNG, DOCX)\n * - Size validation (10MB max)\n * - Upload progress indicator\n * - Camera capture for mobile\n * - Mobile-first, RTL-compatible, 44x44px touch targets\n */\n\nimport { useState, useRef, useCallback } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Button } from '@/components/ui/button';\nimport { Progress } from '@/components/ui/progress';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport {\n  Upload,\n  Camera,\n  FileText,\n  Image,\n  File,\n  AlertCircle,\n  CheckCircle,\n  X,\n  Loader2,\n} from 'lucide-react';\nimport {\n  ALLOWED_EVIDENCE_TYPES,\n  MAX_EVIDENCE_SIZE,\n} from '@/types/commitment.types';\nimport { useUploadEvidence } from '@/hooks/useCommitments';\n\nexport interface EvidenceUploadProps {\n  commitmentId: string;\n  onSuccess?: () => void;\n  onCancel?: () => void;\n  disabled?: boolean;\n}\n\n// File type icons mapping\nconst fileTypeIcons: Record<string, React.ReactNode> = {\n  'application/pdf': <FileText className=\"size-6 text-red-500\" />,\n  'image/jpeg': <Image className=\"size-6 text-blue-500\" />,\n  'image/png': <Image className=\"size-6 text-blue-500\" />,\n  'application/vnd.openxmlformats-officedocument.wordprocessingml.document': (\n    <File className=\"size-6 text-blue-700\" />\n  ),\n};\n\n// Friendly file type names\nconst fileTypeNames: Record<string, string> = {\n  'application/pdf': 'PDF',\n  'image/jpeg': 'JPEG',\n  'image/png': 'PNG',\n  'application/vnd.openxmlformats-officedocument.wordprocessingml.document': 'DOCX',\n};\n\nexport function EvidenceUpload({\n  commitmentId,\n  onSuccess,\n  onCancel,\n  disabled = false,\n}: EvidenceUploadProps) {\n  const { t, i18n } = useTranslation('commitments');\n  const isRTL = i18n.language === 'ar';\n\n  // Refs\n  const fileInputRef = useRef<HTMLInputElement>(null);\n  const cameraInputRef = useRef<HTMLInputElement>(null);\n\n  // State\n  const [selectedFile, setSelectedFile] = useState<File | null>(null);\n  const [uploadProgress, setUploadProgress] = useState(0);\n  const [validationError, setValidationError] = useState<string | null>(null);\n  const [isDragging, setIsDragging] = useState(false);\n\n  // Upload mutation\n  const uploadMutation = useUploadEvidence();\n\n  // T050: Validate file type and size\n  const validateFile = useCallback(\n    (file: File): boolean => {\n      setValidationError(null);\n\n      // Check file type\n      if (!ALLOWED_EVIDENCE_TYPES.includes(file.type as (typeof ALLOWED_EVIDENCE_TYPES)[number])) {\n        setValidationError(t('evidence.invalidType'));\n        return false;\n      }\n\n      // Check file size\n      if (file.size > MAX_EVIDENCE_SIZE) {\n        setValidationError(t('evidence.fileTooLarge'));\n        return false;\n      }\n\n      return true;\n    },\n    [t]\n  );\n\n  // Handle file selection\n  const handleFileSelect = useCallback(\n    (file: File) => {\n      if (validateFile(file)) {\n        setSelectedFile(file);\n      }\n    },\n    [validateFile]\n  );\n\n  // Handle input change\n  const handleInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n    if (file) {\n      handleFileSelect(file);\n    }\n    // Reset input value to allow re-selecting same file\n    e.target.value = '';\n  };\n\n  // Handle drag events\n  const handleDragEnter = (e: React.DragEvent) => {\n    e.preventDefault();\n    e.stopPropagation();\n    setIsDragging(true);\n  };\n\n  const handleDragLeave = (e: React.DragEvent) => {\n    e.preventDefault();\n    e.stopPropagation();\n    setIsDragging(false);\n  };\n\n  const handleDragOver = (e: React.DragEvent) => {\n    e.preventDefault();\n    e.stopPropagation();\n  };\n\n  const handleDrop = (e: React.DragEvent) => {\n    e.preventDefault();\n    e.stopPropagation();\n    setIsDragging(false);\n\n    const file = e.dataTransfer.files?.[0];\n    if (file) {\n      handleFileSelect(file);\n    }\n  };\n\n  // Handle upload\n  const handleUpload = async () => {\n    if (!selectedFile) return;\n\n    // T051: Simulate progress for better UX\n    setUploadProgress(10);\n\n    try {\n      // Progress simulation\n      const progressInterval = setInterval(() => {\n        setUploadProgress((prev) => Math.min(prev + 10, 90));\n      }, 200);\n\n      await uploadMutation.mutateAsync({\n        commitmentId,\n        file: selectedFile,\n      });\n\n      clearInterval(progressInterval);\n      setUploadProgress(100);\n\n      // Small delay to show 100% before closing\n      setTimeout(() => {\n        onSuccess?.();\n      }, 500);\n    } catch {\n      setUploadProgress(0);\n    }\n  };\n\n  // Clear selected file\n  const handleClearFile = () => {\n    setSelectedFile(null);\n    setUploadProgress(0);\n    setValidationError(null);\n  };\n\n  // Format file size\n  const formatFileSize = (bytes: number): string => {\n    if (bytes < 1024) return `${bytes} B`;\n    if (bytes < 1024 * 1024) return `${(bytes / 1024).toFixed(1)} KB`;\n    return `${(bytes / (1024 * 1024)).toFixed(1)} MB`;\n  };\n\n  // Check if device has camera (mobile detection)\n  const hasCamera = 'mediaDevices' in navigator && 'getUserMedia' in navigator.mediaDevices;\n  const isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);\n\n  return (\n    <div className=\"space-y-4\" dir={isRTL ? 'rtl' : 'ltr'}>\n      {/* Hidden file inputs */}\n      <input\n        ref={fileInputRef}\n        type=\"file\"\n        accept={ALLOWED_EVIDENCE_TYPES.join(',')}\n        onChange={handleInputChange}\n        className=\"hidden\"\n        aria-hidden=\"true\"\n      />\n      {/* T052: Camera capture input for mobile */}\n      <input\n        ref={cameraInputRef}\n        type=\"file\"\n        accept=\"image/jpeg,image/png\"\n        capture=\"environment\"\n        onChange={handleInputChange}\n        className=\"hidden\"\n        aria-hidden=\"true\"\n      />\n\n      {/* Validation Error */}\n      {validationError && (\n        <Alert variant=\"destructive\">\n          <AlertCircle className=\"size-4\" />\n          <AlertDescription>{validationError}</AlertDescription>\n        </Alert>\n      )}\n\n      {/* File not selected - show dropzone */}\n      {!selectedFile && (\n        <>\n          {/* Drag & Drop Zone */}\n          <div\n            onDragEnter={handleDragEnter}\n            onDragLeave={handleDragLeave}\n            onDragOver={handleDragOver}\n            onDrop={handleDrop}\n            onClick={() => fileInputRef.current?.click()}\n            className={`\n              border-2 border-dashed rounded-lg p-6 sm:p-8 text-center cursor-pointer\n              transition-colors duration-200\n              ${\n                isDragging\n                  ? 'border-primary bg-primary/5'\n                  : 'border-muted-foreground/25 hover:border-primary/50'\n              }\n              ${disabled ? 'opacity-50 cursor-not-allowed' : ''}\n            `}\n          >\n            <Upload className=\"size-10 sm:size-12 mx-auto mb-3 text-muted-foreground\" />\n            <p className=\"text-sm sm:text-base font-medium mb-1\">\n              {t('evidence.dropzone')}\n            </p>\n            <p className=\"text-xs sm:text-sm text-muted-foreground\">\n              {t('evidence.allowedTypes')}\n            </p>\n            <p className=\"text-xs text-muted-foreground mt-1\">\n              {t('evidence.maxSize')}\n            </p>\n          </div>\n\n          {/* Action Buttons */}\n          <div className=\"flex flex-col sm:flex-row gap-2\">\n            {/* Browse Files Button */}\n            <Button\n              type=\"button\"\n              variant=\"outline\"\n              onClick={() => fileInputRef.current?.click()}\n              disabled={disabled}\n              className=\"min-h-11 flex-1\"\n            >\n              <Upload className={`size-4 ${isRTL ? 'ms-2' : 'me-2'}`} />\n              {t('actions.uploadEvidence')}\n            </Button>\n\n            {/* T052: Camera Capture Button (mobile only) */}\n            {(hasCamera || isMobile) && (\n              <Button\n                type=\"button\"\n                variant=\"outline\"\n                onClick={() => cameraInputRef.current?.click()}\n                disabled={disabled}\n                className=\"min-h-11 flex-1\"\n              >\n                <Camera className={`size-4 ${isRTL ? 'ms-2' : 'me-2'}`} />\n                {t('evidence.camera')}\n              </Button>\n            )}\n          </div>\n        </>\n      )}\n\n      {/* File selected - show preview and upload button */}\n      {selectedFile && (\n        <div className=\"border rounded-lg p-4\">\n          {/* File info */}\n          <div className=\"flex items-start gap-3\">\n            <div className=\"shrink-0\">\n              {fileTypeIcons[selectedFile.type] || <File className=\"size-6 text-gray-500\" />}\n            </div>\n            <div className=\"flex-1 min-w-0\">\n              <p className=\"font-medium text-sm truncate text-start\">\n                {selectedFile.name}\n              </p>\n              <p className=\"text-xs text-muted-foreground text-start\">\n                {fileTypeNames[selectedFile.type] || selectedFile.type} â€¢{' '}\n                {formatFileSize(selectedFile.size)}\n              </p>\n            </div>\n            {!uploadMutation.isPending && (\n              <Button\n                type=\"button\"\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={handleClearFile}\n                className=\"min-h-9 min-w-9 p-0\"\n              >\n                <X className=\"size-4\" />\n              </Button>\n            )}\n          </div>\n\n          {/* T051: Upload progress indicator */}\n          {uploadMutation.isPending && (\n            <div className=\"mt-4 space-y-2\">\n              <Progress value={uploadProgress} className=\"h-2\" />\n              <p className=\"text-xs text-muted-foreground text-center\">\n                {t('evidence.uploading')} {uploadProgress}%\n              </p>\n            </div>\n          )}\n\n          {/* Success indicator */}\n          {uploadProgress === 100 && !uploadMutation.isPending && (\n            <div className=\"mt-4 flex items-center justify-center gap-2 text-green-600\">\n              <CheckCircle className=\"size-5\" />\n              <span className=\"text-sm font-medium\">\n                {t('evidence.uploadSuccess')}\n              </span>\n            </div>\n          )}\n\n          {/* Action buttons */}\n          {uploadProgress !== 100 && (\n            <div className=\"mt-4 flex flex-col sm:flex-row gap-2\">\n              <Button\n                type=\"button\"\n                variant=\"outline\"\n                onClick={() => {\n                  handleClearFile();\n                  onCancel?.();\n                }}\n                disabled={uploadMutation.isPending}\n                className=\"min-h-11 flex-1\"\n              >\n                {t('actions.cancel')}\n              </Button>\n              <Button\n                type=\"button\"\n                onClick={handleUpload}\n                disabled={disabled || uploadMutation.isPending}\n                className=\"min-h-11 flex-1\"\n              >\n                {uploadMutation.isPending ? (\n                  <>\n                    <Loader2 className={`size-4 animate-spin ${isRTL ? 'ms-2' : 'me-2'}`} />\n                    {t('evidence.uploading')}\n                  </>\n                ) : (\n                  <>\n                    <Upload className={`size-4 ${isRTL ? 'ms-2' : 'me-2'}`} />\n                    {t('actions.uploadEvidence')}\n                  </>\n                )}\n              </Button>\n            </div>\n          )}\n        </div>\n      )}\n    </div>\n  );\n}\n","/**\n * CommitmentCard Component v1.1\n * Feature: 031-commitments-management\n * Tasks: T023, T032, T053\n *\n * Displays a single commitment with:\n * - Inline StatusDropdown for quick status updates (2 taps)\n * - Priority indicator, overdue styling\n * - Quick action buttons\n * - Evidence upload/download (T053)\n * Mobile-first, RTL-compatible, accessible (44x44px touch targets)\n */\n\nimport { useTranslation } from 'react-i18next';\nimport { useNavigate } from '@tanstack/react-router';\nimport { useState } from 'react';\nimport { Card, CardContent, CardHeader } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { Button } from '@/components/ui/button';\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n} from '@/components/ui/dialog';\nimport {\n  Calendar,\n  CheckCircle,\n  MoreVertical,\n  Edit,\n  Trash2,\n  FileText,\n  AlertTriangle,\n  Upload,\n  Download,\n  ExternalLink,\n} from 'lucide-react';\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuSeparator,\n  DropdownMenuTrigger,\n} from '@/components/ui/dropdown-menu';\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n} from '@/components/ui/alert-dialog';\nimport { Textarea } from '@/components/ui/textarea';\nimport { Label } from '@/components/ui/label';\nimport {\n  type Commitment,\n  PRIORITY_COLORS,\n} from '@/types/commitment.types';\nimport {\n  isCommitmentOverdue,\n  getDaysUntilDue,\n} from '@/services/commitments.service';\nimport { useCancelCommitment } from '@/hooks/useCommitments';\nimport { getEvidenceUrl } from '@/services/commitments.service';\nimport { StatusDropdown } from './StatusDropdown';\nimport { EvidenceUpload } from './EvidenceUpload';\n\nexport interface CommitmentCardProps {\n  commitment: Commitment;\n  onEdit?: (commitment: Commitment) => void;\n  onStatusChange?: (commitmentId: string, newStatus: string) => void;\n  showDossierContext?: boolean;\n  compact?: boolean;\n}\n\nexport function CommitmentCard({\n  commitment,\n  onEdit,\n  onStatusChange,\n  showDossierContext = false,\n  compact = false,\n}: CommitmentCardProps) {\n  const { t, i18n } = useTranslation('commitments');\n  const navigate = useNavigate();\n  const isRTL = i18n.language === 'ar';\n\n  const [showCancelDialog, setShowCancelDialog] = useState(false);\n  const [cancelReason, setCancelReason] = useState('');\n  const [showUploadDialog, setShowUploadDialog] = useState(false);\n  const [isDownloading, setIsDownloading] = useState(false);\n\n  const cancelMutation = useCancelCommitment();\n\n  // T053: Handle evidence download\n  const handleDownloadEvidence = async (e: React.MouseEvent) => {\n    e.stopPropagation();\n    if (!commitment.proof_url) return;\n\n    setIsDownloading(true);\n    try {\n      const { signedUrl } = await getEvidenceUrl(commitment.proof_url);\n      window.open(signedUrl, '_blank');\n    } catch (error) {\n      console.error('Failed to get evidence URL:', error);\n    } finally {\n      setIsDownloading(false);\n    }\n  };\n\n  // Calculate overdue status\n  const overdue = isCommitmentOverdue(commitment.due_date, commitment.status);\n  const daysUntilDue = getDaysUntilDue(commitment.due_date);\n\n  // Format date\n  const dueDate = new Date(commitment.due_date);\n  const formattedDate = dueDate.toLocaleDateString(i18n.language, {\n    year: 'numeric',\n    month: 'short',\n    day: 'numeric',\n  });\n\n  // Get style classes\n  const priorityColors = PRIORITY_COLORS[commitment.priority];\n\n  // Due date label\n  const getDueDateLabel = () => {\n    if (overdue) {\n      return t('card.overdueDays', { days: Math.abs(daysUntilDue) });\n    }\n    if (daysUntilDue === 0) {\n      return t('card.dueToday');\n    }\n    return t('card.dueIn', { days: daysUntilDue });\n  };\n\n  // Handle cancel confirmation\n  const handleCancelConfirm = () => {\n    if (cancelReason.trim()) {\n      cancelMutation.mutate(\n        { id: commitment.id, reason: cancelReason },\n        {\n          onSuccess: () => {\n            setShowCancelDialog(false);\n            setCancelReason('');\n          },\n        }\n      );\n    }\n  };\n\n  // Handle card click - navigate to detail\n  const handleCardClick = () => {\n    navigate({\n      to: '/commitments',\n      search: { id: commitment.id },\n    });\n  };\n\n  return (\n    <>\n      <Card\n        className={`\n          hover:shadow-md transition-shadow duration-200 cursor-pointer\n          ${overdue ? 'border-red-300 dark:border-red-800' : ''}\n          ${commitment.status === 'completed' ? 'opacity-75' : ''}\n        `}\n        onClick={handleCardClick}\n        dir={isRTL ? 'rtl' : 'ltr'}\n      >\n        <CardHeader className={compact ? 'pb-2 pt-3 px-3' : 'pb-3'}>\n          <div className=\"flex items-start justify-between gap-2\">\n            {/* Title and Status */}\n            <div className=\"flex-1 min-w-0\">\n              <div className=\"flex flex-col sm:flex-row sm:items-center gap-2 mb-1\">\n                <h3 className=\"text-sm sm:text-base font-medium text-start truncate\">\n                  {commitment.title || t('card.noTitle')}\n                </h3>\n                {/* T032: Inline StatusDropdown for quick status updates */}\n                <div onClick={(e) => e.stopPropagation()}>\n                  <StatusDropdown\n                    commitmentId={commitment.id}\n                    currentStatus={commitment.status}\n                    compact={compact}\n                  />\n                </div>\n              </div>\n            </div>\n\n            {/* Actions Menu */}\n            <DropdownMenu>\n              <DropdownMenuTrigger asChild onClick={(e) => e.stopPropagation()}>\n                <Button\n                  variant=\"ghost\"\n                  size=\"sm\"\n                  className=\"h-9 w-9 p-0 shrink-0 min-h-11 min-w-11\"\n                  aria-label={t('actions.viewDetails')}\n                >\n                  <MoreVertical className=\"size-4\" />\n                </Button>\n              </DropdownMenuTrigger>\n              <DropdownMenuContent\n                align={isRTL ? 'start' : 'end'}\n                className=\"w-48\"\n              >\n                <DropdownMenuItem\n                  onClick={(e) => {\n                    e.stopPropagation();\n                    handleCardClick();\n                  }}\n                >\n                  <FileText className={`size-4 ${isRTL ? 'ms-2' : 'me-2'}`} />\n                  {t('actions.viewDetails')}\n                </DropdownMenuItem>\n\n                {/* T053: Evidence actions */}\n                {commitment.proof_url && (\n                  <DropdownMenuItem\n                    onClick={handleDownloadEvidence}\n                    disabled={isDownloading}\n                  >\n                    <Download className={`size-4 ${isRTL ? 'ms-2' : 'me-2'}`} />\n                    {t('actions.downloadEvidence')}\n                  </DropdownMenuItem>\n                )}\n\n                {commitment.status !== 'cancelled' &&\n                  commitment.status !== 'completed' && (\n                    <>\n                      {/* Upload evidence option */}\n                      {commitment.proof_required && !commitment.proof_url && (\n                        <DropdownMenuItem\n                          onClick={(e) => {\n                            e.stopPropagation();\n                            setShowUploadDialog(true);\n                          }}\n                        >\n                          <Upload className={`size-4 ${isRTL ? 'ms-2' : 'me-2'}`} />\n                          {t('actions.uploadEvidence')}\n                        </DropdownMenuItem>\n                      )}\n\n                      <DropdownMenuItem\n                        onClick={(e) => {\n                          e.stopPropagation();\n                          onEdit?.(commitment);\n                        }}\n                      >\n                        <Edit className={`size-4 ${isRTL ? 'ms-2' : 'me-2'}`} />\n                        {t('actions.edit')}\n                      </DropdownMenuItem>\n                      <DropdownMenuSeparator />\n                      <DropdownMenuItem\n                        className=\"text-red-600 focus:text-red-600\"\n                        onClick={(e) => {\n                          e.stopPropagation();\n                          setShowCancelDialog(true);\n                        }}\n                      >\n                        <Trash2 className={`size-4 ${isRTL ? 'ms-2' : 'me-2'}`} />\n                        {t('actions.cancel')}\n                      </DropdownMenuItem>\n                    </>\n                  )}\n              </DropdownMenuContent>\n            </DropdownMenu>\n          </div>\n        </CardHeader>\n\n        <CardContent className={compact ? 'pb-3 px-3' : 'pb-4'}>\n          {/* Description */}\n          {!compact && commitment.description && (\n            <p className=\"text-sm text-muted-foreground text-start line-clamp-2 mb-3\">\n              {commitment.description}\n            </p>\n          )}\n\n          {/* Meta info row */}\n          <div className=\"flex flex-wrap items-center gap-2 sm:gap-4\">\n            {/* Due Date with overdue indicator */}\n            <div\n              className={`flex items-center gap-1.5 text-sm ${\n                overdue\n                  ? 'text-red-600 dark:text-red-400 font-medium'\n                  : 'text-muted-foreground'\n              }`}\n            >\n              {overdue ? (\n                <AlertTriangle className=\"size-4 shrink-0\" />\n              ) : (\n                <Calendar className=\"size-4 shrink-0\" />\n              )}\n              <span className=\"truncate\">\n                {overdue ? getDueDateLabel() : formattedDate}\n              </span>\n            </div>\n\n            {/* Priority Badge */}\n            <Badge\n              variant=\"outline\"\n              className={`${priorityColors.bg} ${priorityColors.text} text-xs`}\n            >\n              {t(`priority.${commitment.priority}`)}\n            </Badge>\n\n            {/* Proof required indicator */}\n            {commitment.proof_required && !commitment.proof_url && (\n              <Badge variant=\"outline\" className=\"text-xs\">\n                <FileText className=\"size-3 me-1\" />\n                {t('form.proofRequired')}\n              </Badge>\n            )}\n\n            {/* Evidence submitted indicator */}\n            {commitment.proof_url && (\n              <Badge\n                variant=\"secondary\"\n                className=\"text-xs text-green-700 dark:text-green-300 bg-green-50 dark:bg-green-900/20\"\n              >\n                <CheckCircle className=\"size-3 me-1\" />\n                {t('detail.evidence')}\n              </Badge>\n            )}\n          </div>\n\n          {/* Dossier context (optional) */}\n          {showDossierContext && commitment.dossier_id && (\n            <div className=\"mt-3 pt-3 border-t text-xs text-muted-foreground\">\n              <span className=\"truncate\">{commitment.dossier_id}</span>\n            </div>\n          )}\n        </CardContent>\n      </Card>\n\n      {/* Cancel Confirmation Dialog */}\n      <AlertDialog open={showCancelDialog} onOpenChange={setShowCancelDialog}>\n        <AlertDialogContent dir={isRTL ? 'rtl' : 'ltr'}>\n          <AlertDialogHeader>\n            <AlertDialogTitle className=\"text-start\">\n              {t('confirm.cancel')}\n            </AlertDialogTitle>\n            <AlertDialogDescription className=\"text-start\">\n              {t('confirm.delete')}\n            </AlertDialogDescription>\n          </AlertDialogHeader>\n\n          <div className=\"py-4\">\n            <Label htmlFor=\"cancel-reason\" className=\"text-start block mb-2\">\n              {t('confirm.cancelReason')}\n            </Label>\n            <Textarea\n              id=\"cancel-reason\"\n              value={cancelReason}\n              onChange={(e) => setCancelReason(e.target.value)}\n              placeholder={t('confirm.cancelReasonPlaceholder')}\n              className=\"min-h-20\"\n            />\n          </div>\n\n          <AlertDialogFooter className=\"flex-col sm:flex-row gap-2\">\n            <AlertDialogCancel className=\"min-h-11\">\n              {t('actions.cancel')}\n            </AlertDialogCancel>\n            <AlertDialogAction\n              onClick={handleCancelConfirm}\n              disabled={!cancelReason.trim() || cancelMutation.isPending}\n              className=\"min-h-11 bg-red-600 hover:bg-red-700 text-white\"\n            >\n              {cancelMutation.isPending ? t('list.loading') : t('actions.delete')}\n            </AlertDialogAction>\n          </AlertDialogFooter>\n        </AlertDialogContent>\n      </AlertDialog>\n\n      {/* T053: Evidence Upload Dialog */}\n      <Dialog open={showUploadDialog} onOpenChange={setShowUploadDialog}>\n        <DialogContent\n          className=\"max-w-md max-h-[90vh] overflow-y-auto\"\n          dir={isRTL ? 'rtl' : 'ltr'}\n          onClick={(e) => e.stopPropagation()}\n        >\n          <DialogHeader>\n            <DialogTitle className=\"text-start\">\n              {t('evidence.title')}\n            </DialogTitle>\n          </DialogHeader>\n          <p className=\"text-sm text-muted-foreground text-start mb-4\">\n            {t('evidence.description')}\n          </p>\n          <EvidenceUpload\n            commitmentId={commitment.id}\n            onSuccess={() => setShowUploadDialog(false)}\n            onCancel={() => setShowUploadDialog(false)}\n          />\n        </DialogContent>\n      </Dialog>\n    </>\n  );\n}\n","/**\n * CommitmentForm Component v1.1\n * Feature: 031-commitments-management\n * Tasks: T024, T027, T029\n *\n * Form for creating and editing commitments with:\n * - Mobile-first, RTL-compatible layout\n * - Zod validation schema\n * - Pre-populated values for edit mode\n * - 44x44px touch targets\n */\n\nimport { useTranslation } from 'react-i18next';\nimport { useForm } from 'react-hook-form';\nimport { zodResolver } from '@hookform/resolvers/zod';\nimport { z } from 'zod';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Textarea } from '@/components/ui/textarea';\nimport { Label } from '@/components/ui/label';\nimport { Switch } from '@/components/ui/switch';\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from '@/components/ui/select';\nimport {\n  Form,\n  FormControl,\n  FormDescription,\n  FormField,\n  FormItem,\n  FormLabel,\n  FormMessage,\n} from '@/components/ui/form';\nimport { Calendar } from '@/components/ui/calendar';\nimport {\n  Popover,\n  PopoverContent,\n  PopoverTrigger,\n} from '@/components/ui/popover';\nimport { CalendarIcon, Loader2 } from 'lucide-react';\nimport { format } from 'date-fns';\nimport { ar, enUS } from 'date-fns/locale';\nimport { cn } from '@/lib/utils';\nimport type {\n  Commitment,\n  CommitmentPriority,\n  CommitmentOwnerType,\n  CommitmentTrackingMode,\n  CreateCommitmentInput,\n  UpdateCommitmentInput,\n} from '@/types/commitment.types';\nimport { useCreateCommitment, useUpdateCommitment } from '@/hooks/useCommitments';\n\n// T029: Zod validation schema\nconst commitmentFormSchema = z.object({\n  title: z\n    .string()\n    .min(1, 'validation.titleRequired')\n    .max(200, 'validation.titleMaxLength'),\n  description: z.string().min(1, 'validation.descriptionRequired'),\n  due_date: z.date({\n    required_error: 'validation.dueDateRequired',\n  }),\n  priority: z.enum(['low', 'medium', 'high', 'critical'] as const),\n  owner_type: z.enum(['internal', 'external'] as const),\n  owner_user_id: z.string().optional().nullable(),\n  owner_contact_id: z.string().optional().nullable(),\n  tracking_mode: z.enum(['manual', 'automatic'] as const),\n  proof_required: z.boolean(),\n});\n\ntype CommitmentFormValues = z.infer<typeof commitmentFormSchema>;\n\nexport interface CommitmentFormProps {\n  dossierId: string;\n  afterActionId?: string;\n  commitment?: Commitment; // If provided, form is in edit mode\n  onSuccess?: (commitment: Commitment) => void;\n  onCancel?: () => void;\n}\n\nexport function CommitmentForm({\n  dossierId,\n  afterActionId,\n  commitment,\n  onSuccess,\n  onCancel,\n}: CommitmentFormProps) {\n  const { t, i18n } = useTranslation('commitments');\n  const isRTL = i18n.language === 'ar';\n  const isEditMode = !!commitment;\n\n  const createMutation = useCreateCommitment();\n  const updateMutation = useUpdateCommitment();\n  const isPending = createMutation.isPending || updateMutation.isPending;\n\n  // T027: Pre-populated values for edit mode\n  const defaultValues: CommitmentFormValues = {\n    title: commitment?.title ?? '',\n    description: commitment?.description ?? '',\n    due_date: commitment?.due_date ? new Date(commitment.due_date) : new Date(),\n    priority: (commitment?.priority as CommitmentPriority) ?? 'medium',\n    owner_type: (commitment?.owner_type as CommitmentOwnerType) ?? 'internal',\n    owner_user_id: commitment?.owner_user_id ?? null,\n    owner_contact_id: commitment?.owner_contact_id ?? null,\n    tracking_mode: (commitment?.tracking_mode as CommitmentTrackingMode) ?? 'manual',\n    proof_required: commitment?.proof_required ?? false,\n  };\n\n  const form = useForm<CommitmentFormValues>({\n    resolver: zodResolver(commitmentFormSchema),\n    defaultValues,\n  });\n\n  const watchOwnerType = form.watch('owner_type');\n\n  const onSubmit = (values: CommitmentFormValues) => {\n    if (isEditMode && commitment) {\n      // Update existing commitment\n      const updateInput: UpdateCommitmentInput = {\n        title: values.title,\n        description: values.description,\n        due_date: values.due_date.toISOString().split('T')[0],\n        priority: values.priority,\n        owner_type: values.owner_type,\n        owner_user_id: values.owner_type === 'internal' ? values.owner_user_id : null,\n        owner_contact_id: values.owner_type === 'external' ? values.owner_contact_id : null,\n        tracking_mode: values.tracking_mode,\n        proof_required: values.proof_required,\n      };\n\n      updateMutation.mutate(\n        { commitmentId: commitment.id, input: updateInput },\n        {\n          onSuccess: (data) => {\n            onSuccess?.(data);\n          },\n        }\n      );\n    } else {\n      // Create new commitment\n      const createInput: CreateCommitmentInput = {\n        dossier_id: dossierId,\n        after_action_id: afterActionId ?? null,\n        title: values.title,\n        description: values.description,\n        due_date: values.due_date.toISOString().split('T')[0],\n        priority: values.priority,\n        owner_type: values.owner_type,\n        owner_user_id: values.owner_type === 'internal' ? values.owner_user_id : null,\n        owner_contact_id: values.owner_type === 'external' ? values.owner_contact_id : null,\n        tracking_mode: values.tracking_mode,\n        proof_required: values.proof_required,\n      };\n\n      createMutation.mutate(createInput, {\n        onSuccess: (data) => {\n          form.reset();\n          onSuccess?.(data);\n        },\n      });\n    }\n  };\n\n  return (\n    <Form {...form}>\n      <form\n        onSubmit={form.handleSubmit(onSubmit)}\n        className=\"space-y-6\"\n        dir={isRTL ? 'rtl' : 'ltr'}\n      >\n        {/* Title */}\n        <FormField\n          control={form.control}\n          name=\"title\"\n          render={({ field }) => (\n            <FormItem>\n              <FormLabel className=\"text-start block\">\n                {t('form.title')} *\n              </FormLabel>\n              <FormControl>\n                <Input\n                  {...field}\n                  placeholder={t('form.titlePlaceholder')}\n                  className=\"min-h-11\"\n                />\n              </FormControl>\n              <FormMessage>\n                {form.formState.errors.title?.message &&\n                  t(form.formState.errors.title.message)}\n              </FormMessage>\n            </FormItem>\n          )}\n        />\n\n        {/* Description */}\n        <FormField\n          control={form.control}\n          name=\"description\"\n          render={({ field }) => (\n            <FormItem>\n              <FormLabel className=\"text-start block\">\n                {t('form.description')} *\n              </FormLabel>\n              <FormControl>\n                <Textarea\n                  {...field}\n                  placeholder={t('form.descriptionPlaceholder')}\n                  className=\"min-h-24\"\n                />\n              </FormControl>\n              <FormMessage>\n                {form.formState.errors.description?.message &&\n                  t(form.formState.errors.description.message)}\n              </FormMessage>\n            </FormItem>\n          )}\n        />\n\n        {/* Due Date */}\n        <FormField\n          control={form.control}\n          name=\"due_date\"\n          render={({ field }) => (\n            <FormItem className=\"flex flex-col\">\n              <FormLabel className=\"text-start\">\n                {t('form.dueDate')} *\n              </FormLabel>\n              <Popover>\n                <PopoverTrigger asChild>\n                  <FormControl>\n                    <Button\n                      variant=\"outline\"\n                      className={cn(\n                        'min-h-11 w-full justify-start text-start font-normal',\n                        !field.value && 'text-muted-foreground'\n                      )}\n                    >\n                      <CalendarIcon className={`size-4 ${isRTL ? 'ms-2' : 'me-2'}`} />\n                      {field.value ? (\n                        format(field.value, 'PPP', {\n                          locale: isRTL ? ar : enUS,\n                        })\n                      ) : (\n                        <span>{t('form.dueDate')}</span>\n                      )}\n                    </Button>\n                  </FormControl>\n                </PopoverTrigger>\n                <PopoverContent className=\"w-auto p-0\" align=\"start\">\n                  <Calendar\n                    mode=\"single\"\n                    selected={field.value}\n                    onSelect={field.onChange}\n                    disabled={(date) =>\n                      date < new Date(new Date().setHours(0, 0, 0, 0))\n                    }\n                    initialFocus\n                    locale={isRTL ? ar : enUS}\n                  />\n                </PopoverContent>\n              </Popover>\n              <FormMessage>\n                {form.formState.errors.due_date?.message &&\n                  t(form.formState.errors.due_date.message)}\n              </FormMessage>\n            </FormItem>\n          )}\n        />\n\n        {/* Priority and Owner Type Row */}\n        <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\n          {/* Priority */}\n          <FormField\n            control={form.control}\n            name=\"priority\"\n            render={({ field }) => (\n              <FormItem>\n                <FormLabel className=\"text-start block\">\n                  {t('form.priority')}\n                </FormLabel>\n                <Select\n                  onValueChange={field.onChange}\n                  defaultValue={field.value}\n                >\n                  <FormControl>\n                    <SelectTrigger className=\"min-h-11\">\n                      <SelectValue placeholder={t('priority.label')} />\n                    </SelectTrigger>\n                  </FormControl>\n                  <SelectContent>\n                    <SelectItem value=\"low\">{t('priority.low')}</SelectItem>\n                    <SelectItem value=\"medium\">{t('priority.medium')}</SelectItem>\n                    <SelectItem value=\"high\">{t('priority.high')}</SelectItem>\n                    <SelectItem value=\"critical\">{t('priority.critical')}</SelectItem>\n                  </SelectContent>\n                </Select>\n                <FormMessage />\n              </FormItem>\n            )}\n          />\n\n          {/* Owner Type */}\n          <FormField\n            control={form.control}\n            name=\"owner_type\"\n            render={({ field }) => (\n              <FormItem>\n                <FormLabel className=\"text-start block\">\n                  {t('form.ownerType')}\n                </FormLabel>\n                <Select\n                  onValueChange={field.onChange}\n                  defaultValue={field.value}\n                >\n                  <FormControl>\n                    <SelectTrigger className=\"min-h-11\">\n                      <SelectValue placeholder={t('ownerType.label')} />\n                    </SelectTrigger>\n                  </FormControl>\n                  <SelectContent>\n                    <SelectItem value=\"internal\">{t('ownerType.internal')}</SelectItem>\n                    <SelectItem value=\"external\">{t('ownerType.external')}</SelectItem>\n                  </SelectContent>\n                </Select>\n                <FormMessage />\n              </FormItem>\n            )}\n          />\n        </div>\n\n        {/* Owner Selection - TODO: Replace with actual user/contact picker */}\n        <FormField\n          control={form.control}\n          name={watchOwnerType === 'internal' ? 'owner_user_id' : 'owner_contact_id'}\n          render={({ field }) => (\n            <FormItem>\n              <FormLabel className=\"text-start block\">\n                {t('form.owner')}\n              </FormLabel>\n              <FormControl>\n                <Input\n                  {...field}\n                  value={field.value ?? ''}\n                  placeholder={t('form.selectOwner')}\n                  className=\"min-h-11\"\n                />\n              </FormControl>\n              <FormDescription className=\"text-start\">\n                {watchOwnerType === 'internal'\n                  ? 'Enter internal user ID'\n                  : 'Enter external contact ID'}\n              </FormDescription>\n              <FormMessage />\n            </FormItem>\n          )}\n        />\n\n        {/* Tracking Mode */}\n        <FormField\n          control={form.control}\n          name=\"tracking_mode\"\n          render={({ field }) => (\n            <FormItem>\n              <FormLabel className=\"text-start block\">\n                {t('form.trackingMode')}\n              </FormLabel>\n              <Select\n                onValueChange={field.onChange}\n                defaultValue={field.value}\n              >\n                <FormControl>\n                  <SelectTrigger className=\"min-h-11\">\n                    <SelectValue placeholder={t('form.trackingMode')} />\n                  </SelectTrigger>\n                </FormControl>\n                <SelectContent>\n                  <SelectItem value=\"manual\">{t('form.manual')}</SelectItem>\n                  <SelectItem value=\"automatic\">{t('form.automatic')}</SelectItem>\n                </SelectContent>\n              </Select>\n              <FormMessage />\n            </FormItem>\n          )}\n        />\n\n        {/* Proof Required Toggle */}\n        <FormField\n          control={form.control}\n          name=\"proof_required\"\n          render={({ field }) => (\n            <FormItem className=\"flex flex-row items-center justify-between rounded-lg border p-4\">\n              <div className=\"space-y-0.5 flex-1\">\n                <FormLabel className=\"text-base text-start block\">\n                  {t('form.proofRequired')}\n                </FormLabel>\n                <FormDescription className=\"text-start\">\n                  {t('form.proofRequiredDescription')}\n                </FormDescription>\n              </div>\n              <FormControl>\n                <Switch\n                  checked={field.value}\n                  onCheckedChange={field.onChange}\n                  className=\"ms-4\"\n                />\n              </FormControl>\n            </FormItem>\n          )}\n        />\n\n        {/* Action Buttons */}\n        <div className=\"flex flex-col-reverse sm:flex-row gap-3 pt-4 border-t\">\n          <Button\n            type=\"button\"\n            variant=\"outline\"\n            onClick={onCancel}\n            disabled={isPending}\n            className=\"min-h-11 w-full sm:w-auto\"\n          >\n            {t('actions.cancel')}\n          </Button>\n          <Button\n            type=\"submit\"\n            disabled={isPending}\n            className=\"min-h-11 w-full sm:flex-1\"\n          >\n            {isPending ? (\n              <>\n                <Loader2 className={`size-4 animate-spin ${isRTL ? 'ms-2' : 'me-2'}`} />\n                {t('list.loading')}\n              </>\n            ) : isEditMode ? (\n              t('actions.save')\n            ) : (\n              t('actions.create')\n            )}\n          </Button>\n        </div>\n      </form>\n    </Form>\n  );\n}\n","/**\n * CommitmentFilterDrawer Component v1.1\n * Feature: 031-commitments-management\n * Tasks: T037, T042, T042a\n *\n * Filter panel for commitments:\n * - Bottom sheet on mobile, side panel on desktop\n * - Status, priority, owner type filters\n * - Overdue toggle\n * - Date range picker for due dates\n * - Mobile-first, RTL-compatible, 44x44px touch targets\n */\n\nimport { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport {\n  Sheet,\n  SheetContent,\n  SheetHeader,\n  SheetTitle,\n  SheetFooter,\n} from '@/components/ui/sheet';\nimport { Button } from '@/components/ui/button';\nimport { Label } from '@/components/ui/label';\nimport { Switch } from '@/components/ui/switch';\nimport { Checkbox } from '@/components/ui/checkbox';\nimport { Calendar } from '@/components/ui/calendar';\nimport {\n  Popover,\n  PopoverContent,\n  PopoverTrigger,\n} from '@/components/ui/popover';\nimport { CalendarIcon, X } from 'lucide-react';\nimport { format } from 'date-fns';\nimport { ar, enUS } from 'date-fns/locale';\nimport { cn } from '@/lib/utils';\nimport type {\n  CommitmentStatus,\n  CommitmentPriority,\n  CommitmentOwnerType,\n  CommitmentFilters,\n} from '@/types/commitment.types';\n\nexport interface CommitmentFilterDrawerProps {\n  open: boolean;\n  onOpenChange: (open: boolean) => void;\n  filters: CommitmentFilters;\n  onFiltersChange: (filters: CommitmentFilters) => void;\n  onApply: () => void;\n  onClear: () => void;\n}\n\nconst STATUS_OPTIONS: CommitmentStatus[] = ['pending', 'in_progress', 'completed', 'cancelled'];\nconst PRIORITY_OPTIONS: CommitmentPriority[] = ['low', 'medium', 'high', 'critical'];\nconst OWNER_TYPE_OPTIONS: CommitmentOwnerType[] = ['internal', 'external'];\n\nexport function CommitmentFilterDrawer({\n  open,\n  onOpenChange,\n  filters,\n  onFiltersChange,\n  onApply,\n  onClear,\n}: CommitmentFilterDrawerProps) {\n  const { t, i18n } = useTranslation('commitments');\n  const isRTL = i18n.language === 'ar';\n\n  // Local state for form values\n  const [localFilters, setLocalFilters] = useState<CommitmentFilters>(filters);\n\n  // Sync local state with props when drawer opens\n  useEffect(() => {\n    if (open) {\n      setLocalFilters(filters);\n    }\n  }, [open, filters]);\n\n  // Handle status toggle\n  const handleStatusToggle = (status: CommitmentStatus) => {\n    const currentStatus = localFilters.status || [];\n    const newStatus = currentStatus.includes(status)\n      ? currentStatus.filter((s) => s !== status)\n      : [...currentStatus, status];\n    setLocalFilters({ ...localFilters, status: newStatus.length > 0 ? newStatus : undefined });\n  };\n\n  // Handle priority toggle\n  const handlePriorityToggle = (priority: CommitmentPriority) => {\n    const currentPriority = localFilters.priority || [];\n    const newPriority = currentPriority.includes(priority)\n      ? currentPriority.filter((p) => p !== priority)\n      : [...currentPriority, priority];\n    setLocalFilters({ ...localFilters, priority: newPriority.length > 0 ? newPriority : undefined });\n  };\n\n  // Handle owner type selection\n  const handleOwnerTypeChange = (ownerType: CommitmentOwnerType | undefined) => {\n    setLocalFilters({ ...localFilters, ownerType });\n  };\n\n  // Handle overdue toggle\n  const handleOverdueToggle = (checked: boolean) => {\n    setLocalFilters({ ...localFilters, overdue: checked || undefined });\n  };\n\n  // Handle date range changes\n  const handleDateFromChange = (date: Date | undefined) => {\n    setLocalFilters({\n      ...localFilters,\n      dueDateFrom: date ? date.toISOString().split('T')[0] : undefined,\n    });\n  };\n\n  const handleDateToChange = (date: Date | undefined) => {\n    setLocalFilters({\n      ...localFilters,\n      dueDateTo: date ? date.toISOString().split('T')[0] : undefined,\n    });\n  };\n\n  // Apply filters\n  const handleApply = () => {\n    onFiltersChange(localFilters);\n    onApply();\n    onOpenChange(false);\n  };\n\n  // Clear filters\n  const handleClear = () => {\n    setLocalFilters({});\n    onFiltersChange({});\n    onClear();\n  };\n\n  return (\n    <Sheet open={open} onOpenChange={onOpenChange}>\n      <SheetContent\n        side={isRTL ? 'left' : 'right'}\n        className=\"w-full sm:max-w-md overflow-y-auto\"\n        dir={isRTL ? 'rtl' : 'ltr'}\n      >\n        <SheetHeader>\n          <SheetTitle className=\"text-start\">{t('filters.title')}</SheetTitle>\n        </SheetHeader>\n\n        <div className=\"py-6 space-y-6\">\n          {/* Status Filter */}\n          <div className=\"space-y-3\">\n            <Label className=\"text-sm font-medium text-start block\">\n              {t('filters.status')}\n            </Label>\n            <div className=\"grid grid-cols-2 gap-2\">\n              {STATUS_OPTIONS.map((status) => (\n                <label\n                  key={status}\n                  className=\"flex items-center gap-3 p-3 rounded-lg border cursor-pointer hover:bg-accent min-h-11\"\n                >\n                  <Checkbox\n                    checked={localFilters.status?.includes(status) || false}\n                    onCheckedChange={() => handleStatusToggle(status)}\n                  />\n                  <span className=\"text-sm\">{t(`status.${status}`)}</span>\n                </label>\n              ))}\n            </div>\n          </div>\n\n          {/* Priority Filter */}\n          <div className=\"space-y-3\">\n            <Label className=\"text-sm font-medium text-start block\">\n              {t('filters.priority')}\n            </Label>\n            <div className=\"grid grid-cols-2 gap-2\">\n              {PRIORITY_OPTIONS.map((priority) => (\n                <label\n                  key={priority}\n                  className=\"flex items-center gap-3 p-3 rounded-lg border cursor-pointer hover:bg-accent min-h-11\"\n                >\n                  <Checkbox\n                    checked={localFilters.priority?.includes(priority) || false}\n                    onCheckedChange={() => handlePriorityToggle(priority)}\n                  />\n                  <span className=\"text-sm\">{t(`priority.${priority}`)}</span>\n                </label>\n              ))}\n            </div>\n          </div>\n\n          {/* Owner Type Filter */}\n          <div className=\"space-y-3\">\n            <Label className=\"text-sm font-medium text-start block\">\n              {t('filters.ownerType')}\n            </Label>\n            <div className=\"flex flex-wrap gap-2\">\n              <Button\n                type=\"button\"\n                variant={!localFilters.ownerType ? 'default' : 'outline'}\n                size=\"sm\"\n                className=\"min-h-11\"\n                onClick={() => handleOwnerTypeChange(undefined)}\n              >\n                {t('actions.clearFilters').split(' ')[0]} {/* \"All\" or similar */}\n              </Button>\n              {OWNER_TYPE_OPTIONS.map((ownerType) => (\n                <Button\n                  key={ownerType}\n                  type=\"button\"\n                  variant={localFilters.ownerType === ownerType ? 'default' : 'outline'}\n                  size=\"sm\"\n                  className=\"min-h-11\"\n                  onClick={() => handleOwnerTypeChange(ownerType)}\n                >\n                  {t(`ownerType.${ownerType}`)}\n                </Button>\n              ))}\n            </div>\n          </div>\n\n          {/* Overdue Toggle - T042 */}\n          <div className=\"flex items-center justify-between p-4 rounded-lg border\">\n            <div className=\"space-y-0.5\">\n              <Label className=\"text-sm font-medium text-start block\">\n                {t('filters.overdue')}\n              </Label>\n              <p className=\"text-xs text-muted-foreground text-start\">\n                {t('filters.overdueDescription')}\n              </p>\n            </div>\n            <Switch\n              checked={localFilters.overdue || false}\n              onCheckedChange={handleOverdueToggle}\n            />\n          </div>\n\n          {/* Date Range Filter - T042a */}\n          <div className=\"space-y-3\">\n            <Label className=\"text-sm font-medium text-start block\">\n              {t('filters.dueDate')}\n            </Label>\n            <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-3\">\n              {/* From Date */}\n              <div className=\"space-y-1.5\">\n                <Label className=\"text-xs text-muted-foreground\">\n                  {t('filters.dueDateFrom')}\n                </Label>\n                <Popover>\n                  <PopoverTrigger asChild>\n                    <Button\n                      variant=\"outline\"\n                      className={cn(\n                        'w-full min-h-11 justify-start text-start font-normal',\n                        !localFilters.dueDateFrom && 'text-muted-foreground'\n                      )}\n                    >\n                      <CalendarIcon className={`size-4 ${isRTL ? 'ms-2' : 'me-2'}`} />\n                      {localFilters.dueDateFrom ? (\n                        format(new Date(localFilters.dueDateFrom), 'PPP', {\n                          locale: isRTL ? ar : enUS,\n                        })\n                      ) : (\n                        <span>{t('filters.dueDateFrom')}</span>\n                      )}\n                      {localFilters.dueDateFrom && (\n                        <X\n                          className={`size-4 ${isRTL ? 'me-auto ms-2' : 'ms-auto me-2'} opacity-50 hover:opacity-100`}\n                          onClick={(e) => {\n                            e.stopPropagation();\n                            handleDateFromChange(undefined);\n                          }}\n                        />\n                      )}\n                    </Button>\n                  </PopoverTrigger>\n                  <PopoverContent className=\"w-auto p-0\" align=\"start\">\n                    <Calendar\n                      mode=\"single\"\n                      selected={localFilters.dueDateFrom ? new Date(localFilters.dueDateFrom) : undefined}\n                      onSelect={handleDateFromChange}\n                      initialFocus\n                      locale={isRTL ? ar : enUS}\n                    />\n                  </PopoverContent>\n                </Popover>\n              </div>\n\n              {/* To Date */}\n              <div className=\"space-y-1.5\">\n                <Label className=\"text-xs text-muted-foreground\">\n                  {t('filters.dueDateTo')}\n                </Label>\n                <Popover>\n                  <PopoverTrigger asChild>\n                    <Button\n                      variant=\"outline\"\n                      className={cn(\n                        'w-full min-h-11 justify-start text-start font-normal',\n                        !localFilters.dueDateTo && 'text-muted-foreground'\n                      )}\n                    >\n                      <CalendarIcon className={`size-4 ${isRTL ? 'ms-2' : 'me-2'}`} />\n                      {localFilters.dueDateTo ? (\n                        format(new Date(localFilters.dueDateTo), 'PPP', {\n                          locale: isRTL ? ar : enUS,\n                        })\n                      ) : (\n                        <span>{t('filters.dueDateTo')}</span>\n                      )}\n                      {localFilters.dueDateTo && (\n                        <X\n                          className={`size-4 ${isRTL ? 'me-auto ms-2' : 'ms-auto me-2'} opacity-50 hover:opacity-100`}\n                          onClick={(e) => {\n                            e.stopPropagation();\n                            handleDateToChange(undefined);\n                          }}\n                        />\n                      )}\n                    </Button>\n                  </PopoverTrigger>\n                  <PopoverContent className=\"w-auto p-0\" align=\"start\">\n                    <Calendar\n                      mode=\"single\"\n                      selected={localFilters.dueDateTo ? new Date(localFilters.dueDateTo) : undefined}\n                      onSelect={handleDateToChange}\n                      disabled={(date) =>\n                        localFilters.dueDateFrom\n                          ? date < new Date(localFilters.dueDateFrom)\n                          : false\n                      }\n                      initialFocus\n                      locale={isRTL ? ar : enUS}\n                    />\n                  </PopoverContent>\n                </Popover>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <SheetFooter className=\"flex-col sm:flex-row gap-3 pt-4 border-t\">\n          <Button\n            type=\"button\"\n            variant=\"outline\"\n            onClick={handleClear}\n            className=\"min-h-11 w-full sm:w-auto\"\n          >\n            {t('filters.clear')}\n          </Button>\n          <Button\n            type=\"button\"\n            onClick={handleApply}\n            className=\"min-h-11 w-full sm:flex-1\"\n          >\n            {t('filters.apply')}\n          </Button>\n        </SheetFooter>\n      </SheetContent>\n    </Sheet>\n  );\n}\n","/**\n * FilterChips Component v1.1\n * Feature: 031-commitments-management\n * Task: T038\n *\n * Displays active filters as removable chips above the list:\n * - Shows active status, priority, owner type, and date filters\n * - Click X to remove individual filter\n * - Mobile-first, RTL-compatible, 44x44px touch targets\n */\n\nimport { useTranslation } from 'react-i18next';\nimport { Badge } from '@/components/ui/badge';\nimport { Button } from '@/components/ui/button';\nimport { X } from 'lucide-react';\nimport type { CommitmentFilters } from '@/types/commitment.types';\n\nexport interface FilterChipsProps {\n  filters: CommitmentFilters;\n  onRemoveFilter: (key: keyof CommitmentFilters, value?: string) => void;\n  onClearAll: () => void;\n}\n\nexport function FilterChips({\n  filters,\n  onRemoveFilter,\n  onClearAll,\n}: FilterChipsProps) {\n  const { t, i18n } = useTranslation('commitments');\n  const isRTL = i18n.language === 'ar';\n\n  // Count active filters\n  const activeFilterCount =\n    (filters.status?.length || 0) +\n    (filters.priority?.length || 0) +\n    (filters.ownerType ? 1 : 0) +\n    (filters.overdue ? 1 : 0) +\n    (filters.dueDateFrom ? 1 : 0) +\n    (filters.dueDateTo ? 1 : 0);\n\n  // Don't render if no active filters\n  if (activeFilterCount === 0) {\n    return null;\n  }\n\n  // Format date for display\n  const formatDate = (dateStr: string) => {\n    const date = new Date(dateStr);\n    return date.toLocaleDateString(i18n.language, {\n      month: 'short',\n      day: 'numeric',\n      year: 'numeric',\n    });\n  };\n\n  return (\n    <div\n      className=\"flex flex-wrap items-center gap-2 py-2\"\n      dir={isRTL ? 'rtl' : 'ltr'}\n    >\n      {/* Status chips */}\n      {filters.status?.map((status) => (\n        <Badge\n          key={`status-${status}`}\n          variant=\"secondary\"\n          className=\"flex items-center gap-1 pe-1 text-xs\"\n        >\n          <span>{t(`status.${status}`)}</span>\n          <button\n            type=\"button\"\n            onClick={() => onRemoveFilter('status', status)}\n            className=\"ms-1 rounded-full hover:bg-muted p-0.5 min-w-6 min-h-6 flex items-center justify-center\"\n            aria-label={`Remove ${t(`status.${status}`)} filter`}\n          >\n            <X className=\"size-3\" />\n          </button>\n        </Badge>\n      ))}\n\n      {/* Priority chips */}\n      {filters.priority?.map((priority) => (\n        <Badge\n          key={`priority-${priority}`}\n          variant=\"secondary\"\n          className=\"flex items-center gap-1 pe-1 text-xs\"\n        >\n          <span>{t(`priority.${priority}`)}</span>\n          <button\n            type=\"button\"\n            onClick={() => onRemoveFilter('priority', priority)}\n            className=\"ms-1 rounded-full hover:bg-muted p-0.5 min-w-6 min-h-6 flex items-center justify-center\"\n            aria-label={`Remove ${t(`priority.${priority}`)} filter`}\n          >\n            <X className=\"size-3\" />\n          </button>\n        </Badge>\n      ))}\n\n      {/* Owner type chip */}\n      {filters.ownerType && (\n        <Badge\n          variant=\"secondary\"\n          className=\"flex items-center gap-1 pe-1 text-xs\"\n        >\n          <span>{t(`ownerType.${filters.ownerType}`)}</span>\n          <button\n            type=\"button\"\n            onClick={() => onRemoveFilter('ownerType')}\n            className=\"ms-1 rounded-full hover:bg-muted p-0.5 min-w-6 min-h-6 flex items-center justify-center\"\n            aria-label={`Remove ${t(`ownerType.${filters.ownerType}`)} filter`}\n          >\n            <X className=\"size-3\" />\n          </button>\n        </Badge>\n      )}\n\n      {/* Overdue chip */}\n      {filters.overdue && (\n        <Badge\n          variant=\"secondary\"\n          className=\"flex items-center gap-1 pe-1 text-xs bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-300\"\n        >\n          <span>{t('filters.overdue')}</span>\n          <button\n            type=\"button\"\n            onClick={() => onRemoveFilter('overdue')}\n            className=\"ms-1 rounded-full hover:bg-red-200 dark:hover:bg-red-800 p-0.5 min-w-6 min-h-6 flex items-center justify-center\"\n            aria-label={`Remove ${t('filters.overdue')} filter`}\n          >\n            <X className=\"size-3\" />\n          </button>\n        </Badge>\n      )}\n\n      {/* Date from chip */}\n      {filters.dueDateFrom && (\n        <Badge\n          variant=\"secondary\"\n          className=\"flex items-center gap-1 pe-1 text-xs\"\n        >\n          <span>\n            {t('filters.dueDateFrom')}: {formatDate(filters.dueDateFrom)}\n          </span>\n          <button\n            type=\"button\"\n            onClick={() => onRemoveFilter('dueDateFrom')}\n            className=\"ms-1 rounded-full hover:bg-muted p-0.5 min-w-6 min-h-6 flex items-center justify-center\"\n            aria-label=\"Remove from date filter\"\n          >\n            <X className=\"size-3\" />\n          </button>\n        </Badge>\n      )}\n\n      {/* Date to chip */}\n      {filters.dueDateTo && (\n        <Badge\n          variant=\"secondary\"\n          className=\"flex items-center gap-1 pe-1 text-xs\"\n        >\n          <span>\n            {t('filters.dueDateTo')}: {formatDate(filters.dueDateTo)}\n          </span>\n          <button\n            type=\"button\"\n            onClick={() => onRemoveFilter('dueDateTo')}\n            className=\"ms-1 rounded-full hover:bg-muted p-0.5 min-w-6 min-h-6 flex items-center justify-center\"\n            aria-label=\"Remove to date filter\"\n          >\n            <X className=\"size-3\" />\n          </button>\n        </Badge>\n      )}\n\n      {/* Clear all button */}\n      {activeFilterCount > 1 && (\n        <Button\n          type=\"button\"\n          variant=\"ghost\"\n          size=\"sm\"\n          onClick={onClearAll}\n          className=\"min-h-8 text-xs text-muted-foreground hover:text-foreground\"\n        >\n          {t('filters.clear')}\n        </Button>\n      )}\n    </div>\n  );\n}\n","/**\n * CommitmentsList Component v1.1\n * Feature: 031-commitments-management\n * Tasks: T025, T026, T043, T044, T061, T064, T065, T066\n *\n * Displays a list of commitments with:\n * - CommitmentCard components\n * - Create commitment dialog integration\n * - Filter drawer and chips integration (T043)\n * - Empty state when no results match filters (T044)\n * - Detail drawer on card tap (T061)\n * - Infinite scroll pagination (T064, T065, T066)\n * - Mobile-first, RTL-compatible, accessible\n */\n\nimport { useState, useCallback, useEffect, useRef } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Button } from '@/components/ui/button';\nimport { Skeleton } from '@/components/ui/skeleton';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n} from '@/components/ui/dialog';\nimport {\n  Sheet,\n  SheetContent,\n  SheetHeader,\n  SheetTitle,\n} from '@/components/ui/sheet';\nimport {\n  AlertCircle,\n  CheckCircle,\n  Plus,\n  Filter,\n  SearchX,\n  Loader2,\n} from 'lucide-react';\nimport { useInfiniteCommitments } from '@/hooks/useCommitments';\nimport { CommitmentCard } from './CommitmentCard';\nimport { CommitmentForm } from './CommitmentForm';\nimport { CommitmentFilterDrawer } from './CommitmentFilterDrawer';\nimport { CommitmentDetailDrawer } from './CommitmentDetailDrawer';\nimport { FilterChips } from './FilterChips';\nimport type {\n  CommitmentStatus,\n  CommitmentPriority,\n  Commitment,\n  CommitmentFilters,\n} from '@/types/commitment.types';\n\nexport interface CommitmentsListProps {\n  dossierId?: string;\n  status?: CommitmentStatus[];\n  priority?: CommitmentPriority[];\n  ownerId?: string;\n  overdue?: boolean;\n  dueDateFrom?: string;\n  dueDateTo?: string;\n  showFilters?: boolean;\n  showCreateButton?: boolean;\n  onFiltersChange?: (filters: CommitmentFilters) => void;\n}\n\nexport function CommitmentsList({\n  dossierId,\n  status,\n  priority,\n  ownerId,\n  overdue,\n  dueDateFrom,\n  dueDateTo,\n  showFilters = false,\n  showCreateButton = true,\n  onFiltersChange,\n}: CommitmentsListProps) {\n  const { t, i18n } = useTranslation('commitments');\n  const isRTL = i18n.language === 'ar';\n\n  // State for create/edit dialogs\n  const [showCreateDialog, setShowCreateDialog] = useState(false);\n  const [editingCommitment, setEditingCommitment] = useState<Commitment | null>(null);\n  const [showFilterDrawer, setShowFilterDrawer] = useState(false);\n  // T061: State for detail drawer\n  const [selectedCommitmentId, setSelectedCommitmentId] = useState<string | null>(null);\n\n  // Build filters from props\n  const filters: CommitmentFilters = {\n    dossierId,\n    status,\n    priority,\n    ownerId,\n    overdue,\n    dueDateFrom,\n    dueDateTo,\n  };\n\n  // Local filter state for the drawer\n  const [localFilters, setLocalFilters] = useState<CommitmentFilters>(filters);\n\n  // T064: Ref for scroll detection\n  const loadMoreRef = useRef<HTMLDivElement>(null);\n\n  // Fetch commitments with infinite scroll pagination\n  const {\n    data,\n    isLoading,\n    isError,\n    error,\n    fetchNextPage,\n    hasNextPage,\n    isFetchingNextPage,\n  } = useInfiniteCommitments({\n    dossierId,\n    status,\n    priority,\n    ownerId,\n    overdue,\n    dueDateFrom,\n    dueDateTo,\n  });\n\n  // T064: Scroll detection using Intersection Observer\n  useEffect(() => {\n    const observer = new IntersectionObserver(\n      (entries) => {\n        const [entry] = entries;\n        if (entry.isIntersecting && hasNextPage && !isFetchingNextPage) {\n          fetchNextPage();\n        }\n      },\n      { threshold: 0.1, rootMargin: '100px' }\n    );\n\n    const currentRef = loadMoreRef.current;\n    if (currentRef) {\n      observer.observe(currentRef);\n    }\n\n    return () => {\n      if (currentRef) {\n        observer.unobserve(currentRef);\n      }\n    };\n  }, [fetchNextPage, hasNextPage, isFetchingNextPage]);\n\n  // Flatten pages into single array of commitments\n  const allCommitments = data?.pages.flatMap((page) => page.commitments) ?? [];\n  const totalCount = data?.pages[0]?.totalCount ?? 0;\n\n  // Handle edit commitment\n  const handleEdit = (commitment: Commitment) => {\n    setEditingCommitment(commitment);\n  };\n\n  // T061: Handle card click - open detail drawer\n  const handleCardClick = (commitmentId: string) => {\n    setSelectedCommitmentId(commitmentId);\n  };\n\n  // Handle form success\n  const handleFormSuccess = () => {\n    setShowCreateDialog(false);\n    setEditingCommitment(null);\n  };\n\n  // Handle filter changes from drawer\n  const handleFiltersChange = useCallback((newFilters: CommitmentFilters) => {\n    setLocalFilters(newFilters);\n  }, []);\n\n  // Apply filters\n  const handleApplyFilters = useCallback(() => {\n    onFiltersChange?.(localFilters);\n  }, [localFilters, onFiltersChange]);\n\n  // Clear all filters\n  const handleClearFilters = useCallback(() => {\n    const clearedFilters: CommitmentFilters = { dossierId };\n    setLocalFilters(clearedFilters);\n    onFiltersChange?.(clearedFilters);\n  }, [dossierId, onFiltersChange]);\n\n  // T043: Remove individual filter from chips\n  const handleRemoveFilter = useCallback(\n    (key: keyof CommitmentFilters, value?: string) => {\n      const newFilters = { ...filters };\n\n      if (key === 'status' && value) {\n        newFilters.status = filters.status?.filter((s) => s !== value);\n        if (newFilters.status?.length === 0) newFilters.status = undefined;\n      } else if (key === 'priority' && value) {\n        newFilters.priority = filters.priority?.filter((p) => p !== value);\n        if (newFilters.priority?.length === 0) newFilters.priority = undefined;\n      } else {\n        (newFilters as Record<string, unknown>)[key] = undefined;\n      }\n\n      setLocalFilters(newFilters);\n      onFiltersChange?.(newFilters);\n    },\n    [filters, onFiltersChange]\n  );\n\n  // Check if any filters are active (excluding dossierId)\n  const hasActiveFilters =\n    (filters.status?.length || 0) > 0 ||\n    (filters.priority?.length || 0) > 0 ||\n    !!filters.ownerId ||\n    !!filters.ownerType ||\n    !!filters.overdue ||\n    !!filters.dueDateFrom ||\n    !!filters.dueDateTo;\n\n  // Loading state\n  if (isLoading) {\n    return (\n      <div className=\"space-y-4\" dir={isRTL ? 'rtl' : 'ltr'}>\n        {[...Array(3)].map((_, i) => (\n          <Skeleton key={i} className=\"h-32 w-full rounded-lg\" />\n        ))}\n      </div>\n    );\n  }\n\n  // Error state\n  if (isError) {\n    return (\n      <div dir={isRTL ? 'rtl' : 'ltr'}>\n        <Alert variant=\"destructive\">\n          <AlertCircle className=\"size-4\" />\n          <AlertDescription>\n            {t('errors.loadFailed')}\n            {error?.message && `: ${error.message}`}\n          </AlertDescription>\n        </Alert>\n      </div>\n    );\n  }\n\n  // T044: Empty state when no results match filters\n  if (!data || allCommitments.length === 0) {\n    const isFiltered = hasActiveFilters;\n\n    return (\n      <div dir={isRTL ? 'rtl' : 'ltr'}>\n        {/* Header with filter button even when empty */}\n        {showFilters && (\n          <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 px-1 mb-4\">\n            <h2 className=\"text-xl sm:text-2xl font-bold text-foreground text-start\">\n              {t('title')}\n            </h2>\n            <div className=\"flex items-center gap-2\">\n              <Button\n                variant=\"outline\"\n                size=\"sm\"\n                className=\"min-h-11\"\n                onClick={() => setShowFilterDrawer(true)}\n              >\n                <Filter className={`size-4 ${isRTL ? 'ms-2' : 'me-2'}`} />\n                {t('filters.title')}\n                {hasActiveFilters && (\n                  <span className=\"ms-1 px-1.5 py-0.5 bg-primary text-primary-foreground rounded-full text-xs\">\n                    {(filters.status?.length || 0) +\n                      (filters.priority?.length || 0) +\n                      (filters.ownerId ? 1 : 0) +\n                      (filters.ownerType ? 1 : 0) +\n                      (filters.overdue ? 1 : 0) +\n                      (filters.dueDateFrom ? 1 : 0) +\n                      (filters.dueDateTo ? 1 : 0)}\n                  </span>\n                )}\n              </Button>\n              {showCreateButton && dossierId && (\n                <Button\n                  onClick={() => setShowCreateDialog(true)}\n                  size=\"sm\"\n                  className=\"min-h-11\"\n                >\n                  <Plus className={`size-4 ${isRTL ? 'ms-2' : 'me-2'}`} />\n                  {t('actions.create')}\n                </Button>\n              )}\n            </div>\n          </div>\n        )}\n\n        {/* Filter chips when empty but filtered */}\n        {isFiltered && (\n          <FilterChips\n            filters={filters}\n            onRemoveFilter={handleRemoveFilter}\n            onClearAll={handleClearFilters}\n          />\n        )}\n\n        <div className=\"flex flex-col items-center justify-center py-12 px-4 text-center\">\n          {isFiltered ? (\n            <>\n              <SearchX className=\"size-12 text-muted-foreground mb-4\" />\n              <h3 className=\"text-lg font-medium text-foreground mb-2\">\n                {t('list.emptyFiltered')}\n              </h3>\n              <p className=\"text-sm text-muted-foreground max-w-md mb-6\">\n                {t('list.emptyFiltered')}\n              </p>\n              <Button\n                variant=\"outline\"\n                onClick={handleClearFilters}\n                className=\"min-h-11\"\n              >\n                {t('filters.clear')}\n              </Button>\n            </>\n          ) : (\n            <>\n              <CheckCircle className=\"size-12 text-muted-foreground mb-4\" />\n              <h3 className=\"text-lg font-medium text-foreground mb-2\">\n                {t('list.empty')}\n              </h3>\n              <p className=\"text-sm text-muted-foreground max-w-md mb-6\">\n                {t('list.empty')}\n              </p>\n              {showCreateButton && dossierId && (\n                <Button\n                  onClick={() => setShowCreateDialog(true)}\n                  className=\"min-h-11\"\n                >\n                  <Plus className={`size-4 ${isRTL ? 'ms-2' : 'me-2'}`} />\n                  {t('actions.create')}\n                </Button>\n              )}\n            </>\n          )}\n        </div>\n\n        {/* Filter Drawer */}\n        <CommitmentFilterDrawer\n          open={showFilterDrawer}\n          onOpenChange={setShowFilterDrawer}\n          filters={localFilters}\n          onFiltersChange={handleFiltersChange}\n          onApply={handleApplyFilters}\n          onClear={handleClearFilters}\n        />\n\n        {/* Create Dialog */}\n        {dossierId && (\n          <Dialog open={showCreateDialog} onOpenChange={setShowCreateDialog}>\n            <DialogContent\n              className=\"max-w-lg max-h-[90vh] overflow-y-auto\"\n              dir={isRTL ? 'rtl' : 'ltr'}\n            >\n              <DialogHeader>\n                <DialogTitle className=\"text-start\">\n                  {t('actions.create')}\n                </DialogTitle>\n              </DialogHeader>\n              <CommitmentForm\n                dossierId={dossierId}\n                onSuccess={handleFormSuccess}\n                onCancel={() => setShowCreateDialog(false)}\n              />\n            </DialogContent>\n          </Dialog>\n        )}\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-4\" dir={isRTL ? 'rtl' : 'ltr'}>\n      {/* Header with count and actions */}\n      <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 px-1\">\n        <h2 className=\"text-xl sm:text-2xl font-bold text-foreground text-start\">\n          {t('title')}\n          <span className=\"ms-2 text-sm font-normal text-muted-foreground\">\n            ({totalCount})\n          </span>\n        </h2>\n\n        <div className=\"flex items-center gap-2\">\n          {showFilters && (\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              className=\"min-h-11\"\n              onClick={() => setShowFilterDrawer(true)}\n            >\n              <Filter className={`size-4 ${isRTL ? 'ms-2' : 'me-2'}`} />\n              {t('filters.title')}\n              {hasActiveFilters && (\n                <span className=\"ms-1 px-1.5 py-0.5 bg-primary text-primary-foreground rounded-full text-xs\">\n                  {(filters.status?.length || 0) +\n                    (filters.priority?.length || 0) +\n                    (filters.ownerType ? 1 : 0) +\n                    (filters.overdue ? 1 : 0) +\n                    (filters.dueDateFrom ? 1 : 0) +\n                    (filters.dueDateTo ? 1 : 0)}\n                </span>\n              )}\n            </Button>\n          )}\n          {showCreateButton && dossierId && (\n            <Button\n              onClick={() => setShowCreateDialog(true)}\n              size=\"sm\"\n              className=\"min-h-11\"\n            >\n              <Plus className={`size-4 ${isRTL ? 'ms-2' : 'me-2'}`} />\n              {t('actions.create')}\n            </Button>\n          )}\n        </div>\n      </div>\n\n      {/* T043: Filter chips above list */}\n      {hasActiveFilters && (\n        <FilterChips\n          filters={filters}\n          onRemoveFilter={handleRemoveFilter}\n          onClearAll={handleClearFilters}\n        />\n      )}\n\n      {/* Commitments Grid - Mobile First */}\n      <div className=\"grid grid-cols-1 gap-4\">\n        {allCommitments.map((commitment) => (\n          <CommitmentCard\n            key={commitment.id}\n            commitment={commitment}\n            onEdit={handleEdit}\n          />\n        ))}\n      </div>\n\n      {/* T064: Scroll detection trigger and T065: Loading indicator */}\n      <div ref={loadMoreRef} className=\"py-4\">\n        {isFetchingNextPage && (\n          <div className=\"flex items-center justify-center gap-2 text-muted-foreground\">\n            <Loader2 className=\"size-5 animate-spin\" />\n            <span className=\"text-sm\">{t('list.loading')}</span>\n          </div>\n        )}\n        {hasNextPage && !isFetchingNextPage && (\n          <p className=\"text-sm text-muted-foreground text-center\">\n            {t('list.loadMore')}\n          </p>\n        )}\n      </div>\n\n      {/* T066: End of list indicator */}\n      {!hasNextPage && allCommitments.length > 0 && (\n        <p className=\"text-sm text-muted-foreground text-center py-2\">\n          {t('list.endOfList')}\n        </p>\n      )}\n\n      {/* Filter Drawer */}\n      <CommitmentFilterDrawer\n        open={showFilterDrawer}\n        onOpenChange={setShowFilterDrawer}\n        filters={localFilters}\n        onFiltersChange={handleFiltersChange}\n        onApply={handleApplyFilters}\n        onClear={handleClearFilters}\n      />\n\n      {/* Create Dialog */}\n      {dossierId && (\n        <Dialog open={showCreateDialog} onOpenChange={setShowCreateDialog}>\n          <DialogContent\n            className=\"max-w-lg max-h-[90vh] overflow-y-auto\"\n            dir={isRTL ? 'rtl' : 'ltr'}\n          >\n            <DialogHeader>\n              <DialogTitle className=\"text-start\">\n                {t('actions.create')}\n              </DialogTitle>\n            </DialogHeader>\n            <CommitmentForm\n              dossierId={dossierId}\n              onSuccess={handleFormSuccess}\n              onCancel={() => setShowCreateDialog(false)}\n            />\n          </DialogContent>\n        </Dialog>\n      )}\n\n      {/* Edit Sheet (bottom sheet on mobile, side panel on desktop) */}\n      <Sheet\n        open={!!editingCommitment}\n        onOpenChange={(open) => !open && setEditingCommitment(null)}\n      >\n        <SheetContent\n          side={isRTL ? 'left' : 'right'}\n          className=\"w-full sm:max-w-lg overflow-y-auto\"\n          dir={isRTL ? 'rtl' : 'ltr'}\n        >\n          <SheetHeader>\n            <SheetTitle className=\"text-start\">\n              {t('actions.edit')}\n            </SheetTitle>\n          </SheetHeader>\n          {editingCommitment && dossierId && (\n            <div className=\"mt-6\">\n              <CommitmentForm\n                dossierId={dossierId}\n                commitment={editingCommitment}\n                onSuccess={handleFormSuccess}\n                onCancel={() => setEditingCommitment(null)}\n              />\n            </div>\n          )}\n        </SheetContent>\n      </Sheet>\n    </div>\n  );\n}\n","/**\n * StatusTimeline Component v1.1\n * Feature: 031-commitments-management\n * Task: T056\n *\n * Displays commitment status history as a vertical timeline:\n * - Status changes with timestamps\n * - User who made the change\n * - Notes associated with changes\n * - Mobile-first, RTL-compatible\n */\n\nimport { useTranslation } from 'react-i18next';\nimport { Skeleton } from '@/components/ui/skeleton';\nimport {\n  Clock,\n  ArrowRight,\n  CheckCircle,\n  XCircle,\n  User,\n  FileText,\n  AlertTriangle,\n} from 'lucide-react';\nimport { useCommitmentStatusHistory } from '@/hooks/useCommitments';\nimport type { CommitmentStatus, CommitmentStatusHistory } from '@/types/commitment.types';\nimport { STATUS_COLORS } from '@/types/commitment.types';\n\nexport interface StatusTimelineProps {\n  commitmentId: string;\n  createdAt?: string | null;\n  createdBy?: string | null;\n}\n\n// Status icons mapping\nconst statusIcons: Record<CommitmentStatus, React.ReactNode> = {\n  pending: <Clock className=\"size-4\" />,\n  in_progress: <ArrowRight className=\"size-4\" />,\n  completed: <CheckCircle className=\"size-4\" />,\n  cancelled: <XCircle className=\"size-4\" />,\n  overdue: <AlertTriangle className=\"size-4\" />,\n};\n\nexport function StatusTimeline({\n  commitmentId,\n  createdAt,\n  createdBy,\n}: StatusTimelineProps) {\n  const { t, i18n } = useTranslation('commitments');\n  const isRTL = i18n.language === 'ar';\n\n  // Fetch status history\n  const { data: history, isLoading, isError } = useCommitmentStatusHistory(commitmentId);\n\n  // Format date/time\n  const formatDateTime = (dateStr: string) => {\n    const date = new Date(dateStr);\n    return date.toLocaleString(i18n.language, {\n      year: 'numeric',\n      month: 'short',\n      day: 'numeric',\n      hour: '2-digit',\n      minute: '2-digit',\n    });\n  };\n\n  // Loading state\n  if (isLoading) {\n    return (\n      <div className=\"space-y-4\">\n        {[...Array(3)].map((_, i) => (\n          <div key={i} className=\"flex gap-3\">\n            <Skeleton className=\"size-8 rounded-full shrink-0\" />\n            <div className=\"flex-1 space-y-2\">\n              <Skeleton className=\"h-4 w-3/4\" />\n              <Skeleton className=\"h-3 w-1/2\" />\n            </div>\n          </div>\n        ))}\n      </div>\n    );\n  }\n\n  // Error state\n  if (isError) {\n    return (\n      <p className=\"text-sm text-muted-foreground text-center py-4\">\n        {t('detail.noHistory')}\n      </p>\n    );\n  }\n\n  // Empty state\n  if (!history?.length && !createdAt) {\n    return (\n      <p className=\"text-sm text-muted-foreground text-center py-4\">\n        {t('detail.noHistory')}\n      </p>\n    );\n  }\n\n  return (\n    <div className=\"space-y-0\" dir={isRTL ? 'rtl' : 'ltr'}>\n      {/* Status history entries */}\n      {history?.map((entry, index) => (\n        <TimelineEntry\n          key={entry.id}\n          entry={entry}\n          isFirst={index === 0}\n          isLast={index === (history.length - 1) && !createdAt}\n          formatDateTime={formatDateTime}\n        />\n      ))}\n\n      {/* Creation entry */}\n      {createdAt && (\n        <div className=\"flex gap-3\">\n          {/* Timeline connector */}\n          <div className=\"flex flex-col items-center\">\n            <div className=\"size-8 rounded-full bg-muted flex items-center justify-center shrink-0\">\n              <FileText className=\"size-4 text-muted-foreground\" />\n            </div>\n          </div>\n\n          {/* Content */}\n          <div className=\"flex-1 pb-4\">\n            <p className=\"text-sm font-medium text-start\">\n              {t('timeline.created')}\n            </p>\n            <p className=\"text-xs text-muted-foreground text-start mt-0.5\">\n              {formatDateTime(createdAt)}\n            </p>\n            {createdBy && (\n              <p className=\"text-xs text-muted-foreground text-start mt-0.5 flex items-center gap-1\">\n                <User className=\"size-3\" />\n                {t('timeline.by', { user: createdBy })}\n              </p>\n            )}\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n\n// Individual timeline entry component\ninterface TimelineEntryProps {\n  entry: CommitmentStatusHistory;\n  isFirst: boolean;\n  isLast: boolean;\n  formatDateTime: (dateStr: string) => string;\n}\n\nfunction TimelineEntry({\n  entry,\n  isFirst,\n  isLast,\n  formatDateTime,\n}: TimelineEntryProps) {\n  const { t, i18n } = useTranslation('commitments');\n  const isRTL = i18n.language === 'ar';\n\n  // Guard against undefined status with fallback colors\n  const newStatusColors = entry.new_status && STATUS_COLORS[entry.new_status]\n    ? STATUS_COLORS[entry.new_status]\n    : { bg: 'bg-gray-100', text: 'text-gray-500', border: 'border-gray-300' };\n\n  return (\n    <div className=\"flex gap-3\">\n      {/* Timeline connector */}\n      <div className=\"flex flex-col items-center\">\n        <div\n          className={`size-8 rounded-full flex items-center justify-center shrink-0 ${newStatusColors.bg} ${newStatusColors.text}`}\n        >\n          {entry.new_status && statusIcons[entry.new_status] ? statusIcons[entry.new_status] : <Clock className=\"size-4\" />}\n        </div>\n        {/* Line to next entry */}\n        {!isLast && (\n          <div className=\"w-0.5 flex-1 bg-muted min-h-4\" />\n        )}\n      </div>\n\n      {/* Content */}\n      <div className={`flex-1 ${!isLast ? 'pb-4' : ''}`}>\n        <p className=\"text-sm font-medium text-start\">\n          {entry.old_status ? (\n            t('timeline.statusChanged', {\n              from: t(`status.${entry.old_status}`),\n              to: t(`status.${entry.new_status}`),\n            })\n          ) : (\n            t(`status.${entry.new_status}`)\n          )}\n        </p>\n        <p className=\"text-xs text-muted-foreground text-start mt-0.5\">\n          {formatDateTime(entry.changed_at)}\n        </p>\n        {entry.changed_by_name && (\n          <p className=\"text-xs text-muted-foreground text-start mt-0.5 flex items-center gap-1\">\n            <User className=\"size-3\" />\n            {t('timeline.by', { user: entry.changed_by_name })}\n          </p>\n        )}\n        {entry.notes && (\n          <p className=\"text-xs text-muted-foreground text-start mt-2 italic border-s-2 border-muted ps-2\">\n            {entry.notes}\n          </p>\n        )}\n      </div>\n    </div>\n  );\n}\n","/**\n * CommitmentDetailDrawer Component v1.1\n * Feature: 031-commitments-management\n * Tasks: T055, T058, T059, T060\n *\n * Displays detailed commitment information in a side drawer:\n * - Full commitment details with status timeline (T058)\n * - Dossier link navigation (T059)\n * - Edit mode toggle with CommitmentForm (T060)\n * - Evidence display and upload\n * - Mobile-first, RTL-compatible, 44x44px touch targets\n */\n\nimport { useState } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { useNavigate } from '@tanstack/react-router';\nimport {\n  Sheet,\n  SheetContent,\n  SheetHeader,\n  SheetTitle,\n} from '@/components/ui/sheet';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Separator } from '@/components/ui/separator';\nimport { Skeleton } from '@/components/ui/skeleton';\nimport {\n  Calendar,\n  Edit,\n  ExternalLink,\n  FileText,\n  User,\n  CheckCircle,\n  AlertTriangle,\n  Download,\n  Upload,\n  Loader2,\n} from 'lucide-react';\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n} from '@/components/ui/dialog';\nimport { useCommitment } from '@/hooks/useCommitments';\nimport { useDossier } from '@/hooks/useDossier';\nimport { getEvidenceUrl } from '@/services/commitments.service';\nimport {\n  type Commitment,\n  PRIORITY_COLORS,\n  STATUS_COLORS,\n} from '@/types/commitment.types';\nimport {\n  isCommitmentOverdue,\n  getDaysUntilDue,\n} from '@/services/commitments.service';\nimport { StatusDropdown } from './StatusDropdown';\nimport { StatusTimeline } from './StatusTimeline';\nimport { CommitmentForm } from './CommitmentForm';\nimport { EvidenceUpload } from './EvidenceUpload';\n\nexport interface CommitmentDetailDrawerProps {\n  commitmentId: string | null;\n  open: boolean;\n  onOpenChange: (open: boolean) => void;\n}\n\nexport function CommitmentDetailDrawer({\n  commitmentId,\n  open,\n  onOpenChange,\n}: CommitmentDetailDrawerProps) {\n  const { t, i18n } = useTranslation('commitments');\n  const navigate = useNavigate();\n  const isRTL = i18n.language === 'ar';\n\n  // State\n  const [isEditing, setIsEditing] = useState(false);\n  const [showUploadDialog, setShowUploadDialog] = useState(false);\n  const [isDownloading, setIsDownloading] = useState(false);\n\n  // Fetch commitment details\n  const { data: commitment, isLoading, isError } = useCommitment(\n    commitmentId ?? '',\n    { enabled: !!commitmentId && open }\n  );\n\n  // Fetch dossier details for displaying name\n  const { data: dossier } = useDossier(\n    commitment?.dossier_id ?? '',\n    undefined,\n    { enabled: !!commitment?.dossier_id }\n  );\n\n  // Get dossier display name based on language\n  const dossierDisplayName = dossier\n    ? isRTL\n      ? dossier.name_ar || dossier.name_en\n      : dossier.name_en\n    : commitment?.dossier_id;\n\n  // Reset edit mode when drawer closes\n  const handleOpenChange = (newOpen: boolean) => {\n    if (!newOpen) {\n      setIsEditing(false);\n    }\n    onOpenChange(newOpen);\n  };\n\n  // T059: Navigate to dossier (using type-specific routes)\n  const handleNavigateToDossier = () => {\n    if (commitment?.dossier_id && dossier?.type) {\n      onOpenChange(false);\n      // Map dossier type to route segment (pluralize for route)\n      const typeToRoute: Record<string, string> = {\n        country: 'countries',\n        organization: 'organizations',\n        person: 'persons',\n        engagement: 'engagements',\n        forum: 'forums',\n        working_group: 'working_groups',\n      };\n      const routeSegment = typeToRoute[dossier.type] || 'countries';\n      navigate({\n        to: `/dossiers/${routeSegment}/$id`,\n        params: { id: commitment.dossier_id },\n      });\n    }\n  };\n\n  // Handle evidence download\n  const handleDownloadEvidence = async () => {\n    if (!commitment?.proof_url) return;\n\n    setIsDownloading(true);\n    try {\n      const { signedUrl } = await getEvidenceUrl(commitment.proof_url);\n      window.open(signedUrl, '_blank');\n    } catch (error) {\n      console.error('Failed to get evidence URL:', error);\n    } finally {\n      setIsDownloading(false);\n    }\n  };\n\n  // Format dates\n  const formatDate = (dateStr: string | null | undefined) => {\n    if (!dateStr) return '-';\n    return new Date(dateStr).toLocaleDateString(i18n.language, {\n      year: 'numeric',\n      month: 'short',\n      day: 'numeric',\n    });\n  };\n\n  const formatDateTime = (dateStr: string | null | undefined) => {\n    if (!dateStr) return '-';\n    return new Date(dateStr).toLocaleString(i18n.language, {\n      year: 'numeric',\n      month: 'short',\n      day: 'numeric',\n      hour: '2-digit',\n      minute: '2-digit',\n    });\n  };\n\n  // Calculate overdue status\n  const overdue = commitment\n    ? isCommitmentOverdue(commitment.due_date, commitment.status)\n    : false;\n  const daysUntilDue = commitment ? getDaysUntilDue(commitment.due_date) : 0;\n\n  return (\n    <>\n      <Sheet open={open} onOpenChange={handleOpenChange}>\n        <SheetContent\n          side={isRTL ? 'left' : 'right'}\n          className=\"w-full sm:max-w-lg overflow-y-auto\"\n          dir={isRTL ? 'rtl' : 'ltr'}\n          accessibleTitle={t('detail.title', 'Commitment Details')}\n        >\n          {/* Loading State */}\n          {isLoading && (\n            <div className=\"space-y-6\">\n              <SheetHeader>\n                <Skeleton className=\"h-8 w-3/4\" />\n              </SheetHeader>\n              <div className=\"space-y-4\">\n                <Skeleton className=\"h-20 w-full\" />\n                <Skeleton className=\"h-20 w-full\" />\n                <Skeleton className=\"h-40 w-full\" />\n              </div>\n            </div>\n          )}\n\n          {/* Error State */}\n          {isError && (\n            <div className=\"flex flex-col items-center justify-center py-12\">\n              <AlertTriangle className=\"size-12 text-muted-foreground mb-4\" />\n              <p className=\"text-muted-foreground\">{t('errors.loadFailed')}</p>\n            </div>\n          )}\n\n          {/* Content */}\n          {commitment && !isLoading && (\n            <>\n              {/* T060: Edit Mode */}\n              {isEditing ? (\n                <>\n                  <SheetHeader>\n                    <SheetTitle className=\"text-start\">\n                      {t('actions.edit')}\n                    </SheetTitle>\n                  </SheetHeader>\n                  <div className=\"mt-6\">\n                    <CommitmentForm\n                      dossierId={commitment.dossier_id}\n                      commitment={commitment}\n                      onSuccess={() => setIsEditing(false)}\n                      onCancel={() => setIsEditing(false)}\n                    />\n                  </div>\n                </>\n              ) : (\n                <>\n                  {/* Header with title and actions */}\n                  <SheetHeader className=\"space-y-4\">\n                    <div className=\"flex items-start justify-between gap-2\">\n                      <SheetTitle className=\"text-start text-lg flex-1\">\n                        {commitment.title || t('card.noTitle')}\n                      </SheetTitle>\n                      {commitment.status !== 'cancelled' &&\n                        commitment.status !== 'completed' && (\n                          <Button\n                            variant=\"outline\"\n                            size=\"sm\"\n                            onClick={() => setIsEditing(true)}\n                            className=\"min-h-11 shrink-0\"\n                          >\n                            <Edit className={`size-4 ${isRTL ? 'ms-2' : 'me-2'}`} />\n                            {t('actions.edit')}\n                          </Button>\n                        )}\n                    </div>\n\n                    {/* Status */}\n                    <div className=\"flex items-center gap-2\">\n                      <StatusDropdown\n                        commitmentId={commitment.id}\n                        currentStatus={commitment.status}\n                      />\n                    </div>\n                  </SheetHeader>\n\n                  <div className=\"mt-6 space-y-6\">\n                    {/* Description */}\n                    {commitment.description && (\n                      <div>\n                        <p className=\"text-sm text-muted-foreground text-start\">\n                          {commitment.description}\n                        </p>\n                      </div>\n                    )}\n\n                    <Separator />\n\n                    {/* Key Details Grid */}\n                    <div className=\"grid grid-cols-2 gap-4\">\n                      {/* Due Date */}\n                      <div className=\"space-y-1\">\n                        <p className=\"text-xs text-muted-foreground text-start\">\n                          {t('form.dueDate')}\n                        </p>\n                        <div\n                          className={`flex items-center gap-1.5 text-sm ${\n                            overdue\n                              ? 'text-red-600 dark:text-red-400 font-medium'\n                              : ''\n                          }`}\n                        >\n                          {overdue ? (\n                            <AlertTriangle className=\"size-4\" />\n                          ) : (\n                            <Calendar className=\"size-4\" />\n                          )}\n                          <span>\n                            {formatDate(commitment.due_date)}\n                            {overdue && ` (${Math.abs(daysUntilDue)} ${t('card.overdueDays', { days: '' }).trim()})`}\n                          </span>\n                        </div>\n                      </div>\n\n                      {/* Priority */}\n                      <div className=\"space-y-1\">\n                        <p className=\"text-xs text-muted-foreground text-start\">\n                          {t('form.priority')}\n                        </p>\n                        <Badge\n                          variant=\"outline\"\n                          className={`${PRIORITY_COLORS[commitment.priority].bg} ${PRIORITY_COLORS[commitment.priority].text}`}\n                        >\n                          {t(`priority.${commitment.priority}`)}\n                        </Badge>\n                      </div>\n\n                      {/* Owner Type */}\n                      <div className=\"space-y-1\">\n                        <p className=\"text-xs text-muted-foreground text-start\">\n                          {t('form.ownerType')}\n                        </p>\n                        <div className=\"flex items-center gap-1.5 text-sm\">\n                          <User className=\"size-4\" />\n                          <span>{t(`ownerType.${commitment.owner_type}`)}</span>\n                        </div>\n                      </div>\n\n                      {/* Tracking Mode */}\n                      <div className=\"space-y-1\">\n                        <p className=\"text-xs text-muted-foreground text-start\">\n                          {t('form.trackingMode')}\n                        </p>\n                        <span className=\"text-sm\">\n                          {t(`form.${commitment.tracking_mode}`)}\n                        </span>\n                      </div>\n                    </div>\n\n                    <Separator />\n\n                    {/* T059: Dossier Link */}\n                    {commitment.dossier_id && (\n                      <>\n                        <div className=\"space-y-2\">\n                          <p className=\"text-xs text-muted-foreground text-start\">\n                            {t('detail.dossier')}\n                          </p>\n                          <Button\n                            variant=\"outline\"\n                            onClick={handleNavigateToDossier}\n                            className=\"min-h-11 w-full justify-start\"\n                          >\n                            <FileText className={`size-4 ${isRTL ? 'ms-2' : 'me-2'}`} />\n                            <span className=\"truncate flex-1 text-start\">\n                              {dossierDisplayName}\n                            </span>\n                            <ExternalLink className=\"size-4 shrink-0\" />\n                          </Button>\n                        </div>\n                        <Separator />\n                      </>\n                    )}\n\n                    {/* Evidence Section */}\n                    <div className=\"space-y-3\">\n                      <p className=\"text-xs text-muted-foreground text-start font-medium\">\n                        {t('detail.evidence')}\n                      </p>\n\n                      {commitment.proof_url ? (\n                        <div className=\"flex flex-col gap-2\">\n                          <div className=\"flex items-center gap-2 p-3 bg-green-50 dark:bg-green-900/20 rounded-lg\">\n                            <CheckCircle className=\"size-5 text-green-600 dark:text-green-400\" />\n                            <div className=\"flex-1\">\n                              <p className=\"text-sm font-medium text-start\">\n                                {t('evidence.uploadSuccess')}\n                              </p>\n                              {commitment.evidence_submitted_at && (\n                                <p className=\"text-xs text-muted-foreground text-start\">\n                                  {t('detail.evidenceSubmittedAt')}:{' '}\n                                  {formatDateTime(commitment.evidence_submitted_at)}\n                                </p>\n                              )}\n                            </div>\n                          </div>\n                          <Button\n                            variant=\"outline\"\n                            onClick={handleDownloadEvidence}\n                            disabled={isDownloading}\n                            className=\"min-h-11\"\n                          >\n                            {isDownloading ? (\n                              <Loader2 className={`size-4 animate-spin ${isRTL ? 'ms-2' : 'me-2'}`} />\n                            ) : (\n                              <Download className={`size-4 ${isRTL ? 'ms-2' : 'me-2'}`} />\n                            )}\n                            {t('actions.downloadEvidence')}\n                          </Button>\n                        </div>\n                      ) : commitment.proof_required ? (\n                        <div className=\"flex flex-col gap-2\">\n                          <div className=\"flex items-center gap-2 p-3 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg\">\n                            <AlertTriangle className=\"size-5 text-yellow-600 dark:text-yellow-400\" />\n                            <p className=\"text-sm text-start\">\n                              {t('form.proofRequiredDescription')}\n                            </p>\n                          </div>\n                          {commitment.status !== 'cancelled' &&\n                            commitment.status !== 'completed' && (\n                              <Button\n                                variant=\"outline\"\n                                onClick={() => setShowUploadDialog(true)}\n                                className=\"min-h-11\"\n                              >\n                                <Upload className={`size-4 ${isRTL ? 'ms-2' : 'me-2'}`} />\n                                {t('actions.uploadEvidence')}\n                              </Button>\n                            )}\n                        </div>\n                      ) : (\n                        <p className=\"text-sm text-muted-foreground text-start\">\n                          {t('detail.noEvidence')}\n                        </p>\n                      )}\n                    </div>\n\n                    <Separator />\n\n                    {/* T058: Status Timeline */}\n                    <div className=\"space-y-3\">\n                      <p className=\"text-xs text-muted-foreground text-start font-medium\">\n                        {t('detail.statusHistory')}\n                      </p>\n                      <StatusTimeline\n                        commitmentId={commitment.id}\n                        createdAt={commitment.created_at}\n                        createdBy={commitment.created_by}\n                      />\n                    </div>\n\n                    <Separator />\n\n                    {/* Metadata */}\n                    <div className=\"grid grid-cols-2 gap-4 text-xs text-muted-foreground\">\n                      <div className=\"space-y-1\">\n                        <p className=\"text-start\">{t('detail.createdAt')}</p>\n                        <p className=\"text-start font-medium text-foreground\">\n                          {formatDateTime(commitment.created_at)}\n                        </p>\n                      </div>\n                      <div className=\"space-y-1\">\n                        <p className=\"text-start\">{t('detail.updatedAt')}</p>\n                        <p className=\"text-start font-medium text-foreground\">\n                          {formatDateTime(commitment.updated_at)}\n                        </p>\n                      </div>\n                      {commitment.completed_at && (\n                        <div className=\"space-y-1 col-span-2\">\n                          <p className=\"text-start\">{t('detail.completedAt')}</p>\n                          <p className=\"text-start font-medium text-foreground\">\n                            {formatDateTime(commitment.completed_at)}\n                          </p>\n                        </div>\n                      )}\n                    </div>\n                  </div>\n                </>\n              )}\n            </>\n          )}\n        </SheetContent>\n      </Sheet>\n\n      {/* Evidence Upload Dialog */}\n      {commitment && (\n        <Dialog open={showUploadDialog} onOpenChange={setShowUploadDialog}>\n          <DialogContent\n            className=\"max-w-md max-h-[90vh] overflow-y-auto\"\n            dir={isRTL ? 'rtl' : 'ltr'}\n          >\n            <DialogHeader>\n              <DialogTitle className=\"text-start\">\n                {t('evidence.title')}\n              </DialogTitle>\n            </DialogHeader>\n            <p className=\"text-sm text-muted-foreground text-start mb-4\">\n              {t('evidence.description')}\n            </p>\n            <EvidenceUpload\n              commitmentId={commitment.id}\n              onSuccess={() => setShowUploadDialog(false)}\n              onCancel={() => setShowUploadDialog(false)}\n            />\n          </DialogContent>\n        </Dialog>\n      )}\n    </>\n  );\n}\n","/**\n * PersonalCommitmentsDashboard Component v1.1\n * Feature: 031-commitments-management\n *\n * Dashboard showing user's commitments with quick status updates\n * Mobile-first, RTL-compatible, accessible\n */\n\nimport { useTranslation } from 'react-i18next'\nimport { supabase } from '@/lib/supabase'\nimport { useQuery } from '@tanstack/react-query'\nimport { CommitmentsList } from './CommitmentsList'\nimport { Card, CardDescription, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs'\nimport { Loader2 } from 'lucide-react'\nimport type { CommitmentStatus } from '@/types/commitment.types'\n\nexport function PersonalCommitmentsDashboard() {\n  const { t, i18n } = useTranslation('commitments')\n  const isRTL = i18n.language === 'ar'\n\n  // Get current user ID for filtering\n  const { data: userData, isLoading: userLoading } = useQuery({\n    queryKey: ['currentUser'],\n    queryFn: async () => {\n      const {\n        data: { user },\n      } = await supabase.auth.getUser()\n      return user\n    },\n    staleTime: 5 * 60 * 1000,\n  })\n\n  // Stats query for quick counts\n  const { data: stats } = useQuery({\n    queryKey: ['commitmentStats', userData?.id],\n    queryFn: async () => {\n      if (!userData?.id) return { active: 0, overdue: 0, completed: 0 }\n\n      // Count active (pending + in_progress)\n      const { count: activeCount } = await supabase\n        .from('aa_commitments')\n        .select('*', { count: 'exact', head: true })\n        .or(`owner_user_id.eq.${userData.id}`)\n        .in('status', ['pending', 'in_progress'])\n\n      // Count overdue\n      const today = new Date().toISOString().split('T')[0]\n      const { count: overdueCount } = await supabase\n        .from('aa_commitments')\n        .select('*', { count: 'exact', head: true })\n        .or(`owner_user_id.eq.${userData.id}`)\n        .lt('due_date', today)\n        .not('status', 'in', '(completed,cancelled)')\n\n      // Count completed\n      const { count: completedCount } = await supabase\n        .from('aa_commitments')\n        .select('*', { count: 'exact', head: true })\n        .or(`owner_user_id.eq.${userData.id}`)\n        .eq('status', 'completed')\n\n      return {\n        active: activeCount ?? 0,\n        overdue: overdueCount ?? 0,\n        completed: completedCount ?? 0,\n      }\n    },\n    enabled: !!userData?.id,\n    staleTime: 2 * 60 * 1000,\n  })\n\n  if (userLoading) {\n    return (\n      <div className=\"flex items-center justify-center py-12\" dir={isRTL ? 'rtl' : 'ltr'}>\n        <Loader2 className=\"h-8 w-8 animate-spin text-gray-400\" />\n        <span className=\"ms-3 text-gray-600\">{t('list.loading')}</span>\n      </div>\n    )\n  }\n\n  const activeStatuses: CommitmentStatus[] = ['pending', 'in_progress']\n  const overdueStatuses: CommitmentStatus[] = ['pending', 'in_progress'] // overdue filter applied separately\n  const completedStatuses: CommitmentStatus[] = ['completed']\n\n  return (\n    <div\n      className=\"container mx-auto px-4 sm:px-6 lg:px-8 py-6 sm:py-8\"\n      dir={isRTL ? 'rtl' : 'ltr'}\n    >\n      {/* Header */}\n      <div className=\"mb-6 sm:mb-8\">\n        <h1 className=\"text-2xl sm:text-3xl md:text-4xl font-bold text-start mb-2\">\n          {t('pageTitle')}\n        </h1>\n        <p className=\"text-sm sm:text-base text-gray-600 text-start\">{t('subtitle')}</p>\n      </div>\n\n      {/* Quick Stats */}\n      <div className=\"grid grid-cols-1 sm:grid-cols-3 gap-4 mb-6 sm:mb-8\">\n        <Card>\n          <CardHeader className=\"pb-3\">\n            <CardDescription className=\"text-start\">\n              {t('status.pending')} / {t('status.in_progress')}\n            </CardDescription>\n            <CardTitle className=\"text-2xl sm:text-3xl text-start\">{stats?.active ?? 0}</CardTitle>\n          </CardHeader>\n        </Card>\n\n        <Card>\n          <CardHeader className=\"pb-3\">\n            <CardDescription className=\"text-start\">{t('status.overdue')}</CardDescription>\n            <CardTitle className=\"text-2xl sm:text-3xl text-red-600 text-start\">\n              {stats?.overdue ?? 0}\n            </CardTitle>\n          </CardHeader>\n        </Card>\n\n        <Card>\n          <CardHeader className=\"pb-3\">\n            <CardDescription className=\"text-start\">{t('status.completed')}</CardDescription>\n            <CardTitle className=\"text-2xl sm:text-3xl text-green-600 text-start\">\n              {stats?.completed ?? 0}\n            </CardTitle>\n          </CardHeader>\n        </Card>\n      </div>\n\n      {/* Tabs with CommitmentsList for each status */}\n      <Tabs defaultValue=\"active\" className=\"w-full\">\n        <TabsList className=\"grid w-full grid-cols-3 mb-4\">\n          <TabsTrigger value=\"active\">\n            <bdi>\n              {t('status.pending')} ({stats?.active ?? 0})\n            </bdi>\n          </TabsTrigger>\n          <TabsTrigger value=\"overdue\">\n            <bdi>\n              {t('status.overdue')} ({stats?.overdue ?? 0})\n            </bdi>\n          </TabsTrigger>\n          <TabsTrigger value=\"completed\">\n            <bdi>\n              {t('status.completed')} ({stats?.completed ?? 0})\n            </bdi>\n          </TabsTrigger>\n        </TabsList>\n\n        <TabsContent value=\"active\">\n          <CommitmentsList ownerId={userData?.id} status={activeStatuses} showFilters={false} />\n        </TabsContent>\n\n        <TabsContent value=\"overdue\">\n          <CommitmentsList ownerId={userData?.id} overdue={true} showFilters={false} />\n        </TabsContent>\n\n        <TabsContent value=\"completed\">\n          <CommitmentsList ownerId={userData?.id} status={completedStatuses} showFilters={false} />\n        </TabsContent>\n      </Tabs>\n    </div>\n  )\n}\n","/**\n * Commitments Page v1.1\n * Feature: 031-commitments-management\n * Tasks: T030, T039, T040\n *\n * Main commitments page with:\n * - URL-synced filtering (T039, T040)\n * - Dossier context support\n * - Personal dashboard view\n * - Mobile-first, RTL-compatible\n */\n\nimport { useCallback } from 'react';\nimport { createFileRoute, Link } from '@tanstack/react-router';\nimport { useTranslation } from 'react-i18next';\nimport { CommitmentsList } from '@/components/commitments/CommitmentsList';\nimport { CommitmentDetailDrawer } from '@/components/commitments/CommitmentDetailDrawer';\nimport { PersonalCommitmentsDashboard } from '@/components/commitments/PersonalCommitmentsDashboard';\nimport { useDossier } from '@/hooks/useDossier';\nimport { Button } from '@/components/ui/button';\nimport { ArrowLeft, Home } from 'lucide-react';\nimport type { CommitmentStatus, CommitmentPriority, CommitmentFilters } from '@/types/commitment.types';\n\n// Type-specific route mapping for dossier navigation\nconst DOSSIER_TYPE_TO_ROUTE: Record<string, string> = {\n  country: 'countries',\n  organization: 'organizations',\n  person: 'persons',\n  engagement: 'engagements',\n  forum: 'forums',\n  working_group: 'working_groups',\n  topic: 'topics',\n};\n\n// T039: Search params schema for URL filter synchronization\ninterface CommitmentsSearchParams {\n  dossierId?: string;\n  status?: string; // Comma-separated status values\n  priority?: string; // Comma-separated priority values (T039)\n  ownerId?: string;\n  overdue?: boolean;\n  dueDateFrom?: string;\n  dueDateTo?: string;\n  search?: string;\n  id?: string; // For deep-linking to specific commitment\n  view?: 'list' | 'dashboard';\n}\n\nexport const Route = createFileRoute('/_protected/commitments')({\n  component: CommitmentsPage,\n  validateSearch: (search: Record<string, unknown>): CommitmentsSearchParams => {\n    return {\n      dossierId: search.dossierId as string | undefined,\n      status: search.status as string | undefined,\n      priority: search.priority as string | undefined,\n      ownerId: search.ownerId as string | undefined,\n      overdue: search.overdue === 'true' || search.overdue === true,\n      dueDateFrom: search.dueDateFrom as string | undefined,\n      dueDateTo: search.dueDateTo as string | undefined,\n      search: search.search as string | undefined,\n      id: search.id as string | undefined,\n      view: (search.view as 'list' | 'dashboard') || 'dashboard',\n    };\n  },\n});\n\nfunction CommitmentsPage() {\n  const { t, i18n } = useTranslation('commitments');\n  const searchParams = Route.useSearch();\n  const navigate = Route.useNavigate();\n  const isRTL = i18n.language === 'ar';\n\n  // Fetch dossier details when dossierId is present (for type-specific navigation)\n  const { data: dossier } = useDossier(\n    searchParams.dossierId ?? '',\n    undefined,\n    { enabled: !!searchParams.dossierId }\n  );\n\n  // Parse status from comma-separated string to typed array\n  const statusArray: CommitmentStatus[] | undefined = searchParams.status\n    ? (searchParams.status.split(',').filter(Boolean) as CommitmentStatus[])\n    : undefined;\n\n  // Parse priority from comma-separated string to typed array (T039)\n  const priorityArray: CommitmentPriority[] | undefined = searchParams.priority\n    ? (searchParams.priority.split(',').filter(Boolean) as CommitmentPriority[])\n    : undefined;\n\n  // T040: Handler to sync filter changes with URL query parameters\n  const handleFiltersChange = useCallback(\n    (filters: CommitmentFilters) => {\n      navigate({\n        search: (prev) => ({\n          ...prev,\n          // Convert arrays to comma-separated strings for URL\n          status: filters.status?.length ? filters.status.join(',') : undefined,\n          priority: filters.priority?.length ? filters.priority.join(',') : undefined,\n          ownerId: filters.ownerId || undefined,\n          overdue: filters.overdue || undefined,\n          dueDateFrom: filters.dueDateFrom || undefined,\n          dueDateTo: filters.dueDateTo || undefined,\n          // Preserve dossierId from current params\n          dossierId: filters.dossierId || prev.dossierId,\n        }),\n        replace: true, // Replace history entry instead of pushing new\n      });\n    },\n    [navigate]\n  );\n\n  // T061: Handler to close detail drawer (remove id from URL)\n  const handleDetailDrawerClose = useCallback(\n    (open: boolean) => {\n      if (!open) {\n        navigate({\n          search: (prev) => ({\n            ...prev,\n            id: undefined,\n          }),\n          replace: true,\n        });\n      }\n    },\n    [navigate]\n  );\n\n  // Determine view mode: dashboard (default) or list (when dossier context)\n  const showDashboard = searchParams.view === 'dashboard' && !searchParams.dossierId;\n\n  // If showing dashboard, render personal commitments view with detail drawer\n  if (showDashboard) {\n    return (\n      <>\n        <PersonalCommitmentsDashboard />\n        {/* Detail Drawer - opens when id is in URL */}\n        <CommitmentDetailDrawer\n          commitmentId={searchParams.id ?? null}\n          open={!!searchParams.id}\n          onOpenChange={handleDetailDrawerClose}\n        />\n      </>\n    );\n  }\n\n  // List view with optional dossier context\n  return (\n    <div\n      className=\"min-h-screen bg-gray-50 dark:bg-gray-900\"\n      dir={isRTL ? 'rtl' : 'ltr'}\n    >\n      {/* Page Header */}\n      <div className=\"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 sm:py-6\">\n          <div className=\"flex flex-col sm:flex-row sm:items-center gap-4\">\n            {/* Navigation */}\n            <div className=\"flex items-center gap-2\">\n              {searchParams.dossierId ? (\n                <Button\n                  variant=\"ghost\"\n                  size=\"sm\"\n                  className=\"min-h-11\"\n                  onClick={() => {\n                    // Navigate to type-specific dossier route\n                    const routeSegment = dossier?.type\n                      ? DOSSIER_TYPE_TO_ROUTE[dossier.type] || 'countries'\n                      : 'countries';\n                    navigate({\n                      to: `/dossiers/${routeSegment}/$id`,\n                      params: { id: searchParams.dossierId! },\n                    });\n                  }}\n                >\n                  <ArrowLeft\n                    className={`size-4 ${isRTL ? 'ms-2 rotate-180' : 'me-2'}`}\n                  />\n                  {t('detail.dossier')}\n                </Button>\n              ) : (\n                <Link to=\"/commitments\" search={{ view: 'dashboard' }}>\n                  <Button variant=\"ghost\" size=\"sm\" className=\"min-h-11\">\n                    <Home className={`size-4 ${isRTL ? 'ms-2' : 'me-2'}`} />\n                    {t('pageTitle')}\n                  </Button>\n                </Link>\n              )}\n            </div>\n\n            {/* Title */}\n            <div className=\"flex-1\">\n              <h1 className=\"text-2xl sm:text-3xl font-bold text-foreground text-start\">\n                {t('title')}\n              </h1>\n              {searchParams.dossierId && (\n                <p className=\"mt-1 text-sm text-muted-foreground text-start\">\n                  {t('subtitle')}\n                </p>\n              )}\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Main Content */}\n      <main className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6 sm:py-8\">\n        <CommitmentsList\n          dossierId={searchParams.dossierId}\n          status={statusArray}\n          priority={priorityArray}\n          ownerId={searchParams.ownerId}\n          overdue={searchParams.overdue}\n          dueDateFrom={searchParams.dueDateFrom}\n          dueDateTo={searchParams.dueDateTo}\n          showFilters={true}\n          showCreateButton={!!searchParams.dossierId}\n          onFiltersChange={handleFiltersChange}\n        />\n      </main>\n\n      {/* T061: Detail Drawer - opens when id is in URL */}\n      <CommitmentDetailDrawer\n        commitmentId={searchParams.id ?? null}\n        open={!!searchParams.id}\n        onOpenChange={handleDetailDrawerClose}\n      />\n    </div>\n  );\n}\n"],"names":["statusIcons","jsx","Clock","ArrowRight","CheckCircle","XCircle","AlertTriangle","StatusDropdown","commitmentId","currentStatus","disabled","compact","t","i18n","useTranslation","isRTL","updateStatusMutation","useUpdateCommitmentStatus","STATUS_COLORS","jsxs","Badge","statusColors","availableTransitions","VALID_STATUS_TRANSITIONS","status","isDisabled","handleStatusChange","newStatus","isValidStatusTransition","DropdownMenu","DropdownMenuTrigger","Button","e","Loader2","ChevronDown","DropdownMenuContent","colors","DropdownMenuItem","fileTypeIcons","FileText","Image","File","fileTypeNames","EvidenceUpload","onSuccess","onCancel","fileInputRef","useRef","cameraInputRef","selectedFile","setSelectedFile","useState","uploadProgress","setUploadProgress","validationError","setValidationError","isDragging","setIsDragging","uploadMutation","useUploadEvidence","validateFile","useCallback","file","ALLOWED_EVIDENCE_TYPES","MAX_EVIDENCE_SIZE","handleFileSelect","handleInputChange","handleDragEnter","handleDragLeave","handleDragOver","handleDrop","handleUpload","progressInterval","prev","handleClearFile","formatFileSize","bytes","hasCamera","isMobile","Alert","AlertCircle","AlertDescription","Fragment","Upload","Camera","X","Progress","CommitmentCard","commitment","onEdit","onStatusChange","showDossierContext","navigate","useNavigate","showCancelDialog","setShowCancelDialog","cancelReason","setCancelReason","showUploadDialog","setShowUploadDialog","isDownloading","setIsDownloading","cancelMutation","useCancelCommitment","handleDownloadEvidence","signedUrl","getEvidenceUrl","error","overdue","isCommitmentOverdue","daysUntilDue","getDaysUntilDue","formattedDate","priorityColors","PRIORITY_COLORS","getDueDateLabel","handleCancelConfirm","handleCardClick","Card","CardHeader","MoreVertical","Download","Edit","DropdownMenuSeparator","Trash2","CardContent","Calendar","AlertDialog","AlertDialogContent","AlertDialogHeader","AlertDialogTitle","AlertDialogDescription","Label","Textarea","AlertDialogFooter","AlertDialogCancel","AlertDialogAction","Dialog","DialogContent","DialogHeader","DialogTitle","commitmentFormSchema","z.object","z.string","z.date","z.enum","z.boolean","CommitmentForm","dossierId","afterActionId","isEditMode","createMutation","useCreateCommitment","updateMutation","useUpdateCommitment","isPending","defaultValues","form","useForm","zodResolver","watchOwnerType","onSubmit","values","updateInput","data","createInput","Form","FormField","field","FormItem","FormLabel","FormControl","Input","FormMessage","Popover","PopoverTrigger","cn","CalendarIcon","format","ar","enUS","PopoverContent","date","Select","SelectTrigger","SelectValue","SelectContent","SelectItem","FormDescription","Switch","STATUS_OPTIONS","PRIORITY_OPTIONS","OWNER_TYPE_OPTIONS","CommitmentFilterDrawer","open","onOpenChange","filters","onFiltersChange","onApply","onClear","localFilters","setLocalFilters","useEffect","handleStatusToggle","s","handlePriorityToggle","priority","currentPriority","newPriority","p","handleOwnerTypeChange","ownerType","handleOverdueToggle","checked","handleDateFromChange","handleDateToChange","handleApply","handleClear","Sheet","SheetContent","SheetHeader","SheetTitle","Checkbox","SheetFooter","FilterChips","onRemoveFilter","onClearAll","activeFilterCount","formatDate","dateStr","CommitmentsList","ownerId","dueDateFrom","dueDateTo","showFilters","showCreateButton","showCreateDialog","setShowCreateDialog","editingCommitment","setEditingCommitment","showFilterDrawer","setShowFilterDrawer","selectedCommitmentId","setSelectedCommitmentId","loadMoreRef","isLoading","isError","fetchNextPage","hasNextPage","isFetchingNextPage","useInfiniteCommitments","observer","entries","entry","currentRef","allCommitments","page","totalCount","handleEdit","handleFormSuccess","handleFiltersChange","newFilters","handleApplyFilters","handleClearFilters","clearedFilters","handleRemoveFilter","key","value","hasActiveFilters","_","i","Skeleton","isFiltered","Filter","Plus","SearchX","StatusTimeline","createdAt","createdBy","history","useCommitmentStatusHistory","formatDateTime","index","TimelineEntry","User","isFirst","isLast","newStatusColors","CommitmentDetailDrawer","isEditing","setIsEditing","useCommitment","dossier","useDossier","dossierDisplayName","handleOpenChange","newOpen","handleNavigateToDossier","routeSegment","Separator","ExternalLink","PersonalCommitmentsDashboard","userData","userLoading","useQuery","user","supabase","stats","activeCount","today","overdueCount","completedCount","activeStatuses","completedStatuses","CardDescription","CardTitle","Tabs","TabsList","TabsTrigger","TabsContent","DOSSIER_TYPE_TO_ROUTE","country","organization","person","engagement","forum","working_group","topic","CommitmentsPage","searchParams","Route","useSearch","language","undefined","enabled","statusArray","split","filter","Boolean","priorityArray","search","length","join","replace","handleDetailDrawerClose","id","view","type","to","params","ArrowLeft","Link","Home"],"mappings":"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"}