{"version":3,"file":"waiting-CwnWZNL1.js","sources":["../../src/hooks/use-waiting-queue-actions.ts","../../src/components/waiting-queue/ReminderButton.tsx","../../src/components/waiting-queue/BulkActionToolbar.tsx","../../src/components/waiting-queue/PriorityFilter.tsx","../../src/components/waiting-queue/AgingFilter.tsx","../../src/components/waiting-queue/TypeFilter.tsx","../../src/components/waiting-queue/AssigneeFilter.tsx","../../src/components/waiting-queue/FilterPanel.tsx","../../src/hooks/use-bulk-selection.ts","../../src/hooks/use-queue-filters.ts","../../src/pages/WaitingQueue.tsx","../../src/routes/_protected/my-work/waiting.tsx?tsr-split=component"],"sourcesContent":["import { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\nimport { supabase } from '@/lib/supabase';\nimport type { Assignment } from '@/components/waiting-queue/AssignmentDetailsModal';\n\n/**\n * Waiting Queue Actions Hooks\n * Feature: Waiting Queue Actions (023-specs-waiting-queue)\n * Purpose: TanStack Query hooks for managing waiting queue actions\n *\n * Hooks included:\n * - useAssignmentDetails (User Story 1)\n * - useReminderAction (User Story 2) - TODO\n * - useBulkReminderAction (User Story 3) - TODO\n * - useEscalationAction (User Story 4) - TODO\n * - useQueueFilters (User Story 5) - TODO\n */\n\n// ============================================================================\n// User Story 1: Quick Access to Assignment Details\n// ============================================================================\n\n/**\n * Fetch assignment details by ID\n * @param assignmentId - UUID of the assignment\n * @returns Query result with assignment data\n */\nexport function useAssignmentDetails(assignmentId: string | null) {\n  return useQuery({\n    queryKey: ['assignment', assignmentId],\n    queryFn: async (): Promise<Assignment> => {\n      if (!assignmentId) {\n        throw new Error('Assignment ID is required');\n      }\n\n      // Fetch assignment first\n      const { data, error } = await supabase\n        .from('assignments')\n        .select(`\n          id,\n          work_item_id,\n          work_item_type,\n          assignee_id,\n          status,\n          workflow_stage,\n          assigned_at,\n          priority,\n          last_reminder_sent_at,\n          created_at,\n          updated_at\n        `)\n        .eq('id', assignmentId)\n        .single();\n\n      if (error) {\n        console.error('Error fetching assignment details:', error);\n        throw new Error(`Failed to fetch assignment: ${error.message}`);\n      }\n\n      if (!data) {\n        throw new Error('Assignment not found');\n      }\n\n      // Fetch user email from auth metadata\n      // Note: In Supabase, we can get user email from auth.users using admin methods\n      // For now, we'll use the session user if it's the same as assignee\n      const { data: { user } } = await supabase.auth.getUser();\n      const assigneeEmail = user?.id === data.assignee_id ? user.email : undefined;\n\n      // Try to get user's full name from user_metadata if available\n      const assigneeName = user?.id === data.assignee_id ? user.user_metadata?.full_name : undefined;\n\n      // Fetch work item details based on type\n      let workItem = null;\n\n      if (data.work_item_type === 'task') {\n        // Fetch task details\n        const { data: task } = await supabase\n          .from('tasks')\n          .select('id, title, description, source, status')\n          .eq('id', data.work_item_id)\n          .single();\n\n        if (task) {\n          // Extract linked entity IDs from task source\n          const linkedEntities: any[] = [];\n\n          // Fetch linked dossiers\n          if (task.source?.dossier_ids && Array.isArray(task.source.dossier_ids)) {\n            const { data: dossiers } = await supabase\n              .from('dossiers')\n              .select('id, name_en, name_ar, status')\n              .in('id', task.source.dossier_ids);\n\n            if (dossiers) {\n              linkedEntities.push(...dossiers.map((d: any) => ({\n                type: 'dossier',\n                id: d.id,\n                name_en: d.name_en,\n                name_ar: d.name_ar,\n                status: d.status,\n              })));\n            }\n          }\n\n          // Fetch linked positions\n          if (task.source?.position_ids && Array.isArray(task.source.position_ids)) {\n            const { data: positions } = await supabase\n              .from('positions')\n              .select('id, title_en, title_ar, status')\n              .in('id', task.source.position_ids);\n\n            if (positions) {\n              linkedEntities.push(...positions.map((p: any) => ({\n                type: 'position',\n                id: p.id,\n                title_en: p.title_en,\n                title_ar: p.title_ar,\n                status: p.status,\n              })));\n            }\n          }\n\n          // Fetch linked tickets\n          if (task.source?.ticket_ids && Array.isArray(task.source.ticket_ids)) {\n            const { data: tickets } = await supabase\n              .from('intake_tickets')\n              .select('id, ticket_number, title, title_ar, status')\n              .in('id', task.source.ticket_ids);\n\n            if (tickets) {\n              linkedEntities.push(...tickets.map((t: any) => ({\n                type: 'ticket',\n                id: t.id,\n                ticket_number: t.ticket_number,\n                title_en: t.title,\n                title_ar: t.title_ar,\n                status: t.status,\n              })));\n            }\n          }\n\n          workItem = {\n            title_en: task.title,\n            title_ar: task.title, // Tasks use same title for both languages\n            description: task.description,\n            status: task.status,\n            source_type: task.source?.type,\n            linked_entities: linkedEntities,\n          };\n        }\n      } else if (data.work_item_type === 'dossier') {\n        const { data: dossier } = await supabase\n          .from('dossiers')\n          .select('id, name_en, name_ar, type, status')\n          .eq('id', data.work_item_id)\n          .single();\n\n        if (dossier) {\n          workItem = {\n            title_en: dossier.name_en,\n            title_ar: dossier.name_ar,\n            type: dossier.type,\n            status: dossier.status,\n          };\n        }\n      } else if (data.work_item_type === 'ticket') {\n        const { data: ticket } = await supabase\n          .from('intake_tickets')\n          .select('id, ticket_number, title, title_ar, status')\n          .eq('id', data.work_item_id)\n          .single();\n\n        if (ticket) {\n          workItem = {\n            title_en: ticket.title || ticket.ticket_number,\n            title_ar: ticket.title_ar || ticket.ticket_number,\n            ticket_number: ticket.ticket_number,\n            status: ticket.status,\n          };\n        }\n      } else if (data.work_item_type === 'position') {\n        const { data: position } = await supabase\n          .from('positions')\n          .select('id, title_en, title_ar, status')\n          .eq('id', data.work_item_id)\n          .single();\n\n        if (position) {\n          workItem = {\n            title_en: position.title_en,\n            title_ar: position.title_ar,\n            status: position.status,\n          };\n        }\n      }\n\n      // Calculate days waiting\n      const daysWaiting = Math.floor(\n        (Date.now() - new Date(data.assigned_at).getTime()) / (1000 * 60 * 60 * 24)\n      );\n\n      // Transform data to match Assignment interface\n      return {\n        id: data.id,\n        work_item_id: data.work_item_id,\n        work_item_type: data.work_item_type as Assignment['work_item_type'],\n        assignee_id: data.assignee_id,\n        assignee_name: assigneeName,\n        assignee_email: assigneeEmail,\n        status: data.status as Assignment['status'],\n        workflow_stage: data.workflow_stage as Assignment['workflow_stage'],\n        assigned_at: data.assigned_at,\n        priority: data.priority as Assignment['priority'],\n        last_reminder_sent_at: data.last_reminder_sent_at,\n        created_at: data.created_at,\n        updated_at: data.updated_at,\n        days_waiting: daysWaiting,\n        work_item: workItem,\n      };\n    },\n    enabled: !!assignmentId, // Only run query if assignmentId is provided\n    staleTime: 1000 * 60 * 5, // 5 minutes\n    gcTime: 1000 * 60 * 10, // 10 minutes (previously cacheTime)\n  });\n}\n\n// ============================================================================\n// User Story 2: Individual Follow-Up Reminders\n// ============================================================================\n\n/**\n * Type definitions for reminder actions\n */\nexport interface ReminderAPIError {\n  error: string;\n  message: string;\n  details?: {\n    hours_remaining?: number;\n  };\n  retry_after?: number;\n}\n\nexport interface SendReminderResponse {\n  success: boolean;\n  message: string;\n}\n\n/**\n * Send individual reminder to assignment owner\n * @param assignmentId - UUID of the assignment\n * @returns Mutation result\n */\nexport function useReminderAction() {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: async ({ assignmentId }: { assignmentId: string }): Promise<SendReminderResponse> => {\n      const supabaseUrl = import.meta.env.VITE_SUPABASE_URL;\n\n      // Get current session token\n      const { data: { session } } = await supabase.auth.getSession();\n      if (!session?.access_token) {\n        throw new Error('Unauthorized: No active session');\n      }\n\n      const response = await fetch(`${supabaseUrl}/functions/v1/waiting-queue-reminder/send`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${session.access_token}`,\n        },\n        body: JSON.stringify({\n          assignment_id: assignmentId,\n        }),\n      });\n\n      if (!response.ok) {\n        const error: ReminderAPIError = await response.json();\n        throw error;\n      }\n\n      return response.json();\n    },\n    // T090: Optimistic update - Update cache immediately before server response\n    onMutate: async ({ assignmentId }) => {\n      // Cancel any outgoing refetches to avoid overwriting optimistic update\n      await queryClient.cancelQueries({ queryKey: ['assignment', assignmentId] });\n\n      // Snapshot the previous value\n      const previousAssignment = queryClient.getQueryData(['assignment', assignmentId]);\n\n      // Optimistically update the cache\n      queryClient.setQueryData(['assignment', assignmentId], (old: any) => {\n        if (!old) return old;\n        return {\n          ...old,\n          last_reminder_sent_at: new Date().toISOString(),\n        };\n      });\n\n      // Return context with snapshot for rollback\n      return { previousAssignment };\n    },\n    onSuccess: (_data, variables) => {\n      // Invalidate assignment details to get actual server data\n      queryClient.invalidateQueries({\n        queryKey: ['assignment', variables.assignmentId],\n      });\n\n      // Invalidate assignments list\n      queryClient.invalidateQueries({\n        queryKey: ['assignments'],\n      });\n      queryClient.invalidateQueries({\n        queryKey: ['waiting-queue'],\n      });\n    },\n    onError: (error: ReminderAPIError, variables, context: any) => {\n      // Rollback optimistic update on error\n      if (context?.previousAssignment) {\n        queryClient.setQueryData(['assignment', variables.assignmentId], context.previousAssignment);\n      }\n      console.error('Failed to send reminder:', error.message, error.details);\n    },\n  });\n}\n\n// ============================================================================\n// User Story 3: Bulk Reminder Management\n// ============================================================================\n\n/**\n * Type definitions for bulk reminder actions\n */\nexport interface BulkReminderJob {\n  job_id: string;\n  status: 'queued' | 'processing' | 'completed' | 'failed';\n  total_items: number;\n  processed_items: number;\n  successful_items: number;\n  failed_items: number;\n  results?: Array<{\n    assignment_id: string;\n    success: boolean;\n    error?: string;\n    skipped?: boolean;\n    reason?: string;\n  }>;\n}\n\nexport interface SendBulkRemindersResponse {\n  job_id: string;\n  total_items: number;\n  message: string;\n}\n\n/**\n * Send bulk reminders to multiple assignments\n * @returns Mutation and query for bulk reminders with job status polling\n */\nexport function useBulkReminderAction() {\n  const queryClient = useQueryClient();\n\n  const sendBulkMutation = useMutation({\n    mutationFn: async ({ assignmentIds }: { assignmentIds: string[] }): Promise<SendBulkRemindersResponse> => {\n      if (assignmentIds.length === 0) {\n        throw new Error('No assignments selected');\n      }\n\n      if (assignmentIds.length > 100) {\n        throw new Error('Maximum 100 assignments can be selected for bulk action');\n      }\n\n      const supabaseUrl = import.meta.env.VITE_SUPABASE_URL;\n\n      // Get current session token\n      const { data: { session } } = await supabase.auth.getSession();\n      if (!session?.access_token) {\n        throw new Error('Unauthorized: No active session');\n      }\n\n      const response = await fetch(`${supabaseUrl}/functions/v1/waiting-queue-reminder/send-bulk`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${session.access_token}`,\n        },\n        body: JSON.stringify({\n          assignment_ids: assignmentIds,\n        }),\n      });\n\n      if (!response.ok) {\n        const error: ReminderAPIError = await response.json();\n        throw error;\n      }\n\n      return response.json();\n    },\n    onSuccess: () => {\n      // Invalidate assignments list after bulk operation\n      queryClient.invalidateQueries({\n        queryKey: ['assignments'],\n      });\n    },\n    onError: (error: ReminderAPIError) => {\n      console.error('Failed to send bulk reminders:', error.message, error.details);\n    },\n  });\n\n  return {\n    sendBulk: sendBulkMutation,\n  };\n}\n\n/**\n * Poll bulk reminder job status\n * @param jobId - Job ID returned from bulk reminder creation\n * @param enabled - Whether to enable polling\n * @returns Query result with job status\n */\nexport function useBulkReminderJobStatus(jobId: string | null, enabled = true) {\n  return useQuery({\n    queryKey: ['bulk-reminder-job', jobId],\n    queryFn: async (): Promise<BulkReminderJob> => {\n      if (!jobId) {\n        throw new Error('Job ID is required');\n      }\n\n      const supabaseUrl = import.meta.env.VITE_SUPABASE_URL;\n\n      // Get current session token\n      const { data: { session } } = await supabase.auth.getSession();\n      if (!session?.access_token) {\n        throw new Error('Unauthorized: No active session');\n      }\n\n      const response = await fetch(`${supabaseUrl}/functions/v1/waiting-queue-reminder/status/${jobId}`, {\n        method: 'GET',\n        headers: {\n          'Authorization': `Bearer ${session.access_token}`,\n        },\n      });\n\n      if (!response.ok) {\n        const error: ReminderAPIError = await response.json();\n        throw error;\n      }\n\n      return response.json();\n    },\n    enabled: !!jobId && enabled,\n    refetchInterval: (query) => {\n      const data = query.state.data;\n      // Stop polling when job is completed or failed\n      if (!data || data.status === 'completed' || data.status === 'failed') {\n        return false;\n      }\n      // Poll every 2 seconds while processing\n      return 2000;\n    },\n    staleTime: 0, // Always fetch fresh data\n  });\n}\n\n// ============================================================================\n// User Story 4: Assignment Escalation\n// ============================================================================\n\n/**\n * Type definitions for escalation actions\n */\nexport interface EscalateAssignmentRequest {\n  assignmentId: string;\n  reason?: string;\n}\n\nexport interface EscalateAssignmentResponse {\n  escalation_id: string;\n  escalated_to_id: string;\n  escalated_to_name: string;\n  message: string;\n}\n\nexport interface EscalationAPIError {\n  error: string;\n  message?: string;\n}\n\n/**\n * Escalate an assignment to higher management\n * @returns Mutation result\n */\nexport function useEscalationAction() {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: async ({ assignmentId, reason }: EscalateAssignmentRequest): Promise<EscalateAssignmentResponse> => {\n      const supabaseUrl = import.meta.env.VITE_SUPABASE_URL;\n\n      // Get current session token\n      const { data: { session } } = await supabase.auth.getSession();\n      if (!session?.access_token) {\n        throw new Error('Unauthorized: No active session');\n      }\n\n      const response = await fetch(`${supabaseUrl}/functions/v1/waiting-queue-escalation/escalate`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${session.access_token}`,\n        },\n        body: JSON.stringify({\n          assignment_id: assignmentId,\n          reason,\n        }),\n      });\n\n      if (!response.ok) {\n        const error: EscalationAPIError = await response.json();\n\n        // Handle special error cases\n        if (error.error === 'NO_ESCALATION_PATH') {\n          throw new Error('No escalation path configured for this assignment');\n        }\n\n        if (error.error === 'CANNOT_ESCALATE_COMPLETED') {\n          throw new Error('Cannot escalate a completed assignment');\n        }\n\n        throw new Error(error.message || error.error || 'Failed to escalate assignment');\n      }\n\n      return response.json();\n    },\n    onSuccess: (_data, variables) => {\n      // Invalidate assignment details to refresh escalation status\n      queryClient.invalidateQueries({\n        queryKey: ['assignment', variables.assignmentId],\n      });\n\n      // Invalidate assignments list\n      queryClient.invalidateQueries({\n        queryKey: ['assignments'],\n      });\n    },\n    onError: (error: Error) => {\n      console.error('Failed to escalate assignment:', error.message);\n    },\n  });\n}\n\n/**\n * Acknowledge an escalation (for recipients)\n * @returns Mutation result\n */\nexport function useAcknowledgeEscalation() {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: async ({ escalationId, notes }: { escalationId: string; notes?: string }) => {\n      const supabaseUrl = import.meta.env.VITE_SUPABASE_URL;\n\n      // Get current session token\n      const { data: { session } } = await supabase.auth.getSession();\n      if (!session?.access_token) {\n        throw new Error('Unauthorized: No active session');\n      }\n\n      const response = await fetch(`${supabaseUrl}/functions/v1/waiting-queue-escalation/${escalationId}/acknowledge`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${session.access_token}`,\n        },\n        body: JSON.stringify({ notes }),\n      });\n\n      if (!response.ok) {\n        const error: EscalationAPIError = await response.json();\n        throw new Error(error.message || error.error || 'Failed to acknowledge escalation');\n      }\n\n      return response.json();\n    },\n    onSuccess: () => {\n      // Invalidate escalations list\n      queryClient.invalidateQueries({\n        queryKey: ['escalations'],\n      });\n    },\n  });\n}\n\n/**\n * Resolve an escalation (for recipients)\n * @returns Mutation result\n */\nexport function useResolveEscalation() {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: async ({ escalationId, resolution }: { escalationId: string; resolution: string }) => {\n      const supabaseUrl = import.meta.env.VITE_SUPABASE_URL;\n\n      // Get current session token\n      const { data: { session } } = await supabase.auth.getSession();\n      if (!session?.access_token) {\n        throw new Error('Unauthorized: No active session');\n      }\n\n      const response = await fetch(`${supabaseUrl}/functions/v1/waiting-queue-escalation/${escalationId}/resolve`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${session.access_token}`,\n        },\n        body: JSON.stringify({ resolution }),\n      });\n\n      if (!response.ok) {\n        const error: EscalationAPIError = await response.json();\n        throw new Error(error.message || error.error || 'Failed to resolve escalation');\n      }\n\n      return response.json();\n    },\n    onSuccess: () => {\n      // Invalidate escalations list\n      queryClient.invalidateQueries({\n        queryKey: ['escalations'],\n      });\n    },\n  });\n}\n\n// ============================================================================\n// User Story 5: Advanced Queue Filtering\n// ============================================================================\n\n// TODO: Implement useQueueFilters hook\n","import { useState } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Button } from '@/components/ui/button';\nimport { Bell, Loader2, CheckCircle2 } from 'lucide-react';\nimport { useReminderAction } from '@/hooks/use-waiting-queue-actions';\nimport { useToast } from '@/hooks/use-toast';\n\n/**\n * Reminder Button Component\n * Feature: Waiting Queue Actions (User Story 2)\n * Purpose: Send individual follow-up reminders to assignment owners\n *\n * Features:\n * - Send reminder with cooldown enforcement (24h default)\n * - Loading state during API call\n * - Success/error feedback via toasts\n * - Mobile-first responsive design\n * - RTL support\n * - Touch-friendly (min 44x44px)\n *\n * Requirements (from spec):\n * FR-003: Send follow-up reminder to assignment owner\n * FR-004: Display cooldown error if sent within 24h\n * FR-005: Update last_reminder_sent_at timestamp\n * FR-006: Prevent reminder if no assignee\n * FR-022: Rate limiting (100 per 5 min)\n * FR-032: Visual feedback (loading spinner, success/error)\n */\n\ninterface ReminderButtonProps {\n assignmentId: string;\n assigneeId?: string | null;\n lastReminderSentAt?: string | null;\n workItemId?: string;\n disabled?: boolean;\n variant?: 'default' | 'outline' | 'ghost';\n size?: 'default' | 'sm' | 'lg' | 'icon';\n className?: string;\n}\n\nexport function ReminderButton({\n assignmentId,\n assigneeId,\n lastReminderSentAt,\n workItemId,\n disabled = false,\n variant = 'outline',\n size = 'default',\n className = '',\n}: ReminderButtonProps) {\n const { t, i18n } = useTranslation();\n const { toast } = useToast();\n const { mutate: sendReminder, isPending } = useReminderAction();\n const [showSuccess, setShowSuccess] = useState(false);\n const isRTL = i18n.language === 'ar';\n\n // Calculate if cooldown is active\n const isCooldownActive = () => {\n if (!lastReminderSentAt) return false;\n\n const lastSent = new Date(lastReminderSentAt);\n const now = new Date();\n const hoursSince = (now.getTime() - lastSent.getTime()) / 1000 / 60 / 60;\n const cooldownHours = 24; // Should match backend REMINDER_COOLDOWN_HOURS\n\n return hoursSince < cooldownHours;\n };\n\n const getHoursRemaining = () => {\n if (!lastReminderSentAt) return 0;\n\n const lastSent = new Date(lastReminderSentAt);\n const now = new Date();\n const hoursSince = (now.getTime() - lastSent.getTime()) / 1000 / 60 / 60;\n const cooldownHours = 24;\n\n return Math.ceil(cooldownHours - hoursSince);\n };\n\n const handleSendReminder = () => {\n // Validate assignee exists\n if (!assigneeId) {\n toast({\n variant: 'destructive',\n title: t('waitingQueue.reminder.noAssignee.title', 'No Assignee'),\n description: t(\n 'waitingQueue.reminder.noAssignee.description',\n 'This assignment has no assignee. Please assign it first.'\n ),\n });\n return;\n }\n\n // Check cooldown locally before API call\n if (isCooldownActive()) {\n const hoursRemaining = getHoursRemaining();\n toast({\n variant: 'destructive',\n title: t('waitingQueue.reminder.cooldown.title', 'Cooldown Active'),\n description: t(\n 'waitingQueue.reminder.cooldown.description',\n `Please wait {{hours}} more hours before sending another reminder.`,\n { hours: hoursRemaining }\n ),\n });\n return;\n }\n\n // Send reminder\n sendReminder(\n { assignmentId },\n {\n onSuccess: () => {\n setShowSuccess(true);\n toast({\n title: t('waitingQueue.reminder.success.title', 'Reminder Sent'),\n description: t(\n 'waitingQueue.reminder.success.description',\n 'Follow-up reminder has been sent successfully.'\n ),\n variant: 'default',\n });\n\n // Reset success icon after 2 seconds\n setTimeout(() => setShowSuccess(false), 2000);\n },\n onError: (error: any) => {\n let title = t('waitingQueue.reminder.error.title', 'Failed to Send Reminder');\n let description = t(\n 'waitingQueue.reminder.error.description',\n 'An error occurred while sending the reminder. Please try again.'\n );\n\n // Handle specific error codes\n if (error?.error === 'COOLDOWN_ACTIVE') {\n const hoursRemaining = error?.details?.hours_remaining || 24;\n title = t('waitingQueue.reminder.cooldown.title', 'Cooldown Active');\n description = t(\n 'waitingQueue.reminder.cooldown.description',\n `Please wait {{hours}} more hours before sending another reminder.`,\n { hours: hoursRemaining }\n );\n } else if (error?.error === 'RATE_LIMIT_EXCEEDED') {\n title = t('waitingQueue.reminder.rateLimit.title', 'Rate Limit Exceeded');\n description = t(\n 'waitingQueue.reminder.rateLimit.description',\n 'You have sent too many reminders. Please wait a few minutes and try again.'\n );\n } else if (error?.error === 'NO_ASSIGNEE') {\n title = t('waitingQueue.reminder.noAssignee.title', 'No Assignee');\n description = t(\n 'waitingQueue.reminder.noAssignee.description',\n 'This assignment has no assignee. Please assign it first.'\n );\n } else if (error?.error === 'ASSIGNMENT_NOT_FOUND') {\n title = t('waitingQueue.reminder.notFound.title', 'Assignment Not Found');\n description = t(\n 'waitingQueue.reminder.notFound.description',\n 'The assignment could not be found. It may have been deleted.'\n );\n } else if (error?.error === 'VERSION_CONFLICT') {\n title = t('waitingQueue.reminder.conflict.title', 'Assignment Changed');\n description = t(\n 'waitingQueue.reminder.conflict.description',\n 'This assignment was modified by another user. Please refresh and try again.'\n );\n }\n\n toast({\n variant: 'destructive',\n title,\n description,\n });\n },\n }\n );\n };\n\n const cooldownActive = isCooldownActive();\n const isDisabled = disabled || isPending || cooldownActive || !assigneeId;\n\n return (\n <Button\n variant={variant}\n size={size}\n onClick={handleSendReminder}\n disabled={isDisabled}\n className={`min-h-11 min-w-11 gap-2 ${className}`}\n data-testid=\"reminder-button\"\n aria-label={t('waitingQueue.reminder.button.label', 'Send follow-up reminder')}\n >\n {isPending ? (\n <>\n <Loader2 className={`h-4 w-4 animate-spin ${isRTL ? '' : ''}`} />\n <span className=\"hidden sm:inline\">\n {t('waitingQueue.reminder.button.sending', 'Sending...')}\n </span>\n </>\n ) : showSuccess ? (\n <>\n <CheckCircle2 className=\"h-4 w-4 text-green-600\" />\n <span className=\"hidden sm:inline text-green-600\">\n {t('waitingQueue.reminder.button.sent', 'Sent!')}\n </span>\n </>\n ) : (\n <>\n <Bell className=\"h-4 w-4\" />\n <span className=\"hidden sm:inline\">\n {t('waitingQueue.reminder.button.send', 'Send Reminder')}\n </span>\n </>\n )}\n </Button>\n );\n}\n","import { useTranslation } from 'react-i18next';\nimport { Button } from '@/components/ui/button';\nimport { X } from 'lucide-react';\n\nexport interface BulkActionToolbarProps {\n selectedCount: number;\n onSendReminders: () => void;\n onClearSelection: () => void;\n isProcessing?: boolean;\n}\n\n/**\n * BulkActionToolbar - Displays bulk action controls when items are selected\n *\n * Features:\n * - Shows selection count\n * - \"Send Reminders\" button for bulk operations\n * - \"Clear Selection\" button\n * - Mobile-first responsive design\n * - RTL support via logical properties\n * - Touch-friendly controls (44x44px minimum)\n *\n * @param selectedCount - Number of items currently selected\n * @param onSendReminders - Callback when \"Send Reminders\" is clicked\n * @param onClearSelection - Callback when \"Clear Selection\" is clicked\n * @param isProcessing - Whether bulk operation is in progress\n */\nexport function BulkActionToolbar({\n selectedCount,\n onSendReminders,\n onClearSelection,\n isProcessing = false,\n}: BulkActionToolbarProps) {\n const { t, i18n } = useTranslation();\n const isRTL = i18n.language === 'ar';\n\n if (selectedCount === 0) {\n return null;\n }\n\n return (\n <div\n className=\"sticky top-0 z-10 flex flex-col gap-2 p-4 bg-blue-50 border-b border-blue-200 dark:bg-blue-950 dark:border-blue-800 sm:flex-row sm:items-center sm:justify-between sm:gap-4\"\n dir={isRTL ? 'rtl' : 'ltr'}\n role=\"toolbar\"\n aria-label={t('waitingQueue.bulkActions.toolbar')}\n >\n {/* Selection Count */}\n <div className=\"flex items-center gap-2\">\n <span className=\"text-sm font-medium text-blue-900 dark:text-blue-100 sm:text-base\">\n {t('waitingQueue.bulkActions.selectedCount', { count: selectedCount })}\n </span>\n <span className=\"text-xs text-blue-700 dark:text-blue-300 sm:text-sm\">\n {t('waitingQueue.bulkActions.maxItems', { max: 100 })}\n </span>\n </div>\n\n {/* Action Buttons */}\n <div className=\"flex gap-2 sm:gap-3\">\n <Button\n onClick={onSendReminders}\n disabled={isProcessing}\n className=\"flex-1 h-11 px-4 text-sm sm:flex-initial sm:px-6 sm:text-base\"\n aria-label={t('waitingQueue.bulkActions.sendReminders')}\n >\n {isProcessing\n ? t('waitingQueue.bulkActions.sending')\n : t('waitingQueue.bulkActions.sendReminders')}\n </Button>\n\n <Button\n onClick={onClearSelection}\n variant=\"outline\"\n disabled={isProcessing}\n className=\"h-11 px-3 sm:px-4\"\n aria-label={t('waitingQueue.bulkActions.clearSelection')}\n >\n <X className={`h-4 w-4 ${isRTL ? 'rotate-180' : ''}`} />\n <span className=\"hidden sm:inline ms-2\">\n {t('waitingQueue.bulkActions.clear')}\n </span>\n </Button>\n </div>\n\n {/* Warning for max items */}\n {selectedCount >= 100 && (\n <div className=\"text-xs text-orange-600 dark:text-orange-400 sm:text-sm\">\n {t('waitingQueue.bulkActions.maxReached')}\n </div>\n )}\n </div>\n );\n}\n","/**\n * PriorityFilter Component\n *\n * Compact multi-select filter for assignment priority with RTL support\n * Task: T083 [P] [US5]\n */\n\nimport { useTranslation } from 'react-i18next';\nimport { Checkbox } from '@/components/ui/checkbox';\nimport { Label } from '@/components/ui/label';\n\ninterface PriorityFilterProps {\n value?: ('low' | 'medium' | 'high' | 'urgent')[];\n onChange: (value?: ('low' | 'medium' | 'high' | 'urgent')[]) => void;\n disabled?: boolean;\n}\n\ninterface Priority {\n value: 'low' | 'medium' | 'high' | 'urgent';\n label: string;\n dotColor: string;\n}\n\nconst priorities: Priority[] = [\n { value: 'low', label: 'Low', dotColor: 'bg-gray-500' },\n { value: 'medium', label: 'Medium', dotColor: 'bg-blue-500' },\n { value: 'high', label: 'High', dotColor: 'bg-orange-500' },\n { value: 'urgent', label: 'Urgent', dotColor: 'bg-red-500' }\n];\n\nexport function PriorityFilter({ value = [], onChange, disabled = false }: PriorityFilterProps) {\n const { t, i18n } = useTranslation();\n const isRTL = i18n.language === 'ar';\n\n const handleToggle = (priorityValue: 'low' | 'medium' | 'high' | 'urgent') => {\n const newValue = value.includes(priorityValue)\n ? value.filter(v => v !== priorityValue)\n : [...value, priorityValue];\n onChange(newValue.length > 0 ? newValue : undefined);\n };\n\n return (\n <div className=\"space-y-1.5\" role=\"group\" aria-labelledby=\"priority-filter-label\">\n {priorities.map((priority) => (\n <div\n key={priority.value}\n className=\"flex items-center gap-2 rounded-sm hover:bg-accent/50 transition-colors px-1 py-1\"\n dir={isRTL ? 'rtl' : 'ltr'}\n >\n <Checkbox\n id={`priority-${priority.value}`}\n checked={value.includes(priority.value)}\n onCheckedChange={() => handleToggle(priority.value)}\n disabled={disabled}\n className=\"h-4 w-4\"\n />\n <Label\n htmlFor={`priority-${priority.value}`}\n className=\"flex-1 cursor-pointer text-start text-xs\"\n >\n {t(`waitingQueue.filters.priorities.${priority.value}`)}\n </Label>\n </div>\n ))}\n </div>\n );\n}\n","/**\n * AgingFilter Component\n *\n * Compact multi-select filter for assignment aging with RTL support\n * Task: T083 [P] [US5]\n */\n\nimport { useTranslation } from 'react-i18next';\nimport { Checkbox } from '@/components/ui/checkbox';\nimport { Label } from '@/components/ui/label';\n\ninterface AgingFilterProps {\n value?: ('0-2' | '3-6' | '7+')[];\n onChange: (value?: ('0-2' | '3-6' | '7+')[]) => void;\n disabled?: boolean;\n}\n\ninterface AgingBucket {\n value: '0-2' | '3-6' | '7+';\n label: string;\n barColor: string;\n}\n\nconst agingBuckets: AgingBucket[] = [\n { value: '0-2', label: '0-2 days', barColor: 'bg-green-500' },\n { value: '3-6', label: '3-6 days', barColor: 'bg-yellow-500' },\n { value: '7+', label: '7+ days', barColor: 'bg-red-500' }\n];\n\nexport function AgingFilter({ value = [], onChange, disabled = false }: AgingFilterProps) {\n const { t, i18n } = useTranslation();\n const isRTL = i18n.language === 'ar';\n\n const handleToggle = (agingValue: '0-2' | '3-6' | '7+') => {\n const newValue = value.includes(agingValue)\n ? value.filter(v => v !== agingValue)\n : [...value, agingValue];\n onChange(newValue.length > 0 ? newValue : undefined);\n };\n\n return (\n <div className=\"space-y-1.5\" role=\"group\" aria-labelledby=\"aging-filter-label\">\n {agingBuckets.map((bucket) => (\n <div\n key={bucket.value}\n className=\"flex items-center gap-2 rounded-sm hover:bg-accent/50 transition-colors px-1 py-1\"\n dir={isRTL ? 'rtl' : 'ltr'}\n >\n <Checkbox\n id={`aging-${bucket.value}`}\n checked={value.includes(bucket.value)}\n onCheckedChange={() => handleToggle(bucket.value)}\n disabled={disabled}\n className=\"h-4 w-4\"\n />\n <Label\n htmlFor={`aging-${bucket.value}`}\n className=\"flex-1 cursor-pointer text-start text-xs\"\n >\n {t(`waitingQueue.filters.agingBuckets.${bucket.value}.label`)}\n </Label>\n </div>\n ))}\n </div>\n );\n}\n","/**\n * TypeFilter Component\n *\n * Compact multi-select filter for work item type with RTL support\n * Task: T083 [P] [US5]\n */\n\nimport { useTranslation } from 'react-i18next';\nimport { Checkbox } from '@/components/ui/checkbox';\nimport { Label } from '@/components/ui/label';\nimport { Folder, Ticket, User, CheckSquare, LucideIcon } from 'lucide-react';\n\ninterface TypeFilterProps {\n value?: ('dossier' | 'ticket' | 'position' | 'task')[];\n onChange: (value?: ('dossier' | 'ticket' | 'position' | 'task')[]) => void;\n disabled?: boolean;\n}\n\ninterface WorkItemType {\n value: 'dossier' | 'ticket' | 'position' | 'task';\n label: string;\n Icon: LucideIcon;\n color: string;\n}\n\nconst workItemTypes: WorkItemType[] = [\n { value: 'dossier', label: 'Dossier', Icon: Folder, color: 'text-blue-600' },\n { value: 'ticket', label: 'Ticket', Icon: Ticket, color: 'text-purple-600' },\n { value: 'position', label: 'Position', Icon: User, color: 'text-green-600' },\n { value: 'task', label: 'Task', Icon: CheckSquare, color: 'text-orange-600' }\n];\n\nexport function TypeFilter({ value = [], onChange, disabled = false }: TypeFilterProps) {\n const { t, i18n } = useTranslation();\n const isRTL = i18n.language === 'ar';\n\n const handleToggle = (typeValue: 'dossier' | 'ticket' | 'position' | 'task') => {\n const newValue = value.includes(typeValue)\n ? value.filter(v => v !== typeValue)\n : [...value, typeValue];\n onChange(newValue.length > 0 ? newValue : undefined);\n };\n\n return (\n <div className=\"space-y-1.5\" role=\"group\" aria-labelledby=\"type-filter-label\">\n {workItemTypes.map((type) => {\n const Icon = type.Icon;\n return (\n <div\n key={type.value}\n className=\"flex items-center gap-2 rounded-sm hover:bg-accent/50 transition-colors px-1 py-1\"\n dir={isRTL ? 'rtl' : 'ltr'}\n >\n <Checkbox\n id={`type-${type.value}`}\n checked={value.includes(type.value)}\n onCheckedChange={() => handleToggle(type.value)}\n disabled={disabled}\n className=\"h-4 w-4\"\n />\n <Label\n htmlFor={`type-${type.value}`}\n className=\"flex-1 cursor-pointer text-start text-xs\"\n >\n {t(`waitingQueue.filters.types.${type.value}`)}\n </Label>\n </div>\n );\n })}\n </div>\n );\n}\n","/**\n * AssigneeFilter Component\n *\n * Mobile-first filter for assignee with RTL support\n * Task: T083 [P] [US5]\n */\n\nimport { useTranslation } from 'react-i18next';\nimport { Checkbox } from '@/components/ui/checkbox';\nimport { Label } from '@/components/ui/label';\nimport { UserCircle } from 'lucide-react';\nimport { supabase } from '@/lib/supabase';\nimport { useQuery } from '@tanstack/react-query';\n\ninterface AssigneeFilterProps {\n value?: string;\n onChange: (value?: string) => void;\n disabled?: boolean;\n}\n\nexport function AssigneeFilter({ value, onChange, disabled = false }: AssigneeFilterProps) {\n const { t, i18n } = useTranslation();\n const isRTL = i18n.language === 'ar';\n\n // Get current user\n const { data: currentUser } = useQuery({\n queryKey: ['current-user'],\n queryFn: async () => {\n const { data: { user } } = await supabase.auth.getUser();\n return user;\n }\n });\n\n // Quick filter for \"My assignments\"\n const isMyAssignments = value === currentUser?.id;\n\n return (\n <div className=\"space-y-1.5\" role=\"group\" aria-labelledby=\"assignee-filter-label\">\n <div\n className=\"flex items-center gap-2 rounded-sm hover:bg-accent/50 transition-colors px-1 py-1\"\n dir={isRTL ? 'rtl' : 'ltr'}\n >\n <Checkbox\n id=\"assignee-me\"\n checked={isMyAssignments}\n onCheckedChange={(checked) => {\n onChange(checked ? currentUser?.id : undefined);\n }}\n disabled={disabled}\n className=\"h-4 w-4\"\n />\n <Label\n htmlFor=\"assignee-me\"\n className=\"flex-1 cursor-pointer text-start text-xs\"\n >\n {t('waitingQueue.filters.myAssignments')}\n </Label>\n </div>\n\n {/* Future enhancement: Add searchable user list */}\n {/* For now, just \"My assignments\" filter is sufficient */}\n </div>\n );\n}\n","/**\n * FilterPanel Component\n *\n * Popover-based filter panel with full RTL support\n * Attaches to the Filters button\n *\n * Task: T081 [P] [US5]\n */\n\nimport { useTranslation } from 'react-i18next';\nimport { Button } from '@/components/ui/button';\nimport { Popover, PopoverContent, PopoverTrigger } from '@/components/ui/popover';\nimport { Accordion, AccordionContent, AccordionItem, AccordionTrigger } from '@/components/ui/accordion';\nimport { ScrollArea } from '@/components/ui/scroll-area';\nimport { SlidersHorizontal, X } from 'lucide-react';\nimport { Separator } from '@/components/ui/separator';\nimport { PriorityFilter } from './PriorityFilter';\nimport { AgingFilter } from './AgingFilter';\nimport { TypeFilter } from './TypeFilter';\nimport { AssigneeFilter } from './AssigneeFilter';\nimport type { FilterCriteria } from '@/hooks/use-queue-filters';\n\ninterface FilterPanelProps {\n filters: FilterCriteria;\n onFiltersChange: (filters: FilterCriteria) => void;\n onClearFilters: () => void;\n isOpen: boolean;\n onOpenChange: (open: boolean) => void;\n resultCount?: number;\n isLoading?: boolean;\n isApplying?: boolean;\n hasFilters?: boolean;\n filterCount?: number;\n}\n\nexport default function FilterPanel({\n filters,\n onFiltersChange,\n onClearFilters,\n isOpen,\n onOpenChange,\n resultCount,\n isLoading = false,\n isApplying = false,\n hasFilters = false,\n filterCount = 0\n}: FilterPanelProps) {\n const { t, i18n } = useTranslation();\n const isRTL = i18n.language === 'ar';\n\n return (\n <Popover open={isOpen} onOpenChange={onOpenChange}>\n <PopoverTrigger asChild>\n <Button\n variant={hasFilters ? 'default' : 'outline'}\n size=\"sm\"\n className=\"h-9\"\n aria-label={t('waitingQueue.filters.openFilters')}\n >\n <SlidersHorizontal className=\"h-4 w-4 me-2\" />\n {hasFilters ? `${filterCount} ${t('waitingQueue.filters.active')}` : t('waitingQueue.filters.title')}\n </Button>\n </PopoverTrigger>\n <PopoverContent\n className=\"w-[240px] p-0\"\n align={isRTL ? 'end' : 'start'}\n side=\"bottom\"\n dir={isRTL ? 'rtl' : 'ltr'}\n >\n <div className=\"flex flex-col max-h-[520px]\">\n {/* Compact Header */}\n <div className=\"flex items-center justify-between px-3 py-2.5 border-b\">\n <div className=\"flex items-center gap-2\">\n <SlidersHorizontal className=\"h-4 w-4 text-muted-foreground\" />\n <h2 className=\"text-sm font-semibold\">{t('waitingQueue.filters.title')}</h2>\n {hasFilters && (\n <span className=\"text-xs text-muted-foreground\">({filterCount})</span>\n )}\n </div>\n {hasFilters && (\n <Button\n variant=\"ghost\"\n size=\"sm\"\n onClick={onClearFilters}\n disabled={isApplying}\n className=\"h-7 px-2 text-xs\"\n >\n <X className=\"h-3 w-3 me-1\" />\n {t('waitingQueue.filters.clearAll')}\n </Button>\n )}\n </div>\n\n {/* Result count */}\n {resultCount !== undefined && (\n <div className=\"px-3 py-2 bg-muted/50 text-xs text-muted-foreground\">\n {t('waitingQueue.filters.showingResults', { count: resultCount })}\n </div>\n )}\n\n {/* Filter sections with Accordion */}\n {isLoading ? (\n // Loading skeletons\n <div className=\"space-y-3 p-3\">\n {[1, 2, 3, 4].map((i) => (\n <div key={i} className=\"space-y-1.5\" data-testid=\"filter-skeleton\">\n <div className=\"h-4 w-16 bg-muted animate-pulse rounded\" />\n <div className=\"h-7 bg-muted animate-pulse rounded\" />\n </div>\n ))}\n </div>\n ) : (\n <ScrollArea className=\"flex-1\">\n <Accordion type=\"multiple\" defaultValue={[\"priority\", \"aging\", \"type\", \"assignee\"]} className=\"w-full\">\n <AccordionItem value=\"priority\" className=\"border-b-0\">\n <AccordionTrigger className=\"px-3 py-2 hover:no-underline hover:bg-accent/50\">\n <span className=\"text-xs font-medium\">{t('waitingQueue.filters.priority')}</span>\n </AccordionTrigger>\n <AccordionContent className=\"px-3 pb-3\">\n <PriorityFilter\n value={filters.priority}\n onChange={(value) => onFiltersChange({ ...filters, priority: value, page: 1 })}\n disabled={isApplying}\n />\n </AccordionContent>\n </AccordionItem>\n\n <Separator />\n\n <AccordionItem value=\"aging\" className=\"border-b-0\">\n <AccordionTrigger className=\"px-3 py-2 hover:no-underline hover:bg-accent/50\">\n <span className=\"text-xs font-medium\">{t('waitingQueue.filters.aging')}</span>\n </AccordionTrigger>\n <AccordionContent className=\"px-3 pb-3\">\n <AgingFilter\n value={filters.aging}\n onChange={(value) => onFiltersChange({ ...filters, aging: value, page: 1 })}\n disabled={isApplying}\n />\n </AccordionContent>\n </AccordionItem>\n\n <Separator />\n\n <AccordionItem value=\"type\" className=\"border-b-0\">\n <AccordionTrigger className=\"px-3 py-2 hover:no-underline hover:bg-accent/50\">\n <span className=\"text-xs font-medium\">{t('waitingQueue.filters.type')}</span>\n </AccordionTrigger>\n <AccordionContent className=\"px-3 pb-3\">\n <TypeFilter\n value={filters.type}\n onChange={(value) => onFiltersChange({ ...filters, type: value, page: 1 })}\n disabled={isApplying}\n />\n </AccordionContent>\n </AccordionItem>\n\n <Separator />\n\n <AccordionItem value=\"assignee\" className=\"border-b-0\">\n <AccordionTrigger className=\"px-3 py-2 hover:no-underline hover:bg-accent/50\">\n <span className=\"text-xs font-medium\">{t('waitingQueue.filters.assignee')}</span>\n </AccordionTrigger>\n <AccordionContent className=\"px-3 pb-3\">\n <AssigneeFilter\n value={filters.assignee}\n onChange={(value) => onFiltersChange({ ...filters, assignee: value, page: 1 })}\n disabled={isApplying}\n />\n </AccordionContent>\n </AccordionItem>\n </Accordion>\n </ScrollArea>\n )}\n </div>\n </PopoverContent>\n </Popover>\n );\n}\n","import { useState, useCallback, useMemo } from 'react';\n\nconst MAX_SELECTION = 100;\n\nexport interface UseBulkSelectionResult {\n  selectedIds: Set<string>;\n  selectedCount: number;\n  isSelected: (id: string) => boolean;\n  toggleSelection: (id: string) => void;\n  selectAll: (ids: string[]) => void;\n  clearSelection: () => void;\n  canSelectMore: boolean;\n  maxReached: boolean;\n}\n\n/**\n * useBulkSelection - Hook for managing bulk selection state\n *\n * Features:\n * - Maintains set of selected assignment IDs\n * - Enforces max 100 items constraint\n * - Provides selection helpers (toggle, selectAll, clear)\n * - Optimized with Set for O(1) lookups\n *\n * Constraints:\n * - Maximum 100 items can be selected (per C-001)\n * - Selection state persists within component lifecycle only\n *\n * @returns {UseBulkSelectionResult} Selection state and methods\n */\nexport function useBulkSelection(): UseBulkSelectionResult {\n  const [selectedIds, setSelectedIds] = useState<Set<string>>(new Set());\n\n  const selectedCount = selectedIds.size;\n  const canSelectMore = selectedCount < MAX_SELECTION;\n  const maxReached = selectedCount >= MAX_SELECTION;\n\n  /**\n   * Check if an item is currently selected\n   */\n  const isSelected = useCallback(\n    (id: string): boolean => {\n      return selectedIds.has(id);\n    },\n    [selectedIds]\n  );\n\n  /**\n   * Toggle selection state for a single item\n   * Prevents selection if max limit reached\n   */\n  const toggleSelection = useCallback(\n    (id: string) => {\n      setSelectedIds((prev) => {\n        const newSet = new Set(prev);\n\n        if (newSet.has(id)) {\n          // Remove if already selected\n          newSet.delete(id);\n        } else {\n          // Add only if under max limit\n          if (newSet.size < MAX_SELECTION) {\n            newSet.add(id);\n          } else {\n            // Show warning toast or notification in component\n            console.warn(\n              `Maximum selection limit (${MAX_SELECTION}) reached. Cannot select more items.`\n            );\n          }\n        }\n\n        return newSet;\n      });\n    },\n    []\n  );\n\n  /**\n   * Select all items from provided list\n   * Respects max limit by taking first MAX_SELECTION items\n   */\n  const selectAll = useCallback((ids: string[]) => {\n    setSelectedIds((prev) => {\n      // Take first MAX_SELECTION items\n      const itemsToSelect = ids.slice(0, MAX_SELECTION);\n      return new Set(itemsToSelect);\n    });\n  }, []);\n\n  /**\n   * Clear all selections\n   */\n  const clearSelection = useCallback(() => {\n    setSelectedIds(new Set());\n  }, []);\n\n  return useMemo(\n    () => ({\n      selectedIds,\n      selectedCount,\n      isSelected,\n      toggleSelection,\n      selectAll,\n      clearSelection,\n      canSelectMore,\n      maxReached,\n    }),\n    [\n      selectedIds,\n      selectedCount,\n      isSelected,\n      toggleSelection,\n      selectAll,\n      clearSelection,\n      canSelectMore,\n      maxReached,\n    ]\n  );\n}\n","/**\n * useQueueFilters Hook\n *\n * Manages filter state, persists to localStorage with 7-day expiration\n * Task: T082 [P] [US5]\n */\n\nimport { useState, useEffect, useCallback } from 'react';\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\nimport { supabase } from '@/lib/supabase';\n\nconst STORAGE_KEY = 'waiting-queue-filters';\nconst EXPIRATION_DAYS = 7;\n\nexport interface FilterCriteria {\n  priority?: ('low' | 'medium' | 'high' | 'urgent')[];\n  aging?: ('0-2' | '3-6' | '7+')[];\n  type?: ('dossier' | 'ticket' | 'position' | 'task')[];\n  assignee?: string;\n  status?: 'pending' | 'assigned';\n  sort_by?: 'assigned_at_asc' | 'assigned_at_desc' | 'priority_asc' | 'priority_desc';\n  page?: number;\n  page_size?: number;\n}\n\ninterface StoredFilters {\n  filters: FilterCriteria;\n  timestamp: number;\n}\n\n/**\n * Load filters from localStorage with expiration check\n */\nfunction loadFiltersFromStorage(): FilterCriteria {\n  try {\n    const stored = localStorage.getItem(STORAGE_KEY);\n    if (!stored) return {};\n\n    const parsed: StoredFilters = JSON.parse(stored);\n    const age = Date.now() - parsed.timestamp;\n    const maxAge = EXPIRATION_DAYS * 24 * 60 * 60 * 1000;\n\n    // Expire old filters\n    if (age > maxAge) {\n      localStorage.removeItem(STORAGE_KEY);\n      return {};\n    }\n\n    return parsed.filters;\n  } catch {\n    return {};\n  }\n}\n\n/**\n * Save filters to localStorage with timestamp\n */\nfunction saveFiltersToStorage(filters: FilterCriteria): void {\n  try {\n    const data: StoredFilters = {\n      filters,\n      timestamp: Date.now()\n    };\n    localStorage.setItem(STORAGE_KEY, JSON.stringify(data));\n  } catch (error) {\n    console.error('Failed to save filters to localStorage:', error);\n  }\n}\n\n/**\n * Main hook for managing queue filters\n */\nexport function useQueueFilters() {\n  const [filters, setFilters] = useState<FilterCriteria>(loadFiltersFromStorage);\n  const queryClient = useQueryClient();\n\n  // Sync filters to localStorage on change\n  useEffect(() => {\n    saveFiltersToStorage(filters);\n  }, [filters]);\n\n  /**\n   * Update specific filter\n   */\n  const updateFilter = useCallback((key: keyof FilterCriteria, value: any) => {\n    setFilters(prev => ({\n      ...prev,\n      [key]: value\n    }));\n  }, []);\n\n  /**\n   * Update multiple filters at once\n   */\n  const updateFilters = useCallback((newFilters: Partial<FilterCriteria>) => {\n    setFilters(prev => ({\n      ...prev,\n      ...newFilters\n    }));\n  }, []);\n\n  /**\n   * Clear all filters\n   */\n  const clearFilters = useCallback(() => {\n    setFilters({});\n    localStorage.removeItem(STORAGE_KEY);\n\n    // Invalidate queries to refetch without filters\n    queryClient.invalidateQueries({ queryKey: ['waiting-queue-assignments'] });\n  }, [queryClient]);\n\n  /**\n   * Reset to specific filters\n   */\n  const resetFilters = useCallback((newFilters: FilterCriteria) => {\n    setFilters(newFilters);\n  }, []);\n\n  /**\n   * Count active filters\n   */\n  const filterCount = Object.keys(filters).filter(\n    key => key !== 'page' && key !== 'page_size' && key !== 'sort_by' && filters[key as keyof FilterCriteria] !== undefined\n  ).length;\n\n  /**\n   * Check if any filters are active\n   */\n  const hasFilters = filterCount > 0;\n\n  return {\n    filters,\n    updateFilter,\n    updateFilters,\n    clearFilters,\n    resetFilters,\n    filterCount,\n    hasFilters\n  };\n}\n\n/**\n * Fetch filtered assignments from API\n */\nexport function useFilteredAssignments(filters: FilterCriteria) {\n  return useQuery({\n    queryKey: ['waiting-queue-assignments', filters],\n    queryFn: async () => {\n      const { data: { session } } = await supabase.auth.getSession();\n      if (!session) throw new Error('Not authenticated');\n\n      // Build query string - handle arrays\n      const params = new URLSearchParams();\n      Object.entries(filters).forEach(([key, value]) => {\n        if (value !== undefined && value !== null) {\n          if (Array.isArray(value)) {\n            // For arrays, add multiple params with the same key\n            value.forEach(v => params.append(key, String(v)));\n          } else {\n            params.append(key, String(value));\n          }\n        }\n      });\n\n      const response = await fetch(\n        `${import.meta.env.VITE_SUPABASE_URL}/functions/v1/waiting-queue-filters/assignments?${params}`,\n        {\n          headers: {\n            'Authorization': `Bearer ${session.access_token}`,\n            'Content-Type': 'application/json'\n          }\n        }\n      );\n\n      if (!response.ok) {\n        const error = await response.json();\n        throw new Error(error.error || 'Failed to fetch assignments');\n      }\n\n      return response.json();\n    },\n    staleTime: 5 * 60 * 1000, // 5 minutes\n    gcTime: 10 * 60 * 1000 // 10 minutes\n  });\n}\n\n/**\n * Load user filter preferences from backend\n */\nexport function useFilterPreferences() {\n  return useQuery({\n    queryKey: ['filter-preferences'],\n    queryFn: async () => {\n      const { data: { session } } = await supabase.auth.getSession();\n      if (!session) throw new Error('Not authenticated');\n\n      const response = await fetch(\n        `${import.meta.env.VITE_SUPABASE_URL}/functions/v1/waiting-queue-filters/preferences`,\n        {\n          headers: {\n            'Authorization': `Bearer ${session.access_token}`,\n            'Content-Type': 'application/json'\n          }\n        }\n      );\n\n      if (!response.ok) {\n        throw new Error('Failed to load preferences');\n      }\n\n      return response.json();\n    },\n    staleTime: Infinity // Preferences rarely change\n  });\n}\n\n/**\n * Save user filter preferences to backend\n */\nexport function useSaveFilterPreferences() {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: async (preferences: FilterCriteria) => {\n      const { data: { session } } = await supabase.auth.getSession();\n      if (!session) throw new Error('Not authenticated');\n\n      const response = await fetch(\n        `${import.meta.env.VITE_SUPABASE_URL}/functions/v1/waiting-queue-filters/preferences`,\n        {\n          method: 'POST',\n          headers: {\n            'Authorization': `Bearer ${session.access_token}`,\n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify({ preferences })\n        }\n      );\n\n      if (!response.ok) {\n        throw new Error('Failed to save preferences');\n      }\n\n      return response.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['filter-preferences'] });\n    }\n  });\n}\n","/**\n * Waiting Queue Page (FR-033)\n *\n * Work-Queue-First: Priority page for blocked/waiting items\n * Features:\n * - List of assignments waiting for dependencies\n * - Categorized by waiting reason (approval, response, capacity)\n * - Aging indicators\n * - Escalation actions\n * - Follow-up reminders\n *\n * Mobile-first responsive design with RTL support\n */\n\nimport { useState, useEffect, useRef } from 'react'\nimport { useTranslation } from 'react-i18next'\nimport { useQuery, useQueryClient } from '@tanstack/react-query'\nimport { useVirtualizer } from '@tanstack/react-virtual'\nimport { supabase } from '../lib/supabase'\nimport {\n  Clock,\n  AlertTriangle,\n  Mail,\n  UserCheck,\n  Zap,\n  Loader2,\n  SlidersHorizontal,\n  ArrowUpDown,\n} from 'lucide-react'\nimport { Button } from '../components/ui/button'\nimport { Badge } from '../components/ui/badge'\nimport { Card } from '../components/ui/card'\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '../components/ui/tabs'\nimport { Checkbox } from '../components/ui/checkbox'\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from '../components/ui/select'\nimport { SkeletonCard } from '../components/ui/skeleton'\nimport { ReminderButton } from '../components/waiting-queue/ReminderButton'\nimport { BulkActionToolbar } from '../components/waiting-queue/BulkActionToolbar'\nimport FilterPanel from '../components/waiting-queue/FilterPanel'\nimport { useBulkReminderAction, useBulkReminderJobStatus } from '../hooks/use-waiting-queue-actions'\nimport { useBulkSelection } from '../hooks/use-bulk-selection'\nimport { useQueueFilters, useFilteredAssignments } from '../hooks/use-queue-filters'\nimport { useToast } from '../hooks/use-toast'\nimport QueryErrorBoundary from '../components/QueryErrorBoundary'\n\ninterface LinkedEntity {\n  type: 'dossier' | 'position' | 'ticket'\n  id: string\n  name_en?: string\n  name_ar?: string\n  title_en?: string\n  title_ar?: string\n  ticket_number?: string\n  status?: string\n}\n\ninterface WorkItemDetails {\n  title_en: string\n  title_ar: string\n  description?: string\n  status?: string\n  source_type?: 'dossier' | 'position' | 'ticket'\n  linked_entities?: LinkedEntity[]\n  // Legacy fields (for backward compatibility)\n  ticket_number?: string\n  type?: string\n}\n\ninterface WaitingItem {\n  id: string\n  work_item_id: string\n  work_item_type: string\n  assignee_id: string | null\n  assignee_name: string\n  workflow_stage: string\n  assigned_at: string\n  priority: 'low' | 'medium' | 'high' | 'urgent'\n  status: string\n  last_reminder_sent_at: string | null\n  work_item: WorkItemDetails | null\n}\n\nfunction WaitingQueuePageInner() {\n  const { t, i18n } = useTranslation()\n  const isRTL = i18n.language === 'ar'\n  const { toast } = useToast()\n  const queryClient = useQueryClient()\n\n  const [activeTab, setActiveTab] = useState<string>('all')\n  const [bulkJobId, setBulkJobId] = useState<string | null>(null)\n  const [isFilterPanelOpen, setIsFilterPanelOpen] = useState(false)\n\n  // Ref for virtualization scroll container\n  const parentRef = useRef<HTMLDivElement>(null)\n\n  // Filter state management (T084-T088)\n  const { filters, updateFilters, clearFilters, filterCount, hasFilters } = useQueueFilters()\n\n  // Bulk selection state\n  const { selectedIds, selectedCount, isSelected, toggleSelection, clearSelection, maxReached } =\n    useBulkSelection()\n\n  // Bulk reminder action\n  const { sendBulk } = useBulkReminderAction()\n\n  // Poll bulk job status\n  const { data: bulkJobStatus, isLoading: isJobLoading } = useBulkReminderJobStatus(\n    bulkJobId,\n    !!bulkJobId,\n  )\n\n  const handleNavigateToTask = (workItemId: string) => {\n    // Navigate to task detail page\n    window.location.href = `/tasks/${workItemId}`\n  }\n\n  // Bulk action handlers\n  const handleSendBulkReminders = async () => {\n    const assignmentIds = Array.from(selectedIds)\n\n    // Filter out assignments with no assignee\n    const itemsWithAssignee =\n      filteredItems?.filter((item) => assignmentIds.includes(item.id) && item.assignee_id) || []\n\n    const skippedCount = assignmentIds.length - itemsWithAssignee.length\n\n    if (itemsWithAssignee.length === 0) {\n      toast({\n        variant: 'destructive',\n        title: t('waitingQueue.bulkActions.noAssignees'),\n        description: t('waitingQueue.bulkActions.noAssigneesDesc'),\n      })\n      return\n    }\n\n    try {\n      const response = await sendBulk.mutateAsync({\n        assignmentIds: itemsWithAssignee.map((item) => item.id),\n      })\n\n      setBulkJobId(response.job_id)\n\n      if (skippedCount > 0) {\n        toast({\n          title: t('waitingQueue.bulkActions.processing'),\n          description: t('waitingQueue.bulkActions.skippedSome', {\n            sent: itemsWithAssignee.length,\n            skipped: skippedCount,\n          }),\n        })\n      } else {\n        toast({\n          title: t('waitingQueue.bulkActions.processing'),\n          description: t('waitingQueue.bulkActions.jobCreated', {\n            count: itemsWithAssignee.length,\n          }),\n        })\n      }\n    } catch (error: any) {\n      toast({\n        variant: 'destructive',\n        title: t('waitingQueue.bulkActions.error'),\n        description: error.message || t('waitingQueue.bulkActions.errorDesc'),\n      })\n    }\n  }\n\n  const handleClearSelection = () => {\n    clearSelection()\n    toast({\n      title: t('waitingQueue.bulkActions.selectionCleared'),\n      description: t('waitingQueue.bulkActions.selectionClearedDesc'),\n    })\n  }\n\n  // Monitor bulk job completion\n  useEffect(() => {\n    if (!bulkJobStatus) return\n\n    if (bulkJobStatus.status === 'completed') {\n      clearSelection()\n      setBulkJobId(null)\n\n      const successCount = bulkJobStatus.successful_items\n      const failedCount = bulkJobStatus.failed_items\n\n      toast({\n        title: t('waitingQueue.bulkActions.completed'),\n        description: t('waitingQueue.bulkActions.summary', {\n          success: successCount,\n          failed: failedCount,\n          total: bulkJobStatus.total_items,\n        }),\n        variant: failedCount > 0 ? 'default' : 'default',\n      })\n    } else if (bulkJobStatus.status === 'failed') {\n      setBulkJobId(null)\n      toast({\n        variant: 'destructive',\n        title: t('waitingQueue.bulkActions.failed'),\n        description: t('waitingQueue.bulkActions.failedDesc'),\n      })\n    }\n  }, [bulkJobStatus, clearSelection, t, toast])\n\n  // Fetch filtered assignments (T085: Update assignment list query to use filters)\n  const { data: response, isLoading } = useFilteredAssignments(filters)\n\n  // Extract items and pagination from response\n  const items = response?.data || []\n  const pagination = response?.pagination\n\n  // T089: Supabase Realtime subscriptions for assignment status changes\n  useEffect(() => {\n    // Subscribe to changes on the assignments table\n    const channel = supabase\n      .channel('waiting-queue-changes')\n      .on(\n        'postgres_changes',\n        {\n          event: '*', // Listen to all events (INSERT, UPDATE, DELETE)\n          schema: 'public',\n          table: 'assignments',\n          filter: 'status=in.(pending,assigned,completed,cancelled)',\n        },\n        (payload) => {\n          // Handle different event types\n          if (payload.eventType === 'UPDATE') {\n            const updatedAssignment = payload.new as any\n\n            // If assignment was completed or cancelled, remove from queue\n            if (\n              updatedAssignment.status === 'completed' ||\n              updatedAssignment.status === 'cancelled'\n            ) {\n              // Deselect if selected for bulk action\n              if (isSelected(updatedAssignment.id)) {\n                toggleSelection(updatedAssignment.id)\n              }\n\n              // Show toast notification\n              toast({\n                title: t('waiting.assignmentUpdated'),\n                description: t('waiting.assignmentCompletedDesc', {\n                  id: updatedAssignment.work_item_id,\n                }),\n              })\n            }\n\n            // Invalidate and refetch query to update UI\n            queryClient.invalidateQueries({ queryKey: ['waiting-queue'] })\n          }\n\n          if (payload.eventType === 'INSERT') {\n            // New assignment added to queue\n            queryClient.invalidateQueries({ queryKey: ['waiting-queue'] })\n          }\n\n          if (payload.eventType === 'DELETE') {\n            // Assignment deleted\n            queryClient.invalidateQueries({ queryKey: ['waiting-queue'] })\n          }\n        },\n      )\n      .subscribe()\n\n    // Cleanup subscription on unmount\n    return () => {\n      supabase.removeChannel(channel)\n    }\n  }, [isSelected, toggleSelection, queryClient, t, toast])\n\n  const getAgingStatus = (assignedAt: string) => {\n    const now = new Date()\n    const since = new Date(assignedAt)\n    const daysInReview = Math.floor((now.getTime() - since.getTime()) / (1000 * 60 * 60 * 24))\n\n    if (daysInReview >= 7)\n      return { color: 'text-red-600', severity: 'critical', days: daysInReview }\n    if (daysInReview >= 3)\n      return { color: 'text-orange-600', severity: 'warning', days: daysInReview }\n    return { color: 'text-yellow-600', severity: 'normal', days: daysInReview }\n  }\n\n  const getTypeIcon = (type: string) => {\n    switch (type) {\n      case 'dossier':\n        return UserCheck\n      case 'ticket':\n        return Mail\n      case 'position':\n        return Zap\n      default:\n        return Clock\n    }\n  }\n\n  const getWorkItemTitle = (item: WaitingItem): string => {\n    if (!item.work_item) {\n      return item.work_item_id.substring(0, 8) + '...'\n    }\n\n    // Show task title (which already includes context like \"Review and process: Dossier Name\")\n    const title = isRTL ? item.work_item.title_ar : item.work_item.title_en\n    return title || item.work_item_id.substring(0, 8) + '...'\n  }\n\n  // Get linked entity names for display (e.g., \"Related to: Germany Trade Statistics Agreement\")\n  const getLinkedEntitiesText = (item: WaitingItem): string | null => {\n    if (!item.work_item?.linked_entities || item.work_item.linked_entities.length === 0) {\n      return null\n    }\n\n    const entities = item.work_item.linked_entities\n      .map((entity) => {\n        if (entity.type === 'dossier') {\n          return isRTL ? entity.name_ar : entity.name_en\n        } else if (entity.type === 'position') {\n          return isRTL ? entity.title_ar : entity.title_en\n        } else if (entity.type === 'ticket') {\n          return entity.ticket_number || (isRTL ? entity.title_ar : entity.title_en)\n        }\n        return null\n      })\n      .filter(Boolean)\n\n    if (entities.length === 0) return null\n\n    return t('waitingQueue.relatedTo', 'Related to: ') + entities.join(', ')\n  }\n\n  const filteredItems =\n    activeTab === 'all' ? items : items?.filter((item) => item.work_item_type === activeTab)\n\n  const groupedCounts =\n    items?.reduce(\n      (acc, item) => {\n        acc[item.work_item_type] = (acc[item.work_item_type] || 0) + 1\n        return acc\n      },\n      {} as Record<string, number>,\n    ) || {}\n\n  // T093: Performance optimization - Virtualize long lists (>100 items)\n  const shouldVirtualize = (filteredItems?.length || 0) > 100\n\n  // Setup virtualizer for long lists\n  const virtualizer = useVirtualizer({\n    count: filteredItems?.length || 0,\n    getScrollElement: () => parentRef.current,\n    estimateSize: () => 120, // Estimated row height in pixels\n    overscan: 5, // Render 5 extra items above/below visible area\n    enabled: shouldVirtualize, // Only enable when list is long\n  })\n\n  return (\n    <div className=\"min-h-screen bg-background\" dir={isRTL ? 'rtl' : 'ltr'}>\n      {/* Header */}\n      <div className=\"border-b border-border bg-card\">\n        <div className=\"container mx-auto p-4 sm:p-6 lg:px-8\">\n          <div className=\"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between\">\n            <div className=\"flex items-center gap-3\">\n              <div className=\"flex size-10 items-center justify-center rounded-lg bg-orange-500/10 sm:size-12\">\n                <Clock className=\"size-5 text-orange-600 sm:size-6\" />\n              </div>\n              <div>\n                <h1 className=\"text-xl font-bold text-foreground sm:text-2xl md:text-3xl\">\n                  {t('navigation.waitingQueue', 'Waiting Queue')}\n                </h1>\n                <p className=\"mt-1 text-sm text-muted-foreground\">\n                  {t('waiting.description', 'Items pending or assigned but not yet started')}\n                </p>\n              </div>\n            </div>\n            {/* T086: Filter button and count, T088: Sorting controls */}\n            <div className=\"flex items-center gap-2\">\n              {/* Sort selector (desktop) */}\n              <Select\n                value={filters.sort_by || 'assigned_at_desc'}\n                onValueChange={(value) => updateFilters({ sort_by: value as any })}\n              >\n                <SelectTrigger\n                  className=\"hidden min-h-9 w-[180px] sm:flex\"\n                  aria-label={t('waitingQueue.filters.sortBy')}\n                >\n                  <ArrowUpDown className=\"me-2 size-4\" />\n                  <SelectValue />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"assigned_at_desc\">\n                    {t('waitingQueue.filters.sort.oldestFirst')}\n                  </SelectItem>\n                  <SelectItem value=\"assigned_at_asc\">\n                    {t('waitingQueue.filters.sort.newestFirst')}\n                  </SelectItem>\n                  <SelectItem value=\"priority_desc\">\n                    {t('waitingQueue.filters.sort.highPriorityFirst')}\n                  </SelectItem>\n                  <SelectItem value=\"priority_asc\">\n                    {t('waitingQueue.filters.sort.lowPriorityFirst')}\n                  </SelectItem>\n                </SelectContent>\n              </Select>\n\n              {/* Filter button with popover (T084) */}\n              <FilterPanel\n                filters={filters}\n                onFiltersChange={updateFilters}\n                onClearFilters={clearFilters}\n                isOpen={isFilterPanelOpen}\n                onOpenChange={setIsFilterPanelOpen}\n                resultCount={pagination?.total_count}\n                isLoading={isLoading}\n                hasFilters={hasFilters}\n                filterCount={filterCount}\n              />\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Bulk Action Toolbar */}\n      <BulkActionToolbar\n        selectedCount={selectedCount}\n        onSendReminders={handleSendBulkReminders}\n        onClearSelection={handleClearSelection}\n        isProcessing={sendBulk.isPending || !!bulkJobId}\n      />\n\n      {/* Bulk Job Progress Indicator */}\n      {bulkJobId && bulkJobStatus && (\n        <div\n          className=\"border-b border-border bg-blue-50 dark:bg-blue-950\"\n          dir={isRTL ? 'rtl' : 'ltr'}\n        >\n          <div className=\"container mx-auto px-4 py-3 sm:px-6 lg:px-8\">\n            <div className=\"flex items-center gap-3\">\n              <Loader2 className=\"size-4 animate-spin text-blue-600\" />\n              <div className=\"flex-1\">\n                <p className=\"text-sm font-medium text-blue-900 dark:text-blue-100\">\n                  {t('waitingQueue.bulkActions.sending')}\n                </p>\n                <p className=\"text-xs text-blue-700 dark:text-blue-300\">\n                  {bulkJobStatus.processed_items} / {bulkJobStatus.total_items}{' '}\n                  {t('waitingQueue.bulkActions.completed')}\n                </p>\n              </div>\n              <div className=\"text-sm text-blue-900 dark:text-blue-100\">\n                {Math.round((bulkJobStatus.processed_items / bulkJobStatus.total_items) * 100)}%\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Main Content (T084) */}\n      <div className=\"container mx-auto px-4 py-6 sm:px-6 lg:px-8\">\n        <main className=\"w-full\">\n          <Tabs value={activeTab} onValueChange={setActiveTab} className=\"space-y-4\">\n            {/* Tabs Navigation */}\n            <TabsList className=\"grid h-auto w-full grid-cols-2 gap-1 p-1 sm:grid-cols-5\">\n              <TabsTrigger value=\"all\" className=\"min-h-9 text-xs sm:text-sm\">\n                {t('common.all', 'All')} ({items?.length || 0})\n              </TabsTrigger>\n              <TabsTrigger value=\"dossier\" className=\"min-h-9 text-xs sm:text-sm\">\n                {t('waiting.dossiers', 'Dossiers')} ({groupedCounts['dossier'] || 0})\n              </TabsTrigger>\n              <TabsTrigger value=\"ticket\" className=\"min-h-9 text-xs sm:text-sm\">\n                {t('waiting.tickets', 'Tickets')} ({groupedCounts['ticket'] || 0})\n              </TabsTrigger>\n              <TabsTrigger value=\"position\" className=\"min-h-9 text-xs sm:text-sm\">\n                {t('waiting.positions', 'Positions')} ({groupedCounts['position'] || 0})\n              </TabsTrigger>\n              <TabsTrigger value=\"task\" className=\"min-h-9 text-xs sm:text-sm\">\n                {t('waiting.tasks', 'Tasks')} ({groupedCounts['task'] || 0})\n              </TabsTrigger>\n            </TabsList>\n\n            {/* Tab Content */}\n            <TabsContent value={activeTab} className=\"mt-4 space-y-3\">\n              {/* Loading State (T096: Improved loading skeletons) */}\n              {isLoading && (\n                <div className=\"space-y-4\" data-testid=\"loading-skeletons\">\n                  {[1, 2, 3].map((i) => (\n                    <SkeletonCard key={i} />\n                  ))}\n                </div>\n              )}\n\n              {/* Empty State (T087: filter-specific empty state) */}\n              {!isLoading && (!filteredItems || filteredItems.length === 0) && (\n                <Card className=\"p-8 text-center sm:p-12\">\n                  <Clock className=\"mx-auto mb-4 size-12 text-muted-foreground sm:size-16\" />\n                  <h3 className=\"mb-2 text-lg font-semibold text-foreground sm:text-xl\">\n                    {hasFilters\n                      ? t('waitingQueue.filters.noResults')\n                      : t('waiting.empty', 'No waiting items')}\n                  </h3>\n                  <p className=\"mb-4 text-sm text-muted-foreground\">\n                    {hasFilters\n                      ? t('waitingQueue.filters.noResultsDesc')\n                      : activeTab === 'all'\n                        ? t('waiting.emptyDescription', 'All work items are progressing')\n                        : t('waiting.emptyCategory', 'No items waiting for this reason')}\n                  </p>\n                  {hasFilters && (\n                    <Button variant=\"outline\" size=\"sm\" onClick={clearFilters} className=\"min-h-9\">\n                      {t('waitingQueue.filters.clearFilters')}\n                    </Button>\n                  )}\n                </Card>\n              )}\n\n              {/* Items List - T093: Virtualized for lists >100 items */}\n              {!isLoading && filteredItems && filteredItems.length > 0 && (\n                <>\n                  {!shouldVirtualize ? (\n                    /* Regular rendering for short lists (<100 items) */\n                    <div className=\"space-y-3\">\n                      {filteredItems.map((item) => {\n                        const agingStatus = getAgingStatus(item.assigned_at)\n                        const TypeIcon = getTypeIcon(item.work_item_type)\n\n                        const linkedEntitiesText = getLinkedEntitiesText(item)\n                        const engagement = item.work_item?.engagement\n\n                        return (\n                          <Card\n                            key={item.id}\n                            className=\"group cursor-pointer p-4 transition-all hover:shadow-lg sm:p-6\"\n                            data-testid=\"assignment-row\"\n                            data-has-reminder=\"false\"\n                            onClick={() => handleNavigateToTask(item.work_item_id)}\n                          >\n                            <div className=\"flex gap-3 sm:gap-4\">\n                              {/* Checkbox for bulk selection */}\n                              <div className=\"flex items-start pt-1\">\n                                <Checkbox\n                                  checked={isSelected(item.id)}\n                                  onCheckedChange={(e) => {\n                                    e.stopPropagation()\n                                    if (!isSelected(item.id) && maxReached) {\n                                      toast({\n                                        variant: 'destructive',\n                                        title: t('waitingQueue.bulkActions.maxReached'),\n                                        description: t('waitingQueue.bulkActions.maxReachedDesc'),\n                                      })\n                                      return\n                                    }\n                                    toggleSelection(item.id)\n                                  }}\n                                  onClick={(e) => e.stopPropagation()}\n                                  aria-label={t('waitingQueue.bulkActions.selectItem', {\n                                    id: item.work_item_id,\n                                  })}\n                                  className=\"mt-0.5 size-5\"\n                                />\n                              </div>\n\n                              {/* Main Content */}\n                              <div className=\"min-w-0 flex-1\">\n                                <div className=\"flex flex-col gap-4 sm:flex-row sm:items-start\">\n                                  <div className=\"flex-1 space-y-3\">\n                                    <div className=\"flex flex-wrap items-center gap-2\">\n                                      <h3\n                                        className=\"text-base font-semibold text-foreground transition-colors group-hover:text-primary sm:text-lg\"\n                                        data-testid=\"row-work-item-id\"\n                                      >\n                                        {getWorkItemTitle(item)}\n                                      </h3>\n                                      <Badge variant=\"outline\" className=\"capitalize\">\n                                        {item.priority}\n                                      </Badge>\n                                      {agingStatus.severity === 'critical' && (\n                                        <Badge variant=\"destructive\" className=\"gap-1\">\n                                          <AlertTriangle className=\"size-3\" />\n                                          {agingStatus.days}d\n                                        </Badge>\n                                      )}\n                                    </div>\n\n                                    {/* Engagement Info */}\n                                    {engagement && (\n                                      <div className=\"flex items-center gap-2 rounded-md bg-blue-50 px-3 py-1.5 text-sm dark:bg-blue-950\">\n                                        <UserCheck className=\"size-4 text-blue-600 dark:text-blue-400\" />\n                                        <span className=\"font-medium text-blue-900 dark:text-blue-100\">\n                                          {engagement.title}\n                                        </span>\n                                        {engagement.dossiers && (\n                                          <>\n                                            <span className=\"text-blue-600 dark:text-blue-400\">\n                                              \n                                            </span>\n                                            <span className=\"text-xs text-blue-700 dark:text-blue-300\">\n                                              {isRTL\n                                                ? engagement.dossiers.name_ar\n                                                : engagement.dossiers.name_en}\n                                            </span>\n                                          </>\n                                        )}\n                                      </div>\n                                    )}\n\n                                    {/* Linked Entities */}\n                                    {linkedEntitiesText && (\n                                      <div className=\"text-sm text-muted-foreground\">\n                                        {linkedEntitiesText}\n                                      </div>\n                                    )}\n\n                                    {/* Waiting Status */}\n                                    <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\n                                      <TypeIcon className=\"size-4\" />\n                                      <span className=\"capitalize\">{item.status}</span>\n                                      <span></span>\n                                      <span className={agingStatus.color}>\n                                        {t('waiting.waitingFor', 'Waiting for')} {agingStatus.days}{' '}\n                                        {agingStatus.days === 1\n                                          ? t('waiting.day', 'day')\n                                          : t('waiting.days', 'days')}\n                                      </span>\n                                    </div>\n\n                                    {/* Metadata */}\n                                    <div className=\"flex flex-wrap items-center gap-3 text-xs text-muted-foreground\">\n                                      <span data-testid=\"row-assignee-name\">\n                                        {t('waiting.assignee', 'Assignee')}: {item.assignee_name}\n                                      </span>\n                                      <span></span>\n                                      <span>\n                                        {t('waiting.status', 'Status')}: {item.status}\n                                      </span>\n                                      <span></span>\n                                      <span>ID: {item.work_item_id.substring(0, 8)}...</span>\n                                    </div>\n                                  </div>\n\n                                  {/* Actions */}\n                                  <div className=\"flex gap-2 sm:flex-col\">\n                                    <ReminderButton\n                                      assignmentId={item.id}\n                                      assigneeId={item.assignee_id}\n                                      lastReminderSentAt={item.last_reminder_sent_at}\n                                      workItemId={item.work_item_id}\n                                      variant=\"outline\"\n                                      size=\"sm\"\n                                      className=\"flex-1 sm:flex-none\"\n                                      onClick={(e) => e.stopPropagation()}\n                                    />\n                                  </div>\n                                </div>\n                              </div>\n                            </div>\n                          </Card>\n                        )\n                      })}\n                    </div>\n                  ) : (\n                    /* Virtualized rendering for long lists (>100 items) */\n                    <div\n                      ref={parentRef}\n                      className=\"overflow-auto\"\n                      style={{\n                        height: '600px', // Fixed height for virtual scrolling\n                      }}\n                    >\n                      <div\n                        style={{\n                          height: `${virtualizer.getTotalSize()}px`,\n                          width: '100%',\n                          position: 'relative',\n                        }}\n                      >\n                        {virtualizer.getVirtualItems().map((virtualItem) => {\n                          const item = filteredItems[virtualItem.index]\n                          const agingStatus = getAgingStatus(item.assigned_at)\n                          const TypeIcon = getTypeIcon(item.work_item_type)\n                          const linkedEntitiesText = getLinkedEntitiesText(item)\n                          const engagement = item.work_item?.engagement\n\n                          return (\n                            <div\n                              key={item.id}\n                              data-index={virtualItem.index}\n                              ref={virtualizer.measureElement}\n                              style={{\n                                position: 'absolute',\n                                top: 0,\n                                left: 0,\n                                width: '100%',\n                                transform: `translateY(${virtualItem.start}px)`,\n                              }}\n                            >\n                              <Card\n                                className=\"group mb-3 cursor-pointer p-4 transition-all hover:shadow-lg sm:p-6\"\n                                data-testid=\"assignment-row\"\n                                data-has-reminder=\"false\"\n                                onClick={() => handleNavigateToTask(item.work_item_id)}\n                              >\n                                <div className=\"flex gap-3 sm:gap-4\">\n                                  {/* Checkbox for bulk selection */}\n                                  <div className=\"flex items-start pt-1\">\n                                    <Checkbox\n                                      checked={isSelected(item.id)}\n                                      onCheckedChange={(e) => {\n                                        e.stopPropagation()\n                                        if (!isSelected(item.id) && maxReached) {\n                                          toast({\n                                            variant: 'destructive',\n                                            title: t('waitingQueue.bulkActions.maxReached'),\n                                            description: t(\n                                              'waitingQueue.bulkActions.maxReachedDesc',\n                                            ),\n                                          })\n                                          return\n                                        }\n                                        toggleSelection(item.id)\n                                      }}\n                                      onClick={(e) => e.stopPropagation()}\n                                      aria-label={t('waitingQueue.bulkActions.selectItem', {\n                                        id: item.work_item_id,\n                                      })}\n                                      className=\"mt-0.5 size-5\"\n                                    />\n                                  </div>\n\n                                  {/* Main Content */}\n                                  <div className=\"min-w-0 flex-1\">\n                                    <div className=\"flex flex-col gap-4 sm:flex-row sm:items-start\">\n                                      <div className=\"flex-1 space-y-3\">\n                                        <div className=\"flex flex-wrap items-center gap-2\">\n                                          <h3\n                                            className=\"text-base font-semibold text-foreground transition-colors group-hover:text-primary sm:text-lg\"\n                                            data-testid=\"row-work-item-id\"\n                                          >\n                                            {getWorkItemTitle(item)}\n                                          </h3>\n                                          <Badge variant=\"outline\" className=\"capitalize\">\n                                            {item.priority}\n                                          </Badge>\n                                          {agingStatus.severity === 'critical' && (\n                                            <Badge variant=\"destructive\" className=\"gap-1\">\n                                              <AlertTriangle className=\"size-3\" />\n                                              {agingStatus.days}d\n                                            </Badge>\n                                          )}\n                                        </div>\n\n                                        {/* Engagement Info */}\n                                        {engagement && (\n                                          <div className=\"flex items-center gap-2 rounded-md bg-blue-50 px-3 py-1.5 text-sm dark:bg-blue-950\">\n                                            <UserCheck className=\"size-4 text-blue-600 dark:text-blue-400\" />\n                                            <span className=\"font-medium text-blue-900 dark:text-blue-100\">\n                                              {engagement.title}\n                                            </span>\n                                            {engagement.dossiers && (\n                                              <>\n                                                <span className=\"text-blue-600 dark:text-blue-400\">\n                                                  \n                                                </span>\n                                                <span className=\"text-xs text-blue-700 dark:text-blue-300\">\n                                                  {isRTL\n                                                    ? engagement.dossiers.name_ar\n                                                    : engagement.dossiers.name_en}\n                                                </span>\n                                              </>\n                                            )}\n                                          </div>\n                                        )}\n\n                                        {/* Linked Entities */}\n                                        {linkedEntitiesText && (\n                                          <div className=\"text-sm text-muted-foreground\">\n                                            {linkedEntitiesText}\n                                          </div>\n                                        )}\n\n                                        {/* Waiting Status */}\n                                        <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\n                                          <TypeIcon className=\"size-4\" />\n                                          <span className=\"capitalize\">{item.status}</span>\n                                          <span></span>\n                                          <span className={agingStatus.color}>\n                                            {t('waiting.waitingFor', 'Waiting for')}{' '}\n                                            {agingStatus.days}{' '}\n                                            {agingStatus.days === 1\n                                              ? t('waiting.day', 'day')\n                                              : t('waiting.days', 'days')}\n                                          </span>\n                                        </div>\n\n                                        {/* Metadata */}\n                                        <div className=\"flex flex-wrap items-center gap-3 text-xs text-muted-foreground\">\n                                          <span data-testid=\"row-assignee-name\">\n                                            {t('waiting.assignee', 'Assignee')}:{' '}\n                                            {item.assignee_name}\n                                          </span>\n                                          <span></span>\n                                          <span>\n                                            {t('waiting.status', 'Status')}: {item.status}\n                                          </span>\n                                          <span></span>\n                                          <span>ID: {item.work_item_id.substring(0, 8)}...</span>\n                                        </div>\n                                      </div>\n\n                                      {/* Actions */}\n                                      <div className=\"flex gap-2 sm:flex-col\">\n                                        <ReminderButton\n                                          assignmentId={item.id}\n                                          assigneeId={item.assignee_id}\n                                          lastReminderSentAt={item.last_reminder_sent_at}\n                                          workItemId={item.work_item_id}\n                                          variant=\"outline\"\n                                          size=\"sm\"\n                                          className=\"flex-1 sm:flex-none\"\n                                          onClick={(e) => e.stopPropagation()}\n                                        />\n                                      </div>\n                                    </div>\n                                  </div>\n                                </div>\n                              </Card>\n                            </div>\n                          )\n                        })}\n                      </div>\n                    </div>\n                  )}\n                </>\n              )}\n            </TabsContent>\n          </Tabs>\n        </main>\n      </div>\n    </div>\n  )\n}\n\n/**\n * Exported component wrapped with QueryErrorBoundary (T095)\n * Provides graceful error handling for query errors\n */\nexport function WaitingQueuePage() {\n  return (\n    <QueryErrorBoundary>\n      <WaitingQueuePageInner />\n    </QueryErrorBoundary>\n  )\n}\n","/**\n * Waiting Queue Route (FR-033)\n *\n * Work-Queue-First Navigation: Priority route for blocked items\n * Displays work items awaiting external dependencies or approvals\n * - Items waiting for approvals\n * - Items waiting for external responses\n * - Items waiting for capacity\n * - Aging indicators\n * - Escalation actions\n */\n\nimport { createFileRoute } from '@tanstack/react-router'\nimport { WaitingQueuePage } from '../../../pages/WaitingQueue'\n\nexport const Route = createFileRoute('/_protected/my-work/waiting')({\n component: WaitingQueuePage,\n})\n"],"names":["useReminderAction","queryClient","useQueryClient","useMutation","assignmentId","supabaseUrl","session","supabase","response","previousAssignment","old","_data","variables","error","context","useBulkReminderAction","assignmentIds","useBulkReminderJobStatus","jobId","enabled","useQuery","query","data","ReminderButton","assigneeId","lastReminderSentAt","workItemId","disabled","variant","size","className","t","i18n","useTranslation","toast","useToast","sendReminder","isPending","showSuccess","setShowSuccess","useState","isRTL","isCooldownActive","lastSent","getHoursRemaining","hoursSince","handleSendReminder","hoursRemaining","title","description","cooldownActive","isDisabled","jsx","Button","jsxs","Fragment","Loader2","CheckCircle2","Bell","BulkActionToolbar","selectedCount","onSendReminders","onClearSelection","isProcessing","X","priorities","PriorityFilter","value","onChange","handleToggle","priorityValue","newValue","v","priority","Checkbox","Label","agingBuckets","AgingFilter","agingValue","bucket","workItemTypes","Folder","Ticket","User","CheckSquare","TypeFilter","typeValue","type","AssigneeFilter","currentUser","user","isMyAssignments","checked","FilterPanel","filters","onFiltersChange","onClearFilters","isOpen","onOpenChange","resultCount","isLoading","isApplying","hasFilters","filterCount","Popover","PopoverTrigger","SlidersHorizontal","PopoverContent","i","ScrollArea","Accordion","AccordionItem","AccordionTrigger","AccordionContent","Separator","MAX_SELECTION","useBulkSelection","selectedIds","setSelectedIds","canSelectMore","maxReached","isSelected","useCallback","id","toggleSelection","prev","newSet","selectAll","ids","itemsToSelect","clearSelection","useMemo","STORAGE_KEY","EXPIRATION_DAYS","loadFiltersFromStorage","stored","parsed","age","maxAge","saveFiltersToStorage","useQueueFilters","setFilters","useEffect","updateFilter","key","updateFilters","newFilters","clearFilters","resetFilters","useFilteredAssignments","params","WaitingQueuePageInner","activeTab","setActiveTab","bulkJobId","setBulkJobId","isFilterPanelOpen","setIsFilterPanelOpen","parentRef","useRef","sendBulk","bulkJobStatus","isJobLoading","handleNavigateToTask","handleSendBulkReminders","itemsWithAssignee","filteredItems","item","skippedCount","handleClearSelection","successCount","failedCount","items","pagination","channel","payload","updatedAssignment","getAgingStatus","assignedAt","now","since","daysInReview","getTypeIcon","UserCheck","Mail","Zap","Clock","getWorkItemTitle","getLinkedEntitiesText","entities","entity","groupedCounts","acc","shouldVirtualize","virtualizer","useVirtualizer","Select","SelectTrigger","ArrowUpDown","SelectValue","SelectContent","SelectItem","Tabs","TabsList","TabsTrigger","TabsContent","SkeletonCard","Card","virtualItem","agingStatus","TypeIcon","linkedEntitiesText","engagement","e","Badge","AlertTriangle","WaitingQueuePage","QueryErrorBoundary","SplitComponent"],"mappings":"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"}