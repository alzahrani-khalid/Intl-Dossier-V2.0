{"version":3,"file":"_id-Bk34JHp1.js","sources":["../../src/hooks/useDossiers.ts","../../src/hooks/useArchiveDossier.ts","../../src/components/DossierHeader.tsx","../../src/hooks/useDossierStats.ts","../../src/components/DossierStats.tsx","../../src/components/DossierActions.tsx","../../src/components/ConflictDialog.tsx","../../src/components/intelligence/ConfidenceBadge.tsx","../../src/utils/intelligence-helpers.ts","../../src/components/intelligence/IntelligenceCard.tsx","../../src/components/dossiers/DossierIntelligenceTab.tsx","../../src/routes/_protected/dossiers/$id.tsx?tsr-split=component"],"sourcesContent":["/**\n * Dossier Listing Hook\n * @module hooks/useDossiers\n * @feature 026-unified-dossier-architecture\n * @feature 034-dossier-ui-polish\n *\n * TanStack Query hook for listing dossiers with advanced filtering capabilities.\n * Provides paginated results with configurable cache behavior.\n *\n * @description\n * This hook fetches a paginated list of dossiers from the Edge Function API\n * with support for multiple filter types including:\n * - Type filtering (country, organization, person, etc.)\n * - Status filtering (active, inactive, archived)\n * - Text search across name fields\n * - Tag-based filtering\n * - Pagination with configurable page size\n *\n * Query caching:\n * - staleTime: 30 seconds (data considered fresh)\n * - gcTime: 5 minutes (garbage collection)\n *\n * @example\n * // Basic usage - fetch all dossiers\n * const { data, isLoading } = useDossiers();\n *\n * @example\n * // With filters\n * const { data } = useDossiers({\n *   type: 'country',\n *   status: 'active',\n *   search: 'united',\n *   page: 1,\n *   page_size: 20,\n * });\n */\n\nimport { useQuery } from '@tanstack/react-query'\nimport { supabase } from '../lib/supabase'\nimport type { DossierFilters, DossierListResponse } from '../types/dossier'\n\n/** API base URL for Edge Functions */\nconst API_BASE_URL = import.meta.env.VITE_SUPABASE_URL + '/functions/v1'\n\n/**\n * Serializes filter object for stable query key generation\n *\n * @description\n * Sorts filter keys alphabetically and removes undefined/null/empty values\n * to ensure consistent cache key generation regardless of property order.\n *\n * @param filters - Optional filter object to serialize\n * @returns Serialized filter object or undefined if no filters\n */\nconst serializeFilters = (filters?: DossierFilters) => {\n  if (!filters) return undefined\n  // Sort keys to ensure consistent serialization\n  const sorted: Record<string, any> = {}\n  Object.keys(filters)\n    .sort()\n    .forEach((key) => {\n      const value = filters[key as keyof DossierFilters]\n      if (value !== undefined && value !== null && value !== '') {\n        sorted[key] = value\n      }\n    })\n  return sorted\n}\n\n/**\n * Query Keys Factory for dossier queries\n *\n * @description\n * Provides hierarchical cache keys for TanStack Query.\n * Enables granular cache invalidation at different levels.\n *\n * @example\n * // Invalidate all dossier queries\n * queryClient.invalidateQueries({ queryKey: dossierKeys.all });\n *\n * // Invalidate only list queries\n * queryClient.invalidateQueries({ queryKey: dossierKeys.lists() });\n */\nexport const dossierKeys = {\n  /** Root key for all dossier queries */\n  all: ['dossiers'] as const,\n  /** Key for list queries */\n  lists: () => [...dossierKeys.all, 'list'] as const,\n  /** Key for filtered list queries */\n  list: (filters?: DossierFilters) => [...dossierKeys.lists(), serializeFilters(filters)] as const,\n  /** Key for detail queries */\n  details: () => [...dossierKeys.all, 'detail'] as const,\n  /** Key for specific dossier detail */\n  detail: (id: string, includes?: string[]) => [...dossierKeys.details(), id, includes] as const,\n  /** Key for dossier timeline queries */\n  timeline: (id: string, filters?: any) => [...dossierKeys.all, 'timeline', id, filters] as const,\n  /** Key for dossier briefs queries */\n  briefs: (id: string) => [...dossierKeys.all, 'briefs', id] as const,\n}\n\n/**\n * Gets authentication headers for API requests\n *\n * @description\n * Retrieves the current Supabase session and returns headers\n * with the access token for authenticated API calls.\n *\n * @returns Promise resolving to headers object with Content-Type and Authorization\n * @internal\n */\nconst getAuthHeaders = async () => {\n  const {\n    data: { session },\n  } = await supabase.auth.getSession()\n\n  if (!session?.access_token) {\n    console.error('❌ No access token available!')\n  }\n\n  return {\n    'Content-Type': 'application/json',\n    Authorization: `Bearer ${session?.access_token}`,\n  }\n}\n\n/**\n * Hook to list dossiers with filtering and pagination\n *\n * @description\n * Fetches a paginated list of dossiers from the dossiers-list Edge Function.\n * Supports multiple filter types and handles array parameters correctly.\n *\n * @param filters - Optional filters for the query\n * @param filters.type - Dossier type filter ('country', 'organization', etc.)\n * @param filters.status - Status filter ('active', 'inactive', 'archived')\n * @param filters.search - Text search across name fields\n * @param filters.tags - Array of tags to filter by\n * @param filters.page - Page number (1-indexed)\n * @param filters.page_size - Items per page\n * @returns TanStack Query result with DossierListResponse\n *\n * @example\n * // Basic usage\n * const { data, isLoading, error } = useDossiers();\n *\n * @example\n * // With filters\n * const { data } = useDossiers({\n *   type: 'country',\n *   status: 'active',\n *   page: 1,\n *   page_size: 10,\n * });\n *\n * @example\n * // Access pagination info\n * const { data } = useDossiers({ page: 2 });\n * console.log(`Showing ${data?.data.length} of ${data?.total}`);\n */\nexport const useDossiers = (filters?: DossierFilters) => {\n  return useQuery({\n    queryKey: dossierKeys.list(filters),\n    queryFn: async (): Promise<DossierListResponse> => {\n      const headers = await getAuthHeaders()\n      const params = new URLSearchParams()\n\n      if (filters) {\n        Object.entries(filters).forEach(([key, value]) => {\n          if (value !== undefined && value !== null) {\n            if (Array.isArray(value)) {\n              // For arrays like tags, serialize as repeated params\n              value.forEach((v) => params.append(key, String(v)))\n            } else {\n              params.append(key, String(value))\n            }\n          }\n        })\n      }\n\n      const response = await fetch(`${API_BASE_URL}/dossiers-list?${params.toString()}`, {\n        headers,\n      })\n\n      if (!response.ok) {\n        const error = await response.json()\n        throw new Error(error.error?.message_en || 'Failed to fetch dossiers')\n      }\n\n      return response.json()\n    },\n    staleTime: 30_000, // 30 seconds\n    gcTime: 5 * 60_000, // 5 minutes (formerly cacheTime)\n  })\n}\n","/**\n * TanStack Query mutation for archiving dossiers\n *\n * Archives (soft delete) dossier\n * On success: Invalidates dossiers list, navigates to hub, shows toast\n */\n\nimport { useMutation, useQueryClient } from '@tanstack/react-query';\nimport { useNavigate } from '@tanstack/react-router';\nimport { supabase } from '../lib/supabase';\nimport { dossierKeys } from './useDossiers';\n\n// API base URL\nconst API_BASE_URL = import.meta.env.VITE_SUPABASE_URL + '/functions/v1';\n\n// Helper to get auth headers\nconst getAuthHeaders = async () => {\n  const { data: { session } } = await supabase.auth.getSession();\n  return {\n    'Content-Type': 'application/json',\n    'Authorization': `Bearer ${session?.access_token}`,\n  };\n};\n\n/**\n * Hook to archive dossier\n */\nexport const useArchiveDossier = (dossierId: string) => {\n  const queryClient = useQueryClient();\n  const navigate = useNavigate();\n\n  return useMutation({\n    mutationFn: async (): Promise<void> => {\n      const headers = await getAuthHeaders();\n      const response = await fetch(`${API_BASE_URL}/dossiers-archive`, {\n        method: 'DELETE',\n        headers,\n        body: JSON.stringify({ id: dossierId }),\n      });\n\n      if (!response.ok) {\n        const error = await response.json();\n        throw new Error(error.error?.message_en || 'Failed to archive dossier');\n      }\n\n      // 204 No Content response\n      if (response.status !== 204) {\n        return response.json();\n      }\n    },\n    onSuccess: () => {\n      // Invalidate queries\n      queryClient.invalidateQueries({ queryKey: dossierKeys.lists() });\n      queryClient.invalidateQueries({ queryKey: dossierKeys.detail(dossierId) });\n\n      // Navigate to hub\n      navigate({ to: '/dossiers' });\n    },\n  });\n};","import { useTranslation } from 'react-i18next';\nimport { Button } from './ui/button';\nimport { Badge } from './ui/badge';\nimport {\n DropdownMenu,\n DropdownMenuContent,\n DropdownMenuItem,\n DropdownMenuTrigger,\n} from './ui/dropdown-menu';\nimport { MoreVertical, Edit, Archive, FileText, Globe } from 'lucide-react';\nimport type { Dossier } from '../types/dossier';\nimport { switchLanguage } from '../i18n';\n\ninterface DossierHeaderProps {\n dossier: Dossier;\n onEdit?: () => void;\n onArchive?: () => void;\n onGenerateBrief?: () => void;\n}\n\nexport function DossierHeader({\n dossier,\n onEdit,\n onArchive,\n onGenerateBrief,\n}: DossierHeaderProps) {\n const { t, i18n } = useTranslation('dossiers');\n const isRTL = i18n.language === 'ar';\n\n const name = isRTL ? dossier.name_ar : dossier.name_en;\n\n const handleLanguageToggle = async () => {\n const newLang = i18n.language === 'en' ? 'ar' : 'en';\n await switchLanguage(newLang);\n };\n\n // Get badge variant based on sensitivity\n const getSensitivityVariant = (level: string): 'default' | 'secondary' | 'destructive' => {\n switch (level) {\n case 'high':\n return 'destructive';\n case 'medium':\n return 'default';\n case 'low':\n default:\n return 'secondary';\n }\n };\n\n // Get type badge color\n const getTypeBadgeClass = (type: string): string => {\n switch (type) {\n case 'country':\n return 'bg-blue-100 text-blue-800 hover:bg-blue-200';\n case 'organization':\n return 'bg-green-100 text-green-800 hover:bg-green-200';\n case 'forum':\n return 'bg-purple-100 text-purple-800 hover:bg-purple-200';\n case 'theme':\n return 'bg-amber-100 text-amber-800 hover:bg-amber-200';\n default:\n return '';\n }\n };\n\n return (\n <div className=\"border-b bg-background\">\n <div className=\"flex flex-col gap-4 p-6\">\n {/* Top Row: Title and Actions */}\n <div className=\"flex items-start justify-between gap-4\">\n <div className=\"min-w-0 flex-1\">\n <h1 className=\"mb-2 truncate text-3xl font-bold tracking-tight\">\n {name}\n </h1>\n <div className=\"flex flex-wrap gap-2\">\n <Badge\n className={getTypeBadgeClass(dossier.type)}\n aria-label={`${t('fields.type')}: ${t(`types.${dossier.type}`)}`}\n >\n {t(`types.${dossier.type}`)}\n </Badge>\n <Badge\n variant=\"outline\"\n aria-label={`${t('fields.status')}: ${t(`statuses.${dossier.status}`)}`}\n >\n {t(`statuses.${dossier.status}`)}\n </Badge>\n <Badge\n variant={getSensitivityVariant(dossier.sensitivity_level)}\n aria-label={`${t('fields.sensitivity')}: ${t(`sensitivity.${dossier.sensitivity_level}`)}`}\n >\n {t(`sensitivity.${dossier.sensitivity_level}`)}\n </Badge>\n <Badge\n variant=\"outline\"\n className=\"text-xs\"\n aria-label={`${t('fields.version')}: ${dossier.version}`}\n >\n v{dossier.version}\n </Badge>\n </div>\n </div>\n\n {/* Action Buttons */}\n <div className=\"flex shrink-0 items-center gap-2\">\n {/* Language Toggle */}\n <Button\n variant=\"outline\"\n size=\"sm\"\n onClick={handleLanguageToggle}\n className=\"gap-2\"\n aria-label={t('languageToggle', { ns: 'translation' })}\n >\n <Globe className=\"size-4\" />\n {i18n.language === 'en' ? 'عربي' : 'English'}\n </Button>\n\n {/* Generate Brief Button */}\n {onGenerateBrief && (\n <Button\n variant=\"default\"\n size=\"sm\"\n onClick={onGenerateBrief}\n className=\"gap-2\"\n aria-label={t('generateBrief')}\n >\n <FileText className=\"size-4\" />\n <span className=\"hidden sm:inline\">{t('generateBrief')}</span>\n </Button>\n )}\n\n {/* More Actions Dropdown */}\n <DropdownMenu>\n <DropdownMenuTrigger asChild>\n <Button\n variant=\"outline\"\n size=\"sm\"\n aria-label={t('moreActions', { ns: 'translation' })}\n >\n <MoreVertical className=\"size-4\" />\n </Button>\n </DropdownMenuTrigger>\n <DropdownMenuContent align={isRTL ? 'start' : 'end'}>\n {onEdit && (\n <DropdownMenuItem onClick={onEdit} className=\"gap-2\">\n <Edit className=\"size-4\" />\n {t('edit')}\n </DropdownMenuItem>\n )}\n {onArchive && (\n <DropdownMenuItem\n onClick={onArchive}\n className=\"gap-2 text-destructive focus:text-destructive\"\n >\n <Archive className=\"size-4\" />\n {t('archive')}\n </DropdownMenuItem>\n )}\n </DropdownMenuContent>\n </DropdownMenu>\n </div>\n </div>\n\n {/* Summary Section */}\n {(dossier.summary_en || dossier.summary_ar) && (\n <div className=\"border-t pt-4\">\n <p className=\"text-sm leading-relaxed text-muted-foreground\">\n {isRTL ? dossier.summary_ar : dossier.summary_en}\n </p>\n </div>\n )}\n\n {/* Metadata Row */}\n <div className=\"flex flex-wrap gap-x-6 gap-y-2 text-sm text-muted-foreground\">\n {dossier.tags && dossier.tags.length > 0 && (\n <div className=\"flex items-center gap-1\">\n <span className=\"font-medium\">{t('fields.tags')}:</span>\n <div className=\"flex flex-wrap gap-1\">\n {dossier.tags.slice(0, 5).map((tag, index) => (\n <Badge key={index} variant=\"outline\" className=\"text-xs\">\n {tag}\n </Badge>\n ))}\n {dossier.tags.length > 5 && (\n <Badge variant=\"outline\" className=\"text-xs\">\n +{dossier.tags.length - 5}\n </Badge>\n )}\n </div>\n </div>\n )}\n <div className=\"flex items-center gap-1\">\n <span className=\"font-medium\">{t('fields.created')}:</span>\n <span>{new Date(dossier.created_at).toLocaleDateString(i18n.language)}</span>\n </div>\n <div className=\"flex items-center gap-1\">\n <span className=\"font-medium\">{t('fields.updated')}:</span>\n <span>{new Date(dossier.updated_at).toLocaleDateString(i18n.language)}</span>\n </div>\n {dossier.last_review_date && (\n <div className=\"flex items-center gap-1\">\n <span className=\"font-medium\">{t('fields.lastReview')}:</span>\n <span>{new Date(dossier.last_review_date).toLocaleDateString(i18n.language)}</span>\n </div>\n )}\n </div>\n </div>\n </div>\n );\n}","/**\n * Dossier Statistics Hook\n * @module hooks/useDossierStats\n * @feature 030-health-commitment\n * @feature 034-dossier-ui-polish\n *\n * TanStack Query hook for fetching dossier statistics with automatic caching,\n * background refresh, and selective data inclusion.\n *\n * @description\n * This hook provides aggregated statistics for a dossier including:\n * - Commitment counts and status breakdown\n * - Engagement metrics\n * - Document counts by type\n * - Health score and indicators\n *\n * The hook implements intelligent caching with:\n * - 5-minute stale time (data considered fresh)\n * - 30-minute garbage collection\n * - Automatic refetch on window focus\n * - Background refetch every 5 minutes\n *\n * @example\n * // Fetch all stats for a dossier\n * const { data, isLoading } = useDossierStats({ dossierId: 'uuid-123' });\n *\n * @example\n * // Fetch only specific stat categories\n * const { data } = useDossierStats({\n *   dossierId: 'uuid-123',\n *   include: ['commitments', 'health'],\n * });\n *\n * @example\n * // Conditionally enable the query\n * const { data } = useDossierStats({\n *   dossierId,\n *   enabled: !!dossierId && isVisible,\n * });\n */\n\nimport { useQuery } from '@tanstack/react-query'\nimport { getStats, type DossierStats } from '@/services/dossier-stats.service'\n\n/**\n * Options for the useDossierStats hook\n */\nexport interface UseDossierStatsOptions {\n  /**\n   * The UUID of the dossier to fetch statistics for\n   */\n  dossierId: string\n  /**\n   * Optional array of stat categories to include\n   * If not specified, all categories are included\n   * @default ['commitments', 'engagements', 'documents', 'health']\n   */\n  include?: Array<'commitments' | 'engagements' | 'documents' | 'health'>\n  /**\n   * Whether the query should be enabled\n   * Useful for conditional fetching based on UI state\n   * @default true\n   */\n  enabled?: boolean\n}\n\n/**\n * Hook to fetch dossier statistics with intelligent caching\n *\n * @description\n * Fetches aggregated statistics for a dossier with configurable caching behavior.\n * Supports selective data inclusion to reduce payload size when only specific\n * stats are needed.\n *\n * Cache behavior:\n * - staleTime: 5 minutes - data considered fresh, no background refetch\n * - gcTime: 30 minutes - unused data removed from cache\n * - refetchOnWindowFocus: true - refreshes when user returns to tab\n * - refetchInterval: 5 minutes - background updates for long-lived pages\n *\n * @param options - Hook configuration options\n * @param options.dossierId - Required dossier UUID\n * @param options.include - Optional array of stat categories to fetch\n * @param options.enabled - Optional flag to enable/disable the query\n * @returns TanStack Query result with DossierStats data\n *\n * @example\n * // Basic usage\n * const { data: stats } = useDossierStats({ dossierId: 'uuid-123' });\n * console.log(`Health score: ${stats?.health?.score}`);\n *\n * @example\n * // With selective inclusion\n * const { data } = useDossierStats({\n *   dossierId: 'uuid-123',\n *   include: ['commitments'],\n * });\n * console.log(`Open commitments: ${data?.commitments?.open}`);\n */\nexport function useDossierStats(options: UseDossierStatsOptions) {\n  const { dossierId, include, enabled = true } = options\n\n  return useQuery<DossierStats, Error>({\n    queryKey: ['dossierStats', dossierId, include],\n    queryFn: () => getStats(dossierId, include),\n    staleTime: 5 * 60 * 1000, // 5 minutes (data considered fresh)\n    gcTime: 30 * 60 * 1000, // 30 minutes (garbage collection)\n    refetchOnWindowFocus: true, // Refetch when user returns to tab\n    refetchInterval: 5 * 60 * 1000, // Background refetch every 5 minutes\n    enabled: enabled && !!dossierId, // Only fetch if enabled and dossierId exists\n  })\n}\n","import { useTranslation } from 'react-i18next';\nimport { useNavigate } from '@tanstack/react-router';\nimport { Card, CardContent, CardHeader, CardTitle } from './ui/card';\nimport { Progress } from './ui/progress';\nimport { Skeleton } from './ui/skeleton';\nimport { Alert, AlertDescription } from './ui/alert';\nimport {\n Calendar,\n MessageSquare,\n Handshake,\n CheckCircle,\n AlertCircle,\n FileText,\n TrendingUp,\n Activity,\n Loader2,\n} from 'lucide-react';\nimport { useDossierStats } from '../hooks/useDossierStats';\nimport { getHealthScoreColor, getHealthScoreLabel } from '../services/dossier-stats.service';\n\ninterface DossierStatsProps {\n dossierId: string;\n onStatClick?: (statType: 'engagements' | 'positions' | 'mous') => void;\n}\n\ninterface StatCardProps {\n icon: React.ReactNode;\n label: string;\n value: number | string;\n iconColor?: string;\n trend?: 'up' | 'down' | 'neutral';\n onClick?: () => void;\n clickable?: boolean;\n}\n\nfunction StatCard({\n icon,\n label,\n value,\n iconColor = 'text-muted-foreground',\n onClick,\n clickable = false\n}: StatCardProps) {\n const baseClasses = \"flex items-center gap-3 rounded-lg bg-muted/50 p-3 transition-all duration-200\";\n const interactiveClasses = clickable\n ? \"cursor-pointer hover:bg-muted hover:shadow-sm active:scale-[0.98]\"\n : \"\";\n\n const Component = clickable ? 'button' : 'div';\n\n return (\n <Component\n className={`${baseClasses} ${interactiveClasses}`}\n onClick={clickable ? onClick : undefined}\n type={clickable ? \"button\" : undefined}\n aria-label={clickable ? `${label}: ${value}. Click to view details` : undefined}\n >\n <div className={`shrink-0 ${iconColor}`} aria-hidden=\"true\">\n {icon}\n </div>\n <div className=\"min-w-0 flex-1 text-start\">\n <p className=\"truncate text-sm font-medium text-muted-foreground\">{label}</p>\n <p className=\"text-2xl font-bold\">{value}</p>\n </div>\n </Component>\n );\n}\n\nexport function DossierStats({ dossierId, onStatClick }: DossierStatsProps) {\n const { t, i18n } = useTranslation('dossiers');\n const navigate = useNavigate();\n const isRTL = i18n.language === 'ar';\n\n // Fetch dossier stats using TanStack Query hook\n const { data: stats, isLoading, isError, error } = useDossierStats({ dossierId });\n\n // Show loading skeleton\n if (isLoading) {\n return (\n <div className=\"space-y-4\">\n <div className=\"grid grid-cols-1 gap-3 sm:grid-cols-2 lg:grid-cols-3\">\n {[...Array(3)].map((_, i) => (\n <Skeleton key={i} className=\"h-24 w-full\" />\n ))}\n </div>\n <div className=\"grid grid-cols-1 gap-3 sm:grid-cols-2\">\n {[...Array(4)].map((_, i) => (\n <Skeleton key={i} className=\"h-24 w-full\" />\n ))}\n </div>\n <Skeleton className=\"h-40 w-full\" />\n </div>\n );\n }\n\n // Show error state\n if (isError) {\n return (\n <Alert variant=\"destructive\">\n <AlertCircle className=\"size-4\" />\n <AlertDescription>\n {t('errors.failedToLoadStats', { ns: 'translation' }) ||\n `Failed to load dossier stats: ${error?.message}`}\n </AlertDescription>\n </Alert>\n );\n }\n\n // No stats available\n if (!stats) {\n return (\n <Alert>\n <AlertDescription>\n {t('stats.noDataAvailable', { ns: 'translation' }) ||\n 'No statistics available for this dossier'}\n </AlertDescription>\n </Alert>\n );\n }\n\n const healthScore = stats.health?.overallScore ?? null;\n const hasHealthScore = stats.health?.sufficientData ?? false;\n\n // Handle click to navigate to filtered commitments list\n const handleCommitmentsClick = () => {\n navigate({\n to: '/commitments',\n search: {\n dossierId,\n status: 'active,in_progress',\n },\n });\n };\n\n return (\n <div className=\"space-y-4\" dir={isRTL ? 'rtl' : 'ltr'}>\n {/* Main Stats Grid - Theme aware */}\n <div className=\"grid grid-cols-1 gap-3 sm:grid-cols-2 lg:grid-cols-3\">\n <StatCard\n icon={<Calendar className=\"size-5\" />}\n label={t('stats.totalEngagements')}\n value={stats.engagements?.total365d ?? 0}\n iconColor=\"text-info\"\n onClick={() => onStatClick?.('engagements')}\n clickable={!!onStatClick && (stats.engagements?.total365d ?? 0) > 0}\n />\n <StatCard\n icon={<FileText className=\"size-5\" />}\n label={t('stats.totalDocuments')}\n value={stats.documents?.total ?? 0}\n iconColor=\"text-muted-foreground\"\n />\n <StatCard\n icon={<Activity className=\"size-5\" />}\n label={t('stats.recentActivity')}\n value={stats.engagements?.recent90d ?? 0}\n iconColor=\"text-accent\"\n />\n </div>\n\n {/* Commitments Row - Theme aware */}\n <div className=\"grid grid-cols-1 gap-3 sm:grid-cols-2\">\n <StatCard\n icon={<CheckCircle className=\"size-5\" />}\n label={t('stats.activeCommitments')}\n value={stats.commitments?.active ?? 0}\n iconColor=\"text-success\"\n onClick={handleCommitmentsClick}\n clickable={(stats.commitments?.active ?? 0) > 0}\n />\n <StatCard\n icon={<AlertCircle className=\"size-5\" />}\n label={t('stats.overdueCommitments')}\n value={stats.commitments?.overdue ?? 0}\n iconColor={(stats.commitments?.overdue ?? 0) > 0 ? 'text-destructive' : 'text-muted-foreground'}\n />\n </div>\n\n {/* Relationship Health Score Card */}\n <Card className=\"overflow-hidden\">\n <CardHeader className=\"pb-3\">\n <CardTitle className=\"flex items-center gap-2 text-sm font-medium\">\n <TrendingUp className=\"size-4\" />\n {t('stats.relationshipHealth')}\n </CardTitle>\n </CardHeader>\n <CardContent>\n <div className=\"space-y-3\">\n {hasHealthScore ? (\n <>\n <div className=\"flex items-center justify-between\">\n <span className={`text-3xl font-bold ${getHealthScoreColor(healthScore)}`}>\n {healthScore}\n </span>\n <span className=\"text-sm font-medium text-muted-foreground\">\n {getHealthScoreLabel(healthScore)}\n </span>\n </div>\n <Progress\n value={healthScore ?? 0}\n className=\"h-2\"\n aria-label={`${t('stats.relationshipHealth')}: ${healthScore} out of 100`}\n />\n <div className=\"flex justify-between text-xs text-muted-foreground\">\n <span>0</span>\n <span>50</span>\n <span>100</span>\n </div>\n\n {/* Component breakdown tooltip */}\n {stats.health?.components && (\n <div className=\"space-y-1 rounded-md bg-muted/50 p-2 text-xs\">\n <div className=\"font-medium text-muted-foreground\">\n {t('stats.healthComponents', { ns: 'translation' }) || 'Component Breakdown'}\n </div>\n <div className=\"flex justify-between\">\n <span>{t('stats.engagementFrequency', { ns: 'translation' }) || 'Engagement Frequency'}</span>\n <span className=\"font-medium\">{stats.health.components.engagementFrequency}</span>\n </div>\n <div className=\"flex justify-between\">\n <span>{t('stats.commitmentFulfillment', { ns: 'translation' }) || 'Commitment Fulfillment'}</span>\n <span className=\"font-medium\">{stats.health.components.commitmentFulfillment}</span>\n </div>\n <div className=\"flex justify-between\">\n <span>{t('stats.recency', { ns: 'translation' }) || 'Recency'}</span>\n <span className=\"font-medium\">{stats.health.components.recencyScore}</span>\n </div>\n </div>\n )}\n </>\n ) : (\n <div className=\"py-4 text-center\">\n <p className=\"text-sm text-muted-foreground\">\n {stats.health?.reason || t('stats.noHealthScore', { ns: 'translation' }) ||\n 'Not enough data to calculate health score'}\n </p>\n </div>\n )}\n </div>\n </CardContent>\n </Card>\n </div>\n );\n}","import { useTranslation } from 'react-i18next';\nimport { Button } from './ui/button';\nimport { Card, CardContent, CardHeader, CardTitle } from './ui/card';\nimport {\n Calendar,\n MessageSquare,\n Lightbulb,\n Upload,\n UserPlus,\n FileText,\n} from 'lucide-react';\n\ninterface DossierActionsProps {\n dossierId: string;\n onAddEngagement?: () => void;\n onAddPosition?: () => void;\n onLogIntelligence?: () => void;\n onUploadDocument?: () => void;\n onAddContact?: () => void;\n onGenerateBrief?: () => void;\n}\n\ninterface ActionButtonProps {\n icon: React.ReactNode;\n label: string;\n onClick?: () => void;\n variant?: 'default' | 'outline' | 'secondary';\n disabled?: boolean;\n}\n\nfunction ActionButton({\n icon,\n label,\n onClick,\n variant = 'outline',\n disabled = false,\n}: ActionButtonProps) {\n return (\n <Button\n variant={variant}\n className=\"h-auto w-full justify-start gap-2 px-4 py-3\"\n onClick={onClick}\n disabled={disabled}\n aria-label={label}\n >\n <div className=\"shrink-0\" aria-hidden=\"true\">\n {icon}\n </div>\n <span className=\"text-sm font-medium\">{label}</span>\n </Button>\n );\n}\n\nexport function DossierActions({\n onAddEngagement,\n onAddPosition,\n onLogIntelligence,\n onUploadDocument,\n onAddContact,\n onGenerateBrief,\n}: DossierActionsProps) {\n const { t } = useTranslation('dossiers');\n\n return (\n <Card>\n <CardHeader>\n <CardTitle className=\"text-base\">\n Quick Actions\n </CardTitle>\n </CardHeader>\n <CardContent className=\"space-y-2\">\n {/* Primary Action - Generate Brief */}\n {onGenerateBrief && (\n <ActionButton\n icon={<FileText className=\"size-5\" />}\n label={t('generateBrief')}\n onClick={onGenerateBrief}\n variant=\"default\"\n />\n )}\n\n {/* Secondary Actions */}\n {onAddEngagement && (\n <ActionButton\n icon={<Calendar className=\"size-5\" />}\n label={t('actions.addEngagement')}\n onClick={onAddEngagement}\n />\n )}\n\n {onAddPosition && (\n <ActionButton\n icon={<MessageSquare className=\"size-5\" />}\n label={t('actions.addPosition')}\n onClick={onAddPosition}\n />\n )}\n\n {onLogIntelligence && (\n <ActionButton\n icon={<Lightbulb className=\"size-5\" />}\n label={t('actions.logIntelligence')}\n onClick={onLogIntelligence}\n />\n )}\n\n {onUploadDocument && (\n <ActionButton\n icon={<Upload className=\"size-5\" />}\n label={t('actions.uploadDocument')}\n onClick={onUploadDocument}\n />\n )}\n\n {onAddContact && (\n <ActionButton\n icon={<UserPlus className=\"size-5\" />}\n label={t('actions.addContact')}\n onClick={onAddContact}\n />\n )}\n </CardContent>\n </Card>\n );\n}","import { useTranslation } from 'react-i18next';\nimport {\n Dialog,\n DialogContent,\n DialogDescription,\n DialogFooter,\n DialogHeader,\n DialogTitle,\n} from './ui/dialog';\nimport { Button } from './ui/button';\nimport { Badge } from './ui/badge';\nimport { AlertTriangle } from 'lucide-react';\nimport type { Dossier } from '../types/dossier';\n\ninterface ConflictDialogProps {\n open: boolean;\n currentData: Partial<Dossier>;\n remoteData: Partial<Dossier>;\n onResolve: (resolution: 'keep-mine' | 'use-theirs' | 'cancel') => void;\n}\n\nexport function ConflictDialog({\n open,\n currentData,\n remoteData,\n onResolve,\n}: ConflictDialogProps) {\n const { t, i18n } = useTranslation('dossiers');\n const isRTL = i18n.language === 'ar';\n\n // Find conflicting fields\n const getConflictingFields = (): Array<{\n field: string;\n currentValue: any;\n remoteValue: any;\n }> => {\n const conflicts: Array<{ field: string; currentValue: any; remoteValue: any }> = [];\n const allKeys = new Set([...Object.keys(currentData), ...Object.keys(remoteData)]);\n\n allKeys.forEach((key) => {\n const currentValue = currentData[key as keyof Dossier];\n const remoteValue = remoteData[key as keyof Dossier];\n\n // Skip system fields\n if (['id', 'created_at', 'updated_at', 'archived'].includes(key)) {\n return;\n }\n\n // Compare values (handle arrays and objects)\n const isDifferent =\n JSON.stringify(currentValue) !== JSON.stringify(remoteValue) &&\n currentValue !== undefined &&\n remoteValue !== undefined;\n\n if (isDifferent) {\n conflicts.push({\n field: key,\n currentValue,\n remoteValue,\n });\n }\n });\n\n return conflicts;\n };\n\n const conflicts = getConflictingFields();\n\n // Format value for display\n const formatValue = (value: any): string => {\n if (value === null || value === undefined) {\n return t('none', { ns: 'translation' }) || 'None';\n }\n if (Array.isArray(value)) {\n return value.join(', ');\n }\n if (typeof value === 'object') {\n return JSON.stringify(value, null, 2);\n }\n if (typeof value === 'boolean') {\n return value ? t('yes', { ns: 'translation' }) || 'Yes' : t('no', { ns: 'translation' }) || 'No';\n }\n return String(value);\n };\n\n // Get field label\n const getFieldLabel = (field: string): string => {\n return t(`fields.${field}`) || field;\n };\n\n return (\n <Dialog open={open} onOpenChange={(open) => !open && onResolve('cancel')}>\n <DialogContent className=\"max-h-[80vh] max-w-3xl overflow-y-auto\">\n <DialogHeader>\n <DialogTitle className=\"flex items-center gap-2\">\n <AlertTriangle className=\"size-5 text-amber-500\" />\n {t('conflict.title')}\n </DialogTitle>\n <DialogDescription>{t('conflict.message')}</DialogDescription>\n </DialogHeader>\n\n <div className=\"space-y-4\">\n {/* Version Info */}\n <div className=\"flex gap-4 rounded-lg bg-muted/50 p-4\">\n <div className=\"flex-1\">\n <p className=\"mb-1 text-sm font-medium text-muted-foreground\">\n {t('conflict.currentVersion')}\n </p>\n <Badge variant=\"outline\">v{currentData.version || 'unknown'}</Badge>\n </div>\n <div className=\"flex-1\">\n <p className=\"mb-1 text-sm font-medium text-muted-foreground\">\n {t('conflict.remoteVersion')}\n </p>\n <Badge variant=\"default\">v{remoteData.version || 'unknown'}</Badge>\n </div>\n </div>\n\n {/* Conflicts Table */}\n {conflicts.length > 0 && (\n <div className=\"space-y-3\">\n <h3 className=\"text-sm font-medium\">{t('conflict.changes')}</h3>\n <div className=\"overflow-hidden rounded-lg border\">\n <table className=\"w-full text-sm\">\n <thead className=\"bg-muted/50\">\n <tr>\n <th className=\"p-3 text-start font-medium\">{t('conflict.field')}</th>\n <th className=\"p-3 text-start font-medium\">{t('conflict.yourChange')}</th>\n <th className=\"p-3 text-start font-medium\">{t('conflict.theirChange')}</th>\n </tr>\n </thead>\n <tbody>\n {conflicts.map((conflict, index) => (\n <tr key={conflict.field} className={index % 2 === 0 ? 'bg-muted/20' : ''}>\n <td className=\"p-3 align-top font-medium\">\n {getFieldLabel(conflict.field)}\n </td>\n <td className=\"p-3 align-top\">\n <div className=\"rounded border border-blue-200 bg-blue-50 p-2\">\n <pre className=\"whitespace-pre-wrap text-xs\">\n {formatValue(conflict.currentValue)}\n </pre>\n </div>\n </td>\n <td className=\"p-3 align-top\">\n <div className=\"rounded border border-amber-200 bg-amber-50 p-2\">\n <pre className=\"whitespace-pre-wrap text-xs\">\n {formatValue(conflict.remoteValue)}\n </pre>\n </div>\n </td>\n </tr>\n ))}\n </tbody>\n </table>\n </div>\n </div>\n )}\n\n {/* Warning Message */}\n <div className=\"rounded-lg border border-amber-200 bg-amber-50 p-4\">\n <p className=\"text-sm text-amber-900\">\n {t('conflict.warning', { ns: 'translation' }) ||\n 'Choosing \"Keep My Changes\" will overwrite the remote changes. This action cannot be undone.'}\n </p>\n </div>\n </div>\n\n <DialogFooter className=\"flex-col gap-2 sm:flex-row\">\n <Button\n variant=\"outline\"\n onClick={() => onResolve('cancel')}\n className=\"w-full sm:w-auto\"\n >\n {t('conflict.cancel')}\n </Button>\n <Button\n variant=\"secondary\"\n onClick={() => onResolve('use-theirs')}\n className=\"w-full sm:w-auto\"\n >\n {t('conflict.useTheirs')}\n </Button>\n <Button\n variant=\"destructive\"\n onClick={() => onResolve('keep-mine')}\n className=\"w-full sm:w-auto\"\n >\n {t('conflict.keepMine')}\n </Button>\n </DialogFooter>\n </DialogContent>\n </Dialog>\n );\n}","import { useTranslation } from 'react-i18next';\nimport { Badge } from '@/components/ui/badge';\nimport { CheckCircle2, AlertCircle, Info, ShieldCheck } from 'lucide-react';\n\ninterface ConfidenceBadgeProps {\n  level: 'low' | 'medium' | 'high' | 'verified';\n  showIcon?: boolean;\n  size?: 'sm' | 'md' | 'lg';\n}\n\nconst confidenceConfig = {\n  low: {\n    icon: Info,\n    bgColor: 'bg-gray-100 dark:bg-gray-800',\n    textColor: 'text-gray-700 dark:text-gray-300',\n    borderColor: 'border-gray-300 dark:border-gray-600',\n  },\n  medium: {\n    icon: AlertCircle,\n    bgColor: 'bg-blue-100 dark:bg-blue-900',\n    textColor: 'text-blue-700 dark:text-blue-300',\n    borderColor: 'border-blue-300 dark:border-blue-600',\n  },\n  high: {\n    icon: CheckCircle2,\n    bgColor: 'bg-green-100 dark:bg-green-900',\n    textColor: 'text-green-700 dark:text-green-300',\n    borderColor: 'border-green-300 dark:border-green-600',\n  },\n  verified: {\n    icon: ShieldCheck,\n    bgColor: 'bg-purple-100 dark:bg-purple-900',\n    textColor: 'text-purple-700 dark:text-purple-300',\n    borderColor: 'border-purple-300 dark:border-purple-600',\n  },\n} as const;\n\nconst sizeClasses = {\n  sm: 'text-xs px-2 py-0.5',\n  md: 'text-sm px-2.5 py-1',\n  lg: 'text-base px-3 py-1.5',\n} as const;\n\nconst iconSizes = {\n  sm: 'h-3 w-3',\n  md: 'h-3.5 w-3.5',\n  lg: 'h-4 w-4',\n} as const;\n\nexport function ConfidenceBadge({\n  level,\n  showIcon = true,\n  size = 'sm',\n}: ConfidenceBadgeProps) {\n  const { t, i18n } = useTranslation('dossier');\n  const isRTL = i18n.language === 'ar';\n\n  const config = confidenceConfig[level];\n  const Icon = config.icon;\n\n  return (\n    <Badge\n      variant=\"outline\"\n      className={`\n        ${config.bgColor}\n        ${config.textColor}\n        ${config.borderColor}\n        ${sizeClasses[size]}\n        font-medium\n        inline-flex\n        items-center\n        gap-1\n        ${isRTL ? 'flex-row-reverse' : 'flex-row'}\n      `}\n    >\n      {showIcon && <Icon className={iconSizes[size]} />}\n      <span>{t(`intelligence.confidence.${level}`, level)}</span>\n    </Badge>\n  );\n}\n","/**\n * Intelligence Utility Functions\n * \n * Helper functions for working with intelligence reports\n */\n\n/**\n * Convert numeric confidence score (0-100) to confidence level string\n * \n * Mapping:\n * - 90-100: 'verified' (most reliable, multiple authoritative sources)\n * - 70-89: 'high' (reliable, good sources)\n * - 50-69: 'medium' (moderate reliability)\n * - 0-49: 'low' (limited reliability)\n */\nexport function getConfidenceLevel(\n  confidenceScore: number\n): 'verified' | 'high' | 'medium' | 'low' {\n  if (confidenceScore >= 90) return 'verified';\n  if (confidenceScore >= 70) return 'high';\n  if (confidenceScore >= 50) return 'medium';\n  return 'low';\n}\n\n/**\n * Type guard to check if a value is a valid confidence level\n */\nexport function isValidConfidenceLevel(\n  value: unknown\n): value is 'verified' | 'high' | 'medium' | 'low' {\n  return (\n    value === 'verified' ||\n    value === 'high' ||\n    value === 'medium' ||\n    value === 'low'\n  );\n}\n\n","import { useTranslation } from 'react-i18next';\nimport { formatDistanceToNow } from 'date-fns';\nimport { ar, enUS } from 'date-fns/locale';\nimport { Card } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { ConfidenceBadge } from './ConfidenceBadge';\nimport type { IntelligenceReport } from '@/types/intelligence-reports.types';\nimport { getConfidenceLevel } from '@/utils/intelligence-helpers';\nimport {\n  TrendingUp,\n  Shield,\n  Users,\n  Globe,\n  Clock,\n  AlertTriangle,\n  CheckCircle\n} from 'lucide-react';\n\ninterface IntelligenceCardProps {\n  intelligence: IntelligenceReport;\n  showFullAnalysis?: boolean;\n  onRefresh?: () => void;\n}\n\nconst intelligenceIcons = {\n  economic: TrendingUp,\n  political: Users,\n  security: Shield,\n  bilateral: Globe,\n  general: Globe,\n} as const;\n\nexport function IntelligenceCard({\n  intelligence,\n  showFullAnalysis = false\n}: IntelligenceCardProps) {\n  const { t, i18n } = useTranslation('dossier');\n  const isRTL = i18n.language === 'ar';\n  const locale = isRTL ? ar : enUS;\n\n  const Icon = intelligenceIcons[intelligence.intelligence_type] || Globe;\n\n  // Determine if cache is stale\n  const isStale = intelligence.cache_expires_at\n    ? new Date(intelligence.cache_expires_at) < new Date()\n    : false;\n\n  // Get localized content (title and content with fallback)\n  const title = (isRTL && intelligence.title_ar) ? intelligence.title_ar : intelligence.title;\n  const content = (isRTL && intelligence.content_ar) ? intelligence.content_ar : intelligence.content;\n\n  // Format last updated timestamp\n  const lastUpdated = intelligence.last_refreshed_at\n    ? formatDistanceToNow(new Date(intelligence.last_refreshed_at), {\n        addSuffix: true,\n        locale,\n      })\n    : t('intelligence.never_updated', 'Never updated');\n\n  return (\n    <Card\n      className=\"p-4 sm:p-6 hover:shadow-lg transition-shadow duration-200\"\n      dir={isRTL ? 'rtl' : 'ltr'}\n      role=\"article\"\n      aria-label={t('intelligence.cardLabel', {\n        type: t(`intelligence.types.${intelligence.intelligence_type}`),\n        defaultValue: `{{type}} intelligence report`,\n      })}\n    >\n      {/* Header */}\n      <div className=\"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-4 mb-4\">\n        <div className=\"flex items-start gap-3\">\n          <div className=\"rounded-lg bg-primary/10 p-2 sm:p-3 shrink-0\">\n            <Icon className=\"h-5 w-5 sm:h-6 sm:w-6 text-primary\" />\n          </div>\n          <div className=\"flex-1 min-w-0\">\n            <h3 className=\"text-base sm:text-lg font-semibold text-foreground line-clamp-2\">\n              {title}\n            </h3>\n            <div className=\"flex flex-wrap items-center gap-2 mt-2\">\n              <Badge\n                variant=\"outline\"\n                className=\"text-xs\"\n              >\n                {t(`intelligence.types.${intelligence.intelligence_type}`, intelligence.intelligence_type)}\n              </Badge>\n              <ConfidenceBadge level={getConfidenceLevel(intelligence.confidence_score)} />\n              {isStale && (\n                <Badge\n                  variant=\"secondary\"\n                  className=\"text-xs bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200 flex items-center gap-1\"\n                >\n                  <AlertTriangle className=\"h-3 w-3\" />\n                  {t('intelligence.stale', 'Stale')}\n                </Badge>\n              )}\n              {intelligence.refresh_status === 'fresh' && !isStale && (\n                <Badge\n                  variant=\"secondary\"\n                  className=\"text-xs bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200 flex items-center gap-1\"\n                >\n                  <CheckCircle className=\"h-3 w-3\" />\n                  {t('intelligence.fresh', 'Fresh')}\n                </Badge>\n              )}\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Content */}\n      <div className=\"mb-4\">\n        <p className=\"text-sm sm:text-base text-muted-foreground leading-relaxed whitespace-pre-wrap\">\n          {content}\n        </p>\n      </div>\n\n      {/* Footer */}\n      <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 pt-4 border-t border-border\">\n        <div className=\"flex items-center gap-2 text-xs sm:text-sm text-muted-foreground\">\n          <Clock className=\"h-4 w-4\" />\n          <span>\n            {t('intelligence.last_updated', 'Updated')} {lastUpdated}\n          </span>\n        </div>\n\n        {/* Data Sources Count */}\n        {intelligence.data_sources_metadata && intelligence.data_sources_metadata.length > 0 && (\n          <div className=\"text-xs sm:text-sm text-muted-foreground\">\n            {t('intelligence.sources_count', {\n              count: intelligence.data_sources_metadata.length,\n              defaultValue: `{{count}} sources`,\n            })}\n          </div>\n        )}\n      </div>\n    </Card>\n  );\n}\n","/**\n * DossierIntelligenceTab Component (Feature 029 - User Story 1)\n *\n * Displays AI-generated intelligence for a dossier entity\n * Features: 4 intelligence types (economic, political, security, bilateral)\n * Mobile-first responsive design with RTL support\n * Integrates with AnythingLLM-generated intelligence reports\n */\n\nimport { useTranslation } from 'react-i18next';\nimport { useAllIntelligence, useRefreshIntelligence } from '@/hooks/useIntelligence';\nimport { IntelligenceCard } from '@/components/intelligence/IntelligenceCard';\nimport { RefreshButton } from '@/components/intelligence/RefreshButton';\nimport { Skeleton } from '@/components/ui/skeleton';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport { AlertCircle, Lightbulb } from 'lucide-react';\nimport { toast } from 'sonner';\nimport type { IntelligenceType } from '@/types/intelligence-reports.types';\n\ninterface DossierIntelligenceTabProps {\n  dossierId: string;\n}\n\nexport function DossierIntelligenceTab({ dossierId }: DossierIntelligenceTabProps) {\n  const { t, i18n } = useTranslation('dossier');\n  const isRTL = i18n.language === 'ar';\n\n  const {\n    data: intelligenceData,\n    isLoading,\n    isError,\n    error,\n  } = useAllIntelligence(dossierId);\n\n  const { mutate: refreshIntelligence, isPending: isRefreshing } = useRefreshIntelligence({\n    onSuccess: (data) => {\n      // Show success toast\n      const typeLabels = data.data\n        .map((r) => t(`intelligence.types.${r.intelligence_type}`))\n        .join(', ');\n      toast.success(\n        isRTL\n          ? `تم تحديث التقارير بنجاح: ${typeLabels}`\n          : `Successfully refreshed: ${typeLabels}`\n      );\n    },\n    onError: (error) => {\n      // Handle specific error codes\n      if (error.code === 'CONFLICT') {\n        toast.warning(\n          isRTL\n            ? 'تحديث جاري بالفعل. يرجى الانتظار حتى يكتمل.'\n            : 'Refresh already in progress. Please wait until it completes.'\n        );\n      } else if (error.code === 'SERVICE_UNAVAILABLE') {\n        toast.error(\n          isRTL\n            ? 'خدمة AnythingLLM غير متاحة. سيتم عرض البيانات المخزنة مؤقتاً.'\n            : 'AnythingLLM service unavailable. Showing cached data.'\n        );\n      } else {\n        toast.error(\n          isRTL\n            ? `فشل التحديث: ${error.message_ar || error.message_en}`\n            : `Refresh failed: ${error.message_en}`\n        );\n      }\n    },\n  });\n\n  const handleRefresh = (types: IntelligenceType[]) => {\n    refreshIntelligence({\n      entity_id: dossierId,\n      intelligence_types: types,\n      priority: 'normal',\n    });\n  };\n\n  // Loading state\n  if (isLoading) {\n    return (\n      <div className=\"space-y-4 sm:space-y-6\" dir={isRTL ? 'rtl' : 'ltr'}>\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n          {[1, 2, 3, 4].map((i) => (\n            <Skeleton key={i} className=\"h-48 w-full\" />\n          ))}\n        </div>\n      </div>\n    );\n  }\n\n  // Error state\n  if (isError) {\n    return (\n      <Alert variant=\"destructive\" dir={isRTL ? 'rtl' : 'ltr'}>\n        <AlertCircle className={`h-4 w-4 ${isRTL ? 'ml-2' : 'mr-2'}`} />\n        <AlertDescription>\n          {error instanceof Error\n            ? error.message\n            : t('intelligence.error', 'Failed to load intelligence')}\n        </AlertDescription>\n      </Alert>\n    );\n  }\n\n  // Empty state\n  if (!intelligenceData || intelligenceData.data.length === 0) {\n    return (\n      <div className=\"text-center py-12\" dir={isRTL ? 'rtl' : 'ltr'}>\n        <Lightbulb className=\"mx-auto h-12 w-12 text-gray-400 dark:text-gray-600\" />\n        <h3 className=\"mt-2 text-sm font-medium text-gray-900 dark:text-white\">\n          {t('intelligence.empty', 'No Intelligence Reports')}\n        </h3>\n        <p className=\"mt-1 text-sm text-gray-500 dark:text-gray-400\">\n          {t(\n            'intelligence.emptyDescription',\n            'No intelligence reports have been generated for this entity yet'\n          )}\n        </p>\n      </div>\n    );\n  }\n\n  // Sort intelligence by type: economic, political, security, bilateral\n  const typeOrder = ['economic', 'political', 'security', 'bilateral'];\n  const sortedIntelligence = [...intelligenceData.data].sort((a, b) => {\n    return typeOrder.indexOf(a.intelligence_type) - typeOrder.indexOf(b.intelligence_type);\n  });\n\n  return (\n    <div className=\"space-y-6\" dir={isRTL ? 'rtl' : 'ltr'}>\n      {/* Header with Refresh Button */}\n      <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3\">\n        <div>\n          <h2 className=\"text-lg sm:text-xl font-semibold text-foreground\">\n            {t('intelligence.title', 'Intelligence Reports')}\n          </h2>\n          <p className=\"text-sm text-muted-foreground mt-1\">\n            {t('intelligence.description', 'AI-generated intelligence insights from credible sources')}\n          </p>\n        </div>\n        <RefreshButton\n          intelligenceTypes={['economic', 'political', 'security', 'bilateral']}\n          onRefresh={handleRefresh}\n          isLoading={isRefreshing}\n          showTypeSelection={true}\n          className=\"w-full sm:w-auto\"\n        />\n      </div>\n\n      {/* Intelligence Reports Grid - Mobile First Responsive */}\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6\">\n        {sortedIntelligence.map((intelligence) => (\n          <IntelligenceCard\n            key={intelligence.id}\n            intelligence={intelligence}\n            showFullAnalysis={false}\n          />\n        ))}\n      </div>\n\n      {/* Metadata Summary */}\n      {intelligenceData.meta && (\n        <div className=\"flex flex-wrap gap-4 text-xs text-gray-600 dark:text-gray-400\">\n          <div>\n            <span className=\"font-medium\">{t('intelligence.totalReports', 'Total Reports')}:</span>{' '}\n            {intelligenceData.meta.total_count}\n          </div>\n          <div>\n            <span className=\"font-medium\">{t('intelligence.freshReports', 'Fresh')}:</span>{' '}\n            {intelligenceData.meta.fresh_count}\n          </div>\n          <div>\n            <span className=\"font-medium\">{t('intelligence.staleReports', 'Stale')}:</span>{' '}\n            {intelligenceData.meta.stale_count}\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n","/**\n * Dossier Detail Page (T039)\n *\n * Displays comprehensive dossier information with tabs\n * Components: DossierHeader, DossierStats, DossierTimeline, KeyContactsPanel, DossierActions\n * Tabs: Timeline (default), Positions, MoUs, Commitments, Files, Intelligence\n * Accessibility: Tab navigation, focus management\n */\n\nimport { createFileRoute, useNavigate } from '@tanstack/react-router'\nimport { useState } from 'react'\nimport { useTranslation } from 'react-i18next'\nimport { useDossier } from '../../../hooks/useDossier'\nimport { useArchiveDossier } from '../../../hooks/useArchiveDossier'\nimport { DossierHeader } from '../../../components/DossierHeader'\nimport { DossierStats } from '../../../components/DossierStats'\nimport { DossierActions } from '../../../components/DossierActions'\nimport { KeyContactsPanel } from '../../../components/KeyContactsPanel'\nimport { ConflictDialog } from '../../../components/ConflictDialog'\nimport { DossierPositionsTab } from '../../../components/positions/DossierPositionsTab'\nimport { RelationshipGraph } from '../../../components/dossiers/RelationshipGraph'\nimport { DossierMoUsTab } from '../../../components/dossiers/DossierMoUsTab'\nimport { DossierIntelligenceTab } from '../../../components/dossiers/DossierIntelligenceTab'\nimport { CountryTimeline } from '../../../components/timeline/CountryTimeline'\nimport { EngagementTimeline } from '../../../components/timeline/EngagementTimeline'\nimport { OrganizationTimeline } from '../../../components/timeline/OrganizationTimeline'\nimport { PersonTimeline } from '../../../components/timeline/PersonTimeline'\nimport type { ConflictError } from '../../../types/dossier'\n\n// Search params for tabs and filters\ninterface DossierDetailSearchParams {\n  tab?: string\n  event_type?: string\n}\n\nexport const Route = createFileRoute('/_protected/dossiers/$id')({\n  component: DossierDetailPage,\n  validateSearch: (search: Record<string, unknown>): DossierDetailSearchParams => {\n    return {\n      tab: search.tab as string | undefined,\n      event_type: search.event_type as string | undefined,\n    }\n  },\n})\n\ntype TabType =\n  | 'timeline'\n  | 'relationships'\n  | 'positions'\n  | 'mous'\n  | 'intelligence'\n  | 'contacts'\n  | 'commitments'\n  | 'files'\n\nfunction DossierDetailPage() {\n  const { t } = useTranslation('dossiers')\n  const navigate = useNavigate()\n  const { id } = Route.useParams()\n  const searchParams = Route.useSearch()\n\n  // Active tab state\n  const [activeTab, setActiveTab] = useState<TabType>((searchParams.tab as TabType) || 'timeline')\n\n  // Conflict dialog state (unused for now, but will be needed when edit functionality is added)\n  const [showConflictDialog, setShowConflictDialog] = useState(false)\n  const [conflictData] = useState<ConflictError | null>(null)\n\n  // Fetch dossier with includes\n  const {\n    data: dossier,\n    isLoading,\n    error,\n  } = useDossier(id, ['stats', 'owners', 'contacts', 'recent_briefs'])\n\n  // Mutations (updateMutation unused until edit functionality is added)\n  const archiveMutation = useArchiveDossier(id)\n\n  // Handlers\n  const handleEdit = () => {\n    // TODO: Open edit modal or navigate to edit page\n  }\n\n  const handleArchive = async () => {\n    if (!confirm(t('detail.confirm_archive'))) return\n\n    try {\n      await archiveMutation.mutateAsync()\n      navigate({ to: '/dossiers' })\n    } catch (error) {\n      console.error('Failed to archive dossier:', error)\n    }\n  }\n\n  const handleGenerateBrief = () => {\n    // TODO: Navigate to brief generation page when route is implemented\n  }\n\n  const handleTabChange = (tab: TabType) => {\n    setActiveTab(tab)\n    // Update URL to reflect active tab\n    navigate({\n      search: { tab } as any,\n      replace: true,\n    })\n  }\n\n  const handleConflictResolve = (resolution: 'keep-mine' | 'use-theirs' | 'cancel') => {\n    if (resolution === 'use-theirs') {\n      // Refresh the page to get latest data\n      window.location.reload()\n    } else if (resolution === 'keep-mine') {\n      // TODO: Keep local changes - retry with force flag\n    }\n    setShowConflictDialog(false)\n  }\n\n  const handleStatClick = (statType: 'engagements' | 'positions' | 'mous') => {\n    // Map stat types to their corresponding tabs and event filters\n    const tabMap: Record<typeof statType, TabType> = {\n      engagements: 'timeline',\n      positions: 'positions',\n      mous: 'mous',\n    }\n\n    const eventTypeMap: Record<typeof statType, string | undefined> = {\n      engagements: 'engagement',\n      positions: 'position',\n      mous: 'mou',\n    }\n\n    // Navigate to tab with event_type filter for timeline\n    const targetTab = tabMap[statType]\n    const eventType = eventTypeMap[statType]\n\n    setActiveTab(targetTab)\n    navigate({\n      search: {\n        tab: targetTab,\n        ...(targetTab === 'timeline' && eventType ? { event_type: eventType } : {}),\n      } as any,\n      replace: true,\n    })\n  }\n\n  // Loading state\n  if (isLoading) {\n    return (\n      <div className=\"min-h-screen bg-gray-50 dark:bg-gray-900\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\n          <div className=\"space-y-6\">\n            <div className=\"h-32 bg-gray-200 dark:bg-gray-700 rounded-lg animate-pulse\" />\n            <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n              <div className=\"lg:col-span-2 space-y-6\">\n                <div className=\"h-48 bg-gray-200 dark:bg-gray-700 rounded-lg animate-pulse\" />\n                <div className=\"h-96 bg-gray-200 dark:bg-gray-700 rounded-lg animate-pulse\" />\n              </div>\n              <div className=\"space-y-6\">\n                <div className=\"h-64 bg-gray-200 dark:bg-gray-700 rounded-lg animate-pulse\" />\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n  // Error state\n  if (error) {\n    const isNotFound = error instanceof Error && error.message === 'DOSSIER_NOT_FOUND'\n\n    return (\n      <div className=\"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center px-4\">\n        <div className=\"max-w-md w-full\">\n          <div\n            className=\"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-6\"\n            role=\"alert\"\n          >\n            <h2 className=\"text-lg font-medium text-red-800 dark:text-red-200\">\n              {isNotFound\n                ? t('detail.not_found_title', 'Dossier Not Found')\n                : t('detail.error_title', 'Error Loading Dossier')}\n            </h2>\n            <p className=\"mt-2 text-sm text-red-700 dark:text-red-300\">\n              {isNotFound\n                ? t(\n                    'detail.not_found_message',\n                    'The dossier you are looking for does not exist or may have been removed. This could be due to a data integrity issue where an assignment references a non-existent dossier.',\n                  )\n                : error instanceof Error\n                  ? error.message\n                  : t(\n                      'detail.error_generic',\n                      'An unexpected error occurred while loading the dossier.',\n                    )}\n            </p>\n            <div className=\"mt-4 flex flex-col sm:flex-row gap-2\">\n              <button\n                onClick={() => navigate({ to: '/my-work/waiting' })}\n                className=\"inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-red-700 bg-red-100 hover:bg-red-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500\"\n              >\n                {t('detail.back_to_waiting_queue', 'Back to Waiting Queue')}\n              </button>\n              <button\n                onClick={() => navigate({ to: '/dossiers' })}\n                className=\"inline-flex items-center justify-center px-4 py-2 border border-red-300 text-sm font-medium rounded-md text-red-700 bg-white hover:bg-red-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500\"\n              >\n                {t('detail.back_to_hub', 'Go to Dossiers')}\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n  if (!dossier) return null\n\n  // Check if dossier is a country type (intelligence only available for countries)\n  const isCountryDossier = dossier.type === 'country' || dossier.dossier_type === 'Country'\n\n  // Tab definitions\n  const tabs: Array<{ id: TabType; label: string; disabled?: boolean }> = [\n    { id: 'timeline', label: t('tabs.timeline') },\n    { id: 'relationships', label: t('tabs.relationships') },\n    { id: 'positions', label: t('tabs.positions') },\n    { id: 'mous', label: t('tabs.mous') },\n    // Intelligence tab only enabled for country dossiers\n    { id: 'intelligence', label: t('tabs.intelligence'), disabled: !isCountryDossier },\n    { id: 'contacts', label: t('tabs.contacts') },\n    { id: 'commitments', label: t('tabs.commitments'), disabled: true },\n    { id: 'files', label: t('tabs.files'), disabled: true },\n  ]\n\n  return (\n    <div className=\"min-h-screen bg-gray-50 dark:bg-gray-900\">\n      {/* Dossier Header */}\n      <DossierHeader\n        dossier={dossier}\n        onEdit={handleEdit}\n        onArchive={handleArchive}\n        onGenerateBrief={handleGenerateBrief}\n      />\n\n      {/* Main Content */}\n      <main className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\n        <div className=\"space-y-6\">\n          {/* Stats Cards */}\n          <div>\n            <DossierStats dossierId={id} onStatClick={handleStatClick} />\n          </div>\n\n          {/* Tabs Navigation - Mobile First Responsive */}\n          <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow\">\n            <div className=\"border-b border-gray-200 dark:border-gray-700\">\n              {/* Mobile: Horizontal Scrollable Tabs */}\n              <nav\n                className=\"-mb-px flex overflow-x-auto scrollbar-hide px-4 sm:px-6\"\n                aria-label={t('detail.tabs_label')}\n                role=\"tablist\"\n              >\n                {tabs.map((tab) => (\n                  <button\n                    key={tab.id}\n                    onClick={() => !tab.disabled && handleTabChange(tab.id)}\n                    disabled={tab.disabled}\n                    role=\"tab\"\n                    aria-selected={activeTab === tab.id}\n                    aria-controls={`${tab.id}-panel`}\n                    className={`\n flex-shrink-0 min-h-11 py-3 px-3 sm:px-4 md:px-6 border-b-2 font-medium text-xs sm:text-sm md:text-base\n transition-all duration-200 ease-in-out\n ${\n   activeTab === tab.id\n     ? 'border-blue-500 text-blue-600 dark:text-blue-400 bg-blue-50/50 dark:bg-blue-900/10'\n     : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700/50'\n }\n ${tab.disabled ? 'opacity-50 cursor-not-allowed' : 'cursor-pointer'}\n focus:outline-none focus:ring-2 focus:ring-inset focus:ring-blue-500 rounded-t-md\n `}\n                  >\n                    <span className=\"whitespace-nowrap\">{tab.label}</span>\n                  </button>\n                ))}\n              </nav>\n            </div>\n\n            {/* Tab Panels - Responsive Padding */}\n            <div className=\"p-4 sm:p-6\">\n              {/* Timeline Tab - Type-Specific Unified Timeline */}\n              {activeTab === 'timeline' && (\n                <div id=\"timeline-panel\" role=\"tabpanel\" aria-labelledby=\"timeline-tab\">\n                  {dossier.dossier_type === 'Country' && <CountryTimeline dossierId={id} />}\n                  {dossier.dossier_type === 'Organization' && (\n                    <OrganizationTimeline dossierId={id} />\n                  )}\n                  {dossier.dossier_type === 'Person' && <PersonTimeline dossierId={id} />}\n                  {dossier.dossier_type === 'Engagement' && <EngagementTimeline dossierId={id} />}\n                  {!['Country', 'Organization', 'Person', 'Engagement'].includes(\n                    dossier.dossier_type,\n                  ) && (\n                    <div className=\"text-center py-12 text-muted-foreground\">\n                      <p>\n                        {t(\n                          'timeline.not_supported',\n                          'Timeline not yet supported for this dossier type',\n                        )}\n                      </p>\n                    </div>\n                  )}\n                </div>\n              )}\n\n              {/* Relationships Tab */}\n              {activeTab === 'relationships' && (\n                <div id=\"relationships-panel\" role=\"tabpanel\" aria-labelledby=\"relationships-tab\">\n                  <RelationshipGraph dossierId={id} />\n                </div>\n              )}\n\n              {/* Positions Tab */}\n              {activeTab === 'positions' && (\n                <div id=\"positions-panel\" role=\"tabpanel\" aria-labelledby=\"positions-tab\">\n                  <DossierPositionsTab dossierId={id} />\n                </div>\n              )}\n\n              {/* MoUs Tab */}\n              {activeTab === 'mous' && (\n                <div id=\"mous-panel\" role=\"tabpanel\" aria-labelledby=\"mous-tab\">\n                  <DossierMoUsTab dossierId={id} />\n                </div>\n              )}\n\n              {/* Intelligence Tab - Only for Country Dossiers */}\n              {activeTab === 'intelligence' && (\n                <div id=\"intelligence-panel\" role=\"tabpanel\" aria-labelledby=\"intelligence-tab\">\n                  {isCountryDossier ? (\n                    <DossierIntelligenceTab dossierId={id} />\n                  ) : (\n                    <div className=\"text-center py-12 text-muted-foreground\">\n                      <p>\n                        {t(\n                          'intelligence.country_only',\n                          'Intelligence reports are only available for country dossiers',\n                        )}\n                      </p>\n                    </div>\n                  )}\n                </div>\n              )}\n\n              {/* Contacts Tab */}\n              {activeTab === 'contacts' && (\n                <div id=\"contacts-panel\" role=\"tabpanel\" aria-labelledby=\"contacts-tab\">\n                  <KeyContactsPanel dossierId={id} />\n                </div>\n              )}\n\n              {/* Other tabs - placeholder */}\n              {![\n                'timeline',\n                'relationships',\n                'positions',\n                'mous',\n                'intelligence',\n                'contacts',\n              ].includes(activeTab) && (\n                <div className=\"text-center py-12 text-gray-500 dark:text-gray-400\">\n                  <p>{t('detail.tab_coming_soon')}</p>\n                </div>\n              )}\n            </div>\n          </div>\n\n          {/* Actions Panel */}\n          <DossierActions dossierId={id} />\n        </div>\n      </main>\n\n      {/* Conflict Dialog - shown when edit conflicts occur */}\n      {showConflictDialog && conflictData && dossier && (\n        <ConflictDialog\n          open={showConflictDialog}\n          currentData={dossier}\n          remoteData={{} as any}\n          onResolve={handleConflictResolve}\n        />\n      )}\n    </div>\n  )\n}\n"],"names":["serializeFilters","filters","sorted","key","value","dossierKeys","id","includes","API_BASE_URL","getAuthHeaders","session","supabase","useArchiveDossier","dossierId","queryClient","useQueryClient","navigate","useNavigate","useMutation","headers","response","error","DossierHeader","dossier","onEdit","onArchive","onGenerateBrief","i18n","useTranslation","isRTL","name","handleLanguageToggle","newLang","switchLanguage","getSensitivityVariant","level","getTypeBadgeClass","type","jsxs","jsx","Badge","Button","Globe","FileText","DropdownMenu","DropdownMenuTrigger","MoreVertical","DropdownMenuContent","DropdownMenuItem","Edit","Archive","tag","index","useDossierStats","options","include","enabled","useQuery","getStats","StatCard","icon","label","iconColor","onClick","clickable","baseClasses","interactiveClasses","Component","DossierStats","onStatClick","t","stats","isLoading","isError","_","i","Skeleton","Alert","AlertCircle","AlertDescription","healthScore","hasHealthScore","handleCommitmentsClick","Calendar","Activity","CheckCircle","Card","CardHeader","CardTitle","TrendingUp","CardContent","Fragment","getHealthScoreColor","getHealthScoreLabel","Progress","ActionButton","variant","disabled","DossierActions","onAddEngagement","onAddPosition","onLogIntelligence","onUploadDocument","onAddContact","MessageSquare","Lightbulb","Upload","UserPlus","ConflictDialog","open","currentData","remoteData","onResolve","conflicts","currentValue","remoteValue","formatValue","getFieldLabel","field","Dialog","DialogContent","DialogHeader","DialogTitle","AlertTriangle","DialogDescription","conflict","DialogFooter","confidenceConfig","Info","CheckCircle2","ShieldCheck","sizeClasses","iconSizes","ConfidenceBadge","showIcon","size","config","Icon","getConfidenceLevel","confidenceScore","intelligenceIcons","Users","Shield","IntelligenceCard","intelligence","showFullAnalysis","locale","ar","enUS","isStale","title","content","lastUpdated","formatDistanceToNow","Clock","DossierIntelligenceTab","intelligenceData","useAllIntelligence","refreshIntelligence","isRefreshing","useRefreshIntelligence","data","typeLabels","r","toast","handleRefresh","types","typeOrder","sortedIntelligence","a","b","RefreshButton","DossierDetailPage","Route","useParams","searchParams","useSearch","activeTab","setActiveTab","useState","tab","showConflictDialog","setShowConflictDialog","conflictData","useDossier","archiveMutation","handleEdit","handleArchive","confirm","mutateAsync","to","console","handleGenerateBrief","handleTabChange","search","replace","handleConflictResolve","resolution","window","location","reload","handleStatClick","statType","tabMap","engagements","positions","mous","eventTypeMap","targetTab","eventType","event_type","isNotFound","Error","message","isCountryDossier","dossier_type","tabs","map","CountryTimeline","OrganizationTimeline","PersonTimeline","EngagementTimeline","RelationshipGraph","DossierPositionsTab","DossierMoUsTab","KeyContactsPanel"],"mappings":"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"}