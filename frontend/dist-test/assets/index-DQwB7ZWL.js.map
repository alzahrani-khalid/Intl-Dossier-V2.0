{"version":3,"file":"index-DQwB7ZWL.js","sources":["../../src/routes/_protected/dossiers/countries/index.tsx?tsr-split=component"],"sourcesContent":["/**\n * Countries List Page (Feature 028 - User Story 2)\n *\n * Displays filterable list of country dossiers.\n * Mobile-first, RTL-compatible, WCAG AA compliant.\n */\n\nimport { createFileRoute, Link } from '@tanstack/react-router';\nimport { useTranslation } from 'react-i18next';\nimport { Loader2, Plus, Globe2 } from 'lucide-react';\nimport { useDossiersByType } from '@/hooks/useDossier';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from '@/components/ui/table';\nimport { Badge } from '@/components/ui/badge';\nimport { useState } from 'react';\n\nexport const Route = createFileRoute('/_protected/dossiers/countries/')({\n  component: CountriesListPage,\n});\n\nfunction CountriesListPage() {\n  const { t, i18n } = useTranslation('dossier');\n  const isRTL = i18n.language === 'ar';\n\n  const [searchQuery, setSearchQuery] = useState('');\n  const [page, setPage] = useState(1);\n  const pageSize = 20;\n\n  // Fetch country dossiers\n  const { data, isLoading, error } = useDossiersByType('country', page, pageSize);\n\n  // Filter by search query (client-side for now)\n  const filteredDossiers = data?.data.filter((dossier) => {\n    if (!searchQuery) return true;\n    const searchLower = searchQuery.toLowerCase();\n    return (\n      dossier.name_en.toLowerCase().includes(searchLower) ||\n      dossier.name_ar?.toLowerCase().includes(searchLower) ||\n      dossier.description_en?.toLowerCase().includes(searchLower) ||\n      dossier.description_ar?.toLowerCase().includes(searchLower)\n    );\n  });\n\n  return (\n    <div\n      className=\"container mx-auto px-4 sm:px-6 lg:px-8 py-4 sm:py-6 lg:py-8\"\n      dir={isRTL ? 'rtl' : 'ltr'}\n    >\n      {/* Page Header */}\n      <header className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6 sm:mb-8\">\n        <div className=\"flex items-center gap-3\">\n          <Globe2 className=\"h-6 w-6 sm:h-8 sm:w-8 text-primary\" />\n          <div>\n            <h1 className=\"text-2xl sm:text-3xl md:text-4xl font-bold\">\n              {t('type.country')}\n            </h1>\n            <p className=\"text-sm sm:text-base text-muted-foreground mt-1\">\n              {t('typeDescription.country')}\n            </p>\n          </div>\n        </div>\n        <Button asChild>\n          <Link to=\"/dossiers/create\">\n            <Plus className=\"h-4 w-4 me-2\" />\n            {t('action.create')}\n          </Link>\n        </Button>\n      </header>\n\n      {/* Search Bar */}\n      <div className=\"mb-6\">\n        <Input\n          type=\"text\"\n          placeholder={t('filter.search')}\n          value={searchQuery}\n          onChange={(e) => setSearchQuery(e.target.value)}\n          className=\"max-w-md\"\n        />\n      </div>\n\n      {/* Loading State */}\n      {isLoading && (\n        <div className=\"flex items-center justify-center py-12 sm:py-16 lg:py-20\">\n          <Loader2 className=\"h-8 w-8 sm:h-10 sm:w-10 animate-spin text-muted-foreground\" />\n          <span className=\"ms-3 text-muted-foreground text-sm sm:text-base\">\n            {t('list.loading')}\n          </span>\n        </div>\n      )}\n\n      {/* Error State */}\n      {error && !isLoading && (\n        <div\n          className=\"bg-destructive/10 border border-destructive/20 rounded-lg p-4 sm:p-6\"\n          role=\"alert\"\n        >\n          <h3 className=\"text-base sm:text-lg font-semibold text-destructive mb-2\">\n            {t('list.error')}\n          </h3>\n          <p className=\"text-sm sm:text-base text-destructive/90\">\n            {error.message}\n          </p>\n        </div>\n      )}\n\n      {/* Empty State */}\n      {!isLoading && !error && filteredDossiers?.length === 0 && (\n        <div className=\"flex flex-col items-center justify-center py-12 sm:py-16 lg:py-20 text-center\">\n          <Globe2 className=\"h-12 w-12 sm:h-16 sm:w-16 text-muted-foreground mb-4\" />\n          <h3 className=\"text-base sm:text-lg font-semibold mb-2\">\n            {searchQuery ? t('list.emptyFiltered') : t('list.empty')}\n          </h3>\n          <p className=\"text-sm sm:text-base text-muted-foreground max-w-md mb-6\">\n            {searchQuery\n              ? t('list.emptyFilteredDescription')\n              : t('list.emptyDescription')}\n          </p>\n          {!searchQuery && (\n            <Button asChild>\n              <Link to=\"/dossiers/create\">\n                {t('action.create')}\n              </Link>\n            </Button>\n          )}\n        </div>\n      )}\n\n      {/* Table - Desktop */}\n      {!isLoading && !error && filteredDossiers && filteredDossiers.length > 0 && (\n        <>\n          <div className=\"hidden md:block rounded-lg border overflow-hidden\">\n            <Table>\n              <TableHeader>\n                <TableRow>\n                  <TableHead>{t('form.nameEn')}</TableHead>\n                  <TableHead>{t('form.nameAr')}</TableHead>\n                  <TableHead>{t('form.status')}</TableHead>\n                  <TableHead>{t('form.sensitivityLevel')}</TableHead>\n                  <TableHead className=\"text-end\">{t('action.more')}</TableHead>\n                </TableRow>\n              </TableHeader>\n              <TableBody>\n                {filteredDossiers.map((dossier) => (\n                  <TableRow key={dossier.id}>\n                    <TableCell className=\"font-medium\">\n                      <Link\n                        to={`/dossiers/countries/${dossier.id}`}\n                        className=\"hover:text-primary hover:underline\"\n                      >\n                        {dossier.name_en}\n                      </Link>\n                    </TableCell>\n                    <TableCell>{dossier.name_ar}</TableCell>\n                    <TableCell>\n                      <Badge variant={dossier.status === 'active' ? 'default' : 'secondary'}>\n                        {t(`status.${dossier.status}`)}\n                      </Badge>\n                    </TableCell>\n                    <TableCell>\n                      <Badge variant=\"outline\">\n                        {t(`sensitivityLevel.${dossier.sensitivity_level}`)}\n                      </Badge>\n                    </TableCell>\n                    <TableCell className=\"text-end\">\n                      <Button variant=\"ghost\" size=\"sm\" asChild>\n                        <Link to={`/dossiers/countries/${dossier.id}`}>\n                          {t('action.view')}\n                        </Link>\n                      </Button>\n                    </TableCell>\n                  </TableRow>\n                ))}\n              </TableBody>\n            </Table>\n          </div>\n\n          {/* Card List - Mobile */}\n          <div className=\"md:hidden space-y-4\">\n            {filteredDossiers.map((dossier) => (\n              <Link\n                key={dossier.id}\n                to={`/dossiers/countries/${dossier.id}`}\n                className=\"block p-4 rounded-lg border bg-card hover:bg-accent transition-colors\"\n              >\n                <div className=\"flex items-start justify-between gap-3 mb-3\">\n                  <h3 className=\"font-semibold text-base\">\n                    {isRTL ? dossier.name_ar : dossier.name_en}\n                  </h3>\n                  <Badge variant={dossier.status === 'active' ? 'default' : 'secondary'}>\n                    {t(`status.${dossier.status}`)}\n                  </Badge>\n                </div>\n                {(isRTL ? dossier.description_ar : dossier.description_en) && (\n                  <p className=\"text-sm text-muted-foreground mb-3 line-clamp-2\">\n                    {isRTL ? dossier.description_ar : dossier.description_en}\n                  </p>\n                )}\n                <div className=\"flex items-center gap-2\">\n                  <Badge variant=\"outline\" className=\"text-xs\">\n                    {t(`sensitivityLevel.${dossier.sensitivity_level}`)}\n                  </Badge>\n                </div>\n              </Link>\n            ))}\n          </div>\n\n          {/* Pagination */}\n          {data && data.total > pageSize && (\n            <div className=\"mt-8 flex items-center justify-between\">\n              <Button\n                variant=\"outline\"\n                disabled={page === 1}\n                onClick={() => setPage((p) => Math.max(1, p - 1))}\n              >\n                {t('action.back')}\n              </Button>\n              <span className=\"text-sm text-muted-foreground\">\n                {t('list.pageInfo', {\n                  current: page,\n                  total: Math.ceil(data.total / pageSize),\n                })}\n              </span>\n              <Button\n                variant=\"outline\"\n                disabled={page * pageSize >= data.total}\n                onClick={() => setPage((p) => p + 1)}\n              >\n                {t('action.next')}\n              </Button>\n            </div>\n          )}\n        </>\n      )}\n    </div>\n  );\n}\n"],"names":["CountriesListPage","t","i18n","useTranslation","isRTL","language","searchQuery","setSearchQuery","useState","page","setPage","pageSize","data","isLoading","error","useDossiersByType","filteredDossiers","filter","dossier","searchLower","toLowerCase","name_en","includes","name_ar","description_en","description_ar","jsxs","jsx","Globe2","Button","Link","Plus","Input","e","target","value","Loader2","message","length","Fragment","Table","TableHeader","TableRow","TableHead","TableBody","map","TableCell","id","Badge","status","sensitivity_level","total","Math","max","p","current","ceil"],"mappings":"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"}