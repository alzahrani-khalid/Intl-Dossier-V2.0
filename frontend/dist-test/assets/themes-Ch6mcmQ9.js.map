{"version":3,"file":"themes-Ch6mcmQ9.js","sources":["../../src/pages/Themes.tsx","../../src/routes/_protected/themes.tsx?tsr-split=component"],"sourcesContent":["import { useMemo, useState } from 'react'\nimport { useTranslation } from 'react-i18next'\nimport { Button } from '@/components/ui/button'\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Input } from '@/components/ui/input'\nimport { FileText, Target, Plus, Loader2, ShieldAlert } from 'lucide-react'\nimport { useDossiersByType } from '@/hooks/useDossier'\n\nexport default function Themes() {\n const { t, i18n } = useTranslation()\n const [searchTerm, setSearchTerm] = useState('')\n const [scopeFilter, setScopeFilter] = useState<string>('all')\n const [statusFilter, setStatusFilter] = useState<'all' | 'active' | 'inactive' | 'archived'>('all')\n\n // Query themes from unified dossiers table\n const { data, isLoading, isError, error } = useDossiersByType('theme', 1, 1000)\n\n const filteredThemes = useMemo(() => {\n if (!data?.data) return []\n\n return data.data.filter((dossier) => {\n const theme = dossier.extension_data\n\n // Search filter\n const matchesSearch = [dossier.name_en, dossier.name_ar]\n .filter(Boolean)\n .join(' ')\n .toLowerCase()\n .includes(searchTerm.toLowerCase())\n\n // Scope filter\n const matchesScope = scopeFilter === 'all' || theme?.scope === scopeFilter\n\n // Status filter\n const matchesStatus = statusFilter === 'all' || dossier.status === statusFilter\n\n return matchesSearch && matchesScope && matchesStatus\n })\n }, [data, searchTerm, scopeFilter, statusFilter])\n\n const activeCount = filteredThemes.filter((t) => t.status === 'active').length\n const totalEngagements = filteredThemes.reduce((acc, curr) => {\n const engagements = curr.extension_data?.related_engagements_count || 0\n return acc + engagements\n }, 0)\n\n const isRTL = i18n.dir() === 'rtl'\n\n // Loading state\n if (isLoading) {\n return (\n <div className=\"flex min-h-96 items-center justify-center\">\n <Loader2 className=\"size-8 animate-spin text-primary\" />\n </div>\n )\n }\n\n // Error state\n if (isError) {\n return (\n <div className=\"flex min-h-96 flex-col items-center justify-center gap-4\">\n <ShieldAlert className=\"size-12 text-destructive\" />\n <div className=\"text-center\">\n <h2 className=\"text-xl font-semibold text-foreground\">\n {t('themes.error.title', 'Failed to load themes')}\n </h2>\n <p className=\"text-sm text-muted-foreground\">\n {error?.message || t('themes.error.message', 'An error occurred while fetching data')}\n </p>\n </div>\n </div>\n )\n }\n\n return (\n <div className=\"space-y-6\">\n <header className=\"flex flex-col gap-2\">\n <div className=\"flex flex-wrap items-center justify-between gap-3\">\n <div>\n <h1 className=\"font-display text-3xl font-semibold text-foreground\">\n {t('themes.title', 'Strategic Themes')}\n </h1>\n <p className=\"text-base text-muted-foreground\">\n {t(\n 'themes.subtitle',\n 'Track cross-cutting strategic themes across engagements, working groups, and partnerships.'\n )}\n </p>\n </div>\n <Button size=\"sm\" className=\"gap-2\">\n <Plus className=\"size-4\" />\n {t('themes.actions.addTheme', 'Add new theme')}\n </Button>\n </div>\n </header>\n\n <section className=\"grid gap-4 sm:grid-cols-2 2xl:grid-cols-3\">\n <Card>\n <CardHeader className=\"flex flex-row items-center justify-between\">\n <CardTitle className=\"text-sm font-semibold text-card-foreground\">\n {t('themes.metrics.activeThemes', 'Active themes')}\n </CardTitle>\n <Target className=\"size-5 text-primary\" />\n </CardHeader>\n <CardContent>\n <p className=\"text-2xl font-bold text-foreground\">{activeCount}</p>\n <p className=\"mt-2 text-sm text-muted-foreground\">\n {t('themes.metrics.activeThemesHint', 'Currently tracked strategic priorities')}\n </p>\n </CardContent>\n </Card>\n <Card>\n <CardHeader className=\"flex flex-row items-center justify-between\">\n <CardTitle className=\"text-sm font-semibold text-card-foreground\">\n {t('themes.metrics.linkedEngagements', 'Linked engagements')}\n </CardTitle>\n <FileText className=\"size-5 text-primary\" />\n </CardHeader>\n <CardContent>\n <p className=\"text-2xl font-bold text-foreground\">{totalEngagements}</p>\n <p className=\"mt-2 text-sm text-muted-foreground\">\n {t('themes.metrics.linkedEngagementsHint', 'Engagements aligned with themes')}\n </p>\n </CardContent>\n </Card>\n </section>\n\n <Card>\n <CardHeader>\n <CardTitle>{t('themes.filters.title', 'Filters & search')}</CardTitle>\n </CardHeader>\n <CardContent className=\"flex flex-col gap-4 lg:flex-row lg:items-end\">\n <div className=\"flex-1\">\n <label className=\"mb-1 block text-sm font-medium text-foreground\">\n {t('themes.filters.search', 'Search by name')}\n </label>\n <Input\n value={searchTerm}\n onChange={(event) => setSearchTerm(event.target.value)}\n placeholder={t('themes.filters.searchPlaceholder', 'e.g. Digital Transformation, AI')}\n />\n </div>\n <div>\n <label className=\"mb-1 block text-sm font-medium text-foreground\">\n {t('themes.filters.scope', 'Scope')}\n </label>\n <select\n value={scopeFilter}\n onChange={(event) => setScopeFilter(event.target.value)}\n className=\"w-48 rounded-md border border-input bg-background px-3 py-2 text-sm text-foreground shadow-sm focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/20\"\n dir={isRTL ? 'rtl' : 'ltr'}\n >\n <option value=\"all\">{t('themes.filters.allScopes', 'All scopes')}</option>\n <option value=\"global\">{t('themes.scope.global', 'Global')}</option>\n <option value=\"regional\">{t('themes.scope.regional', 'Regional')}</option>\n <option value=\"bilateral\">{t('themes.scope.bilateral', 'Bilateral')}</option>\n <option value=\"internal\">{t('themes.scope.internal', 'Internal')}</option>\n </select>\n </div>\n <div>\n <label className=\"mb-1 block text-sm font-medium text-foreground\">\n {t('themes.filters.status', 'Status')}\n </label>\n <select\n value={statusFilter}\n onChange={(event) => setStatusFilter(event.target.value as typeof statusFilter)}\n className=\"w-44 rounded-md border border-input bg-background px-3 py-2 text-sm text-foreground shadow-sm focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/20\"\n dir={isRTL ? 'rtl' : 'ltr'}\n >\n <option value=\"all\">{t('themes.filters.allStatuses', 'All statuses')}</option>\n <option value=\"active\">{t('themes.status.active', 'Active')}</option>\n <option value=\"inactive\">{t('themes.status.inactive', 'Inactive')}</option>\n <option value=\"archived\">{t('themes.status.archived', 'Archived')}</option>\n </select>\n </div>\n </CardContent>\n </Card>\n\n <div className=\"overflow-x-auto rounded-xl border border-border bg-card shadow-sm\">\n <table className=\"min-w-full divide-y divide-border text-sm\">\n <thead>\n <tr className=\"bg-muted/50 text-start text-xs font-semibold uppercase tracking-wide text-muted-foreground\">\n <th className=\"px-5 py-3 text-start\">{t('themes.table.theme', 'Theme')}</th>\n <th className=\"px-5 py-3 text-start\">{t('themes.table.scope', 'Scope')}</th>\n <th className=\"px-5 py-3 text-start\">{t('themes.table.priority', 'Priority')}</th>\n <th className=\"px-5 py-3 text-start\">{t('themes.table.status', 'Status')}</th>\n <th className=\"px-5 py-3 text-start\">{t('themes.table.engagements', 'Engagements')}</th>\n <th className=\"px-5 py-3 text-start\">{t('themes.table.updated', 'Last updated')}</th>\n </tr>\n </thead>\n <tbody className=\"divide-y divide-border\">\n {filteredThemes.map((dossier) => {\n const theme = dossier.extension_data\n return (\n <tr key={dossier.id} className=\"hover:bg-accent/50\">\n <td className=\"px-5 py-4\">\n <div className=\"flex flex-col\">\n <span className=\"font-semibold text-foreground\">{dossier.name_en}</span>\n <span className=\"text-xs text-muted-foreground\">{dossier.name_ar}</span>\n </div>\n </td>\n <td className=\"px-5 py-4 text-muted-foreground\">\n {theme?.scope ? t(`themes.scope.${theme.scope}`, theme.scope) : 'â€”'}\n </td>\n <td className=\"px-5 py-4\">\n <span\n className={`inline-flex items-center rounded-full px-3 py-1 text-xs font-semibold ${\n theme?.priority === 'high'\n ? 'bg-destructive/10 text-destructive'\n : theme?.priority === 'medium'\n ? 'bg-warning/10 text-warning'\n : 'bg-muted text-muted-foreground'\n }`}\n >\n {theme?.priority\n ? t(`themes.priority.${theme.priority}`, theme.priority)\n : t('themes.priority.notSet', 'Not set')}\n </span>\n </td>\n <td className=\"px-5 py-4\">\n <span\n className={`inline-flex items-center rounded-full px-3 py-1 text-xs font-semibold ${\n dossier.status === 'active'\n ? 'bg-primary/10 text-primary'\n : dossier.status === 'inactive'\n ? 'bg-muted text-muted-foreground'\n : 'bg-secondary/10 text-secondary-foreground'\n }`}\n >\n {t(`themes.status.${dossier.status}`, dossier.status)}\n </span>\n </td>\n <td className=\"px-5 py-4 text-foreground\">\n {theme?.related_engagements_count || 0}\n </td>\n <td className=\"px-5 py-4 text-xs text-muted-foreground\">\n {new Date(dossier.updated_at).toLocaleDateString()}\n </td>\n </tr>\n )\n })}\n {filteredThemes.length === 0 && (\n <tr>\n <td colSpan={6} className=\"px-5 py-8 text-center text-sm text-muted-foreground\">\n {t('themes.table.empty', 'No themes match the current filters')}\n </td>\n </tr>\n )}\n </tbody>\n </table>\n </div>\n </div>\n )\n}\n","import { createFileRoute } from '@tanstack/react-router'\nimport Themes from '../../pages/Themes'\n\nexport const Route = createFileRoute('/_protected/themes')({\n component: Themes,\n})\n"],"names":["Themes","i18n","useTranslation","searchTerm","setSearchTerm","useState","scopeFilter","setScopeFilter","statusFilter","setStatusFilter","data","isLoading","isError","error","useDossiersByType","filteredThemes","useMemo","dossier","theme","matchesSearch","matchesScope","matchesStatus","activeCount","t","totalEngagements","acc","curr","engagements","isRTL","jsx","Loader2","jsxs","ShieldAlert","Button","Plus","Card","CardHeader","CardTitle","Target","CardContent","FileText","Input","event","SplitComponent"],"mappings":"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"}