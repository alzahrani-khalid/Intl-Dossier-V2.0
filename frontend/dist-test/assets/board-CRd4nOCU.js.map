{"version":3,"file":"board-CRd4nOCU.js","sources":["../../src/components/unified-kanban/UnifiedKanbanBoard.tsx","../../src/routes/_protected/my-work/board.tsx?tsr-split=component"],"sourcesContent":["/**\n * UnifiedKanbanBoard - Main Kanban board using Kibo UI pattern\n * Feature: 034-unified-kanban\n *\n * Supports:\n * - Three context types: personal, dossier, engagement\n * - Three column modes: status, priority, tracking_type\n * - Drag and drop with validation (powered by dnd-kit)\n * - Real-time updates\n * - Mobile-first responsive design\n * - RTL support for Arabic\n */\n\nimport { useState, useCallback, useMemo } from 'react'\nimport { useTranslation } from 'react-i18next'\nimport type { UniqueIdentifier } from '@dnd-kit/core'\nimport { cn } from '@/lib/utils'\nimport { useToast } from '@/hooks/use-toast'\nimport {\n  KanbanProvider,\n  KanbanBoard,\n  KanbanColumn,\n  KanbanCard,\n  KanbanEmpty,\n  type KanbanColumn as KanbanColumnType,\n} from '@/components/ui/kanban'\nimport { UnifiedKanbanHeader } from './UnifiedKanbanHeader'\nimport { UnifiedKanbanCardContent, UnifiedKanbanCardSkeleton } from './UnifiedKanbanCard'\nimport { getColumnsForMode, getColumnOrder } from './utils/column-definitions'\nimport {\n  canDropInColumn,\n  getTransitionErrorMessage,\n  getUpdatePayload,\n} from './utils/status-transitions'\nimport type {\n  UnifiedKanbanBoardProps,\n  WorkItem,\n  KanbanColumnMode,\n  WorkSource,\n  KanbanColumn as ColumnDefinition,\n} from '@/types/work-item.types'\n\ninterface BoardProps extends UnifiedKanbanBoardProps {\n  items?: WorkItem[]\n  isLoading?: boolean\n  isError?: boolean\n  onStatusChange?: (\n    itemId: string,\n    source: WorkSource,\n    newStatus: string,\n    workflowStage?: string,\n  ) => Promise<void>\n  onRefresh?: () => void\n  isRefreshing?: boolean\n}\n\nexport function UnifiedKanbanBoard({\n  contextType: _contextType,\n  contextId: _contextId,\n  columnMode: initialColumnMode = 'status',\n  sourceFilter: initialSourceFilter = [],\n  showFilters = true,\n  showModeSwitch = true,\n  onItemClick,\n  className,\n  items = [],\n  isLoading = false,\n  isError = false,\n  onStatusChange,\n  onRefresh,\n  isRefreshing = false,\n}: BoardProps) {\n  const { t, i18n } = useTranslation('unified-kanban')\n  const isRTL = i18n.language === 'ar'\n  const { toast } = useToast()\n\n  // State\n  const [columnMode, setColumnMode] = useState<KanbanColumnMode>(initialColumnMode)\n  const [sourceFilter, setSourceFilter] = useState<WorkSource[]>(initialSourceFilter)\n\n  // Get column definitions\n  const columnDefinitions = useMemo(() => getColumnsForMode(columnMode), [columnMode])\n  const columnOrder = useMemo(() => getColumnOrder(columnMode, isRTL), [columnMode, isRTL])\n\n  // Filter items by source\n  const filteredItems = useMemo(() => {\n    if (sourceFilter.length === 0) return items\n    return items.filter((item) => sourceFilter.includes(item.source))\n  }, [items, sourceFilter])\n\n  // Map column_key from database to frontend column key\n  // (handles migration from 'pending' to 'todo')\n  const mapColumnKey = (columnKey: string): string => {\n    if (columnKey === 'pending') return 'todo'\n    return columnKey\n  }\n\n  // Convert to kanban columns format\n  const kanbanColumns = useMemo((): KanbanColumnType<WorkItem>[] => {\n    return columnOrder.map((columnKey) => {\n      const columnDef = columnDefinitions.find((c) => c.key === columnKey) as ColumnDefinition\n      const columnItems = filteredItems.filter((item) => {\n        const itemColumnKey = mapColumnKey(item.column_key || 'todo')\n        return itemColumnKey === columnKey\n      })\n\n      return {\n        id: columnKey,\n        title: columnDef?.title || columnKey,\n        items: columnItems,\n      }\n    })\n  }, [columnOrder, columnDefinitions, filteredItems])\n\n  // Track columns state for DnD\n  const [columns, setColumns] = useState(kanbanColumns)\n\n  // Sync columns when kanbanColumns changes (from props)\n  useMemo(() => {\n    setColumns(kanbanColumns)\n  }, [kanbanColumns])\n\n  // Calculate counts\n  const totalCount = filteredItems.length\n  const overdueCount = filteredItems.filter((item) => item.is_overdue).length\n\n  // Handle drag end - validate and update status\n  const handleDragEnd = useCallback(\n    async (\n      itemId: UniqueIdentifier,\n      sourceColumnId: UniqueIdentifier,\n      targetColumnId: UniqueIdentifier,\n    ) => {\n      if (!onStatusChange) return\n\n      const item = filteredItems.find((i) => i.id === itemId)\n      if (!item) return\n\n      const targetColumnKey = targetColumnId as string\n\n      // Validate the transition\n      const canDrop = canDropInColumn(\n        item.source,\n        item.status,\n        item.workflow_stage,\n        targetColumnKey,\n      )\n\n      if (!canDrop) {\n        const errorMsg = getTransitionErrorMessage(\n          item.source,\n          item.column_key,\n          targetColumnKey,\n          isRTL ? 'ar' : 'en',\n        )\n\n        toast({\n          title: t('errors.invalidTransition', { column: targetColumnKey }),\n          description: errorMsg,\n          variant: 'destructive',\n        })\n\n        // Revert the columns state\n        setColumns(kanbanColumns)\n        return\n      }\n\n      // Get the update payload\n      const { status, workflow_stage } = getUpdatePayload(item.source, targetColumnKey)\n\n      try {\n        await onStatusChange(item.id, item.source, status!, workflow_stage)\n        toast({\n          title: t('success.statusUpdated'),\n          description: t('success.statusUpdatedDescription'),\n        })\n      } catch (error) {\n        toast({\n          title: t('errors.updateFailed'),\n          description: t('errors.updateFailedDescription'),\n          variant: 'destructive',\n        })\n        // Revert the columns state\n        setColumns(kanbanColumns)\n      }\n    },\n    [onStatusChange, filteredItems, isRTL, toast, t, kanbanColumns],\n  )\n\n  // Handle item click\n  const handleItemClick = useCallback(\n    (item: WorkItem) => {\n      if (onItemClick) {\n        onItemClick(item)\n      }\n    },\n    [onItemClick],\n  )\n\n  // Render overlay for dragging\n  const renderOverlay = useCallback((activeItem: WorkItem | null) => {\n    if (!activeItem) return null\n    return (\n      <div className=\"rounded-lg border bg-card p-3 shadow-lg cursor-grabbing min-w-[280px]\">\n        <UnifiedKanbanCardContent item={activeItem} />\n      </div>\n    )\n  }, [])\n\n  // Error state\n  if (isError) {\n    return (\n      <div className=\"flex flex-col items-center justify-center h-96 text-center\">\n        <p className=\"text-lg text-muted-foreground mb-4\">{t('errors.loadFailed')}</p>\n        <p className=\"text-sm text-muted-foreground mb-4\">{t('errors.loadFailedDescription')}</p>\n        {onRefresh && (\n          <button onClick={onRefresh} className=\"text-primary hover:underline\">\n            {t('actions.retry')}\n          </button>\n        )}\n      </div>\n    )\n  }\n\n  return (\n    <div className={cn('flex flex-col h-full', className)} dir={isRTL ? 'rtl' : 'ltr'}>\n      {/* Header */}\n      <UnifiedKanbanHeader\n        columnMode={columnMode}\n        onColumnModeChange={setColumnMode}\n        sourceFilter={sourceFilter}\n        onSourceFilterChange={setSourceFilter}\n        showFilters={showFilters}\n        showModeSwitch={showModeSwitch}\n        showViewToggle={false}\n        isRefreshing={isRefreshing}\n        onRefresh={onRefresh}\n        totalCount={totalCount}\n        overdueCount={overdueCount}\n      />\n\n      {/* Board */}\n      <div\n        className={cn(\n          'flex-1 overflow-x-auto overflow-y-hidden',\n          'px-4 sm:px-6 py-4',\n          'bg-muted/20',\n        )}\n      >\n        {isLoading ? (\n          // Loading skeletons\n          <KanbanBoard id=\"loading\" data={[]}>\n            {[1, 2, 3, 4].map((i) => (\n              <div\n                key={i}\n                className=\"flex flex-col rounded-lg border bg-muted/30 w-full sm:w-[300px] sm:min-w-[300px] h-[500px]\"\n              >\n                <div className=\"flex items-center justify-between p-3 border-b bg-muted/50\">\n                  <div className=\"h-5 w-20 bg-muted rounded animate-pulse\" />\n                  <div className=\"h-5 w-6 bg-muted rounded-full animate-pulse\" />\n                </div>\n                <div className=\"flex-1 p-2 space-y-2\">\n                  <UnifiedKanbanCardSkeleton />\n                  <UnifiedKanbanCardSkeleton />\n                  <UnifiedKanbanCardSkeleton />\n                </div>\n              </div>\n            ))}\n          </KanbanBoard>\n        ) : (\n          <KanbanProvider<WorkItem>\n            columns={columns}\n            onColumnsChange={setColumns}\n            onDragEnd={handleDragEnd}\n            renderOverlay={renderOverlay}\n          >\n            <KanbanBoard id=\"unified-kanban\" data={filteredItems}>\n              {columnOrder.map((columnKey) => {\n                const columnDef = columnDefinitions.find(\n                  (c) => c.key === columnKey,\n                ) as ColumnDefinition\n                const column = columns.find((c) => c.id === columnKey)\n                const columnItems = column?.items || []\n\n                return (\n                  <KanbanColumn<WorkItem>\n                    key={columnKey}\n                    id={columnKey}\n                    title={columnDef?.title || columnKey}\n                    titleAr={columnDef?.titleAr}\n                    items={columnItems}\n                    isRTL={isRTL}\n                    className={columnDef?.bgColor}\n                    headerClassName={cn(columnDef?.bgColor, columnDef?.color)}\n                  >\n                    {columnItems.length === 0 ? (\n                      <KanbanEmpty\n                        message={t('empty.noItemsInColumn')}\n                        subMessage={t('empty.dragHere')}\n                      />\n                    ) : (\n                      columnItems.map((item) => (\n                        <KanbanCard\n                          key={item.id}\n                          id={item.id}\n                          onClick={() => handleItemClick(item)}\n                          className={item.is_overdue ? 'border-red-200 bg-red-50/50' : ''}\n                        >\n                          <UnifiedKanbanCardContent item={item} />\n                        </KanbanCard>\n                      ))\n                    )}\n                  </KanbanColumn>\n                )\n              })}\n            </KanbanBoard>\n          </KanbanProvider>\n        )}\n      </div>\n\n      {/* Empty state */}\n      {!isLoading && filteredItems.length === 0 && (\n        <div className=\"absolute inset-0 flex flex-col items-center justify-center pointer-events-none\">\n          <div className=\"text-center p-8\">\n            <p className=\"text-lg font-medium text-muted-foreground mb-2\">{t('empty.noItems')}</p>\n            <p className=\"text-sm text-muted-foreground\">{t('empty.noItemsDescription')}</p>\n          </div>\n        </div>\n      )}\n    </div>\n  )\n}\n","/**\n * Feature 034: Unified Kanban Board - My Work Board View\n *\n * Kanban board view of the unified work items:\n * - Tasks (from tasks table)\n * - Commitments (from aa_commitments)\n * - Intake Tickets (from intake_tickets)\n *\n * Features:\n * - Drag and drop between columns\n * - Multiple column modes (Status, Priority, Tracking Type)\n * - Source filtering (Task, Commitment, Intake)\n * - Real-time updates\n * - Mobile-first, RTL-compatible design\n */\n\nimport { createFileRoute, useNavigate } from '@tanstack/react-router'\nimport { z } from 'zod'\nimport { useTranslation } from 'react-i18next'\nimport { useCallback } from 'react'\nimport { useAuth } from '@/hooks/useAuth'\nimport {\n  useUnifiedKanban,\n  useUnifiedKanbanStatusUpdate,\n  useUnifiedKanbanRealtime,\n} from '@/hooks/useUnifiedKanban'\nimport { UnifiedKanbanBoard } from '@/components/unified-kanban'\nimport { Button } from '@/components/ui/button'\nimport { List } from 'lucide-react'\nimport { cn } from '@/lib/utils'\nimport type { KanbanColumnMode, WorkSource, WorkItem } from '@/types/work-item.types'\n\n// URL search params schema\nconst boardSearchSchema = z.object({\n  mode: z.enum(['status', 'priority', 'tracking_type']).optional().default('status'),\n  sources: z\n    .string()\n    .optional()\n    .transform((val) => (val ? (val.split(',') as WorkSource[]) : undefined)),\n})\n\nexport type BoardSearchParams = z.infer<typeof boardSearchSchema>\n\nexport const Route = createFileRoute('/_protected/my-work/board')({\n  component: MyWorkBoardPage,\n  validateSearch: (search) => boardSearchSchema.parse(search),\n})\n\nfunction MyWorkBoardPage() {\n  const { t, i18n } = useTranslation('unified-kanban')\n  const isRTL = i18n.language === 'ar'\n  const navigate = useNavigate()\n  const { user } = useAuth()\n  const { mode, sources } = Route.useSearch()\n\n  // Parse sources from URL\n  const sourceFilter = sources as WorkSource[] | undefined\n\n  // Fetch kanban data\n  const { items, columns, totalCount, isLoading, isError, refetch, isRefetching } =\n    useUnifiedKanban({\n      contextType: 'personal',\n      columnMode: mode as KanbanColumnMode,\n      sourceFilter,\n    })\n\n  // Status update mutation\n  const statusMutation = useUnifiedKanbanStatusUpdate()\n\n  // Real-time updates\n  useUnifiedKanbanRealtime('personal', null, user?.id || '', !!user)\n\n  // Handle column mode change\n  const handleColumnModeChange = useCallback(\n    (newMode: KanbanColumnMode) => {\n      navigate({\n        to: '/my-work/board',\n        search: { mode: newMode, sources: sourceFilter?.join(',') },\n      })\n    },\n    [navigate, sourceFilter],\n  )\n\n  // Handle source filter change\n  const handleSourceFilterChange = useCallback(\n    (newSources: WorkSource[]) => {\n      navigate({\n        to: '/my-work/board',\n        search: {\n          mode: mode as KanbanColumnMode,\n          sources: newSources.length > 0 ? newSources.join(',') : undefined,\n        },\n      })\n    },\n    [navigate, mode],\n  )\n\n  // Handle status change from drag and drop\n  const handleStatusChange = useCallback(\n    async (itemId: string, source: WorkSource, newStatus: string, workflowStage?: string) => {\n      await statusMutation.mutateAsync({\n        itemId,\n        source,\n        newStatus,\n        newWorkflowStage: workflowStage,\n      })\n    },\n    [statusMutation],\n  )\n\n  // Handle item click - navigate to detail page\n  const handleItemClick = useCallback(\n    (item: WorkItem) => {\n      switch (item.source) {\n        case 'task':\n          navigate({ to: '/my-work/assignments' })\n          break\n        case 'commitment':\n          // Navigate to commitment detail if exists\n          break\n        case 'intake':\n          navigate({ to: '/my-work/intake' })\n          break\n      }\n    },\n    [navigate],\n  )\n\n  // Navigate to list view\n  const handleSwitchToList = useCallback(() => {\n    navigate({ to: '/my-work' })\n  }, [navigate])\n\n  return (\n    <div className=\"flex flex-col h-full\" dir={isRTL ? 'rtl' : 'ltr'}>\n      {/* Top bar with view toggle */}\n      <div className=\"flex items-center justify-between px-4 sm:px-6 py-2 border-b bg-background\">\n        <div className=\"flex items-center gap-2\">\n          <h1 className=\"text-lg font-semibold\">{t('context.personal')}</h1>\n        </div>\n        <Button\n          variant=\"outline\"\n          size=\"sm\"\n          onClick={handleSwitchToList}\n          className=\"flex items-center gap-2\"\n        >\n          <List className=\"h-4 w-4\" />\n          <span className=\"hidden sm:inline\">{t('viewModes.list')}</span>\n        </Button>\n      </div>\n\n      {/* Kanban Board */}\n      <div className=\"flex-1 overflow-hidden\">\n        <UnifiedKanbanBoard\n          contextType=\"personal\"\n          columnMode={mode as KanbanColumnMode}\n          sourceFilter={sourceFilter}\n          items={items}\n          isLoading={isLoading}\n          isError={isError}\n          onStatusChange={handleStatusChange}\n          onItemClick={handleItemClick}\n          onRefresh={() => refetch()}\n          isRefreshing={isRefetching}\n          showFilters\n          showModeSwitch\n          className=\"h-full\"\n        />\n      </div>\n    </div>\n  )\n}\n"],"names":["UnifiedKanbanBoard","_contextType","_contextId","initialColumnMode","initialSourceFilter","showFilters","showModeSwitch","onItemClick","className","items","isLoading","isError","onStatusChange","onRefresh","isRefreshing","t","i18n","useTranslation","isRTL","toast","useToast","columnMode","setColumnMode","useState","sourceFilter","setSourceFilter","columnDefinitions","useMemo","getColumnsForMode","columnOrder","getColumnOrder","filteredItems","item","mapColumnKey","columnKey","kanbanColumns","columnDef","c","columnItems","columns","setColumns","totalCount","overdueCount","handleDragEnd","useCallback","itemId","sourceColumnId","targetColumnId","i","targetColumnKey","canDropInColumn","errorMsg","getTransitionErrorMessage","status","workflow_stage","getUpdatePayload","handleItemClick","renderOverlay","activeItem","jsx","UnifiedKanbanCardContent","jsxs","cn","UnifiedKanbanHeader","KanbanBoard","UnifiedKanbanCardSkeleton","KanbanProvider","KanbanColumn","KanbanEmpty","KanbanCard","z","mode","optional","default","sources","string","transform","val","split","undefined","MyWorkBoardPage","language","navigate","useNavigate","user","useAuth","Route","useSearch","refetch","isRefetching","useUnifiedKanban","contextType","statusMutation","useUnifiedKanbanStatusUpdate","useUnifiedKanbanRealtime","id","newMode","to","search","join","newSources","length","handleStatusChange","source","newStatus","workflowStage","mutateAsync","newWorkflowStage","handleSwitchToList","Button","List"],"mappings":"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"}