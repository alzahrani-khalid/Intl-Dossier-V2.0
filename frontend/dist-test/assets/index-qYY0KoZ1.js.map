{"version":3,"mappings":"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","names":["AVAILABLE_THEMES","ThemeContext","createContext","ThemeProvider","children","initialTheme","initialColorMode","theme","setThemeState","useState","stored","prefs","e","colorMode","setColorModeState","useEffect","root","setTheme","useCallback","newTheme","setColorMode","newMode","handleStorageChange","err","value","jsx","useTheme","context","useContext","supportedLanguages","resources","enCommon","enIntake","enDossiers","enDossier","enPositions","enAssignments","enForums","enContacts","enCommitments","enWorkCreation","enUnifiedKanban","enPersons","enWorkingGroups","enEngagements","enActivityFeed","enEngagementBriefs","enRelationships","enAdvancedSearch","enMLClassification","enAISummary","enAuditLogs","enBulkActions","enMouRenewals","enDashboardWidgets","enDelegation","enRetentionPolicies","enDocumentOcr","enEmail","enCalendar","enExportImport","enDocumentPreview","arCommon","arIntake","arDossiers","arDossier","arPositions","arAssignments","arForums","arContacts","arCommitments","arWorkCreation","arUnifiedKanban","arPersons","arWorkingGroups","arEngagements","arActivityFeed","arEngagementBriefs","arRelationships","arAdvancedSearch","arMLClassification","arAISummary","arAuditLogs","arBulkActions","arMouRenewals","arDashboardWidgets","arDelegation","arRetentionPolicies","arDocumentOcr","arEmail","arCalendar","arExportImport","arDocumentPreview","i18n","LanguageDetector","initReactI18next","lng","ns","key","isRTL","lang","getDirection","switchLanguage","LanguageContext","LanguageProvider","initialLanguage","t","useTranslation","language","setLanguageState","direction","setDirection","uiStorage","storedLang","i18nextLng","dir","setLanguage","newLanguage","handleLanguageChange","useLanguage","queryClient","QueryClient","cn","inputs","twMerge","clsx","buttonVariants","cva","Button","React.forwardRef","className","variant","size","asChild","props","ref","Comp","Slot","alertVariants","Alert","AlertTitle","AlertDescription","Component","error","errorInfo","ErrorFallback","onReset","onGoHome","showDetails","jsxs","AlertTriangle","RefreshCw","Home","Dialog","DialogPrimitive.Root","DialogTrigger","DialogPrimitive.Trigger","DialogPortal","DialogPrimitive.Portal","DialogOverlay","DialogPrimitive.Overlay","DialogContent","DialogPrimitive.Content","DialogPrimitive.Close","Cross2Icon","DialogHeader","DialogFooter","DialogTitle","DialogPrimitive.Title","DialogDescription","DialogPrimitive.Description","Command","CommandPrimitive","CommandDialog","preventCloseOnOutsideClick","VisuallyHidden","CommandInput","MagnifyingGlassIcon","CommandList","CommandEmpty","CommandGroup","CommandSeparator","CommandItem","detectEntityType","pathname","extractEntityId","entityType","patterns","useCreationContext","routerState","useRouterState","s","useMemo","params","entityId","result","typedParams","Popover","PopoverPrimitive.Root","PopoverTrigger","PopoverPrimitive.Trigger","PopoverContent","align","sideOffset","PopoverPrimitive.Portal","PopoverPrimitive.Content","variantClasses","Badge","React","styles","supabaseUrl","supabaseAnonKey","supabase","createClient","SearchAPIError","message","status","code","details","getAuthHeaders","session","handleResponse","response","autocompleteDossiers","request","headers","url","suggestResponse","STORAGE_KEY","MAX_RECENT","DEBOUNCE_MS","MIN_SEARCH_CHARS","getDossierTypeIcon","type","Globe","Building2","Users","FileText","getRecentDossiers","addRecentDossier","dossier","recent","updated","d","DossierPicker","onChange","disabled","placeholder","externalSelectedDossier","open","setOpen","searchQuery","setSearchQuery","searchResults","setSearchResults","isSearching","setIsSearching","recentDossiers","setRecentDossiers","selectedDossier","setSelectedDossier","timeoutId","results","handleSelect","handleClear","displayName","Icon","X","Search","ChevronsUpDown","DossierIcon","name","Check","Input","Textarea","Calendar","classNames","showOutsideDays","captionLayout","buttonVariant","formatters","components","defaultClassNames","getDefaultClassNames","DayPicker","date","rootRef","orientation","ChevronLeftIcon","ChevronRightIcon","ChevronDownIcon","CalendarDayButton","day","modifiers","React.useRef","React.useEffect","labelVariants","Label","LabelPrimitive.Root","Form","FormProvider","FormFieldContext","React.createContext","FormField","Controller","useFormField","fieldContext","React.useContext","itemContext","FormItemContext","getFieldState","formState","useFormContext","fieldState","id","FormItem","React.useId","FormLabel","formItemId","FormControl","formDescriptionId","formMessageId","FormDescription","FormMessage","body","Select","SelectPrimitive.Root","SelectValue","SelectPrimitive.Value","SelectTrigger","SelectPrimitive.Trigger","SelectPrimitive.Icon","ChevronDown","SelectScrollUpButton","SelectPrimitive.ScrollUpButton","ChevronUp","SelectScrollDownButton","SelectPrimitive.ScrollDownButton","SelectContent","position","SelectPrimitive.Portal","SelectPrimitive.Content","SelectPrimitive.Viewport","SelectLabel","SelectPrimitive.Label","SelectItem","SelectPrimitive.Item","SelectPrimitive.ItemIndicator","SelectPrimitive.ItemText","SelectSeparator","SelectPrimitive.Separator","getCommitments","filters","cursor","limit","query","today","data","count","commitments","hasMore","lastItem","nextCursor","getCommitment","commitmentId","createCommitment","input","user","isInternal","owner_user_id","owner_contact_id","tracking_mode","updateCommitment","updateCommitmentStatus","updateData","cancelCommitment","getCommitmentStatusHistory","uploadEvidence","file","fileExt","fileName","filePath","uploadError","evidence_submitted_at","updateError","getEvidenceUrl","proofUrl","isCommitmentOverdue","dueDate","due","getDaysUntilDue","diffTime","commitmentKeys","VALID_STATUS_TRANSITIONS","isValidStatusTransition","from","to","STATUS_COLORS","PRIORITY_COLORS","ALLOWED_EVIDENCE_TYPES","MAX_EVIDENCE_SIZE","useInfiniteCommitments","options","enabled","useInfiniteQuery","pageParam","lastPage","useCommitment","useQuery","useCommitmentStatusHistory","useCreateCommitment","useQueryClient","useMutation","toast","useUpdateCommitment","useUpdateCommitmentStatus","previous","old","c","page","_input","useCancelCommitment","useUploadEvidence","_data","variables","commitmentQuickFormSchema","z.object","z.string","z.date","z.enum","CommitmentQuickForm","dossierId","creationContext","onSuccess","onCancel","createMutation","isPending","form","useForm","zodResolver","onSubmit","values","dossierDisplayName","field","CalendarIcon","format","ar","enUS","Fragment","Loader2","TasksAPIError","OptimisticLockConflictError","fetchWithAuth","tasksAPI","taskId","task","taskError","assigneeName","assigneeEmail","assignee","creatorName","creator","workItemTitleEn","workItemTitleAr","ticket","workItems","source","positionId","ticketId","engagement","engagementData","engagementError","workflow_stage","last_known_updated_at","engagementId","workItemType","workItemId","assigneeId","hours","warningTime","taskQuickFormSchema","TaskQuickForm","createTaskMutation","User","intakeQuickFormSchema","createIntakeTicket","IntakeQuickForm","WORK_TYPE_OPTIONS","CheckSquare","ClipboardList","Inbox","WorkCreationPalette","onOpenChange","defaultType","contextOverride","step","setStep","selectedType","setSelectedType","timeout","option","o","handleTypeSelect","handleDossierSelect","handleDossierContinue","handleBack","handleSuccess","item","handleCancel","finalDossierId","filteredTypes","label","desc","ArrowLeft","ChevronRight","isMac","useGlobalKeyboard","onCreateNew","handleKeyDown","event","activeElement","WorkCreationContext","WorkCreationProvider","disableShortcut","isOpen","setIsOpen","setDefaultType","openPalette","closePalette","_item","messages","Route","createRootRoute","ErrorBoundary","Outlet","TanStackRouterDevtools","createFileRoute","component","lazyRouteComponent","$$splitComponentImporter","useAuthStore","create","persist","set","email","password","mfaCode","profile","state","beforeLoad","auth","getSession","setState","isAuthenticated","redirect","getState","validateSearch","search","q","includeArchived","Card","CardHeader","CardTitle","CardDescription","CardContent","CardFooter","readPxVar","variableName","raw","match","getBreakpoints","xs","sm","md","lg","aliasForWidth","width","bp","deviceForAlias","alias","useResponsive","breakpoints","viewport","setViewport","rafRef","useRef","handleResize","deviceType","a","min","max","useLanguageFromProvider","useThemeFromProvider","useDirection","htmlElement","observer","newDir","toggleDirection","newDirection","setDirectionValue","ResponsiveCard","title","description","footer","collapsible","defaultCollapsed","priority","showOnMobile","mobileLayout","isMobile","isTablet","isCollapsed","setIsCollapsed","shouldEnableCollapse","isCurrentlyCollapsed","priorityClasses","responsivePadding","ResponsiveCardGrid","columns","gap","columnCount","gapClasses","Table","TableHeader","TableBody","TableRow","TableHead","TableCell","ResponsiveTable","mobileView","striped","hoverable","emptyMessage","visibleColumns","col","highPriorityColumns","shouldUseMobileView","index","column","NavigationMenu","NavigationMenuPrimitive.Root","NavigationMenuViewport","NavigationMenuList","NavigationMenuPrimitive.List","NavigationMenuItem","NavigationMenuPrimitive.Item","navigationMenuTriggerStyle","NavigationMenuTrigger","NavigationMenuPrimitive.Trigger","NavigationMenuContent","NavigationMenuPrimitive.Content","NavigationMenuLink","NavigationMenuPrimitive.Link","NavigationMenuPrimitive.Viewport","NavigationMenuIndicator","NavigationMenuPrimitive.Indicator","Sheet","SheetPrimitive.Root","SheetTrigger","SheetPrimitive.Trigger","SheetPortal","SheetPrimitive.Portal","SheetOverlay","SheetPrimitive.Overlay","sheetVariants","SheetContent","side","accessibleTitle","SheetPrimitive.Content","SheetPrimitive.Title","SheetPrimitive.Close","SheetHeader","SheetFooter","SheetTitle","SheetDescription","SheetPrimitive.Description","ResponsiveNav","items","logo","actions","mobileBreakpoint","mobileMenuOpen","setMobileMenuOpen","showMobileNav","visibleItems","highPriorityItems","Menu","MobileNavItem","depth","onItemClick","expanded","setExpanded","hasChildren","child","themes","ThemeSelector","currentTheme","handleThemeSelect","themeId","announcement","toggleColorMode","singleTheme","Palette","themeOption","Moon","Sun","DropdownMenu","DropdownMenuPrimitive.Root","DropdownMenuTrigger","DropdownMenuPrimitive.Trigger","DropdownMenuSubTrigger","inset","DropdownMenuPrimitive.SubTrigger","DropdownMenuSubContent","DropdownMenuPrimitive.SubContent","DropdownMenuContent","DropdownMenuPrimitive.Portal","DropdownMenuPrimitive.Content","DropdownMenuItem","DropdownMenuPrimitive.Item","DropdownMenuCheckboxItem","checked","DropdownMenuPrimitive.CheckboxItem","DropdownMenuPrimitive.ItemIndicator","DropdownMenuRadioItem","DropdownMenuPrimitive.RadioItem","Circle","DropdownMenuLabel","DropdownMenuPrimitive.Label","DropdownMenuSeparator","DropdownMenuPrimitive.Separator","useUIStore","collapsed","notification","wasUnread","notifications","n","modalId","loading","LanguageSwitcher","compact","handleChange","next","labelMap","ViewInfo","r","DemoPage","rows","API_BASE_URL","positionKeys","usePositions","pageSize","useDebouncedValue","delay","debouncedValue","setDebouncedValue","handler","PositionCard","onClick","onAttach","onDetach","engagementAttachmentCount","isAttached","locale","content","positionStatus","contentPreview","getStatusVariant","getLinkTypeBadge","linkType","Link2","Eye","Trash2","PositionList","positions","contextId","onPositionClick","isLoading","hideFilters","layout","parentRef","searchInput","setSearchInput","statusFilter","setStatusFilter","typeFilter","setTypeFilter","dateRangeFilter","setDateRangeFilter","debouncedSearch","filteredPositions","filtered","searchLower","p","now","filterDate","virtualizer","useVirtualizer","_","i","Filter","virtualItem","Checkbox","CheckboxPrimitive.Root","CheckboxPrimitive.Indicator","CheckIcon","ScrollArea","ScrollAreaPrimitive.Root","ScrollAreaPrimitive.Viewport","ScrollBar","ScrollAreaPrimitive.Corner","ScrollAreaPrimitive.ScrollAreaScrollbar","ScrollAreaPrimitive.ScrollAreaThumb","Separator","decorative","SeparatorPrimitive.Root","AttachPositionDialog","attachedPositionIds","trigger","maxSelections","selectedIds","setSelectedIds","previewPosition","setPreviewPosition","isAttaching","setIsAttaching","positionsData","getPositionTitle","getPositionContent","toggleSelection","prev","handleAttach","handleOpenChange","isSelected","isPreviewed","sort","order","PositionsLibraryPage","navigate","useNavigate","searchParams","useSearch","sortBy","setSortBy","sortOrder","setSortOrder","showCreateDialog","setShowCreateDialog","undefined","pages","totalCount","total","stats","byStatus","updateFilters","updates","replace","handleClearFilters","hasActiveFilters","Plus","published","review","draft","target","newStatus","newType","Error","kanbanSearchSchema","z","mode","optional","default","sources","string","transform","val","split","swimlane","wipInProgress","number","wipReview","parse","meta","ownerId","overdue","dueDateFrom","dueDateTo","view","myWorkSearchSchema","tab","filter","trackingType","loader","errorComponent","$$splitErrorComponentImporter","boardSearchSchema","event_type","contactId","user_metadata","role","app_metadata","Skeleton","SkeletonCard","SkeletonText","lines","Tabs","TabsPrimitive.Root","TabsList","TabsPrimitive.List","TabsTrigger","TabsPrimitive.Trigger","TabsContent","TabsPrimitive.Content","Switch","SwitchPrimitives.Root","SwitchPrimitives.Thumb","retentionPolicyKeys","useRetentionPolicies","useCreateRetentionPolicy","useUpdateRetentionPolicy","useLegalHolds","useCreateLegalHold","useReleaseLegalHold","useRetentionStatistics","usePendingRetentionActions","useExpiringEntities","useRetentionExecutionLog","useRunRetentionProcessor","config","DataRetentionPage","ENTITY_TYPES","DOCUMENT_CLASSES","RETENTION_ACTIONS","activeTab","setActiveTab","showPolicyDialog","setShowPolicyDialog","showLegalHoldDialog","setShowLegalHoldDialog","showProcessorDialog","setShowProcessorDialog","selectedPolicy","setSelectedPolicy","policies","policiesLoading","statistics","statsLoading","pendingActions","pendingLoading","expiringEntities","expiringLoading","executionLog","logLoading","legalHolds","holdsLoading","createPolicy","updatePolicy","createLegalHold","releaseLegalHold","runProcessor","totalPolicies","activeLegalHolds","h","totalPendingActions","totalExpiringSoon","entitiesUnderHold","sum","formatRetentionPeriod","days","years","formatAction","action","getStatusColor","Database","Play","Lock","Clock","Shield","BarChart3","Settings","History","stat","log","CheckCircle2","policy","hold","Unlock","entity","PolicyDialog","LegalHoldDialog","ProcessorDialog","onSave","formData","setFormData","handleSubmit","v","cls","onRun","setConfig","Progress","ProgressPrimitive.Root","ProgressPrimitive.Indicator","AIUsageDashboard","dateRange","setDateRange","metrics","refetch","isRefetching","startDate","runs","totalRuns","totalTokens","totalCost","successfulRuns","successRate","totalLatency","averageLatency","runsByType","costByProvider","provider","dailyMap","existing","dailyUsage","b","userMap","userIds","profiles","emailMap","topUsers","user_id","formatCost","cost","formatNumber","num","RUN_TYPE_ICONS","MessageSquare","MetricCard","Zap","DollarSign","TrendingUp","percentage","maxRuns","height","trend","TrendingDown","useToast","duration","AISettingsPage","PROVIDERS","MODELS","setFormState","hasChanges","setHasChanges","policyLoading","orgId","modelPricing","updatePolicyMutation","currentState","updateField","updateFeature","feature","features","handleSave","handleReset","getModelPricingInfo","modelId","m","RotateCcw","Save","Brain","RegisterRoute","RegisterRouteImport","rootRouteImport","ModernNavStandaloneRoute","ModernNavStandaloneRouteImport","LoginRoute","LoginRouteImport","ProtectedRoute","ProtectedRouteImport","IndexRoute","IndexRouteImport","ProtectedWorkingGroupsRoute","ProtectedWorkingGroupsRouteImport","ProtectedWordAssistantRoute","ProtectedWordAssistantRouteImport","ProtectedUsersRoute","ProtectedUsersRouteImport","ProtectedThemesRoute","ProtectedThemesRouteImport","ProtectedSettingsRoute","ProtectedSettingsRouteImport","ProtectedSearchRoute","ProtectedSearchRouteImport","ProtectedResponsiveDemoRoute","ProtectedResponsiveDemoRouteImport","ProtectedReportsRoute","ProtectedReportsRouteImport","ProtectedPrototypeDossierRoute","ProtectedPrototypeDossierRouteImport","ProtectedPositionsRoute","ProtectedPositionsRouteImport","ProtectedPersonsRoute","ProtectedPersonsRouteImport","ProtectedOrganizationsRoute","ProtectedOrganizationsRouteImport","ProtectedMyWorkRoute","ProtectedMyWorkRouteImport","ProtectedMousRoute","ProtectedMousRouteImport","ProtectedMonitoringRoute","ProtectedMonitoringRouteImport","ProtectedModernNavDemoRoute","ProtectedModernNavDemoRouteImport","ProtectedKanbanRoute","ProtectedKanbanRouteImport","ProtectedIntelligenceRoute","ProtectedIntelligenceRouteImport","ProtectedIntakeRoute","ProtectedIntakeRouteImport","ProtectedForumsRoute","ProtectedForumsRouteImport","ProtectedExportImportRoute","ProtectedExportImportRouteImport","ProtectedExportRoute","ProtectedExportRouteImport","ProtectedEventsRoute","ProtectedEventsRouteImport","ProtectedEngagementsRoute","ProtectedEngagementsRouteImport","ProtectedDelegationsRoute","ProtectedDelegationsRouteImport","ProtectedDataLibraryRoute","ProtectedDataLibraryRouteImport","ProtectedDashboardRoute","ProtectedDashboardRouteImport","ProtectedCustomDashboardRoute","ProtectedCustomDashboardRouteImport","ProtectedCountriesRoute","ProtectedCountriesRouteImport","ProtectedContactsRoute","ProtectedContactsRouteImport","ProtectedCommitmentsRoute","ProtectedCommitmentsRouteImport","ProtectedCalendarRoute","ProtectedCalendarRouteImport","ProtectedBulkActionsDemoRoute","ProtectedBulkActionsDemoRouteImport","ProtectedBriefsRoute","ProtectedBriefsRouteImport","ProtectedAuditLogsRoute","ProtectedAuditLogsRouteImport","ProtectedAnalyticsRoute","ProtectedAnalyticsRouteImport","ProtectedAdvancedSearchRoute","ProtectedAdvancedSearchRouteImport","ProtectedAccessibilityRoute","ProtectedAccessibilityRouteImport","ProtectedTasksIndexRoute","ProtectedTasksIndexRouteImport","ProtectedPositionsIndexRoute","ProtectedPositionsIndexRouteImport","ProtectedPersonsIndexRoute","ProtectedPersonsIndexRouteImport","ProtectedMyWorkIndexRoute","ProtectedMyWorkIndexRouteImport","ProtectedIntakeIndexRoute","ProtectedIntakeIndexRouteImport","ProtectedHelpIndexRoute","ProtectedHelpIndexRouteImport","ProtectedEngagementsIndexRoute","ProtectedEngagementsIndexRouteImport","ProtectedDossiersIndexRoute","ProtectedDossiersIndexRouteImport","ProtectedApprovalsIndexRoute","ProtectedApprovalsIndexRouteImport","ProtectedAfterActionsIndexRoute","ProtectedAfterActionsIndexRouteImport","ProtectedTasksQueueRoute","ProtectedTasksQueueRouteImport","ProtectedTasksEscalationsRoute","ProtectedTasksEscalationsRouteImport","ProtectedTasksIdRoute","ProtectedTasksIdRouteImport","ProtectedRelationshipsGraphRoute","ProtectedRelationshipsGraphRouteImport","ProtectedPositionsPositionIdRoute","ProtectedPositionsPositionIdRouteImport","ProtectedPositionsIdRoute","ProtectedPositionsIdRouteImport","ProtectedPersonsCreateRoute","ProtectedPersonsCreateRouteImport","ProtectedPersonsPersonIdRoute","ProtectedPersonsPersonIdRouteImport","ProtectedMyWorkWaitingRoute","ProtectedMyWorkWaitingRouteImport","ProtectedMyWorkIntakeRoute","ProtectedMyWorkIntakeRouteImport","ProtectedMyWorkBoardRoute","ProtectedMyWorkBoardRouteImport","ProtectedMyWorkAssignmentsRoute","ProtectedMyWorkAssignmentsRouteImport","ProtectedIntakeQueueRoute","ProtectedIntakeQueueRouteImport","ProtectedIntakeNewRoute","ProtectedIntakeNewRouteImport","ProtectedHelpCommitmentsRoute","ProtectedHelpCommitmentsRouteImport","ProtectedEngagementsEngagementIdRoute","ProtectedEngagementsEngagementIdRouteImport","ProtectedDossiersCreateRoute","ProtectedDossiersCreateRouteImport","ProtectedDossiersIdRoute","ProtectedDossiersIdRouteImport","ProtectedContactsNotesSearchRoute","ProtectedContactsNotesSearchRouteImport","ProtectedContactsCreateRoute","ProtectedContactsCreateRouteImport","ProtectedContactsContactIdRoute","ProtectedContactsContactIdRouteImport","ProtectedCalendarNewRoute","ProtectedCalendarNewRouteImport","ProtectedAfterActionsAfterActionIdRoute","ProtectedAfterActionsAfterActionIdRouteImport","ProtectedAdminSystemRoute","ProtectedAdminSystemRouteImport","ProtectedAdminDataRetentionRoute","ProtectedAdminDataRetentionRouteImport","ProtectedAdminApprovalsRoute","ProtectedAdminApprovalsRouteImport","ProtectedAdminAiUsageRoute","ProtectedAdminAiUsageRouteImport","ProtectedAdminAiSettingsRoute","ProtectedAdminAiSettingsRouteImport","ProtectedDossiersWorking_groupsIndexRoute","ProtectedDossiersWorking_groupsIndexRouteImport","ProtectedDossiersTopicsIndexRoute","ProtectedDossiersTopicsIndexRouteImport","ProtectedDossiersPersonsIndexRoute","ProtectedDossiersPersonsIndexRouteImport","ProtectedDossiersOrganizationsIndexRoute","ProtectedDossiersOrganizationsIndexRouteImport","ProtectedDossiersForumsIndexRoute","ProtectedDossiersForumsIndexRouteImport","ProtectedDossiersEngagementsIndexRoute","ProtectedDossiersEngagementsIndexRouteImport","ProtectedDossiersCountriesIndexRoute","ProtectedDossiersCountriesIndexRouteImport","ProtectedPositionsIdVersionsRoute","ProtectedPositionsIdVersionsRouteImport","ProtectedPositionsIdApprovalsRoute","ProtectedPositionsIdApprovalsRouteImport","ProtectedIntakeTicketsIdRoute","ProtectedIntakeTicketsIdRouteImport","ProtectedEngagementsEngagementIdAfterActionRoute","ProtectedEngagementsEngagementIdAfterActionRouteImport","ProtectedDossiersWorking_groupsIdRoute","ProtectedDossiersWorking_groupsIdRouteImport","ProtectedDossiersTopicsIdRoute","ProtectedDossiersTopicsIdRouteImport","ProtectedDossiersPersonsIdRoute","ProtectedDossiersPersonsIdRouteImport","ProtectedDossiersOrganizationsIdRoute","ProtectedDossiersOrganizationsIdRouteImport","ProtectedDossiersForumsIdRoute","ProtectedDossiersForumsIdRouteImport","ProtectedDossiersEngagementsIdRoute","ProtectedDossiersEngagementsIdRouteImport","ProtectedDossiersCountriesIdRoute","ProtectedDossiersCountriesIdRouteImport","ProtectedAfterActionsAfterActionIdVersionsRoute","ProtectedAfterActionsAfterActionIdVersionsRouteImport","ProtectedCalendarRouteChildren","ProtectedCalendarRouteWithChildren","ProtectedContactsRouteChildren","ProtectedContactsRouteWithChildren","ProtectedEngagementsEngagementIdRouteChildren","ProtectedEngagementsEngagementIdRouteWithChildren","ProtectedEngagementsRouteChildren","ProtectedEngagementsRouteWithChildren","ProtectedIntakeRouteChildren","ProtectedIntakeRouteWithChildren","ProtectedMyWorkRouteChildren","ProtectedMyWorkRouteWithChildren","ProtectedPersonsRouteChildren","ProtectedPersonsRouteWithChildren","ProtectedPositionsIdRouteChildren","ProtectedPositionsIdRouteWithChildren","ProtectedPositionsRouteChildren","ProtectedPositionsRouteWithChildren","ProtectedAfterActionsAfterActionIdRouteChildren","ProtectedAfterActionsAfterActionIdRouteWithChildren","ProtectedRouteChildren","ProtectedRouteWithChildren","rootRouteChildren","routeTree","router","createRouter","reset","Link","prevProps","resetKeys","resetOnPropsChange","hasError","resetError","setShowDetails","handleGoHome","handleReportError","Bug","DB_NAME","DB_VERSION","STORE_NAME","IndexedDBManager","resolve","reject","db","store","dbManager","useOfflineQueue","subscribeWithSelector","get","actionData","updatedAction","isOnline","isProcessing","priorityOrder","aPriority","bPriority","failedActions","initializeStore","setupNetworkListeners","setOnlineStatus","OfflineIndicator","processQueue","retryFailed","clearCompleted","completedActions","Wifi","WifiOff","useRealtimeStore","table","callback","subscriptionId","subscriptions","channel","payload","subscription","isConnecting","newSubscriptions","newChannel","connectionStateToStatus","teardownConnectionMonitoring","setupConnectionMonitoring","setConnectionStatus","setError","reconnect","updateFromRealtime","realtimeState","heartbeatStatus","intervalId","handleBeforeUnload","AuthContext","AuthProvider","login","logout","checkAuth","clearError","useAuth","RealtimeStatus","connectionStatus","isConnected","lastError","getStatusIcon","AlertCircle","getStatusText","RTLWrapper","ThemeErrorBoundary","fallbackTheme","fallbackColorMode","fallbackLanguage","AppRouter","RouterProvider","App","QueryClientProvider","ReactQueryDevtools","Toaster","createRoot","StrictMode"],"ignoreList":[],"sources":["../../src/components/theme-provider/theme-provider.tsx","../../src/i18n/index.ts","../../src/components/language-provider/language-provider.tsx","../../src/lib/queryClient.ts","../../src/lib/utils.ts","../../src/components/ui/button.tsx","../../src/components/ui/alert.tsx","../../src/components/ErrorBoundary.tsx","../../src/components/ui/dialog.tsx","../../src/components/ui/command.tsx","../../src/components/work-creation/hooks/useCreationContext.ts","../../src/components/ui/popover.tsx","../../src/components/ui/badge.tsx","../../src/lib/supabase.ts","../../src/services/search-api.ts","../../src/components/work-creation/DossierPicker.tsx","../../src/components/ui/input.tsx","../../src/components/ui/textarea.tsx","../../src/components/ui/calendar.tsx","../../src/components/ui/label.tsx","../../src/components/ui/form.tsx","../../src/components/ui/select.tsx","../../src/services/commitments.service.ts","../../src/types/commitment.types.ts","../../src/hooks/useCommitments.ts","../../src/components/work-creation/forms/CommitmentQuickForm.tsx","../../src/services/tasks-api.ts","../../src/components/work-creation/forms/TaskQuickForm.tsx","../../src/components/work-creation/forms/IntakeQuickForm.tsx","../../src/components/work-creation/WorkCreationPalette.tsx","../../src/components/work-creation/hooks/useGlobalKeyboard.ts","../../src/components/work-creation/WorkCreationProvider.tsx","../../src/routes/__root.tsx","../../src/routes/register.tsx","../../src/routes/modern-nav-standalone.tsx","../../src/routes/login.tsx","../../src/store/authStore.ts","../../src/routes/_protected.tsx","../../src/routes/index.tsx","../../src/routes/_protected/working-groups.tsx","../../src/routes/_protected/word-assistant.tsx","../../src/routes/_protected/users.tsx","../../src/routes/_protected/themes.tsx","../../src/routes/_protected/settings.tsx","../../src/routes/_protected/search.tsx","../../src/components/ui/card.tsx","../../src/hooks/use-responsive.ts","../../src/hooks/use-language.ts","../../src/hooks/use-theme.ts","../../src/components/responsive/responsive-card.tsx","../../src/components/ui/table.tsx","../../src/components/responsive/responsive-table.tsx","../../src/components/ui/navigation-menu.tsx","../../src/components/ui/sheet.tsx","../../src/components/responsive/responsive-nav.tsx","../../src/components/theme-selector/theme-selector.tsx","../../src/components/ui/dropdown-menu.tsx","../../src/store/uiStore.ts","../../src/components/LanguageSwitcher.tsx","../../src/routes/_protected/responsive-demo.tsx","../../src/routes/_protected/reports.tsx","../../src/routes/_protected/prototype-dossier.tsx","../../src/hooks/usePositions.ts","../../src/hooks/useDebouncedValue.ts","../../src/components/positions/PositionCard.tsx","../../src/components/positions/PositionList.tsx","../../src/components/ui/checkbox.tsx","../../src/components/ui/scroll-area.tsx","../../src/components/ui/separator.tsx","../../src/components/positions/AttachPositionDialog.tsx","../../src/routes/_protected/positions.tsx","../../src/routes/_protected/persons.tsx","../../src/routes/_protected/organizations.tsx","../../src/routes/_protected/my-work.tsx","../../src/routes/_protected/mous.tsx","../../src/routes/_protected/monitoring.tsx","../../src/routes/_protected/modern-nav-demo.tsx","../../src/routes/_protected/kanban.tsx","../../src/routes/_protected/intelligence.tsx","../../src/routes/_protected/intake.tsx","../../src/routes/_protected/forums.tsx","../../src/routes/_protected/export-import.tsx","../../src/routes/_protected/export.tsx","../../src/routes/_protected/events.tsx","../../src/routes/_protected/engagements.tsx","../../src/routes/_protected/delegations.tsx","../../src/routes/_protected/data-library.tsx","../../src/routes/_protected/dashboard.tsx","../../src/routes/_protected/custom-dashboard.tsx","../../src/routes/_protected/countries.tsx","../../src/routes/_protected/contacts.tsx","../../src/routes/_protected/commitments.tsx","../../src/routes/_protected/calendar.tsx","../../src/routes/_protected/bulk-actions-demo.tsx","../../src/routes/_protected/briefs.tsx","../../src/routes/_protected/audit-logs.tsx","../../src/routes/_protected/analytics.tsx","../../src/routes/_protected/advanced-search.tsx","../../src/routes/_protected/accessibility.tsx","../../src/routes/_protected/tasks/index.tsx","../../src/routes/_protected/positions/index.tsx","../../src/routes/_protected/persons/index.tsx","../../src/routes/_protected/my-work/index.tsx","../../src/routes/_protected/intake/index.tsx","../../src/routes/_protected/help/index.tsx","../../src/routes/_protected/engagements/index.tsx","../../src/routes/_protected/dossiers/index.tsx","../../src/routes/_protected/approvals/index.tsx","../../src/routes/_protected/after-actions/index.tsx","../../src/routes/_protected/tasks/queue.tsx","../../src/routes/_protected/tasks/escalations.tsx","../../src/routes/_protected/tasks/$id.tsx","../../src/routes/_protected/relationships/graph.tsx","../../src/routes/_protected/positions/$positionId.tsx","../../src/routes/_protected/positions/$id.tsx","../../src/routes/_protected/persons/create.tsx","../../src/routes/_protected/persons/$personId.tsx","../../src/routes/_protected/my-work/waiting.tsx","../../src/routes/_protected/my-work/intake.tsx","../../src/routes/_protected/my-work/board.tsx","../../src/routes/_protected/my-work/assignments.tsx","../../src/routes/_protected/intake/queue.tsx","../../src/routes/_protected/intake/new.tsx","../../src/routes/_protected/help/commitments.tsx","../../src/routes/_protected/engagements/$engagementId.tsx","../../src/routes/_protected/dossiers/create.tsx","../../src/routes/_protected/dossiers/$id.tsx","../../src/routes/_protected/contacts/notes-search.tsx","../../src/routes/_protected/contacts/create.tsx","../../src/routes/_protected/contacts/$contactId.tsx","../../src/routes/_protected/calendar/new.tsx","../../src/routes/_protected/after-actions/$afterActionId.tsx","../../src/routes/_protected/admin/system.tsx","../../src/components/ui/skeleton.tsx","../../src/components/ui/tabs.tsx","../../src/components/ui/switch.tsx","../../src/hooks/useRetentionPolicies.ts","../../src/routes/_protected/admin/data-retention.tsx","../../src/routes/_protected/admin/approvals.tsx","../../src/components/ui/progress.tsx","../../src/routes/_protected/admin/ai-usage.tsx","../../src/hooks/use-toast.ts","../../src/routes/_protected/admin/ai-settings.tsx","../../src/routes/_protected/dossiers/working_groups/index.tsx","../../src/routes/_protected/dossiers/topics/index.tsx","../../src/routes/_protected/dossiers/persons/index.tsx","../../src/routes/_protected/dossiers/organizations/index.tsx","../../src/routes/_protected/dossiers/forums/index.tsx","../../src/routes/_protected/dossiers/engagements/index.tsx","../../src/routes/_protected/dossiers/countries/index.tsx","../../src/routes/_protected/positions/$id/versions.tsx","../../src/routes/_protected/positions/$id/approvals.tsx","../../src/routes/_protected/intake/tickets.$id.tsx","../../src/routes/_protected/engagements/$engagementId/after-action.tsx","../../src/routes/_protected/dossiers/working_groups/$id.tsx","../../src/routes/_protected/dossiers/topics/$id.tsx","../../src/routes/_protected/dossiers/persons/$id.tsx","../../src/routes/_protected/dossiers/organizations/$id.tsx","../../src/routes/_protected/dossiers/forums/$id.tsx","../../src/routes/_protected/dossiers/engagements/$id.tsx","../../src/routes/_protected/dossiers/countries/$id.tsx","../../src/routes/_protected/after-actions/$afterActionId/versions.tsx","../../src/routeTree.gen.ts","../../src/router/index.tsx","../../src/components/error-boundary/ErrorBoundary.tsx","../../src/services/offline-queue.ts","../../src/components/OfflineIndicator.tsx","../../src/services/realtime.ts","../../src/contexts/auth.context.tsx","../../src/components/RealtimeStatus.tsx","../../src/components/RTLWrapper.tsx","../../src/components/theme-error-boundary.tsx","../../src/App.tsx","../../src/main.tsx"],"sourcesContent":["import React, { createContext, useContext, useEffect, useState, useCallback } from 'react'\n\n// Theme type - extensible for future themes\ntype Theme = 'canvas' // Add 'ocean' | 'sunset' etc. when needed\ntype ColorMode = 'light' | 'dark'\n\n// Available themes for validation and UI\nexport const AVAILABLE_THEMES = ['canvas'] as const\n\ninterface ThemeContextValue {\n  theme: Theme\n  colorMode: ColorMode\n  setTheme: (theme: Theme) => void\n  setColorMode: (mode: ColorMode) => void\n  isDark: boolean\n}\n\nconst ThemeContext = createContext<ThemeContextValue | undefined>(undefined)\n\ninterface ThemeProviderProps {\n  children: React.ReactNode\n  initialTheme?: Theme\n  initialColorMode?: ColorMode\n}\n\nexport function ThemeProvider({\n  children,\n  initialTheme = 'canvas',\n  initialColorMode = 'light',\n}: ThemeProviderProps) {\n  const [theme, setThemeState] = useState<Theme>(() => {\n    // Initialize theme from localStorage if available\n    const stored = localStorage.getItem('user-preferences')\n    if (stored) {\n      try {\n        const prefs = JSON.parse(stored)\n        if (prefs.theme && AVAILABLE_THEMES.includes(prefs.theme)) {\n          return prefs.theme\n        }\n      } catch (e) {\n        console.warn('Failed to parse user preferences:', e)\n      }\n    }\n    return initialTheme\n  })\n\n  const [colorMode, setColorModeState] = useState<ColorMode>(() => {\n    // Initialize color mode from localStorage or system preference\n    const stored = localStorage.getItem('user-preferences')\n    if (stored) {\n      try {\n        const prefs = JSON.parse(stored)\n        if (prefs.colorMode && (prefs.colorMode === 'light' || prefs.colorMode === 'dark')) {\n          return prefs.colorMode\n        }\n      } catch (e) {\n        console.warn('Failed to parse user preferences:', e)\n      }\n    }\n    // Check system preference for color mode\n    const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches\n    return prefersDark ? 'dark' : 'light'\n  })\n\n  // Apply theme to document\n  useEffect(() => {\n    const root = document.documentElement\n\n    // Set theme palette via data-theme attribute (scalable architecture)\n    root.setAttribute('data-theme', theme)\n\n    // Set color mode via .dark class (shadcn pattern)\n    if (colorMode === 'dark') {\n      root.classList.add('dark')\n    } else {\n      root.classList.remove('dark')\n    }\n  }, [theme, colorMode])\n\n  const setTheme = useCallback(\n    (newTheme: Theme) => {\n      if (!AVAILABLE_THEMES.includes(newTheme)) {\n        console.error(`Invalid theme: ${newTheme}`)\n        return\n      }\n\n      setThemeState(newTheme)\n\n      // Save to localStorage\n      const stored = localStorage.getItem('user-preferences')\n      let prefs = {\n        theme: newTheme,\n        colorMode,\n        language: 'en',\n        updatedAt: new Date().toISOString(),\n      }\n      if (stored) {\n        try {\n          const existing = JSON.parse(stored)\n          prefs = { ...existing, theme: newTheme, updatedAt: new Date().toISOString() }\n        } catch (e) {\n          // Use defaults\n        }\n      }\n      localStorage.setItem('user-preferences', JSON.stringify(prefs))\n\n      // Dispatch custom event for cross-component sync\n      window.dispatchEvent(\n        new CustomEvent('themeChange', {\n          detail: { theme: newTheme, colorMode },\n        }),\n      )\n\n      // Dispatch for cross-tab sync\n      window.dispatchEvent(\n        new CustomEvent('preferenceChange', {\n          detail: { theme: newTheme },\n        }),\n      )\n    },\n    [colorMode],\n  )\n\n  const setColorMode = useCallback(\n    (newMode: ColorMode) => {\n      setColorModeState(newMode)\n\n      // Save to localStorage\n      const stored = localStorage.getItem('user-preferences')\n      let prefs = { theme, colorMode: newMode, language: 'en', updatedAt: new Date().toISOString() }\n      if (stored) {\n        try {\n          const existing = JSON.parse(stored)\n          prefs = { ...existing, colorMode: newMode, updatedAt: new Date().toISOString() }\n        } catch (e) {\n          // Use defaults\n        }\n      }\n      localStorage.setItem('user-preferences', JSON.stringify(prefs))\n\n      // Dispatch custom event\n      window.dispatchEvent(\n        new CustomEvent('themeChange', {\n          detail: { theme, colorMode: newMode },\n        }),\n      )\n\n      // Dispatch for cross-tab sync\n      window.dispatchEvent(\n        new CustomEvent('preferenceChange', {\n          detail: { colorMode: newMode },\n        }),\n      )\n    },\n    [theme],\n  )\n\n  // Listen for theme changes from other components or tabs\n  useEffect(() => {\n    const handleStorageChange = (e: StorageEvent) => {\n      if (e.key === 'user-preferences' && e.newValue) {\n        try {\n          const prefs = JSON.parse(e.newValue)\n          if (prefs.theme && AVAILABLE_THEMES.includes(prefs.theme)) {\n            setThemeState(prefs.theme)\n          }\n          if (prefs.colorMode && (prefs.colorMode === 'light' || prefs.colorMode === 'dark')) {\n            setColorModeState(prefs.colorMode)\n          }\n        } catch (err) {\n          console.warn('Failed to parse preference update:', err)\n        }\n      }\n    }\n\n    window.addEventListener('storage', handleStorageChange)\n    return () => window.removeEventListener('storage', handleStorageChange)\n  }, [])\n\n  const value: ThemeContextValue = {\n    theme,\n    colorMode,\n    setTheme,\n    setColorMode,\n    isDark: colorMode === 'dark',\n  }\n\n  return (\n    <ThemeContext.Provider value={value}>\n      <div data-testid=\"theme-provider\">{children}</div>\n    </ThemeContext.Provider>\n  )\n}\n\nexport function useTheme() {\n  const context = useContext(ThemeContext)\n  if (!context) {\n    throw new Error('useTheme must be used within a ThemeProvider')\n  }\n  return context\n}\n","import i18n from 'i18next'\nimport { initReactI18next } from 'react-i18next'\nimport LanguageDetector from 'i18next-browser-languagedetector'\n\nimport enCommon from './en/common.json'\nimport arCommon from './ar/common.json'\nimport enIntake from './en/intake.json'\nimport arIntake from './ar/intake.json'\nimport enDossiers from './en/dossiers.json'\nimport arDossiers from './ar/dossiers.json'\nimport enDossier from './en/dossier.json'\nimport arDossier from './ar/dossier.json'\nimport enPositions from './en/positions.json'\nimport arPositions from './ar/positions.json'\nimport enAssignments from './en/assignments.json'\nimport arAssignments from './ar/assignments.json'\nimport enForums from './en/forums.json'\nimport arForums from './ar/forums.json'\nimport enContacts from './en/contacts.json'\nimport arContacts from './ar/contacts.json'\nimport enCommitments from './en/commitments.json'\nimport arCommitments from './ar/commitments.json'\nimport enWorkCreation from './en/work-creation.json'\nimport arWorkCreation from './ar/work-creation.json'\nimport enUnifiedKanban from './en/unified-kanban.json'\nimport arUnifiedKanban from './ar/unified-kanban.json'\nimport enPersons from './en/persons.json'\nimport arPersons from './ar/persons.json'\nimport enWorkingGroups from './en/working-groups.json'\nimport arWorkingGroups from './ar/working-groups.json'\nimport enEngagements from './en/engagements.json'\nimport arEngagements from './ar/engagements.json'\nimport enActivityFeed from './en/activity-feed.json'\nimport arActivityFeed from './ar/activity-feed.json'\nimport enEngagementBriefs from './en/engagement-briefs.json'\nimport arEngagementBriefs from './ar/engagement-briefs.json'\nimport enRelationships from './en/relationships.json'\nimport arRelationships from './ar/relationships.json'\nimport enAdvancedSearch from './en/advanced-search.json'\nimport arAdvancedSearch from './ar/advanced-search.json'\nimport enMLClassification from './en/ml-classification.json'\nimport arMLClassification from './ar/ml-classification.json'\nimport enAISummary from './en/ai-summary.json'\nimport arAISummary from './ar/ai-summary.json'\nimport enAuditLogs from './en/audit-logs.json'\nimport arAuditLogs from './ar/audit-logs.json'\nimport enBulkActions from './en/bulk-actions.json'\nimport arBulkActions from './ar/bulk-actions.json'\nimport enMouRenewals from './en/mou-renewals.json'\nimport arMouRenewals from './ar/mou-renewals.json'\nimport enDashboardWidgets from './en/dashboard-widgets.json'\nimport arDashboardWidgets from './ar/dashboard-widgets.json'\nimport enDelegation from './en/delegation.json'\nimport arDelegation from './ar/delegation.json'\nimport enRetentionPolicies from './en/retention-policies.json'\nimport arRetentionPolicies from './ar/retention-policies.json'\nimport enDocumentOcr from './en/document-ocr.json'\nimport arDocumentOcr from './ar/document-ocr.json'\nimport enEmail from './en/email.json'\nimport arEmail from './ar/email.json'\nimport enCalendar from './en/calendar.json'\nimport arCalendar from './ar/calendar.json'\nimport enExportImport from './en/export-import.json'\nimport arExportImport from './ar/export-import.json'\nimport enDocumentPreview from './en/document-preview.json'\nimport arDocumentPreview from './ar/document-preview.json'\n// Force reload - updated 2026-01-11 - v26 - Added document-preview namespace\n\nconst supportedLanguages = ['en', 'ar'] as const\nexport type SupportedLanguage = (typeof supportedLanguages)[number]\n\nconst resources = {\n  en: {\n    translation: enCommon,\n    intake: enIntake,\n    dossiers: enDossiers,\n    dossier: enDossier,\n    positions: enPositions,\n    assignments: enAssignments,\n    forums: enForums,\n    contacts: enContacts,\n    commitments: enCommitments,\n    'work-creation': enWorkCreation,\n    'unified-kanban': enUnifiedKanban,\n    persons: enPersons,\n    'working-groups': enWorkingGroups,\n    engagements: enEngagements,\n    'activity-feed': enActivityFeed,\n    'engagement-briefs': enEngagementBriefs,\n    relationships: enRelationships,\n    'advanced-search': enAdvancedSearch,\n    'ml-classification': enMLClassification,\n    'ai-summary': enAISummary,\n    'audit-logs': enAuditLogs,\n    'bulk-actions': enBulkActions,\n    'mou-renewals': enMouRenewals,\n    'dashboard-widgets': enDashboardWidgets,\n    delegation: enDelegation,\n    'retention-policies': enRetentionPolicies,\n    'document-ocr': enDocumentOcr,\n    email: enEmail,\n    calendar: enCalendar,\n    'export-import': enExportImport,\n    'document-preview': enDocumentPreview,\n  },\n  ar: {\n    translation: arCommon,\n    intake: arIntake,\n    dossiers: arDossiers,\n    dossier: arDossier,\n    positions: arPositions,\n    assignments: arAssignments,\n    forums: arForums,\n    contacts: arContacts,\n    commitments: arCommitments,\n    'work-creation': arWorkCreation,\n    'unified-kanban': arUnifiedKanban,\n    persons: arPersons,\n    'working-groups': arWorkingGroups,\n    engagements: arEngagements,\n    'activity-feed': arActivityFeed,\n    'engagement-briefs': arEngagementBriefs,\n    relationships: arRelationships,\n    'advanced-search': arAdvancedSearch,\n    'ml-classification': arMLClassification,\n    'ai-summary': arAISummary,\n    'audit-logs': arAuditLogs,\n    'bulk-actions': arBulkActions,\n    'mou-renewals': arMouRenewals,\n    'dashboard-widgets': arDashboardWidgets,\n    delegation: arDelegation,\n    'retention-policies': arRetentionPolicies,\n    'document-ocr': arDocumentOcr,\n    email: arEmail,\n    calendar: arCalendar,\n    'export-import': arExportImport,\n    'document-preview': arDocumentPreview,\n  },\n}\n\ni18n\n  .use(LanguageDetector)\n  .use(initReactI18next)\n  .init({\n    resources,\n    fallbackLng: 'en',\n    debug: false,\n    supportedLngs: supportedLanguages,\n\n    interpolation: {\n      escapeValue: false,\n    },\n\n    detection: {\n      order: ['localStorage', 'cookie', 'htmlTag', 'navigator'],\n      caches: ['localStorage', 'cookie'],\n    },\n\n    react: {\n      useSuspense: false,\n    },\n\n    // Add missing keys handling\n    saveMissing: false,\n    missingKeyHandler: (lng, ns, key) => {\n      if (process.env.NODE_ENV === 'development') {\n        console.warn(`Missing translation key: ${key} for language: ${lng}`)\n      }\n    },\n  })\n\n// Function to check if current language is RTL\nexport const isRTL = (lang: string = i18n.language): boolean => {\n  return lang === 'ar'\n}\n\n// Function to get text direction\nexport const getDirection = (lang: string = i18n.language): 'rtl' | 'ltr' => {\n  return isRTL(lang) ? 'rtl' : 'ltr'\n}\n\n// Function to switch language and update document direction\nexport const switchLanguage = async (lang: SupportedLanguage): Promise<void> => {\n  await i18n.changeLanguage(lang)\n  document.documentElement.dir = getDirection(lang)\n  document.documentElement.lang = lang\n}\n\n// Set initial direction\ndocument.documentElement.dir = getDirection()\ndocument.documentElement.lang = i18n.language\n\n// Listen for language changes\ni18n.on('languageChanged', (lng) => {\n  document.documentElement.dir = getDirection(lng)\n  document.documentElement.lang = lng\n})\n\nexport default i18n\n","import React, { createContext, useContext, useEffect, useState, useCallback } from 'react'\nimport { useTranslation } from 'react-i18next'\nimport { getDirection, type SupportedLanguage } from '../../i18n'\n\ninterface LanguageContextValue {\n  language: SupportedLanguage\n  direction: 'ltr' | 'rtl'\n  setLanguage: (language: SupportedLanguage) => void\n  t: (key: string) => string\n}\n\nconst LanguageContext = createContext<LanguageContextValue | undefined>(undefined)\n\ninterface LanguageProviderProps {\n  children: React.ReactNode\n  initialLanguage?: SupportedLanguage\n}\n\nexport function LanguageProvider({ children, initialLanguage = 'en' }: LanguageProviderProps) {\n  const { i18n, t } = useTranslation()\n  const [language, setLanguageState] = useState<SupportedLanguage>(initialLanguage)\n  const [direction, setDirection] = useState<'ltr' | 'rtl'>('ltr')\n\n  // Load language preference from localStorage on mount\n  // Priority: ui-storage (Zustand) > i18nextLng > browser detection\n  useEffect(() => {\n    // First check ui-storage (Zustand persisted store) - this is the primary source\n    const uiStorage = localStorage.getItem('ui-storage')\n    if (uiStorage) {\n      try {\n        const parsed = JSON.parse(uiStorage)\n        const storedLang = parsed?.state?.language\n        if (storedLang && (storedLang === 'en' || storedLang === 'ar')) {\n          setLanguageState(storedLang)\n          i18n.changeLanguage(storedLang)\n          return\n        }\n      } catch (e) {\n        // Silently ignore parse errors\n      }\n    }\n\n    // Fallback to i18nextLng (set by language detector)\n    const i18nextLng = localStorage.getItem('i18nextLng')\n    if (i18nextLng && (i18nextLng === 'en' || i18nextLng === 'ar')) {\n      setLanguageState(i18nextLng as SupportedLanguage)\n      // Don't call changeLanguage - i18n already initialized with this value\n      return\n    }\n\n    // Final fallback: browser language detection\n    const browserLang = navigator.language.toLowerCase()\n    if (browserLang.startsWith('ar')) {\n      setLanguageState('ar')\n      i18n.changeLanguage('ar')\n    }\n  }, [i18n])\n\n  // Apply language direction\n  useEffect(() => {\n    const dir = getDirection(language)\n    setDirection(dir)\n    document.documentElement.dir = dir\n    document.documentElement.lang = language\n  }, [language])\n\n  const setLanguage = useCallback(\n    async (newLanguage: SupportedLanguage) => {\n      if (newLanguage !== 'en' && newLanguage !== 'ar') {\n        console.error(`Invalid language: ${newLanguage}`)\n        return\n      }\n\n      setLanguageState(newLanguage)\n\n      // Change i18n language\n      await i18n.changeLanguage(newLanguage)\n\n      // Apply direction\n      const dir = getDirection(newLanguage)\n      setDirection(dir)\n      document.documentElement.dir = dir\n      document.documentElement.lang = newLanguage\n\n      // Save to localStorage\n      const stored = localStorage.getItem('user-preferences')\n      let prefs = {\n        theme: 'gastat',\n        colorMode: 'light',\n        language: newLanguage,\n        updatedAt: new Date().toISOString(),\n      }\n      if (stored) {\n        try {\n          const existing = JSON.parse(stored)\n          prefs = { ...existing, language: newLanguage, updatedAt: new Date().toISOString() }\n        } catch (e) {\n          // Use defaults\n        }\n      }\n      localStorage.setItem('user-preferences', JSON.stringify(prefs))\n\n      // Dispatch custom event for cross-component sync\n      window.dispatchEvent(\n        new CustomEvent('languageChange', {\n          detail: { language: newLanguage, direction: dir },\n        }),\n      )\n\n      // Dispatch for cross-tab sync\n      window.dispatchEvent(\n        new CustomEvent('preferenceChange', {\n          detail: { language: newLanguage },\n        }),\n      )\n    },\n    [i18n],\n  )\n\n  // Listen for language changes from other components or tabs\n  useEffect(() => {\n    const handleStorageChange = (e: StorageEvent) => {\n      if (e.key === 'user-preferences' && e.newValue) {\n        try {\n          const prefs = JSON.parse(e.newValue)\n          if (prefs.language && (prefs.language === 'en' || prefs.language === 'ar')) {\n            setLanguageState(prefs.language)\n            i18n.changeLanguage(prefs.language)\n          }\n        } catch (err) {\n          console.warn('Failed to parse preference update:', err)\n        }\n      }\n    }\n\n    const handleLanguageChange = (e: CustomEvent) => {\n      if (e.detail?.language) {\n        setLanguageState(e.detail.language)\n        i18n.changeLanguage(e.detail.language)\n      }\n    }\n\n    window.addEventListener('storage', handleStorageChange)\n    window.addEventListener('languageChange' as any, handleLanguageChange)\n\n    return () => {\n      window.removeEventListener('storage', handleStorageChange)\n      window.removeEventListener('languageChange' as any, handleLanguageChange)\n    }\n  }, [i18n])\n\n  const value: LanguageContextValue = {\n    language,\n    direction,\n    setLanguage,\n    t: t as any,\n  }\n\n  return <LanguageContext.Provider value={value}>{children}</LanguageContext.Provider>\n}\n\nexport function useLanguage() {\n  const context = useContext(LanguageContext)\n  if (!context) {\n    throw new Error('useLanguage must be used within a LanguageProvider')\n  }\n  return context\n}\n","import { QueryClient } from '@tanstack/react-query'\n\nexport const queryClient = new QueryClient({\n  defaultOptions: {\n    queries: {\n      staleTime: 1000 * 60 * 5, // 5 minutes\n      gcTime: 1000 * 60 * 30, // 30 minutes\n      retry: 3,\n      refetchOnWindowFocus: false,\n    },\n    mutations: {\n      retry: 2,\n    },\n  },\n})","import { clsx, type ClassValue } from \"clsx\"\nimport { twMerge } from \"tailwind-merge\"\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n\nexport function generateUserColor() {\n  const colors = [\n    '#FF6B6B', '#4ECDC4', '#45B7D1', '#96CEB4', '#FECA57',\n    '#48C9B0', '#5DADE2', '#AF7AC5', '#F8B739', '#58D68D',\n    '#EC7063', '#85C1E2', '#F8C471', '#82E0AA', '#D7BDE2',\n  ]\n  return colors[Math.floor(Math.random() * colors.length)]\n}\n","import * as React from 'react'\nimport { Slot } from '@radix-ui/react-slot'\nimport { cva, type VariantProps } from 'class-variance-authority'\n\nimport { cn } from '@/lib/utils'\n\nconst buttonVariants = cva(\n  'inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0',\n  {\n    variants: {\n      variant: {\n        default: 'bg-primary text-primary-foreground shadow hover:bg-primary/90',\n        destructive: 'bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90',\n        outline:\n          'border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground',\n        secondary: 'bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80',\n        ghost: 'hover:bg-accent hover:text-accent-foreground',\n        link: 'text-primary underline-offset-4 hover:underline',\n      },\n      size: {\n        default: 'min-h-11 h-11 px-4 py-2',\n        sm: 'min-h-11 h-11 rounded-md px-3 text-sm',\n        lg: 'min-h-12 h-12 rounded-md px-8',\n        icon: 'min-h-11 min-w-11 h-11 w-11',\n      },\n    },\n    defaultVariants: {\n      variant: 'default',\n      size: 'sm',\n    },\n  },\n)\n\nexport interface ButtonProps\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\n    VariantProps<typeof buttonVariants> {\n  asChild?: boolean\n}\n\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : 'button'\n    return (\n      <Comp className={cn(buttonVariants({ variant, size, className }))} ref={ref} {...props} />\n    )\n  },\n)\nButton.displayName = 'Button'\n\nexport { Button, buttonVariants }\n","import * as React from 'react';\nimport { cva, type VariantProps } from 'class-variance-authority';\n\nimport { cn } from '@/lib/utils';\n\nconst alertVariants = cva(\n 'relative w-full rounded-lg border p-4 [&>svg~*]:ps-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:start-4 [&>svg]:top-4 [&>svg]:text-foreground',\n {\n variants: {\n variant: {\n default: 'bg-background text-foreground',\n destructive:\n 'border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive',\n },\n },\n defaultVariants: {\n variant: 'default',\n },\n }\n);\n\nconst Alert = React.forwardRef<\n HTMLDivElement,\n React.HTMLAttributes<HTMLDivElement> & VariantProps<typeof alertVariants>\n>(({ className, variant, ...props }, ref) => (\n <div ref={ref} role=\"alert\" className={cn(alertVariants({ variant }), className)} {...props} />\n));\nAlert.displayName = 'Alert';\n\nconst AlertTitle = React.forwardRef<HTMLParagraphElement, React.HTMLAttributes<HTMLHeadingElement>>(\n ({ className, ...props }, ref) => (\n <h5\n ref={ref}\n className={cn('mb-1 font-medium leading-none tracking-tight', className)}\n {...props}\n />\n )\n);\nAlertTitle.displayName = 'AlertTitle';\n\nconst AlertDescription = React.forwardRef<\n HTMLParagraphElement,\n React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => (\n <div ref={ref} className={cn('text-sm [&_p]:leading-relaxed', className)} {...props} />\n));\nAlertDescription.displayName = 'AlertDescription';\n\nexport { Alert, AlertTitle, AlertDescription };\n","/**\n * ErrorBoundary Component\n *\n * Task: T095 [Polish]\n * Graceful error handling for React components with fallback UI\n * Mobile-first, RTL support, WCAG AA compliant\n */\n\nimport React, { Component, ErrorInfo, ReactNode } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { AlertTriangle, RefreshCw, Home } from 'lucide-react';\nimport { Button } from '@/components/ui/button';\nimport { Alert, AlertDescription, AlertTitle } from '@/components/ui/alert';\n\ninterface ErrorBoundaryProps {\n children: ReactNode;\n fallback?: ReactNode;\n onError?: (error: Error, errorInfo: ErrorInfo) => void;\n showDetails?: boolean;\n}\n\ninterface ErrorBoundaryState {\n hasError: boolean;\n error: Error | null;\n errorInfo: ErrorInfo | null;\n}\n\n/**\n * Class-based ErrorBoundary component\n * (React Error Boundaries must be class components)\n */\nclass ErrorBoundary extends Component<ErrorBoundaryProps, ErrorBoundaryState> {\n constructor(props: ErrorBoundaryProps) {\n super(props);\n this.state = {\n hasError: false,\n error: null,\n errorInfo: null\n };\n }\n\n static getDerivedStateFromError(error: Error): Partial<ErrorBoundaryState> {\n return {\n hasError: true,\n error\n };\n }\n\n componentDidCatch(error: Error, errorInfo: ErrorInfo) {\n // Log error to console in development\n if (import.meta.env.DEV) {\n console.error('[ErrorBoundary] Caught error:', error);\n console.error('[ErrorBoundary] Error info:', errorInfo);\n }\n\n // Call optional error handler\n this.props.onError?.(error, errorInfo);\n\n // Update state with error info\n this.setState({\n errorInfo\n });\n\n // In production, send to error tracking service (e.g., Sentry)\n if (!import.meta.env.DEV) {\n // TODO: Send to error tracking service\n // Sentry.captureException(error, { extra: errorInfo });\n }\n }\n\n handleReset = () => {\n this.setState({\n hasError: false,\n error: null,\n errorInfo: null\n });\n };\n\n handleGoHome = () => {\n window.location.href = '/';\n };\n\n render() {\n if (this.state.hasError) {\n // Use custom fallback if provided\n if (this.props.fallback) {\n return this.props.fallback;\n }\n\n // Default fallback UI\n return <ErrorFallback\n error={this.state.error}\n errorInfo={this.state.errorInfo}\n onReset={this.handleReset}\n onGoHome={this.handleGoHome}\n showDetails={this.props.showDetails ?? import.meta.env.DEV}\n />;\n }\n\n return this.props.children;\n }\n}\n\n/**\n * ErrorFallback Component (functional component for i18n)\n */\ninterface ErrorFallbackProps {\n error: Error | null;\n errorInfo: ErrorInfo | null;\n onReset: () => void;\n onGoHome: () => void;\n showDetails?: boolean;\n}\n\nfunction ErrorFallback({ error, errorInfo, onReset, onGoHome, showDetails = false }: ErrorFallbackProps) {\n const { t, i18n } = useTranslation();\n const isRTL = i18n.language === 'ar';\n\n return (\n <div\n className=\"flex min-h-screen items-center justify-center bg-muted/30 p-4 sm:p-6 lg:p-8\"\n dir={isRTL ? 'rtl' : 'ltr'}\n >\n <div className=\"w-full max-w-2xl\">\n <Alert variant=\"destructive\" className=\"mb-6\">\n <AlertTriangle className=\"size-5\" />\n <AlertTitle className=\"mb-2 text-start text-lg sm:text-xl\">\n {t('error.boundary.title', 'Something went wrong')}\n </AlertTitle>\n <AlertDescription className=\"text-start\">\n {t('error.boundary.description', 'An unexpected error occurred. Please try refreshing the page or return to the home page.')}\n </AlertDescription>\n </Alert>\n\n {/* Error message */}\n {error && (\n <div className=\"mb-6 rounded-lg border bg-card p-4 sm:p-6\">\n <p className=\"break-all text-start font-mono text-sm text-destructive sm:text-base\">\n {error.message || t('error.boundary.unknownError', 'Unknown error')}\n </p>\n </div>\n )}\n\n {/* Error details (development only) */}\n {showDetails && errorInfo && (\n <details className=\"mb-6 rounded-lg border bg-card p-4 sm:p-6\">\n <summary className=\"mb-2 cursor-pointer text-start text-sm font-medium sm:text-base\">\n {t('error.boundary.technicalDetails', 'Technical Details')}\n </summary>\n <pre className=\"mt-2 overflow-auto rounded bg-muted p-4 text-start text-xs sm:text-sm\">\n {errorInfo.componentStack}\n </pre>\n </details>\n )}\n\n {/* Actions */}\n <div className=\"flex flex-col gap-3 sm:flex-row sm:gap-4\">\n <Button\n onClick={onReset}\n className=\" w-full sm: sm:w-auto\"\n variant=\"default\"\n >\n <RefreshCw className={`size-4 ${isRTL ? 'ms-2' : 'me-2'}`} />\n {t('error.boundary.tryAgain', 'Try Again')}\n </Button>\n <Button\n onClick={onGoHome}\n className=\" w-full sm: sm:w-auto\"\n variant=\"outline\"\n >\n <Home className={`size-4 ${isRTL ? 'ms-2' : 'me-2'}`} />\n {t('error.boundary.goHome', 'Go to Home')}\n </Button>\n </div>\n </div>\n </div>\n );\n}\n\nexport default ErrorBoundary;\n","import * as React from 'react'\nimport * as DialogPrimitive from '@radix-ui/react-dialog'\nimport { cn } from '@/lib/utils'\nimport { Cross2Icon } from '@radix-ui/react-icons'\n\nconst Dialog = DialogPrimitive.Root\n\nconst DialogTrigger = DialogPrimitive.Trigger\n\nconst DialogPortal = DialogPrimitive.Portal\n\nconst DialogClose = DialogPrimitive.Close\n\nconst DialogOverlay = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Overlay\n    ref={ref}\n    className={cn(\n      'fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0',\n      className,\n    )}\n    {...props}\n  />\n))\nDialogOverlay.displayName = DialogPrimitive.Overlay.displayName\n\nconst DialogContent = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DialogPortal>\n    <DialogOverlay />\n    <DialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        'fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg',\n        className,\n      )}\n      {...props}\n    >\n      {children}\n      <DialogPrimitive.Close className=\"absolute end-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground\">\n        <Cross2Icon className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </DialogPrimitive.Close>\n    </DialogPrimitive.Content>\n  </DialogPortal>\n))\nDialogContent.displayName = DialogPrimitive.Content.displayName\n\nconst DialogHeader = ({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn('flex flex-col space-y-1.5 text-center sm:text-start', className)}\n    {...props}\n  />\n)\nDialogHeader.displayName = 'DialogHeader'\n\nconst DialogFooter = ({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn('flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2', className)}\n    {...props}\n  />\n)\nDialogFooter.displayName = 'DialogFooter'\n\nconst DialogTitle = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Title\n    ref={ref}\n    className={cn('text-lg font-semibold leading-none tracking-tight', className)}\n    {...props}\n  />\n))\nDialogTitle.displayName = DialogPrimitive.Title.displayName\n\nconst DialogDescription = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Description\n    ref={ref}\n    className={cn('text-sm text-muted-foreground', className)}\n    {...props}\n  />\n))\nDialogDescription.displayName = DialogPrimitive.Description.displayName\n\nexport {\n  Dialog,\n  DialogPortal,\n  DialogOverlay,\n  DialogTrigger,\n  DialogClose,\n  DialogContent,\n  DialogHeader,\n  DialogFooter,\n  DialogTitle,\n  DialogDescription,\n}\n","\"use client\"\n\nimport * as React from \"react\"\nimport { type DialogProps } from \"@radix-ui/react-dialog\"\nimport { Command as CommandPrimitive } from \"cmdk\"\nimport { cn } from \"@/lib/utils\"\nimport { Dialog, DialogContent, DialogTitle, DialogDescription } from \"@/components/ui/dialog\"\nimport { MagnifyingGlassIcon } from \"@radix-ui/react-icons\"\nimport { VisuallyHidden } from \"@radix-ui/react-visually-hidden\"\n\nconst Command = React.forwardRef<\n React.ElementRef<typeof CommandPrimitive>,\n React.ComponentPropsWithoutRef<typeof CommandPrimitive>\n>(({ className, ...props }, ref) => (\n <CommandPrimitive\n ref={ref}\n className={cn(\n \"flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground\",\n className\n )}\n {...props}\n />\n))\nCommand.displayName = CommandPrimitive.displayName\n\ninterface CommandDialogProps extends DialogProps {\n  /** Prevent closing when clicking outside the dialog */\n  preventCloseOnOutsideClick?: boolean;\n}\n\nconst CommandDialog = ({ children, preventCloseOnOutsideClick = false, ...props }: CommandDialogProps) => {\n return (\n <Dialog {...props}>\n <DialogContent\n   className=\"overflow-hidden p-0\"\n   aria-describedby={undefined}\n   onInteractOutside={(e) => {\n     if (preventCloseOnOutsideClick) {\n       e.preventDefault();\n     }\n   }}\n   onEscapeKeyDown={(e) => {\n     // Allow Escape to close the dialog (standard UX)\n   }}\n >\n <VisuallyHidden>\n   <DialogTitle>Command Palette</DialogTitle>\n </VisuallyHidden>\n <Command className=\"[&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-group]]:px-2 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5\">\n {children}\n </Command>\n </DialogContent>\n </Dialog>\n )\n}\n\nconst CommandInput = React.forwardRef<\n React.ElementRef<typeof CommandPrimitive.Input>,\n React.ComponentPropsWithoutRef<typeof CommandPrimitive.Input>\n>(({ className, ...props }, ref) => (\n <div className=\"flex items-center border-b px-3\" cmdk-input-wrapper=\"\">\n <MagnifyingGlassIcon className=\"mr-2 h-4 w-4 shrink-0 opacity-50\" />\n <CommandPrimitive.Input\n ref={ref}\n className={cn(\n \"flex h-10 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50\",\n className\n )}\n {...props}\n />\n </div>\n))\n\nCommandInput.displayName = CommandPrimitive.Input.displayName\n\nconst CommandList = React.forwardRef<\n React.ElementRef<typeof CommandPrimitive.List>,\n React.ComponentPropsWithoutRef<typeof CommandPrimitive.List>\n>(({ className, ...props }, ref) => (\n <CommandPrimitive.List\n ref={ref}\n className={cn(\"max-h-[300px] overflow-y-auto overflow-x-hidden\", className)}\n {...props}\n />\n))\n\nCommandList.displayName = CommandPrimitive.List.displayName\n\nconst CommandEmpty = React.forwardRef<\n React.ElementRef<typeof CommandPrimitive.Empty>,\n React.ComponentPropsWithoutRef<typeof CommandPrimitive.Empty>\n>((props, ref) => (\n <CommandPrimitive.Empty\n ref={ref}\n className=\"py-6 text-center text-sm\"\n {...props}\n />\n))\n\nCommandEmpty.displayName = CommandPrimitive.Empty.displayName\n\nconst CommandGroup = React.forwardRef<\n React.ElementRef<typeof CommandPrimitive.Group>,\n React.ComponentPropsWithoutRef<typeof CommandPrimitive.Group>\n>(({ className, ...props }, ref) => (\n <CommandPrimitive.Group\n ref={ref}\n className={cn(\n \"overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground\",\n className\n )}\n {...props}\n />\n))\n\nCommandGroup.displayName = CommandPrimitive.Group.displayName\n\nconst CommandSeparator = React.forwardRef<\n React.ElementRef<typeof CommandPrimitive.Separator>,\n React.ComponentPropsWithoutRef<typeof CommandPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n <CommandPrimitive.Separator\n ref={ref}\n className={cn(\"-mx-1 h-px bg-border\", className)}\n {...props}\n />\n))\nCommandSeparator.displayName = CommandPrimitive.Separator.displayName\n\nconst CommandItem = React.forwardRef<\n React.ElementRef<typeof CommandPrimitive.Item>,\n React.ComponentPropsWithoutRef<typeof CommandPrimitive.Item>\n>(({ className, ...props }, ref) => (\n <CommandPrimitive.Item\n ref={ref}\n className={cn(\n \"relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected=true]:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n className\n )}\n {...props}\n />\n))\n\nCommandItem.displayName = CommandPrimitive.Item.displayName\n\nconst CommandShortcut = ({\n className,\n ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n return (\n <span\n className={cn(\n \"ml-auto text-xs tracking-widest text-muted-foreground\",\n className\n )}\n {...props}\n />\n )\n}\nCommandShortcut.displayName = \"CommandShortcut\"\n\nexport {\n Command,\n CommandDialog,\n CommandInput,\n CommandList,\n CommandEmpty,\n CommandGroup,\n CommandItem,\n CommandShortcut,\n CommandSeparator,\n}\n","/**\n * useCreationContext Hook\n * Feature: 033-unified-work-creation-hub\n *\n * Auto-captures route context for work item creation.\n * Detects entity type and ID from current URL path.\n *\n * Note: Safe to use outside RouterProvider - returns default context.\n */\n\nimport { useMemo } from 'react';\nimport { useRouterState } from '@tanstack/react-router';\n\nexport type EntityType = 'dossier' | 'engagement' | 'after_action' | 'position' | 'intake';\n\nexport interface CreationContext {\n  // Auto-captured from route\n  route: string;\n  entityType?: EntityType;\n  entityId?: string;\n\n  // Derived context\n  dossierId?: string;\n  engagementId?: string;\n  afterActionId?: string;\n  positionId?: string;\n\n  // For database storage\n  createdFromEntity?: {\n    type: EntityType;\n    id: string;\n  };\n}\n\n/**\n * Detects entity type from URL path\n */\nfunction detectEntityType(pathname: string): EntityType | undefined {\n  if (pathname.includes('/dossiers/') || pathname.includes('/dossier/')) {\n    return 'dossier';\n  }\n  if (pathname.includes('/engagements/') || pathname.includes('/engagement/')) {\n    return 'engagement';\n  }\n  if (pathname.includes('/after-actions/') || pathname.includes('/after-action/')) {\n    return 'after_action';\n  }\n  if (pathname.includes('/positions/') || pathname.includes('/position/')) {\n    return 'position';\n  }\n  if (pathname.includes('/intake/')) {\n    return 'intake';\n  }\n  return undefined;\n}\n\n/**\n * Extracts entity ID from URL path\n */\nfunction extractEntityId(pathname: string, entityType: EntityType): string | undefined {\n  const patterns: Record<EntityType, RegExp> = {\n    dossier: /\\/dossiers?\\/([a-f0-9-]+)/i,\n    engagement: /\\/engagements?\\/([a-f0-9-]+)/i,\n    after_action: /\\/after-actions?\\/([a-f0-9-]+)/i,\n    position: /\\/positions?\\/([a-f0-9-]+)/i,\n    intake: /\\/intake\\/([a-f0-9-]+)/i,\n  };\n\n  const match = pathname.match(patterns[entityType]);\n  return match?.[1];\n}\n\n/**\n * Hook to capture creation context from current route\n * Now used inside RouterProvider via __root.tsx\n */\nexport function useCreationContext(): CreationContext {\n  // Get router state - now safe since WorkCreationProvider is inside RouterProvider\n  const routerState = useRouterState({\n    select: (s) => ({\n      pathname: s.location.pathname,\n      params: s.matches.at(-1)?.params ?? {},\n    }),\n  });\n\n  const context = useMemo<CreationContext>(() => {\n    const { pathname, params } = routerState;\n    const entityType = detectEntityType(pathname);\n    const entityId = entityType ? extractEntityId(pathname, entityType) : undefined;\n\n    // Build context object\n    const result: CreationContext = {\n      route: pathname,\n      entityType,\n      entityId,\n    };\n\n    const typedParams = params as Record<string, string | undefined>;\n\n    // Set specific IDs based on entity type or route params\n    if (entityType === 'dossier' && entityId) {\n      result.dossierId = entityId;\n    } else if (typedParams.dossierId) {\n      result.dossierId = typedParams.dossierId;\n    }\n\n    if (entityType === 'engagement' && entityId) {\n      result.engagementId = entityId;\n    } else if (typedParams.engagementId) {\n      result.engagementId = typedParams.engagementId;\n    }\n\n    if (entityType === 'after_action' && entityId) {\n      result.afterActionId = entityId;\n    } else if (typedParams.afterActionId) {\n      result.afterActionId = typedParams.afterActionId;\n    }\n\n    if (entityType === 'position' && entityId) {\n      result.positionId = entityId;\n    } else if (typedParams.positionId) {\n      result.positionId = typedParams.positionId;\n    }\n\n    // Build createdFromEntity for database storage\n    if (entityType && entityId) {\n      result.createdFromEntity = {\n        type: entityType,\n        id: entityId,\n      };\n    }\n\n    return result;\n  }, [routerState]);\n\n  return context;\n}\n\nexport default useCreationContext;\n","import * as React from \"react\"\nimport * as PopoverPrimitive from \"@radix-ui/react-popover\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Popover = PopoverPrimitive.Root\n\nconst PopoverTrigger = PopoverPrimitive.Trigger\n\nconst PopoverAnchor = PopoverPrimitive.Anchor\n\nconst PopoverContent = React.forwardRef<\n React.ElementRef<typeof PopoverPrimitive.Content>,\n React.ComponentPropsWithoutRef<typeof PopoverPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n <PopoverPrimitive.Portal>\n <PopoverPrimitive.Content\n ref={ref}\n align={align}\n sideOffset={sideOffset}\n className={cn(\n \"z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]\",\n className\n )}\n {...props}\n />\n </PopoverPrimitive.Portal>\n))\nPopoverContent.displayName = PopoverPrimitive.Content.displayName\n\nexport { Popover, PopoverTrigger, PopoverContent, PopoverAnchor }\n","import React from 'react'\n\ntype Variant = 'default' | 'secondary' | 'outline' | 'destructive' | 'none'\n\nexport interface BadgeProps extends React.HTMLAttributes<HTMLSpanElement> {\n variant?: Variant\n}\n\nconst variantClasses: Record<Variant, string> = {\n default: 'bg-primary text-primary-foreground',\n secondary: 'bg-secondary text-secondary-foreground',\n outline: 'border border-border text-foreground',\n destructive: 'bg-destructive text-destructive-foreground',\n none: '', // No default styling - use custom classes\n}\n\nexport const Badge = React.forwardRef<HTMLSpanElement, BadgeProps>(\n ({ className = '', variant = 'default', ...props }, ref) => {\n const base = 'inline-flex items-center rounded-md px-2 py-0.5 text-xs font-medium'\n const styles = `${base} ${variantClasses[variant]} ${className}`.trim()\n return <span ref={ref} className={styles} {...props} />\n }\n)\n\nBadge.displayName = 'Badge'\n\nexport default Badge\n\n","import { createClient } from '@supabase/supabase-js'\n\nconst supabaseUrl = import.meta.env.VITE_SUPABASE_URL\nconst supabaseAnonKey = import.meta.env.VITE_SUPABASE_ANON_KEY\n\nif (!supabaseUrl || !supabaseAnonKey) {\n  // During build, just throw a clear error; at runtime, envs must be set.\n  throw new Error('Missing Supabase environment variables (VITE_SUPABASE_URL, VITE_SUPABASE_ANON_KEY)')\n}\n\nexport const supabase = createClient(supabaseUrl, supabaseAnonKey, {\n  auth: {\n    persistSession: true,\n    autoRefreshToken: true,\n  },\n})\n\nexport default supabase\n\n","/**\n * Search API Client\n * Part of: 026-unified-dossier-architecture implementation\n *\n * Typed API client for unified search operations across all dossier types.\n * Handles full-text search with weighted ranking, multilingual support, and clearance filtering.\n */\n\nimport { supabase } from '@/lib/supabase';\nimport type { DossierType } from './dossier-api';\n\n// Get Supabase URL for Edge Functions\nconst supabaseUrl = import.meta.env.VITE_SUPABASE_URL;\n\nif (!supabaseUrl) {\n  throw new Error('Missing VITE_SUPABASE_URL environment variable');\n}\n\n/**\n * Search Result Interface\n */\nexport interface SearchResult {\n  id: string;\n  type: DossierType;\n  name_en: string;\n  name_ar: string;\n  description_en?: string;\n  description_ar?: string;\n  status: string;\n  sensitivity_level: number;\n  tags?: string[];\n  relevance_score: number; // Search ranking score\n  matched_fields: string[]; // Which fields matched the search\n  created_at: string;\n  updated_at: string;\n}\n\n/**\n * API Request types\n */\nexport interface SearchRequest {\n  query: string;\n  types?: DossierType[]; // Filter by specific dossier types\n  status?: string[]; // Filter by status\n  sensitivity_level_max?: number; // Maximum sensitivity level (RLS will enforce)\n  tags?: string[]; // Filter by tags\n  page?: number;\n  page_size?: number;\n  sort_by?: 'relevance' | 'created_at' | 'updated_at' | 'name_en' | 'name_ar';\n  sort_order?: 'asc' | 'desc';\n}\n\nexport interface SearchResponse {\n  results: SearchResult[];\n  total_count: number;\n  page: number;\n  page_size: number;\n  query: string;\n  search_time_ms: number; // Performance metric\n}\n\nexport interface AutocompleteRequest {\n  query: string;\n  types?: DossierType[];\n  limit?: number;\n}\n\nexport interface AutocompleteResult {\n  id: string;\n  type: DossierType;\n  name_en: string;\n  name_ar: string;\n  status: string;\n}\n\nexport interface AutocompleteResponse {\n  suggestions: AutocompleteResult[];\n  query: string;\n}\n\n/**\n * Search Suggest Response (from search-suggest Edge Function)\n */\ninterface SearchSuggestItem {\n  id: string;\n  type: string;\n  title_en: string;\n  title_ar: string;\n  preview_en: string;\n  preview_ar: string;\n  score: number;\n  match_position: number;\n}\n\ninterface SearchSuggestResponse {\n  suggestions: SearchSuggestItem[];\n  query: {\n    original: string;\n    normalized: string;\n    language_detected: string;\n  };\n  took_ms: number;\n  cache_hit: boolean;\n  metadata: {\n    total_suggestions: number;\n    types_searched: string[];\n  };\n}\n\n/**\n * API Error class\n */\nexport class SearchAPIError extends Error {\n  code: string;\n  status: number;\n  details?: any;\n\n  constructor(message: string, status: number, code: string, details?: any) {\n    super(message);\n    this.name = 'SearchAPIError';\n    this.code = code;\n    this.status = status;\n    this.details = details;\n  }\n}\n\n/**\n * Helper function to get auth headers\n */\nasync function getAuthHeaders(): Promise<Record<string, string>> {\n  const { data: { session } } = await supabase.auth.getSession();\n\n  if (!session) {\n    throw new SearchAPIError('Not authenticated', 401, 'AUTH_REQUIRED');\n  }\n\n  return {\n    'Content-Type': 'application/json',\n    'Authorization': `Bearer ${session.access_token}`,\n  };\n}\n\n/**\n * Helper function to handle API responses\n */\nasync function handleResponse<T>(response: Response): Promise<T> {\n  if (!response.ok) {\n    let error: any;\n    try {\n      error = await response.json();\n    } catch {\n      error = { message: response.statusText };\n    }\n\n    throw new SearchAPIError(\n      error.message || 'API request failed',\n      response.status,\n      error.code || 'API_ERROR',\n      error.details\n    );\n  }\n\n  return response.json();\n}\n\n/**\n * Unified search across all dossier types\n */\nexport async function searchDossiers(\n  request: SearchRequest\n): Promise<SearchResponse> {\n  const headers = await getAuthHeaders();\n  const params = new URLSearchParams();\n\n  // Add query parameters\n  params.append('query', request.query);\n\n  if (request.types && request.types.length > 0) {\n    params.append('types', JSON.stringify(request.types));\n  }\n\n  if (request.status && request.status.length > 0) {\n    params.append('status', JSON.stringify(request.status));\n  }\n\n  if (request.sensitivity_level_max !== undefined) {\n    params.append('sensitivity_level_max', String(request.sensitivity_level_max));\n  }\n\n  if (request.tags && request.tags.length > 0) {\n    params.append('tags', JSON.stringify(request.tags));\n  }\n\n  if (request.page !== undefined) {\n    params.append('page', String(request.page));\n  }\n\n  if (request.page_size !== undefined) {\n    params.append('page_size', String(request.page_size));\n  }\n\n  if (request.sort_by) {\n    params.append('sort_by', request.sort_by);\n  }\n\n  if (request.sort_order) {\n    params.append('sort_order', request.sort_order);\n  }\n\n  const url = `${supabaseUrl}/functions/v1/search?${params.toString()}`;\n  const response = await fetch(url, {\n    method: 'GET',\n    headers,\n  });\n\n  return handleResponse<SearchResponse>(response);\n}\n\n/**\n * Autocomplete search for quick suggestions\n * Uses search-suggest Edge Function with 'q' parameter and 'type=dossiers'\n */\nexport async function autocompleteDossiers(\n  request: AutocompleteRequest\n): Promise<AutocompleteResponse> {\n  const headers = await getAuthHeaders();\n  const params = new URLSearchParams();\n\n  // search-suggest uses 'q' parameter (not 'query')\n  params.append('q', request.query);\n\n  // Filter to dossiers type by default\n  if (request.types && request.types.length > 0) {\n    params.append('type', request.types.join(','));\n  } else {\n    params.append('type', 'dossiers');\n  }\n\n  if (request.limit !== undefined) {\n    params.append('limit', String(request.limit));\n  }\n\n  // Use search-suggest endpoint (not search/autocomplete)\n  const url = `${supabaseUrl}/functions/v1/search-suggest?${params.toString()}`;\n  const response = await fetch(url, {\n    method: 'GET',\n    headers,\n  });\n\n  // Transform search-suggest response to AutocompleteResponse format\n  const suggestResponse = await handleResponse<SearchSuggestResponse>(response);\n\n  return {\n    suggestions: suggestResponse.suggestions.map((s) => ({\n      id: s.id,\n      type: (s.type === 'dossier' ? 'country' : s.type) as DossierType, // Map 'dossier' to actual type\n      name_en: s.title_en,\n      name_ar: s.title_ar,\n      status: 'active', // Default status since search-suggest doesn't return it\n    })),\n    query: suggestResponse.query.original,\n  };\n}\n\n/**\n * Search within a specific dossier type\n */\nexport async function searchByType(\n  type: DossierType,\n  query: string,\n  page?: number,\n  page_size?: number\n): Promise<SearchResponse> {\n  return searchDossiers({\n    query,\n    types: [type],\n    page,\n    page_size,\n  });\n}\n\n/**\n * Quick search (default sort by relevance, first page only)\n */\nexport async function quickSearch(query: string): Promise<SearchResponse> {\n  return searchDossiers({\n    query,\n    page: 1,\n    page_size: 10,\n    sort_by: 'relevance',\n    sort_order: 'desc',\n  });\n}\n","/**\n * DossierPicker Component\n * Feature: 033-unified-work-creation-hub\n *\n * Searchable combobox for selecting dossiers with:\n * - Recent dossiers from localStorage\n * - Autocomplete search via API\n * - RTL and mobile-first support\n */\n\nimport { useState, useEffect, useCallback } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Check, ChevronsUpDown, Search, X, Globe, Building2, Users, FileText } from 'lucide-react';\nimport { cn } from '@/lib/utils';\nimport { Button } from '@/components/ui/button';\nimport {\n  Command,\n  CommandEmpty,\n  CommandGroup,\n  CommandInput,\n  CommandItem,\n  CommandList,\n} from '@/components/ui/command';\nimport {\n  Popover,\n  PopoverContent,\n  PopoverTrigger,\n} from '@/components/ui/popover';\nimport { Badge } from '@/components/ui/badge';\nimport { autocompleteDossiers, type AutocompleteResult } from '@/services/search-api';\nimport type { DossierType } from '@/services/dossier-api';\n\nconst STORAGE_KEY = 'recent_dossiers_for_work_creation';\nconst MAX_RECENT = 5;\nconst DEBOUNCE_MS = 300;\nconst MIN_SEARCH_CHARS = 2;\n\nexport interface DossierOption {\n  id: string;\n  name_en: string;\n  name_ar: string;\n  type: DossierType;\n  status: string;\n}\n\nexport interface DossierPickerProps {\n  value?: string;\n  onChange: (dossierId: string | null, dossier?: DossierOption) => void;\n  disabled?: boolean;\n  placeholder?: string;\n  className?: string;\n  /** Pre-selected dossier info (for display when value is set externally) */\n  selectedDossier?: DossierOption;\n}\n\n/**\n * Get icon for dossier type\n */\nfunction getDossierTypeIcon(type: DossierType) {\n  switch (type) {\n    case 'country':\n      return Globe;\n    case 'organization':\n      return Building2;\n    case 'forum':\n      return Users;\n    default:\n      return FileText;\n  }\n}\n\n/**\n * Get recent dossiers from localStorage\n */\nfunction getRecentDossiers(): DossierOption[] {\n  try {\n    const stored = localStorage.getItem(STORAGE_KEY);\n    if (stored) {\n      return JSON.parse(stored);\n    }\n  } catch (e) {\n    console.warn('Failed to parse recent dossiers from localStorage:', e);\n  }\n  return [];\n}\n\n/**\n * Add dossier to recent list\n */\nfunction addRecentDossier(dossier: DossierOption): void {\n  try {\n    const recent = getRecentDossiers();\n    const updated = [dossier, ...recent.filter((d) => d.id !== dossier.id)].slice(0, MAX_RECENT);\n    localStorage.setItem(STORAGE_KEY, JSON.stringify(updated));\n  } catch (e) {\n    console.warn('Failed to save recent dossier to localStorage:', e);\n  }\n}\n\nexport function DossierPicker({\n  value,\n  onChange,\n  disabled = false,\n  placeholder,\n  className,\n  selectedDossier: externalSelectedDossier,\n}: DossierPickerProps) {\n  const { t, i18n } = useTranslation('work-creation');\n  const isRTL = i18n.language === 'ar';\n\n  const [open, setOpen] = useState(false);\n  const [searchQuery, setSearchQuery] = useState('');\n  const [searchResults, setSearchResults] = useState<DossierOption[]>([]);\n  const [isSearching, setIsSearching] = useState(false);\n  const [recentDossiers, setRecentDossiers] = useState<DossierOption[]>([]);\n  const [selectedDossier, setSelectedDossier] = useState<DossierOption | undefined>(\n    externalSelectedDossier\n  );\n\n  // Load recent dossiers on mount\n  useEffect(() => {\n    setRecentDossiers(getRecentDossiers());\n  }, []);\n\n  // Update selected dossier when external prop changes\n  useEffect(() => {\n    if (externalSelectedDossier) {\n      setSelectedDossier(externalSelectedDossier);\n    }\n  }, [externalSelectedDossier]);\n\n  // Debounced search\n  useEffect(() => {\n    if (searchQuery.length < MIN_SEARCH_CHARS) {\n      setSearchResults([]);\n      return;\n    }\n\n    const timeoutId = setTimeout(async () => {\n      setIsSearching(true);\n      try {\n        const response = await autocompleteDossiers({\n          query: searchQuery,\n          limit: 10,\n        });\n        const results: DossierOption[] = response.suggestions.map((s: AutocompleteResult) => ({\n          id: s.id,\n          name_en: s.name_en,\n          name_ar: s.name_ar,\n          type: s.type,\n          status: s.status,\n        }));\n        setSearchResults(results);\n      } catch (error) {\n        console.error('Failed to search dossiers:', error);\n        setSearchResults([]);\n      } finally {\n        setIsSearching(false);\n      }\n    }, DEBOUNCE_MS);\n\n    return () => clearTimeout(timeoutId);\n  }, [searchQuery]);\n\n  const handleSelect = useCallback(\n    (dossier: DossierOption) => {\n      setSelectedDossier(dossier);\n      addRecentDossier(dossier);\n      setRecentDossiers(getRecentDossiers());\n      onChange(dossier.id, dossier);\n      setOpen(false);\n      setSearchQuery('');\n    },\n    [onChange]\n  );\n\n  const handleClear = useCallback(() => {\n    setSelectedDossier(undefined);\n    onChange(null);\n  }, [onChange]);\n\n  const displayName = selectedDossier\n    ? isRTL\n      ? selectedDossier.name_ar || selectedDossier.name_en\n      : selectedDossier.name_en\n    : null;\n\n  const Icon = selectedDossier ? getDossierTypeIcon(selectedDossier.type) : null;\n\n  return (\n    <div className={cn('w-full', className)}>\n      {/* Selected dossier display */}\n      {selectedDossier && (\n        <div\n          className=\"flex items-center gap-2 p-3 mb-2 rounded-lg border bg-muted/50\"\n          dir={isRTL ? 'rtl' : 'ltr'}\n        >\n          {Icon && <Icon className=\"size-4 text-muted-foreground shrink-0\" />}\n          <span className=\"flex-1 text-sm font-medium truncate\">{displayName}</span>\n          <Badge variant=\"outline\" className=\"text-xs\">\n            {selectedDossier.type}\n          </Badge>\n          <Button\n            type=\"button\"\n            variant=\"ghost\"\n            size=\"sm\"\n            className=\"size-6 p-0\"\n            onClick={handleClear}\n            disabled={disabled}\n          >\n            <X className=\"size-3\" />\n            <span className=\"sr-only\">{t('form.clear', 'Clear')}</span>\n          </Button>\n        </div>\n      )}\n\n      {/* Dossier picker popover */}\n      <Popover open={open} onOpenChange={setOpen}>\n        <PopoverTrigger asChild>\n          <Button\n            type=\"button\"\n            variant=\"outline\"\n            role=\"combobox\"\n            aria-expanded={open}\n            className={cn(\n              'w-full min-h-11 justify-between font-normal',\n              !selectedDossier && 'text-muted-foreground'\n            )}\n            disabled={disabled}\n          >\n            <span className=\"flex items-center gap-2\">\n              <Search className=\"size-4 shrink-0\" />\n              {selectedDossier\n                ? t('form.changeDossier', 'Change dossier')\n                : placeholder || t('form.selectDossier', 'Select a dossier')}\n            </span>\n            <ChevronsUpDown className={cn('size-4 shrink-0 opacity-50', isRTL && 'rotate-180')} />\n          </Button>\n        </PopoverTrigger>\n        <PopoverContent\n          className=\"w-[var(--radix-popover-trigger-width)] p-0\"\n          align=\"start\"\n          dir={isRTL ? 'rtl' : 'ltr'}\n        >\n          <Command shouldFilter={false}>\n            <CommandInput\n              placeholder={t('form.searchDossiers', 'Search dossiers...')}\n              value={searchQuery}\n              onValueChange={setSearchQuery}\n            />\n            <CommandList>\n              <CommandEmpty>\n                {isSearching\n                  ? t('form.searching', 'Searching...')\n                  : searchQuery.length < MIN_SEARCH_CHARS\n                    ? t('form.typeToSearch', 'Type at least 2 characters to search')\n                    : t('form.noDossiersFound', 'No dossiers found')}\n              </CommandEmpty>\n\n              {/* Search results */}\n              {searchResults.length > 0 && (\n                <CommandGroup heading={t('form.searchResults', 'Search Results')}>\n                  {searchResults.map((dossier) => {\n                    const DossierIcon = getDossierTypeIcon(dossier.type);\n                    const name = isRTL ? dossier.name_ar || dossier.name_en : dossier.name_en;\n                    return (\n                      <CommandItem\n                        key={dossier.id}\n                        value={dossier.id}\n                        onSelect={() => handleSelect(dossier)}\n                        className=\"min-h-11\"\n                      >\n                        <Check\n                          className={cn(\n                            'size-4 shrink-0',\n                            isRTL ? 'ms-2' : 'me-2',\n                            value === dossier.id ? 'opacity-100' : 'opacity-0'\n                          )}\n                        />\n                        <DossierIcon\n                          className={cn('size-4 shrink-0 text-muted-foreground', isRTL ? 'ms-2' : 'me-2')}\n                        />\n                        <span className=\"flex-1 truncate\">{name}</span>\n                        <Badge variant=\"outline\" className=\"text-xs ms-2\">\n                          {dossier.type}\n                        </Badge>\n                      </CommandItem>\n                    );\n                  })}\n                </CommandGroup>\n              )}\n\n              {/* Recent dossiers (shown when no search query) */}\n              {searchQuery.length < MIN_SEARCH_CHARS && recentDossiers.length > 0 && (\n                <CommandGroup heading={t('form.recentDossiers', 'Recent Dossiers')}>\n                  {recentDossiers.map((dossier) => {\n                    const DossierIcon = getDossierTypeIcon(dossier.type);\n                    const name = isRTL ? dossier.name_ar || dossier.name_en : dossier.name_en;\n                    return (\n                      <CommandItem\n                        key={dossier.id}\n                        value={dossier.id}\n                        onSelect={() => handleSelect(dossier)}\n                        className=\"min-h-11\"\n                      >\n                        <Check\n                          className={cn(\n                            'size-4 shrink-0',\n                            isRTL ? 'ms-2' : 'me-2',\n                            value === dossier.id ? 'opacity-100' : 'opacity-0'\n                          )}\n                        />\n                        <DossierIcon\n                          className={cn('size-4 shrink-0 text-muted-foreground', isRTL ? 'ms-2' : 'me-2')}\n                        />\n                        <span className=\"flex-1 truncate\">{name}</span>\n                        <Badge variant=\"outline\" className=\"text-xs ms-2\">\n                          {dossier.type}\n                        </Badge>\n                      </CommandItem>\n                    );\n                  })}\n                </CommandGroup>\n              )}\n            </CommandList>\n          </Command>\n        </PopoverContent>\n      </Popover>\n    </div>\n  );\n}\n\nexport default DossierPicker;\n","import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Input = React.forwardRef<HTMLInputElement, React.ComponentProps<\"input\">>(\n ({ className, type, ...props }, ref) => {\n return (\n <input\n type={type}\n className={cn(\n \"flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n className\n )}\n ref={ref}\n {...props}\n />\n )\n }\n)\nInput.displayName = \"Input\"\n\nexport { Input }\n","import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Textarea = React.forwardRef<\n HTMLTextAreaElement,\n React.ComponentProps<\"textarea\">\n>(({ className, ...props }, ref) => {\n return (\n <textarea\n className={cn(\n \"flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n className\n )}\n ref={ref}\n {...props}\n />\n )\n})\nTextarea.displayName = \"Textarea\"\n\nexport { Textarea }\n","import * as React from \"react\"\nimport {\n ChevronDownIcon,\n ChevronLeftIcon,\n ChevronRightIcon,\n} from \"lucide-react\"\nimport { DayButton, DayPicker, getDefaultClassNames } from \"react-day-picker\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Button, buttonVariants } from \"@/components/ui/button\"\n\nfunction Calendar({\n className,\n classNames,\n showOutsideDays = true,\n captionLayout = \"label\",\n buttonVariant = \"ghost\",\n formatters,\n components,\n ...props\n}: React.ComponentProps<typeof DayPicker> & {\n buttonVariant?: React.ComponentProps<typeof Button>[\"variant\"]\n}) {\n const defaultClassNames = getDefaultClassNames()\n\n return (\n <DayPicker\n showOutsideDays={showOutsideDays}\n className={cn(\n \"bg-background group/calendar p-3 [--cell-size:2rem] [[data-slot=card-content]_&]:bg-transparent [[data-slot=popover-content]_&]:bg-transparent\",\n String.raw`rtl:**:[.rdp-button\\_next>svg]:rotate-180`,\n String.raw`rtl:**:[.rdp-button\\_previous>svg]:rotate-180`,\n className\n )}\n captionLayout={captionLayout}\n formatters={{\n formatMonthDropdown: (date) =>\n date.toLocaleString(\"default\", { month: \"short\" }),\n ...formatters,\n }}\n classNames={{\n root: cn(\"w-fit\", defaultClassNames.root),\n months: cn(\n \"relative flex flex-col gap-4 md:flex-row\",\n defaultClassNames.months\n ),\n month: cn(\"flex w-full flex-col gap-4\", defaultClassNames.month),\n nav: cn(\n \"absolute inset-x-0 top-0 flex w-full items-center justify-between gap-1\",\n defaultClassNames.nav\n ),\n button_previous: cn(\n buttonVariants({ variant: buttonVariant }),\n \"h-[--cell-size] w-[--cell-size] select-none p-0 aria-disabled:opacity-50\",\n defaultClassNames.button_previous\n ),\n button_next: cn(\n buttonVariants({ variant: buttonVariant }),\n \"h-[--cell-size] w-[--cell-size] select-none p-0 aria-disabled:opacity-50\",\n defaultClassNames.button_next\n ),\n month_caption: cn(\n \"flex h-[--cell-size] w-full items-center justify-center px-[--cell-size]\",\n defaultClassNames.month_caption\n ),\n dropdowns: cn(\n \"flex h-[--cell-size] w-full items-center justify-center gap-1.5 text-sm font-medium\",\n defaultClassNames.dropdowns\n ),\n dropdown_root: cn(\n \"has-focus:border-ring border-input shadow-xs has-focus:ring-ring/50 has-focus:ring-[3px] relative rounded-md border\",\n defaultClassNames.dropdown_root\n ),\n dropdown: cn(\n \"bg-popover absolute inset-0 opacity-0\",\n defaultClassNames.dropdown\n ),\n caption_label: cn(\n \"select-none font-medium\",\n captionLayout === \"label\"\n ? \"text-sm\"\n : \"[&>svg]:text-muted-foreground flex h-8 items-center gap-1 rounded-md ps-2 pe-1 text-sm [&>svg]:size-3.5\",\n defaultClassNames.caption_label\n ),\n table: \"w-full border-collapse\",\n weekdays: cn(\"flex\", defaultClassNames.weekdays),\n weekday: cn(\n \"text-muted-foreground flex-1 select-none rounded-md text-[0.8rem] font-normal\",\n defaultClassNames.weekday\n ),\n week: cn(\"mt-2 flex w-full\", defaultClassNames.week),\n week_number_header: cn(\n \"w-[--cell-size] select-none\",\n defaultClassNames.week_number_header\n ),\n week_number: cn(\n \"text-muted-foreground select-none text-[0.8rem]\",\n defaultClassNames.week_number\n ),\n day: cn(\n \"group/day relative aspect-square h-full w-full select-none p-0 text-center [&:first-child[data-selected=true]_button]:rounded-s-md [&:last-child[data-selected=true]_button]:rounded-e-md\",\n defaultClassNames.day\n ),\n range_start: cn(\n \"bg-accent rounded-s-md\",\n defaultClassNames.range_start\n ),\n range_middle: cn(\"rounded-none\", defaultClassNames.range_middle),\n range_end: cn(\"bg-accent rounded-e-md\", defaultClassNames.range_end),\n today: cn(\n \"bg-accent text-accent-foreground rounded-md data-[selected=true]:rounded-none\",\n defaultClassNames.today\n ),\n outside: cn(\n \"text-muted-foreground aria-selected:text-muted-foreground\",\n defaultClassNames.outside\n ),\n disabled: cn(\n \"text-muted-foreground opacity-50\",\n defaultClassNames.disabled\n ),\n hidden: cn(\"invisible\", defaultClassNames.hidden),\n ...classNames,\n }}\n components={{\n Root: ({ className, rootRef, ...props }) => {\n return (\n <div\n data-slot=\"calendar\"\n ref={rootRef}\n className={cn(className)}\n {...props}\n />\n )\n },\n Chevron: ({ className, orientation, ...props }) => {\n if (orientation === \"left\") {\n return (\n <ChevronLeftIcon className={cn(\"size-4\", className)} {...props} />\n )\n }\n\n if (orientation === \"right\") {\n return (\n <ChevronRightIcon\n className={cn(\"size-4\", className)}\n {...props}\n />\n )\n }\n\n return (\n <ChevronDownIcon className={cn(\"size-4\", className)} {...props} />\n )\n },\n DayButton: CalendarDayButton,\n WeekNumber: ({ children, ...props }) => {\n return (\n <td {...props}>\n <div className=\"flex size-[--cell-size] items-center justify-center text-center\">\n {children}\n </div>\n </td>\n )\n },\n ...components,\n }}\n {...props}\n />\n )\n}\n\nfunction CalendarDayButton({\n className,\n day,\n modifiers,\n ...props\n}: React.ComponentProps<typeof DayButton>) {\n const defaultClassNames = getDefaultClassNames()\n\n const ref = React.useRef<HTMLButtonElement>(null)\n React.useEffect(() => {\n if (modifiers.focused) ref.current?.focus()\n }, [modifiers.focused])\n\n return (\n <Button\n ref={ref}\n variant=\"ghost\"\n size=\"icon\"\n data-day={day.date.toLocaleDateString()}\n data-selected-single={\n modifiers.selected &&\n !modifiers.range_start &&\n !modifiers.range_end &&\n !modifiers.range_middle\n }\n data-range-start={modifiers.range_start}\n data-range-end={modifiers.range_end}\n data-range-middle={modifiers.range_middle}\n className={cn(\n \"data-[selected-single=true]:bg-primary data-[selected-single=true]:text-primary-foreground data-[range-middle=true]:bg-accent data-[range-middle=true]:text-accent-foreground data-[range-start=true]:bg-primary data-[range-start=true]:text-primary-foreground data-[range-end=true]:bg-primary data-[range-end=true]:text-primary-foreground group-data-[focused=true]/day:border-ring group-data-[focused=true]/day:ring-ring/50 flex aspect-square h-auto w-full min-w-[--cell-size] flex-col gap-1 font-normal leading-none data-[range-end=true]:rounded-md data-[range-middle=true]:rounded-none data-[range-start=true]:rounded-md group-data-[focused=true]/day:relative group-data-[focused=true]/day:z-10 group-data-[focused=true]/day:ring-[3px] [&>span]:text-xs [&>span]:opacity-70\",\n defaultClassNames.day,\n className\n )}\n {...props}\n />\n )\n}\n\nexport { Calendar, CalendarDayButton }\n","import * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst labelVariants = cva(\n \"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n)\n\nconst Label = React.forwardRef<\n React.ElementRef<typeof LabelPrimitive.Root>,\n React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> &\n VariantProps<typeof labelVariants>\n>(({ className, ...props }, ref) => (\n <LabelPrimitive.Root\n ref={ref}\n className={cn(labelVariants(), className)}\n {...props}\n />\n))\nLabel.displayName = LabelPrimitive.Root.displayName\n\nexport { Label }\n","\"use client\"\n\nimport * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport {\n Controller,\n FormProvider,\n useFormContext,\n type ControllerProps,\n type FieldPath,\n type FieldValues,\n} from \"react-hook-form\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Label } from \"@/components/ui/label\"\n\nconst Form = FormProvider\n\ntype FormFieldContextValue<\n TFieldValues extends FieldValues = FieldValues,\n TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n> = {\n name: TName\n}\n\nconst FormFieldContext = React.createContext<FormFieldContextValue>(\n {} as FormFieldContextValue\n)\n\nconst FormField = <\n TFieldValues extends FieldValues = FieldValues,\n TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n>({\n ...props\n}: ControllerProps<TFieldValues, TName>) => {\n return (\n <FormFieldContext.Provider value={{ name: props.name }}>\n <Controller {...props} />\n </FormFieldContext.Provider>\n )\n}\n\nconst useFormField = () => {\n const fieldContext = React.useContext(FormFieldContext)\n const itemContext = React.useContext(FormItemContext)\n const { getFieldState, formState } = useFormContext()\n\n const fieldState = getFieldState(fieldContext.name, formState)\n\n if (!fieldContext) {\n throw new Error(\"useFormField should be used within <FormField>\")\n }\n\n const { id } = itemContext\n\n return {\n id,\n name: fieldContext.name,\n formItemId: `${id}-form-item`,\n formDescriptionId: `${id}-form-item-description`,\n formMessageId: `${id}-form-item-message`,\n ...fieldState,\n }\n}\n\ntype FormItemContextValue = {\n id: string\n}\n\nconst FormItemContext = React.createContext<FormItemContextValue>(\n {} as FormItemContextValue\n)\n\nconst FormItem = React.forwardRef<\n HTMLDivElement,\n React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n const id = React.useId()\n\n return (\n <FormItemContext.Provider value={{ id }}>\n <div ref={ref} className={cn(\"space-y-2\", className)} {...props} />\n </FormItemContext.Provider>\n )\n})\nFormItem.displayName = \"FormItem\"\n\nconst FormLabel = React.forwardRef<\n React.ElementRef<typeof LabelPrimitive.Root>,\n React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root>\n>(({ className, ...props }, ref) => {\n const { error, formItemId } = useFormField()\n\n return (\n <Label\n ref={ref}\n className={cn(error && \"text-destructive\", className)}\n htmlFor={formItemId}\n {...props}\n />\n )\n})\nFormLabel.displayName = \"FormLabel\"\n\nconst FormControl = React.forwardRef<\n React.ElementRef<typeof Slot>,\n React.ComponentPropsWithoutRef<typeof Slot>\n>(({ ...props }, ref) => {\n const { error, formItemId, formDescriptionId, formMessageId } = useFormField()\n\n return (\n <Slot\n ref={ref}\n id={formItemId}\n aria-describedby={\n !error\n ? `${formDescriptionId}`\n : `${formDescriptionId} ${formMessageId}`\n }\n aria-invalid={!!error}\n {...props}\n />\n )\n})\nFormControl.displayName = \"FormControl\"\n\nconst FormDescription = React.forwardRef<\n HTMLParagraphElement,\n React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => {\n const { formDescriptionId } = useFormField()\n\n return (\n <p\n ref={ref}\n id={formDescriptionId}\n className={cn(\"text-[0.8rem] text-muted-foreground\", className)}\n {...props}\n />\n )\n})\nFormDescription.displayName = \"FormDescription\"\n\nconst FormMessage = React.forwardRef<\n HTMLParagraphElement,\n React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, children, ...props }, ref) => {\n const { error, formMessageId } = useFormField()\n const body = error ? String(error?.message ?? \"\") : children\n\n if (!body) {\n return null\n }\n\n return (\n <p\n ref={ref}\n id={formMessageId}\n className={cn(\"text-[0.8rem] font-medium text-destructive\", className)}\n {...props}\n >\n {body}\n </p>\n )\n})\nFormMessage.displayName = \"FormMessage\"\n\nexport {\n useFormField,\n Form,\n FormItem,\n FormLabel,\n FormControl,\n FormDescription,\n FormMessage,\n FormField,\n}\n","import * as React from 'react';\nimport * as SelectPrimitive from '@radix-ui/react-select';\nimport { Check, ChevronDown, ChevronUp } from 'lucide-react';\n\nimport { cn } from '@/lib/utils';\n\nconst Select = SelectPrimitive.Root;\n\nconst SelectGroup = SelectPrimitive.Group;\n\nconst SelectValue = SelectPrimitive.Value;\n\nconst SelectTrigger = React.forwardRef<\n React.ElementRef<typeof SelectPrimitive.Trigger>,\n React.ComponentPropsWithoutRef<typeof SelectPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n <SelectPrimitive.Trigger\n ref={ref}\n className={cn(\n 'flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1',\n className\n )}\n {...props}\n >\n {children}\n <SelectPrimitive.Icon asChild>\n <ChevronDown className=\"h-4 w-4 opacity-50\" />\n </SelectPrimitive.Icon>\n </SelectPrimitive.Trigger>\n));\nSelectTrigger.displayName = SelectPrimitive.Trigger.displayName;\n\nconst SelectScrollUpButton = React.forwardRef<\n React.ElementRef<typeof SelectPrimitive.ScrollUpButton>,\n React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollUpButton>\n>(({ className, ...props }, ref) => (\n <SelectPrimitive.ScrollUpButton\n ref={ref}\n className={cn('flex cursor-default items-center justify-center py-1', className)}\n {...props}\n >\n <ChevronUp className=\"h-4 w-4\" />\n </SelectPrimitive.ScrollUpButton>\n));\nSelectScrollUpButton.displayName = SelectPrimitive.ScrollUpButton.displayName;\n\nconst SelectScrollDownButton = React.forwardRef<\n React.ElementRef<typeof SelectPrimitive.ScrollDownButton>,\n React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollDownButton>\n>(({ className, ...props }, ref) => (\n <SelectPrimitive.ScrollDownButton\n ref={ref}\n className={cn('flex cursor-default items-center justify-center py-1', className)}\n {...props}\n >\n <ChevronDown className=\"h-4 w-4\" />\n </SelectPrimitive.ScrollDownButton>\n));\nSelectScrollDownButton.displayName = SelectPrimitive.ScrollDownButton.displayName;\n\nconst SelectContent = React.forwardRef<\n React.ElementRef<typeof SelectPrimitive.Content>,\n React.ComponentPropsWithoutRef<typeof SelectPrimitive.Content>\n>(({ className, children, position = 'popper', ...props }, ref) => (\n <SelectPrimitive.Portal>\n <SelectPrimitive.Content\n ref={ref}\n className={cn(\n 'relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2',\n position === 'popper' &&\n 'data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1',\n className\n )}\n position={position}\n {...props}\n >\n <SelectScrollUpButton />\n <SelectPrimitive.Viewport\n className={cn(\n 'p-1',\n position === 'popper' &&\n 'h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]'\n )}\n >\n {children}\n </SelectPrimitive.Viewport>\n <SelectScrollDownButton />\n </SelectPrimitive.Content>\n </SelectPrimitive.Portal>\n));\nSelectContent.displayName = SelectPrimitive.Content.displayName;\n\nconst SelectLabel = React.forwardRef<\n React.ElementRef<typeof SelectPrimitive.Label>,\n React.ComponentPropsWithoutRef<typeof SelectPrimitive.Label>\n>(({ className, ...props }, ref) => (\n <SelectPrimitive.Label\n ref={ref}\n className={cn('py-1.5 ps-8 pe-2 text-sm font-semibold', className)}\n {...props}\n />\n));\nSelectLabel.displayName = SelectPrimitive.Label.displayName;\n\nconst SelectItem = React.forwardRef<\n React.ElementRef<typeof SelectPrimitive.Item>,\n React.ComponentPropsWithoutRef<typeof SelectPrimitive.Item>\n>(({ className, children, ...props }, ref) => (\n <SelectPrimitive.Item\n ref={ref}\n className={cn(\n 'relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 ps-8 pe-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50',\n className\n )}\n {...props}\n >\n <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n <SelectPrimitive.ItemIndicator>\n <Check className=\"h-4 w-4\" />\n </SelectPrimitive.ItemIndicator>\n </span>\n\n <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>\n </SelectPrimitive.Item>\n));\nSelectItem.displayName = SelectPrimitive.Item.displayName;\n\nconst SelectSeparator = React.forwardRef<\n React.ElementRef<typeof SelectPrimitive.Separator>,\n React.ComponentPropsWithoutRef<typeof SelectPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n <SelectPrimitive.Separator\n ref={ref}\n className={cn('-mx-1 my-1 h-px bg-muted', className)}\n {...props}\n />\n));\nSelectSeparator.displayName = SelectPrimitive.Separator.displayName;\n\nexport {\n Select,\n SelectGroup,\n SelectValue,\n SelectTrigger,\n SelectContent,\n SelectLabel,\n SelectItem,\n SelectSeparator,\n SelectScrollUpButton,\n SelectScrollDownButton,\n};\n","/**\n * Commitments Service v1.1\n * Feature: 031-commitments-management\n *\n * API client for full CRUD operations on commitments with cursor-based pagination,\n * status management, and evidence upload capabilities.\n */\n\nimport { supabase } from '@/lib/supabase';\nimport type {\n  Commitment,\n  CommitmentFilters,\n  CommitmentsListResponse,\n  CommitmentStatusHistory,\n  CreateCommitmentInput,\n  UpdateCommitmentInput,\n  UpdateCommitmentStatusInput,\n  CancelCommitmentInput,\n  PaginationCursor,\n  EvidenceUploadResponse,\n  EvidenceUrlResponse,\n  CommitmentStatus,\n  CommitmentPriority,\n  DEFAULT_PAGE_SIZE,\n} from '@/types/commitment.types';\n\n// Re-export types for convenience\nexport type {\n  Commitment,\n  CommitmentFilters,\n  CommitmentsListResponse,\n  CommitmentStatusHistory,\n  CreateCommitmentInput,\n  UpdateCommitmentInput,\n  PaginationCursor,\n};\n\n/**\n * Fetch commitments with cursor-based pagination and filters\n *\n * @param filters - Optional filters for querying commitments\n * @param cursor - Pagination cursor for infinite scroll\n * @param limit - Number of items per page (default: 20)\n * @returns Commitments list with pagination info\n */\nexport async function getCommitments(\n  filters?: CommitmentFilters,\n  cursor?: PaginationCursor,\n  limit: number = 20\n): Promise<CommitmentsListResponse> {\n  let query = supabase\n    .from('aa_commitments')\n    .select('*', { count: 'exact' });\n\n  // Apply entity filters\n  if (filters?.dossierId) {\n    query = query.eq('dossier_id', filters.dossierId);\n  }\n\n  if (filters?.ownerId) {\n    query = query.or(`owner_user_id.eq.${filters.ownerId},owner_contact_id.eq.${filters.ownerId}`);\n  }\n\n  if (filters?.ownerType) {\n    query = query.eq('owner_type', filters.ownerType);\n  }\n\n  // Apply status filters\n  if (filters?.status && filters.status.length > 0) {\n    query = query.in('status', filters.status);\n  }\n\n  if (filters?.priority && filters.priority.length > 0) {\n    query = query.in('priority', filters.priority);\n  }\n\n  // Apply overdue filter\n  if (filters?.overdue) {\n    const today = new Date().toISOString().split('T')[0];\n    query = query\n      .lt('due_date', today)\n      .not('status', 'in', '(completed,cancelled)');\n  }\n\n  // Apply date range filters\n  if (filters?.dueDateFrom) {\n    query = query.gte('due_date', filters.dueDateFrom);\n  }\n\n  if (filters?.dueDateTo) {\n    query = query.lte('due_date', filters.dueDateTo);\n  }\n\n  // Apply search filter\n  if (filters?.search) {\n    query = query.or(`title.ilike.%${filters.search}%,description.ilike.%${filters.search}%`);\n  }\n\n  // Apply cursor-based pagination\n  if (cursor) {\n    query = query.or(\n      `due_date.gt.${cursor.due_date},and(due_date.eq.${cursor.due_date},id.gt.${cursor.id})`\n    );\n  }\n\n  // Order and limit\n  query = query\n    .order('due_date', { ascending: true })\n    .order('id', { ascending: true })\n    .limit(limit + 1); // Fetch one extra to check if there are more\n\n  const { data, error, count } = await query;\n\n  if (error) {\n    throw new Error(`Failed to fetch commitments: ${error.message}`);\n  }\n\n  const commitments = data ?? [];\n  const hasMore = commitments.length > limit;\n\n  // Remove the extra item if present\n  if (hasMore) {\n    commitments.pop();\n  }\n\n  // Build next cursor from last item\n  const lastItem = commitments[commitments.length - 1];\n  const nextCursor: PaginationCursor | null = hasMore && lastItem\n    ? { due_date: lastItem.due_date, id: lastItem.id }\n    : null;\n\n  return {\n    commitments,\n    totalCount: count ?? 0,\n    nextCursor,\n    hasMore,\n  };\n}\n\n/**\n * Get a single commitment by ID\n *\n * @param commitmentId - UUID of the commitment\n * @returns Commitment details\n */\nexport async function getCommitment(commitmentId: string): Promise<Commitment> {\n  const { data, error } = await supabase\n    .from('aa_commitments')\n    .select('*')\n    .eq('id', commitmentId)\n    .single();\n\n  if (error) {\n    throw new Error(`Failed to fetch commitment: ${error.message}`);\n  }\n\n  if (!data) {\n    throw new Error('Commitment not found');\n  }\n\n  return data as Commitment;\n}\n\n/**\n * Create a new commitment\n *\n * @param input - Commitment creation data\n * @returns Created commitment\n */\nexport async function createCommitment(input: CreateCommitmentInput): Promise<Commitment> {\n  const { data: { user } } = await supabase.auth.getUser();\n\n  if (!user) {\n    throw new Error('User must be authenticated to create a commitment');\n  }\n\n  // Determine owner based on owner_type\n  // - internal: owner_user_id = current user (or specified), owner_contact_id = null\n  // - external: owner_contact_id = specified, owner_user_id = null\n  const isInternal = input.owner_type === 'internal';\n  const owner_user_id = isInternal ? (input.owner_user_id ?? user.id) : null;\n  const owner_contact_id = isInternal ? null : (input.owner_contact_id ?? null);\n\n  // Tracking mode is STRICTLY determined by owner type (per valid_tracking constraint)\n  // - internal: MUST be 'automatic'\n  // - external: MUST be 'manual'\n  // Note: We override any input value to enforce the database constraint\n  const tracking_mode = isInternal ? 'automatic' : 'manual';\n\n  const { data, error } = await supabase\n    .from('aa_commitments')\n    .insert({\n      dossier_id: input.dossier_id,\n      after_action_id: input.after_action_id ?? null,\n      title: input.title,\n      description: input.description,\n      due_date: input.due_date,\n      owner_type: input.owner_type,\n      owner_user_id,\n      owner_contact_id,\n      priority: input.priority ?? 'medium',\n      status: input.status ?? 'pending',\n      tracking_mode,\n      proof_required: input.proof_required ?? false,\n      created_by: user.id,\n      updated_by: user.id,\n    })\n    .select()\n    .single();\n\n  if (error) {\n    throw new Error(`Failed to create commitment: ${error.message}`);\n  }\n\n  return data as Commitment;\n}\n\n/**\n * Update an existing commitment\n *\n * @param commitmentId - UUID of the commitment\n * @param input - Fields to update\n * @returns Updated commitment\n */\nexport async function updateCommitment(\n  commitmentId: string,\n  input: UpdateCommitmentInput\n): Promise<Commitment> {\n  const { data: { user } } = await supabase.auth.getUser();\n\n  if (!user) {\n    throw new Error('User must be authenticated to update a commitment');\n  }\n\n  const { data, error } = await supabase\n    .from('aa_commitments')\n    .update({\n      ...input,\n      updated_by: user.id,\n      updated_at: new Date().toISOString(),\n    })\n    .eq('id', commitmentId)\n    .select()\n    .single();\n\n  if (error) {\n    throw new Error(`Failed to update commitment: ${error.message}`);\n  }\n\n  return data as Commitment;\n}\n\n/**\n * Update commitment status with audit trail\n * The database trigger will automatically create a status history entry\n *\n * @param input - Status update data\n * @returns Updated commitment\n */\nexport async function updateCommitmentStatus(\n  input: UpdateCommitmentStatusInput\n): Promise<Commitment> {\n  const { data: { user } } = await supabase.auth.getUser();\n\n  if (!user) {\n    throw new Error('User must be authenticated to update status');\n  }\n\n  const updateData: Record<string, unknown> = {\n    status: input.status,\n    status_changed_at: new Date().toISOString(),\n    updated_by: user.id,\n    updated_at: new Date().toISOString(),\n  };\n\n  // If marking as completed, set completed_at\n  if (input.status === 'completed') {\n    updateData.completed_at = new Date().toISOString();\n    if (input.notes) {\n      updateData.completion_notes = input.notes;\n    }\n  }\n\n  const { data, error } = await supabase\n    .from('aa_commitments')\n    .update(updateData)\n    .eq('id', input.id)\n    .select()\n    .single();\n\n  if (error) {\n    // Check for status transition error\n    if (error.message.includes('Cannot change status')) {\n      throw new Error('INVALID_STATUS_TRANSITION: ' + error.message);\n    }\n    throw new Error(`Failed to update status: ${error.message}`);\n  }\n\n  return data as Commitment;\n}\n\n/**\n * Cancel a commitment with reason\n *\n * @param input - Cancellation data\n * @returns Updated commitment\n */\nexport async function cancelCommitment(input: CancelCommitmentInput): Promise<Commitment> {\n  return updateCommitmentStatus({\n    id: input.id,\n    status: 'cancelled',\n    notes: input.reason,\n  });\n}\n\n/**\n * Get status history for a commitment\n *\n * @param commitmentId - UUID of the commitment\n * @returns Array of status history entries\n */\nexport async function getCommitmentStatusHistory(\n  commitmentId: string\n): Promise<CommitmentStatusHistory[]> {\n  const { data, error } = await supabase\n    .from('commitment_status_history')\n    .select('*')\n    .eq('commitment_id', commitmentId)\n    .order('changed_at', { ascending: false });\n\n  if (error) {\n    throw new Error(`Failed to fetch status history: ${error.message}`);\n  }\n\n  return (data ?? []) as CommitmentStatusHistory[];\n}\n\n/**\n * Upload evidence file for a commitment\n *\n * @param commitmentId - UUID of the commitment\n * @param file - File to upload\n * @returns Upload response with proof_url\n */\nexport async function uploadEvidence(\n  commitmentId: string,\n  file: File\n): Promise<EvidenceUploadResponse> {\n  const { data: { user } } = await supabase.auth.getUser();\n\n  if (!user) {\n    throw new Error('User must be authenticated to upload evidence');\n  }\n\n  // Generate unique file path\n  const fileExt = file.name.split('.').pop();\n  const fileName = `${Date.now()}-${Math.random().toString(36).substring(7)}.${fileExt}`;\n  const filePath = `${commitmentId}/${fileName}`;\n\n  // Upload to storage bucket\n  const { error: uploadError } = await supabase.storage\n    .from('commitment-evidence')\n    .upload(filePath, file, {\n      contentType: file.type,\n      upsert: false,\n    });\n\n  if (uploadError) {\n    throw new Error(`Failed to upload evidence: ${uploadError.message}`);\n  }\n\n  const evidence_submitted_at = new Date().toISOString();\n\n  // Update commitment with proof_url\n  const { error: updateError } = await supabase\n    .from('aa_commitments')\n    .update({\n      proof_url: filePath,\n      evidence_submitted_at,\n      updated_by: user.id,\n      updated_at: new Date().toISOString(),\n    })\n    .eq('id', commitmentId);\n\n  if (updateError) {\n    throw new Error(`Failed to update commitment with evidence: ${updateError.message}`);\n  }\n\n  return {\n    proof_url: filePath,\n    evidence_submitted_at,\n  };\n}\n\n/**\n * Get signed URL for evidence download\n *\n * @param proofUrl - Path to the evidence file in storage\n * @returns Signed URL response\n */\nexport async function getEvidenceUrl(proofUrl: string): Promise<EvidenceUrlResponse> {\n  const { data, error } = await supabase.storage\n    .from('commitment-evidence')\n    .createSignedUrl(proofUrl, 3600); // 1 hour expiry\n\n  if (error) {\n    throw new Error(`Failed to get evidence URL: ${error.message}`);\n  }\n\n  return {\n    signedUrl: data.signedUrl,\n    expiresAt: new Date(Date.now() + 3600 * 1000).toISOString(),\n  };\n}\n\n/**\n * Delete a commitment (soft delete by setting status to cancelled)\n * Note: Full deletion may be restricted by RLS policies\n *\n * @param commitmentId - UUID of the commitment\n * @param reason - Reason for deletion/cancellation\n */\nexport async function deleteCommitment(commitmentId: string, reason: string): Promise<void> {\n  await cancelCommitment({ id: commitmentId, reason });\n}\n\n// ============================================================================\n// Utility Functions\n// ============================================================================\n\n/**\n * Get commitment status color for UI\n *\n * @param status - Commitment status\n * @returns Tailwind CSS color classes\n */\nexport function getCommitmentStatusColor(\n  status: CommitmentStatus\n): string {\n  switch (status) {\n    case 'completed':\n      return 'text-green-600 dark:text-green-400 bg-green-50 dark:bg-green-900/20';\n    case 'in_progress':\n      return 'text-blue-600 dark:text-blue-400 bg-blue-50 dark:bg-blue-900/20';\n    case 'pending':\n      return 'text-yellow-600 dark:text-yellow-400 bg-yellow-50 dark:bg-yellow-900/20';\n    case 'cancelled':\n      return 'text-gray-600 dark:text-gray-400 bg-gray-50 dark:bg-gray-900/20';\n    default:\n      return 'text-gray-600 dark:text-gray-400 bg-gray-50 dark:bg-gray-900/20';\n  }\n}\n\n/**\n * Get commitment priority color for UI\n *\n * @param priority - Commitment priority\n * @returns Tailwind CSS color class\n */\nexport function getCommitmentPriorityColor(\n  priority: CommitmentPriority\n): string {\n  switch (priority) {\n    case 'critical':\n      return 'text-red-600 dark:text-red-400';\n    case 'high':\n      return 'text-orange-600 dark:text-orange-400';\n    case 'medium':\n      return 'text-yellow-600 dark:text-yellow-400';\n    case 'low':\n      return 'text-green-600 dark:text-green-400';\n    default:\n      return 'text-gray-600 dark:text-gray-400';\n  }\n}\n\n/**\n * Check if commitment is overdue\n *\n * @param dueDate - Commitment due date (ISO string)\n * @param status - Commitment status\n * @returns True if overdue\n */\nexport function isCommitmentOverdue(\n  dueDate: string,\n  status: CommitmentStatus\n): boolean {\n  if (status === 'completed' || status === 'cancelled') {\n    return false;\n  }\n\n  const today = new Date();\n  today.setHours(0, 0, 0, 0);\n  const due = new Date(dueDate);\n  due.setHours(0, 0, 0, 0);\n\n  return due < today;\n}\n\n/**\n * Calculate days until due or days overdue\n *\n * @param dueDate - Commitment due date (ISO string)\n * @returns Positive for days until due, negative for days overdue\n */\nexport function getDaysUntilDue(dueDate: string): number {\n  const today = new Date();\n  today.setHours(0, 0, 0, 0);\n  const due = new Date(dueDate);\n  due.setHours(0, 0, 0, 0);\n\n  const diffTime = due.getTime() - today.getTime();\n  return Math.ceil(diffTime / (1000 * 60 * 60 * 24));\n}\n","/**\n * Commitment Types v1.1\n * Feature: 031-commitments-management\n *\n * TypeScript interfaces for commitment management with full CRUD operations,\n * status tracking, evidence upload, and filtering capabilities.\n */\n\n// Note: Database types are manually defined here since the aa_commitments table\n// and commitment_status_history table types need to match v1.1 schema.\n// When regenerating database.types.ts, ensure these tables are included.\n\n/**\n * Commitment status values\n * Note: 'overdue' is auto-applied by the backend when a commitment passes its due date\n */\nexport type CommitmentStatus = 'pending' | 'in_progress' | 'completed' | 'cancelled' | 'overdue';\n\n/**\n * Commitment priority levels\n */\nexport type CommitmentPriority = 'low' | 'medium' | 'high' | 'critical';\n\n/**\n * Commitment owner type\n */\nexport type CommitmentOwnerType = 'internal' | 'external';\n\n/**\n * Commitment tracking mode\n */\nexport type CommitmentTrackingMode = 'automatic' | 'manual';\n\n/**\n * Full commitment entity from aa_commitments table\n * Enhanced for v1.1 with title, proof fields, and audit fields\n */\nexport interface Commitment {\n  id: string;\n  dossier_id: string;\n  after_action_id: string | null;\n\n  // Core fields\n  title: string;\n  description: string;\n  due_date: string;\n  status: CommitmentStatus;\n  priority: CommitmentPriority;\n\n  // Owner fields\n  owner_type: CommitmentOwnerType;\n  owner_user_id: string | null;\n  owner_contact_id: string | null;\n\n  // Tracking fields\n  tracking_mode: CommitmentTrackingMode;\n\n  // Evidence fields (v1.1)\n  proof_required: boolean;\n  proof_url: string | null;\n  evidence_submitted_at: string | null;\n\n  // Completion fields\n  completed_at: string | null;\n  completion_notes: string | null;\n\n  // AI extraction metadata\n  ai_confidence: number | null;\n\n  // Audit fields (v1.1)\n  status_changed_at: string | null;\n  created_by: string | null;\n  updated_by: string | null;\n  created_at: string | null;\n  updated_at: string | null;\n}\n\n/**\n * Commitment with computed properties for UI display\n */\nexport interface CommitmentWithComputedProps extends Commitment {\n  isOverdue: boolean;\n  daysOverdue: number;\n  daysUntilDue: number;\n  ownerName?: string;\n  dossierName?: string;\n}\n\n/**\n * Status history entry for audit trail\n */\nexport interface CommitmentStatusHistory {\n  id: string;\n  commitment_id: string;\n  old_status: CommitmentStatus | null;\n  new_status: CommitmentStatus;\n  changed_by: string;\n  changed_at: string;\n  notes: string | null;\n\n  // Joined data for display\n  changed_by_name?: string;\n}\n\n/**\n * Filter parameters for commitment queries\n */\nexport interface CommitmentFilters {\n  // Entity filters\n  dossierId?: string;\n  ownerId?: string;\n  ownerType?: CommitmentOwnerType;\n\n  // Status filters\n  status?: CommitmentStatus[];\n  priority?: CommitmentPriority[];\n  overdue?: boolean;\n\n  // Date range filters\n  dueDateFrom?: string;\n  dueDateTo?: string;\n\n  // Search\n  search?: string;\n}\n\n/**\n * Pagination cursor for infinite scroll\n */\nexport interface PaginationCursor {\n  due_date: string;\n  id: string;\n}\n\n/**\n * Paginated response for commitment list\n */\nexport interface CommitmentsListResponse {\n  commitments: Commitment[];\n  totalCount: number;\n  nextCursor: PaginationCursor | null;\n  hasMore: boolean;\n}\n\n/**\n * Input for creating a new commitment\n */\nexport interface CreateCommitmentInput {\n  dossier_id: string;\n  after_action_id?: string | null;\n\n  // Required fields\n  title: string;\n  description: string;\n  due_date: string;\n  owner_type: CommitmentOwnerType;\n\n  // Optional fields with defaults\n  priority?: CommitmentPriority;\n  status?: CommitmentStatus;\n  tracking_mode?: CommitmentTrackingMode;\n  proof_required?: boolean;\n\n  // Owner (one of these based on owner_type)\n  owner_user_id?: string | null;\n  owner_contact_id?: string | null;\n\n  // Context tracking (for audit trail)\n  created_from_route?: string;\n  created_from_entity?: string; // JSON stringified { type, id }\n}\n\n/**\n * Input for updating an existing commitment\n */\nexport interface UpdateCommitmentInput {\n  title?: string;\n  description?: string;\n  due_date?: string;\n  priority?: CommitmentPriority;\n  owner_type?: CommitmentOwnerType;\n  owner_user_id?: string | null;\n  owner_contact_id?: string | null;\n  tracking_mode?: CommitmentTrackingMode;\n  proof_required?: boolean;\n  completion_notes?: string | null;\n}\n\n/**\n * Input for updating commitment status\n */\nexport interface UpdateCommitmentStatusInput {\n  id: string;\n  status: CommitmentStatus;\n  notes?: string;\n}\n\n/**\n * Input for cancelling a commitment\n */\nexport interface CancelCommitmentInput {\n  id: string;\n  reason: string;\n}\n\n/**\n * Evidence upload response\n */\nexport interface EvidenceUploadResponse {\n  proof_url: string;\n  evidence_submitted_at: string;\n}\n\n/**\n * Signed URL response for evidence download\n */\nexport interface EvidenceUrlResponse {\n  signedUrl: string;\n  expiresAt: string;\n}\n\n/**\n * TanStack Query key factory for commitment queries\n */\nexport const commitmentKeys = {\n  all: ['commitments'] as const,\n  lists: () => [...commitmentKeys.all, 'list'] as const,\n  list: (filters?: CommitmentFilters) => [...commitmentKeys.lists(), filters] as const,\n  details: () => [...commitmentKeys.all, 'detail'] as const,\n  detail: (id: string) => [...commitmentKeys.details(), id] as const,\n  history: (commitmentId: string) => [...commitmentKeys.all, 'history', commitmentId] as const,\n};\n\n/**\n * Valid status transitions for non-admin users\n */\nexport const VALID_STATUS_TRANSITIONS: Record<CommitmentStatus, CommitmentStatus[]> = {\n  pending: ['in_progress', 'cancelled'],\n  in_progress: ['pending', 'completed', 'cancelled'],\n  completed: [], // Cannot change without admin\n  cancelled: [], // Cannot change\n  overdue: ['in_progress', 'completed', 'cancelled'], // Overdue items can still be worked on\n};\n\n/**\n * Check if a status transition is valid for non-admin users\n */\nexport function isValidStatusTransition(\n  from: CommitmentStatus,\n  to: CommitmentStatus\n): boolean {\n  return VALID_STATUS_TRANSITIONS[from].includes(to);\n}\n\n/**\n * Status color mapping for UI\n */\nexport const STATUS_COLORS: Record<CommitmentStatus, { bg: string; text: string; border: string }> = {\n  pending: {\n    bg: 'bg-yellow-50 dark:bg-yellow-900/20',\n    text: 'text-yellow-700 dark:text-yellow-300',\n    border: 'border-yellow-200 dark:border-yellow-800',\n  },\n  in_progress: {\n    bg: 'bg-blue-50 dark:bg-blue-900/20',\n    text: 'text-blue-700 dark:text-blue-300',\n    border: 'border-blue-200 dark:border-blue-800',\n  },\n  completed: {\n    bg: 'bg-green-50 dark:bg-green-900/20',\n    text: 'text-green-700 dark:text-green-300',\n    border: 'border-green-200 dark:border-green-800',\n  },\n  cancelled: {\n    bg: 'bg-gray-50 dark:bg-gray-900/20',\n    text: 'text-gray-700 dark:text-gray-300',\n    border: 'border-gray-200 dark:border-gray-800',\n  },\n  overdue: {\n    bg: 'bg-red-50 dark:bg-red-900/20',\n    text: 'text-red-700 dark:text-red-300',\n    border: 'border-red-200 dark:border-red-800',\n  },\n};\n\n/**\n * Priority color mapping for UI\n */\nexport const PRIORITY_COLORS: Record<CommitmentPriority, { bg: string; text: string }> = {\n  low: {\n    bg: 'bg-green-100 dark:bg-green-900/30',\n    text: 'text-green-700 dark:text-green-300',\n  },\n  medium: {\n    bg: 'bg-yellow-100 dark:bg-yellow-900/30',\n    text: 'text-yellow-700 dark:text-yellow-300',\n  },\n  high: {\n    bg: 'bg-orange-100 dark:bg-orange-900/30',\n    text: 'text-orange-700 dark:text-orange-300',\n  },\n  critical: {\n    bg: 'bg-red-100 dark:bg-red-900/30',\n    text: 'text-red-700 dark:text-red-300',\n  },\n};\n\n/**\n * Allowed file types for evidence upload\n */\nexport const ALLOWED_EVIDENCE_TYPES = [\n  'application/pdf',\n  'image/jpeg',\n  'image/png',\n  'application/vnd.openxmlformats-officedocument.wordprocessingml.document',\n] as const;\n\n/**\n * Maximum evidence file size in bytes (10MB)\n */\nexport const MAX_EVIDENCE_SIZE = 10 * 1024 * 1024;\n\n/**\n * Default page size for pagination\n */\nexport const DEFAULT_PAGE_SIZE = 20;\n","/**\n * useCommitments Hooks v1.1\n * Feature: 031-commitments-management\n *\n * TanStack Query hooks for full commitment CRUD operations with:\n * - Infinite scroll pagination\n * - Optimistic updates for status changes\n * - Cache invalidation on mutations\n */\n\nimport {\n  useQuery,\n  useMutation,\n  useInfiniteQuery,\n  useQueryClient,\n  type InfiniteData,\n} from '@tanstack/react-query';\nimport { toast } from 'sonner';\nimport { useTranslation } from 'react-i18next';\nimport {\n  getCommitments,\n  getCommitment,\n  createCommitment,\n  updateCommitment,\n  updateCommitmentStatus,\n  cancelCommitment,\n  getCommitmentStatusHistory,\n  uploadEvidence,\n  type Commitment,\n  type CommitmentFilters,\n  type CommitmentsListResponse,\n  type CreateCommitmentInput,\n  type UpdateCommitmentInput,\n  type PaginationCursor,\n} from '@/services/commitments.service';\nimport {\n  commitmentKeys,\n  type CommitmentStatusHistory,\n  type CommitmentStatus,\n} from '@/types/commitment.types';\n\n// Re-export for convenience\nexport { commitmentKeys };\n\n// ============================================================================\n// Query Options\n// ============================================================================\n\nexport interface UseCommitmentsOptions extends CommitmentFilters {\n  enabled?: boolean;\n}\n\nexport interface UseCommitmentOptions {\n  enabled?: boolean;\n}\n\n// ============================================================================\n// List Query Hook (Standard Pagination)\n// ============================================================================\n\n/**\n * Hook to fetch commitments list with standard pagination\n *\n * @param options - Hook options with filters\n * @returns TanStack Query result\n */\nexport function useCommitments(options?: UseCommitmentsOptions) {\n  const { enabled = true, ...filters } = options ?? {};\n\n  return useQuery<CommitmentsListResponse, Error>({\n    queryKey: commitmentKeys.list(filters),\n    queryFn: () => getCommitments(filters),\n    staleTime: 2 * 60 * 1000,\n    gcTime: 10 * 60 * 1000,\n    refetchOnWindowFocus: true,\n    refetchInterval: 2 * 60 * 1000,\n    enabled,\n  });\n}\n\n// ============================================================================\n// Infinite Query Hook (Cursor-Based Pagination)\n// ============================================================================\n\n/**\n * Hook to fetch commitments with infinite scroll pagination\n *\n * @param options - Hook options with filters\n * @returns TanStack Infinite Query result\n */\nexport function useInfiniteCommitments(options?: UseCommitmentsOptions) {\n  const { enabled = true, ...filters } = options ?? {};\n\n  return useInfiniteQuery<\n    CommitmentsListResponse,\n    Error,\n    InfiniteData<CommitmentsListResponse>,\n    ReturnType<typeof commitmentKeys.list>,\n    PaginationCursor | undefined\n  >({\n    queryKey: commitmentKeys.list(filters),\n    queryFn: ({ pageParam }) => getCommitments(filters, pageParam, 20),\n    initialPageParam: undefined,\n    getNextPageParam: (lastPage) => lastPage.nextCursor ?? undefined,\n    staleTime: 2 * 60 * 1000,\n    gcTime: 10 * 60 * 1000,\n    refetchOnWindowFocus: true,\n    enabled,\n  });\n}\n\n// ============================================================================\n// Detail Query Hook\n// ============================================================================\n\n/**\n * Hook to fetch a single commitment by ID\n *\n * @param commitmentId - UUID of the commitment\n * @param options - Hook options\n * @returns TanStack Query result\n */\nexport function useCommitment(commitmentId: string, options?: UseCommitmentOptions) {\n  const { enabled = true } = options ?? {};\n\n  return useQuery<Commitment, Error>({\n    queryKey: commitmentKeys.detail(commitmentId),\n    queryFn: () => getCommitment(commitmentId),\n    staleTime: 2 * 60 * 1000,\n    gcTime: 10 * 60 * 1000,\n    enabled: enabled && !!commitmentId,\n  });\n}\n\n// ============================================================================\n// Status History Query Hook\n// ============================================================================\n\n/**\n * Hook to fetch status history for a commitment\n *\n * @param commitmentId - UUID of the commitment\n * @returns TanStack Query result\n */\nexport function useCommitmentStatusHistory(commitmentId: string) {\n  return useQuery<CommitmentStatusHistory[], Error>({\n    queryKey: commitmentKeys.history(commitmentId),\n    queryFn: () => getCommitmentStatusHistory(commitmentId),\n    staleTime: 30 * 1000, // 30 seconds - history may update frequently\n    gcTime: 5 * 60 * 1000,\n    enabled: !!commitmentId,\n  });\n}\n\n// ============================================================================\n// Create Mutation Hook\n// ============================================================================\n\n/**\n * Hook to create a new commitment\n *\n * @returns TanStack Mutation result\n */\nexport function useCreateCommitment() {\n  const queryClient = useQueryClient();\n  const { t } = useTranslation('commitments');\n\n  return useMutation<Commitment, Error, CreateCommitmentInput>({\n    mutationFn: createCommitment,\n    onSuccess: () => {\n      // Invalidate list queries to refetch with new item\n      queryClient.invalidateQueries({ queryKey: commitmentKeys.lists() });\n      toast.success(t('success.created'));\n    },\n    onError: (error) => {\n      toast.error(t('errors.createFailed'));\n      console.error('Create commitment error:', error);\n    },\n  });\n}\n\n// ============================================================================\n// Update Mutation Hook\n// ============================================================================\n\n/**\n * Hook to update an existing commitment\n *\n * @returns TanStack Mutation result\n */\nexport function useUpdateCommitment() {\n  const queryClient = useQueryClient();\n  const { t } = useTranslation('commitments');\n\n  return useMutation<\n    Commitment,\n    Error,\n    { commitmentId: string; input: UpdateCommitmentInput }\n  >({\n    mutationFn: ({ commitmentId, input }) => updateCommitment(commitmentId, input),\n    onSuccess: (data) => {\n      // Update the specific commitment in cache\n      queryClient.setQueryData(commitmentKeys.detail(data.id), data);\n      // Invalidate list queries\n      queryClient.invalidateQueries({ queryKey: commitmentKeys.lists() });\n      toast.success(t('success.updated'));\n    },\n    onError: (error) => {\n      toast.error(t('errors.updateFailed'));\n      console.error('Update commitment error:', error);\n    },\n  });\n}\n\n// ============================================================================\n// Status Update Mutation Hook (with Optimistic Updates)\n// ============================================================================\n\ninterface UpdateStatusInput {\n  id: string;\n  status: CommitmentStatus;\n  notes?: string;\n}\n\n/**\n * Hook to update commitment status with optimistic updates\n *\n * Features:\n * - Immediate UI update before server response\n * - Automatic rollback on error\n * - Toast notifications\n *\n * @returns TanStack Mutation result\n */\nexport function useUpdateCommitmentStatus() {\n  const queryClient = useQueryClient();\n  const { t } = useTranslation('commitments');\n\n  return useMutation<Commitment, Error, UpdateStatusInput, { previous: unknown }>({\n    mutationFn: (input) => updateCommitmentStatus(input),\n\n    onMutate: async (input) => {\n      // Cancel any outgoing refetches\n      await queryClient.cancelQueries({ queryKey: commitmentKeys.lists() });\n\n      // Snapshot the previous value\n      const previous = queryClient.getQueryData(commitmentKeys.lists());\n\n      // Optimistically update the list cache\n      queryClient.setQueriesData<CommitmentsListResponse>(\n        { queryKey: commitmentKeys.lists() },\n        (old) => {\n          if (!old) return old;\n          return {\n            ...old,\n            commitments: old.commitments.map((c) =>\n              c.id === input.id\n                ? { ...c, status: input.status, status_changed_at: new Date().toISOString() }\n                : c\n            ),\n          };\n        }\n      );\n\n      // Also update infinite query data if present\n      queryClient.setQueriesData<InfiniteData<CommitmentsListResponse>>(\n        { queryKey: commitmentKeys.lists() },\n        (old) => {\n          if (!old) return old;\n          return {\n            ...old,\n            pages: old.pages.map((page) => ({\n              ...page,\n              commitments: page.commitments.map((c) =>\n                c.id === input.id\n                  ? { ...c, status: input.status, status_changed_at: new Date().toISOString() }\n                  : c\n              ),\n            })),\n          };\n        }\n      );\n\n      return { previous };\n    },\n\n    onError: (error, _input, context) => {\n      // Rollback to previous value on error\n      if (context?.previous) {\n        queryClient.setQueryData(commitmentKeys.lists(), context.previous);\n      }\n\n      // Show appropriate error message\n      if (error.message.includes('INVALID_STATUS_TRANSITION')) {\n        toast.error(t('errors.invalidTransition'));\n      } else {\n        toast.error(t('errors.statusUpdateFailed'));\n      }\n      console.error('Status update error:', error);\n    },\n\n    onSuccess: (data) => {\n      // Update the specific commitment detail\n      queryClient.setQueryData(commitmentKeys.detail(data.id), data);\n      // Invalidate history to refresh\n      queryClient.invalidateQueries({ queryKey: commitmentKeys.history(data.id) });\n      toast.success(t('status.updated'));\n    },\n\n    onSettled: () => {\n      // Always refetch after mutation settles\n      queryClient.invalidateQueries({ queryKey: commitmentKeys.lists() });\n    },\n  });\n}\n\n// ============================================================================\n// Cancel Mutation Hook\n// ============================================================================\n\ninterface CancelInput {\n  id: string;\n  reason: string;\n}\n\n/**\n * Hook to cancel a commitment\n *\n * @returns TanStack Mutation result\n */\nexport function useCancelCommitment() {\n  const queryClient = useQueryClient();\n  const { t } = useTranslation('commitments');\n\n  return useMutation<Commitment, Error, CancelInput>({\n    mutationFn: (input) => cancelCommitment(input),\n    onSuccess: (data) => {\n      queryClient.setQueryData(commitmentKeys.detail(data.id), data);\n      queryClient.invalidateQueries({ queryKey: commitmentKeys.lists() });\n      queryClient.invalidateQueries({ queryKey: commitmentKeys.history(data.id) });\n      toast.success(t('success.deleted'));\n    },\n    onError: (error) => {\n      toast.error(t('errors.deleteFailed'));\n      console.error('Cancel commitment error:', error);\n    },\n  });\n}\n\n// ============================================================================\n// Evidence Upload Mutation Hook\n// ============================================================================\n\ninterface UploadEvidenceInput {\n  commitmentId: string;\n  file: File;\n}\n\n/**\n * Hook to upload evidence for a commitment\n *\n * @returns TanStack Mutation result\n */\nexport function useUploadEvidence() {\n  const queryClient = useQueryClient();\n  const { t } = useTranslation('commitments');\n\n  return useMutation<\n    { proof_url: string; evidence_submitted_at: string },\n    Error,\n    UploadEvidenceInput\n  >({\n    mutationFn: ({ commitmentId, file }) => uploadEvidence(commitmentId, file),\n    onSuccess: (_data, variables) => {\n      // Invalidate the specific commitment to refresh\n      queryClient.invalidateQueries({\n        queryKey: commitmentKeys.detail(variables.commitmentId),\n      });\n      queryClient.invalidateQueries({ queryKey: commitmentKeys.lists() });\n      toast.success(t('evidence.uploadSuccess'));\n    },\n    onError: (error) => {\n      toast.error(t('evidence.uploadFailed'));\n      console.error('Evidence upload error:', error);\n    },\n  });\n}\n","/**\n * CommitmentQuickForm Component\n * Feature: 033-unified-work-creation-hub\n *\n * Simplified commitment creation form for the work creation palette.\n * Includes context tracking for audit trail.\n */\n\nimport { useTranslation } from 'react-i18next';\nimport { useForm } from 'react-hook-form';\nimport { zodResolver } from '@hookform/resolvers/zod';\nimport { z } from 'zod';\nimport { format } from 'date-fns';\nimport { ar, enUS } from 'date-fns/locale';\nimport { CalendarIcon, Loader2 } from 'lucide-react';\nimport { cn } from '@/lib/utils';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Textarea } from '@/components/ui/textarea';\nimport { Calendar } from '@/components/ui/calendar';\nimport {\n  Form,\n  FormControl,\n  FormField,\n  FormItem,\n  FormLabel,\n  FormMessage,\n} from '@/components/ui/form';\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from '@/components/ui/select';\nimport {\n  Popover,\n  PopoverContent,\n  PopoverTrigger,\n} from '@/components/ui/popover';\nimport { Badge } from '@/components/ui/badge';\nimport { useCreateCommitment } from '@/hooks/useCommitments';\nimport type { CreateCommitmentInput, Commitment } from '@/types/commitment.types';\nimport type { CreationContext } from '../hooks/useCreationContext';\nimport type { DossierOption } from '../DossierPicker';\n\n// Validation schema\nconst commitmentQuickFormSchema = z.object({\n  title: z\n    .string()\n    .min(1, 'validation.titleRequired')\n    .max(200, 'validation.titleMaxLength'),\n  description: z.string().min(1, 'validation.descriptionRequired'),\n  due_date: z.date({\n    required_error: 'validation.dueDateRequired',\n  }),\n  priority: z.enum(['low', 'medium', 'high', 'critical'] as const),\n  owner_type: z.enum(['internal', 'external'] as const),\n});\n\ntype CommitmentQuickFormValues = z.infer<typeof commitmentQuickFormSchema>;\n\nexport interface CommitmentQuickFormProps {\n  dossierId: string;\n  creationContext: CreationContext;\n  selectedDossier?: DossierOption;\n  onSuccess?: (commitment: Commitment) => void;\n  onCancel?: () => void;\n}\n\nexport function CommitmentQuickForm({\n  dossierId,\n  creationContext,\n  selectedDossier,\n  onSuccess,\n  onCancel,\n}: CommitmentQuickFormProps) {\n  const { t, i18n } = useTranslation(['work-creation', 'commitments']);\n  const isRTL = i18n.language === 'ar';\n\n  const createMutation = useCreateCommitment();\n  const isPending = createMutation.isPending;\n\n  const form = useForm<CommitmentQuickFormValues>({\n    resolver: zodResolver(commitmentQuickFormSchema),\n    defaultValues: {\n      title: '',\n      description: '',\n      due_date: new Date(),\n      priority: 'medium',\n      owner_type: 'internal',\n    },\n  });\n\n  const onSubmit = (values: CommitmentQuickFormValues) => {\n    // dossier_id is required - should be guaranteed by parent flow\n    if (!dossierId) {\n      return;\n    }\n    const input: CreateCommitmentInput = {\n      dossier_id: dossierId,\n      title: values.title,\n      description: values.description,\n      due_date: values.due_date.toISOString().split('T')[0],\n      priority: values.priority,\n      owner_type: values.owner_type,\n      // Note: tracking_mode is determined by service based on owner_type (database constraint)\n      proof_required: false,\n      // Context tracking\n      created_from_route: creationContext.route,\n      created_from_entity: creationContext.createdFromEntity\n        ? JSON.stringify(creationContext.createdFromEntity)\n        : undefined,\n    };\n\n    createMutation.mutate(input, {\n      onSuccess: (data) => {\n        form.reset();\n        onSuccess?.(data);\n      },\n    });\n  };\n\n  const dossierDisplayName = selectedDossier\n    ? isRTL\n      ? selectedDossier.name_ar || selectedDossier.name_en\n      : selectedDossier.name_en\n    : dossierId;\n\n  return (\n    <Form {...form}>\n      <form\n        onSubmit={form.handleSubmit(onSubmit)}\n        className=\"space-y-4\"\n        dir={isRTL ? 'rtl' : 'ltr'}\n      >\n        {/* Dossier context display */}\n        {selectedDossier && (\n          <div className=\"flex items-center gap-2 p-2 rounded-md bg-muted/50 text-sm\">\n            <span className=\"text-muted-foreground\">\n              {t('form.linkedTo', 'Linked to')}:\n            </span>\n            <Badge variant=\"outline\">{dossierDisplayName}</Badge>\n          </div>\n        )}\n\n        {/* Title */}\n        <FormField\n          control={form.control}\n          name=\"title\"\n          render={({ field }) => (\n            <FormItem>\n              <FormLabel className=\"text-start block\">\n                {t('commitments:form.title')} *\n              </FormLabel>\n              <FormControl>\n                <Input\n                  {...field}\n                  placeholder={t('commitments:form.titlePlaceholder')}\n                  className=\"min-h-11\"\n                  autoFocus\n                />\n              </FormControl>\n              <FormMessage>\n                {form.formState.errors.title?.message &&\n                  t(`commitments:${form.formState.errors.title.message}`)}\n              </FormMessage>\n            </FormItem>\n          )}\n        />\n\n        {/* Description */}\n        <FormField\n          control={form.control}\n          name=\"description\"\n          render={({ field }) => (\n            <FormItem>\n              <FormLabel className=\"text-start block\">\n                {t('commitments:form.description')} *\n              </FormLabel>\n              <FormControl>\n                <Textarea\n                  {...field}\n                  placeholder={t('commitments:form.descriptionPlaceholder')}\n                  className=\"min-h-20 resize-none\"\n                />\n              </FormControl>\n              <FormMessage>\n                {form.formState.errors.description?.message &&\n                  t(`commitments:${form.formState.errors.description.message}`)}\n              </FormMessage>\n            </FormItem>\n          )}\n        />\n\n        {/* Due Date and Priority Row */}\n        <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\n          {/* Due Date */}\n          <FormField\n            control={form.control}\n            name=\"due_date\"\n            render={({ field }) => (\n              <FormItem className=\"flex flex-col\">\n                <FormLabel className=\"text-start\">\n                  {t('commitments:form.dueDate')} *\n                </FormLabel>\n                <Popover>\n                  <PopoverTrigger asChild>\n                    <FormControl>\n                      <Button\n                        variant=\"outline\"\n                        className={cn(\n                          'min-h-11 w-full justify-start text-start font-normal',\n                          !field.value && 'text-muted-foreground'\n                        )}\n                      >\n                        <CalendarIcon className={`size-4 ${isRTL ? 'ms-2' : 'me-2'}`} />\n                        {field.value ? (\n                          format(field.value, 'PPP', {\n                            locale: isRTL ? ar : enUS,\n                          })\n                        ) : (\n                          <span>{t('commitments:form.dueDate')}</span>\n                        )}\n                      </Button>\n                    </FormControl>\n                  </PopoverTrigger>\n                  <PopoverContent className=\"w-auto p-0\" align=\"start\">\n                    <Calendar\n                      mode=\"single\"\n                      selected={field.value}\n                      onSelect={field.onChange}\n                      disabled={(date) =>\n                        date < new Date(new Date().setHours(0, 0, 0, 0))\n                      }\n                      initialFocus\n                      locale={isRTL ? ar : enUS}\n                    />\n                  </PopoverContent>\n                </Popover>\n                <FormMessage>\n                  {form.formState.errors.due_date?.message &&\n                    t(`commitments:${form.formState.errors.due_date.message}`)}\n                </FormMessage>\n              </FormItem>\n            )}\n          />\n\n          {/* Priority */}\n          <FormField\n            control={form.control}\n            name=\"priority\"\n            render={({ field }) => (\n              <FormItem>\n                <FormLabel className=\"text-start block\">\n                  {t('commitments:form.priority')}\n                </FormLabel>\n                <Select onValueChange={field.onChange} defaultValue={field.value}>\n                  <FormControl>\n                    <SelectTrigger className=\"min-h-11\">\n                      <SelectValue placeholder={t('commitments:priority.label')} />\n                    </SelectTrigger>\n                  </FormControl>\n                  <SelectContent>\n                    <SelectItem value=\"low\">{t('commitments:priority.low')}</SelectItem>\n                    <SelectItem value=\"medium\">{t('commitments:priority.medium')}</SelectItem>\n                    <SelectItem value=\"high\">{t('commitments:priority.high')}</SelectItem>\n                    <SelectItem value=\"critical\">{t('commitments:priority.critical')}</SelectItem>\n                  </SelectContent>\n                </Select>\n                <FormMessage />\n              </FormItem>\n            )}\n          />\n        </div>\n\n        {/* Owner Type */}\n        <FormField\n          control={form.control}\n          name=\"owner_type\"\n          render={({ field }) => (\n            <FormItem>\n              <FormLabel className=\"text-start block\">\n                {t('commitments:form.ownerType')}\n              </FormLabel>\n              <Select onValueChange={field.onChange} defaultValue={field.value}>\n                <FormControl>\n                  <SelectTrigger className=\"min-h-11\">\n                    <SelectValue placeholder={t('commitments:ownerType.label')} />\n                  </SelectTrigger>\n                </FormControl>\n                <SelectContent>\n                  <SelectItem value=\"internal\">{t('commitments:ownerType.internal')}</SelectItem>\n                  <SelectItem value=\"external\">{t('commitments:ownerType.external')}</SelectItem>\n                </SelectContent>\n              </Select>\n              <FormMessage />\n            </FormItem>\n          )}\n        />\n\n        {/* Action Buttons */}\n        <div className=\"flex flex-col-reverse sm:flex-row gap-3 pt-4 border-t\">\n          <Button\n            type=\"button\"\n            variant=\"outline\"\n            onClick={onCancel}\n            disabled={isPending}\n            className=\"min-h-11 w-full sm:w-auto\"\n          >\n            {t('actions.cancel', 'Cancel')}\n          </Button>\n          <Button\n            type=\"submit\"\n            disabled={isPending}\n            className=\"min-h-11 w-full sm:flex-1\"\n          >\n            {isPending ? (\n              <>\n                <Loader2 className={`size-4 animate-spin ${isRTL ? 'ms-2' : 'me-2'}`} />\n                {t('form.creating', 'Creating...')}\n              </>\n            ) : (\n              t('form.createCommitment', 'Create Commitment')\n            )}\n          </Button>\n        </div>\n      </form>\n    </Form>\n  );\n}\n\nexport default CommitmentQuickForm;\n","/**\n * Tasks API Client\n * Part of: 025-unified-tasks-model implementation\n *\n * Typed API client for unified tasks operations.\n * Handles authentication, error handling, and response parsing.\n */\n\nimport { supabase } from '@/lib/supabase';\nimport type { Database } from '../../../backend/src/types/database.types';\n\n// Get Supabase URL for Edge Functions\nconst supabaseUrl = import.meta.env.VITE_SUPABASE_URL;\n\nif (!supabaseUrl) {\n  throw new Error('Missing VITE_SUPABASE_URL environment variable');\n}\n\ntype Task = Database['public']['Tables']['tasks']['Row'];\ntype TaskInsert = Database['public']['Tables']['tasks']['Insert'];\ntype TaskUpdate = Database['public']['Tables']['tasks']['Update'];\ntype TaskContributor = Database['public']['Tables']['task_contributors']['Row'];\n\n/**\n * API Request types\n */\nexport interface CreateTaskRequest {\n  title: string;\n  description?: string;\n  assignee_id: string;\n  engagement_id?: string;\n  priority?: 'low' | 'medium' | 'high' | 'urgent';\n  workflow_stage?: 'todo' | 'in_progress' | 'review' | 'done' | 'cancelled';\n  sla_deadline?: string;\n  work_item_type?: 'dossier' | 'position' | 'ticket' | 'generic';\n  work_item_id?: string;\n  source?: Record<string, any>;\n}\n\nexport interface UpdateTaskRequest {\n  title?: string;\n  description?: string;\n  assignee_id?: string;\n  engagement_id?: string;\n  priority?: 'low' | 'medium' | 'high' | 'urgent';\n  workflow_stage?: 'todo' | 'in_progress' | 'review' | 'done' | 'cancelled';\n  status?: 'pending' | 'in_progress' | 'review' | 'completed' | 'cancelled';\n  sla_deadline?: string;\n  work_item_type?: 'dossier' | 'position' | 'ticket' | 'generic';\n  work_item_id?: string;\n  source?: Record<string, any>;\n  completed_by?: string;\n  completed_at?: string;\n  last_known_updated_at?: string; // For optimistic locking\n}\n\nexport interface TaskFilters {\n  filter?: 'assigned' | 'contributed' | 'created' | 'all';\n  assignee_id?: string;\n  engagement_id?: string;\n  workflow_stage?: 'todo' | 'in_progress' | 'review' | 'done' | 'cancelled';\n  status?: 'pending' | 'in_progress' | 'review' | 'completed' | 'cancelled';\n  work_item_type?: 'dossier' | 'position' | 'ticket' | 'generic';\n  work_item_id?: string;\n  sla_deadline_before?: string;\n  is_overdue?: boolean;\n  page?: number;\n  page_size?: number;\n  sort_by?: 'created_at' | 'updated_at' | 'sla_deadline' | 'priority';\n  sort_order?: 'asc' | 'desc';\n}\n\nexport interface TasksListResponse {\n  tasks: Task[];\n  total_count: number;\n  page: number;\n  page_size: number;\n}\n\n/**\n * API Error class\n */\nexport class TasksAPIError extends Error {\n  code: string;\n  status: number;\n  details?: any;\n\n  constructor(message: string, status: number, code: string, details?: any) {\n    super(message);\n    this.name = 'TasksAPIError';\n    this.code = code;\n    this.status = status;\n    this.details = details;\n  }\n}\n\n/**\n * Optimistic lock conflict error\n */\nexport class OptimisticLockConflictError extends TasksAPIError {\n  current_state: Task;\n  client_timestamp: string;\n  server_timestamp: string;\n\n  constructor(data: any) {\n    super(data.message, 409, 'optimistic_lock_conflict');\n    this.current_state = data.current_state;\n    this.client_timestamp = data.client_timestamp;\n    this.server_timestamp = data.server_timestamp;\n  }\n}\n\n/**\n * Helper function to make authenticated requests\n */\nasync function fetchWithAuth<T>(\n  url: string,\n  options: RequestInit = {}\n): Promise<T> {\n  const { data: { session } } = await supabase.auth.getSession();\n\n  if (!session) {\n    throw new TasksAPIError('Not authenticated', 401, 'UNAUTHORIZED');\n  }\n\n  const response = await fetch(url, {\n    ...options,\n    headers: {\n      ...options.headers,\n      'Content-Type': 'application/json',\n      Authorization: `Bearer ${session.access_token}`,\n    },\n  });\n\n  if (!response.ok) {\n    const error = await response.json().catch(() => ({ error: 'Unknown error' }));\n\n    // Handle optimistic lock conflicts\n    if (response.status === 409 && error.error === 'optimistic_lock_conflict') {\n      throw new OptimisticLockConflictError(error);\n    }\n\n    throw new TasksAPIError(\n      error.message || error.error || 'Request failed',\n      response.status,\n      error.code || 'UNKNOWN_ERROR',\n      error\n    );\n  }\n\n  return response.json();\n}\n\n/**\n * Tasks API Client\n */\nexport const tasksAPI = {\n  /**\n   * Get tasks with filtering and pagination\n   */\n  async getTasks(filters: TaskFilters = {}): Promise<TasksListResponse> {\n    const params = new URLSearchParams();\n\n    Object.entries(filters).forEach(([key, value]) => {\n      if (value !== undefined && value !== null) {\n        params.append(key, String(value));\n      }\n    });\n\n    const url = `${supabaseUrl}/functions/v1/tasks-get?${params}`;\n    return fetchWithAuth<TasksListResponse>(url);\n  },\n\n  /**\n   * Get a single task by ID\n   */\n  async getTask(taskId: string): Promise<Task & {\n    assignee_name?: string;\n    assignee_email?: string;\n    created_by_name?: string;\n    work_item_title_en?: string;\n    work_item_title_ar?: string;\n    work_items?: Array<{\n      type: string;\n      id: string;\n      title_en?: string;\n      title_ar?: string;\n    }>;\n    engagement?: {\n      id: string;\n      title: string;\n      engagement_type: string;\n      engagement_date: string;\n      location?: string;\n      dossier?: {\n        id: string;\n        name_en: string;\n        name_ar: string;\n      };\n    };\n  }> {\n    // Fetch the task\n    const { data: task, error: taskError } = await supabase\n      .from('tasks')\n      .select('*')\n      .eq('id', taskId)\n      .eq('is_deleted', false)\n      .single();\n\n    if (taskError) {\n      throw new TasksAPIError(taskError.message, 500, taskError.code);\n    }\n\n    // Fetch assignee info if available\n    let assigneeName = 'Unassigned';\n    let assigneeEmail: string | undefined;\n    if (task.assignee_id) {\n      const { data: assignee, error } = await supabase\n        .from('users')\n        .select('full_name, username, email')\n        .eq('id', task.assignee_id)\n        .maybeSingle();\n\n      if (error) {\n        console.warn(`Failed to fetch assignee info for ${task.assignee_id}:`, error);\n      } else if (assignee) {\n        assigneeName = assignee.full_name || assignee.username || assignee.email || 'Unknown';\n        assigneeEmail = assignee.email;\n      }\n    }\n\n    // Fetch creator info if available\n    let creatorName = 'Unknown';\n    if (task.created_by) {\n      const { data: creator, error } = await supabase\n        .from('users')\n        .select('full_name, username, email')\n        .eq('id', task.created_by)\n        .maybeSingle();\n\n      if (error) {\n        console.warn(`Failed to fetch creator info for ${task.created_by}:`, error);\n      } else if (creator) {\n        creatorName = creator.full_name || creator.username || creator.email || 'Unknown';\n      }\n    }\n\n    // Fetch work item title if available\n    let workItemTitleEn: string | undefined;\n    let workItemTitleAr: string | undefined;\n\n    if (task.work_item_id && task.work_item_type && task.work_item_type !== 'generic') {\n      try {\n        if (task.work_item_type === 'dossier') {\n          const { data: dossier, error } = await supabase\n            .from('dossiers')\n            .select('name_en, name_ar')\n            .eq('id', task.work_item_id)\n            .maybeSingle();\n\n          if (error) {\n            console.warn(`Failed to fetch dossier title for ${task.work_item_id}:`, error);\n          } else if (dossier) {\n            workItemTitleEn = dossier.name_en;\n            workItemTitleAr = dossier.name_ar;\n          }\n        } else if (task.work_item_type === 'position') {\n          const { data: position, error } = await supabase\n            .from('positions')\n            .select('title_en, title_ar')\n            .eq('id', task.work_item_id)\n            .maybeSingle();\n\n          if (error) {\n            console.warn(`Failed to fetch position title for ${task.work_item_id}:`, error);\n          } else if (position) {\n            workItemTitleEn = position.title_en;\n            workItemTitleAr = position.title_ar;\n          }\n        } else if (task.work_item_type === 'ticket') {\n          const { data: ticket, error } = await supabase\n            .from('intake_tickets')\n            .select('title, title_ar')\n            .eq('id', task.work_item_id)\n            .maybeSingle();\n\n          if (error) {\n            console.warn(`Failed to fetch ticket title for ${task.work_item_id}:`, error);\n          } else if (ticket) {\n            workItemTitleEn = ticket.title;\n            workItemTitleAr = ticket.title_ar;\n          }\n        }\n      } catch (error) {\n        // Silently fail if work item not found - it might have been deleted\n        console.warn(`Exception fetching work item title for ${task.work_item_type}:${task.work_item_id}`, error);\n      }\n    }\n\n    // Fetch titles for all work items in source JSONB field (US4 - T070)\n    const workItems: Array<{\n      type: string;\n      id: string;\n      title_en?: string;\n      title_ar?: string;\n    }> = [];\n\n    if (task.source) {\n      const source = task.source as any;\n\n      // Fetch dossier titles\n      if (source.dossier_ids && Array.isArray(source.dossier_ids)) {\n        for (const dossierId of source.dossier_ids) {\n          try {\n            const { data: dossier, error } = await supabase\n              .from('dossiers')\n              .select('name_en, name_ar')\n              .eq('id', dossierId)\n              .maybeSingle();\n\n            if (error) {\n              console.warn(`Failed to fetch dossier title for ${dossierId}:`, error);\n            }\n\n            workItems.push({\n              type: 'dossier',\n              id: dossierId,\n              title_en: dossier?.name_en,\n              title_ar: dossier?.name_ar,\n            });\n          } catch (error) {\n            // Dossier might not exist or user lacks clearance - add with no title\n            console.warn(`Exception fetching dossier title for ${dossierId}`, error);\n            workItems.push({\n              type: 'dossier',\n              id: dossierId,\n            });\n          }\n        }\n      }\n\n      // Fetch position titles\n      if (source.position_ids && Array.isArray(source.position_ids)) {\n        for (const positionId of source.position_ids) {\n          try {\n            const { data: position, error } = await supabase\n              .from('positions')\n              .select('title_en, title_ar')\n              .eq('id', positionId)\n              .maybeSingle();\n\n            if (error) {\n              console.warn(`Failed to fetch position title for ${positionId}:`, error);\n            }\n\n            workItems.push({\n              type: 'position',\n              id: positionId,\n              title_en: position?.title_en,\n              title_ar: position?.title_ar,\n            });\n          } catch (error) {\n            console.warn(`Exception fetching position title for ${positionId}`, error);\n            workItems.push({\n              type: 'position',\n              id: positionId,\n            });\n          }\n        }\n      }\n\n      // Fetch ticket titles\n      if (source.ticket_ids && Array.isArray(source.ticket_ids)) {\n        for (const ticketId of source.ticket_ids) {\n          try {\n            const { data: ticket, error } = await supabase\n              .from('intake_tickets')\n              .select('title, title_ar')\n              .eq('id', ticketId)\n              .maybeSingle();\n\n            if (error) {\n              console.warn(`Failed to fetch ticket title for ${ticketId}:`, error);\n            }\n\n            workItems.push({\n              type: 'ticket',\n              id: ticketId,\n              title_en: ticket?.title,\n              title_ar: ticket?.title_ar,\n            });\n          } catch (error) {\n            console.warn(`Exception fetching ticket title for ${ticketId}`, error);\n            workItems.push({\n              type: 'ticket',\n              id: ticketId,\n            });\n          }\n        }\n      }\n    }\n\n    // Fetch engagement details if available\n    let engagement: any = undefined;\n    if (task.engagement_id) {\n      try {\n        const { data: engagementData, error: engagementError } = await supabase\n          .from('engagements')\n          .select(`\n            id,\n            title,\n            engagement_type,\n            engagement_date,\n            location,\n            dossier_id,\n            dossiers (\n              id,\n              name_en,\n              name_ar\n            )\n          `)\n          .eq('id', task.engagement_id)\n          .maybeSingle();\n\n        if (engagementError) {\n          console.warn(`Failed to fetch engagement for ${task.engagement_id}:`, engagementError);\n        } else if (engagementData) {\n          engagement = {\n            id: engagementData.id,\n            title: engagementData.title,\n            engagement_type: engagementData.engagement_type,\n            engagement_date: engagementData.engagement_date,\n            location: engagementData.location,\n            dossier: engagementData.dossiers ? {\n              id: (engagementData.dossiers as any).id,\n              name_en: (engagementData.dossiers as any).name_en,\n              name_ar: (engagementData.dossiers as any).name_ar,\n            } : undefined,\n          };\n        }\n      } catch (error) {\n        console.warn(`Exception fetching engagement for ${task.engagement_id}`, error);\n      }\n    }\n\n    return {\n      ...task,\n      assignee_name: assigneeName,\n      assignee_email: assigneeEmail,\n      created_by_name: creatorName,\n      work_item_title_en: workItemTitleEn,\n      work_item_title_ar: workItemTitleAr,\n      work_items: workItems.length > 0 ? workItems : undefined,\n      engagement,\n    };\n  },\n\n  /**\n   * Create a new task\n   */\n  async createTask(request: CreateTaskRequest): Promise<Task> {\n    const url = `${supabaseUrl}/functions/v1/tasks-create`;\n    const response = await fetchWithAuth<{ task: Task }>(url, {\n      method: 'POST',\n      body: JSON.stringify(request),\n    });\n    return response.task;\n  },\n\n  /**\n   * Update a task\n   */\n  async updateTask(taskId: string, request: UpdateTaskRequest): Promise<Task> {\n    const url = `${supabaseUrl}/functions/v1/tasks-update/${taskId}`;\n    const response = await fetchWithAuth<{ task: Task }>(url, {\n      method: 'PUT',\n      body: JSON.stringify(request),\n    });\n    return response.task;\n  },\n\n  /**\n   * Update task workflow stage (for kanban drag-and-drop)\n   */\n  async updateWorkflowStage(\n    taskId: string,\n    workflow_stage: UpdateTaskRequest['workflow_stage'],\n    last_known_updated_at?: string\n  ): Promise<Task> {\n    return tasksAPI.updateTask(taskId, {\n      workflow_stage,\n      last_known_updated_at,\n    });\n  },\n\n  /**\n   * Mark task as completed\n   */\n  async completeTask(taskId: string, last_known_updated_at?: string): Promise<Task> {\n    return tasksAPI.updateTask(taskId, {\n      status: 'completed',\n      workflow_stage: 'done',\n      completed_at: new Date().toISOString(),\n      last_known_updated_at,\n    });\n  },\n\n  /**\n   * Delete a task (soft delete)\n   */\n  async deleteTask(taskId: string): Promise<void> {\n    const { error } = await supabase\n      .from('tasks')\n      .update({\n        is_deleted: true,\n        deleted_at: new Date().toISOString(),\n      })\n      .eq('id', taskId)\n      .eq('is_deleted', false);\n\n    if (error) {\n      throw new TasksAPIError(error.message, 500, error.code);\n    }\n  },\n\n  /**\n   * Get my tasks (assigned to current user)\n   */\n  async getMyTasks(filters: Omit<TaskFilters, 'filter'> = {}): Promise<TasksListResponse> {\n    return tasksAPI.getTasks({ ...filters, filter: 'assigned' });\n  },\n\n  /**\n   * Get tasks I contributed to (US2 - T049)\n   * Queries tasks via task_contributors join where current user is a contributor\n   */\n  async getContributedTasks(filters: Omit<TaskFilters, 'filter'> = {}): Promise<TasksListResponse> {\n    return tasksAPI.getTasks({ ...filters, filter: 'contributed' });\n  },\n\n  /**\n   * Get tasks for an engagement (kanban board)\n   */\n  async getEngagementTasks(engagementId: string): Promise<TasksListResponse> {\n    return tasksAPI.getTasks({ engagement_id: engagementId });\n  },\n\n  /**\n   * Get tasks linked to a work item\n   */\n  async getWorkItemTasks(\n    workItemType: 'dossier' | 'position' | 'ticket' | 'generic',\n    workItemId: string\n  ): Promise<Task[]> {\n    const { data, error } = await supabase\n      .from('tasks')\n      .select('*')\n      .eq('work_item_type', workItemType)\n      .eq('work_item_id', workItemId)\n      .eq('is_deleted', false)\n      .order('created_at', { ascending: false });\n\n    if (error) {\n      throw new TasksAPIError(error.message, 500, error.code);\n    }\n\n    return data || [];\n  },\n\n  /**\n   * Get overdue tasks\n   */\n  async getOverdueTasks(assigneeId?: string): Promise<Task[]> {\n    let query = supabase\n      .from('tasks')\n      .select('*')\n      .eq('is_deleted', false)\n      .lt('sla_deadline', new Date().toISOString())\n      .not('status', 'in', '(completed,cancelled)')\n      .order('sla_deadline', { ascending: true });\n\n    if (assigneeId) {\n      query = query.eq('assignee_id', assigneeId);\n    }\n\n    const { data, error } = await query;\n\n    if (error) {\n      throw new TasksAPIError(error.message, 500, error.code);\n    }\n\n    return data || [];\n  },\n\n  /**\n   * Get tasks approaching SLA deadline\n   */\n  async getTasksApproachingDeadline(hours: number = 4, assigneeId?: string): Promise<Task[]> {\n    const warningTime = new Date();\n    warningTime.setHours(warningTime.getHours() + hours);\n\n    let query = supabase\n      .from('tasks')\n      .select('*')\n      .eq('is_deleted', false)\n      .lte('sla_deadline', warningTime.toISOString())\n      .gte('sla_deadline', new Date().toISOString())\n      .not('status', 'in', '(completed,cancelled)')\n      .order('sla_deadline', { ascending: true });\n\n    if (assigneeId) {\n      query = query.eq('assignee_id', assigneeId);\n    }\n\n    const { data, error } = await query;\n\n    if (error) {\n      throw new TasksAPIError(error.message, 500, error.code);\n    }\n\n    return data || [];\n  },\n};\n\nexport default tasksAPI;\n","/**\n * TaskQuickForm Component\n * Feature: 033-unified-work-creation-hub\n *\n * Simplified task creation form for the work creation palette.\n * Includes context tracking for audit trail.\n */\n\nimport { useTranslation } from 'react-i18next';\nimport { useForm } from 'react-hook-form';\nimport { zodResolver } from '@hookform/resolvers/zod';\nimport { z } from 'zod';\nimport { format } from 'date-fns';\nimport { ar, enUS } from 'date-fns/locale';\nimport { CalendarIcon, Loader2, User } from 'lucide-react';\nimport { cn } from '@/lib/utils';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Textarea } from '@/components/ui/textarea';\nimport { Calendar } from '@/components/ui/calendar';\nimport {\n  Form,\n  FormControl,\n  FormDescription,\n  FormField,\n  FormItem,\n  FormLabel,\n  FormMessage,\n} from '@/components/ui/form';\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from '@/components/ui/select';\nimport {\n  Popover,\n  PopoverContent,\n  PopoverTrigger,\n} from '@/components/ui/popover';\nimport { tasksAPI, type CreateTaskRequest } from '@/services/tasks-api';\nimport { useMutation, useQueryClient } from '@tanstack/react-query';\nimport { toast } from 'sonner';\nimport type { CreationContext } from '../hooks/useCreationContext';\n\n// Validation schema\nconst taskQuickFormSchema = z.object({\n  title: z\n    .string()\n    .min(1, 'validation.titleRequired')\n    .max(200, 'validation.titleMaxLength'),\n  description: z.string().optional(),\n  assignee_id: z.string().min(1, 'validation.assigneeRequired'),\n  priority: z.enum(['low', 'medium', 'high', 'urgent'] as const),\n  sla_deadline: z.date().optional().nullable(),\n});\n\ntype TaskQuickFormValues = z.infer<typeof taskQuickFormSchema>;\n\nexport interface TaskQuickFormProps {\n  creationContext: CreationContext;\n  engagementId?: string;\n  onSuccess?: (task: any) => void;\n  onCancel?: () => void;\n}\n\nexport function TaskQuickForm({\n  creationContext,\n  engagementId,\n  onSuccess,\n  onCancel,\n}: TaskQuickFormProps) {\n  const { t, i18n } = useTranslation('work-creation');\n  const isRTL = i18n.language === 'ar';\n  const queryClient = useQueryClient();\n\n  const form = useForm<TaskQuickFormValues>({\n    resolver: zodResolver(taskQuickFormSchema),\n    defaultValues: {\n      title: '',\n      description: '',\n      assignee_id: '',\n      priority: 'medium',\n      sla_deadline: null,\n    },\n  });\n\n  const createTaskMutation = useMutation({\n    mutationFn: (request: CreateTaskRequest) => tasksAPI.createTask(request),\n    onSuccess: (data) => {\n      // Invalidate task queries\n      queryClient.invalidateQueries({ queryKey: ['tasks'] });\n      queryClient.invalidateQueries({ queryKey: ['unified-work'] });\n      toast.success(t('form.taskCreated', 'Task created successfully'));\n      form.reset();\n      onSuccess?.(data);\n    },\n    onError: (error: any) => {\n      toast.error(error.message || t('form.taskError', 'Failed to create task'));\n    },\n  });\n\n  const isPending = createTaskMutation.isPending;\n\n  const onSubmit = (values: TaskQuickFormValues) => {\n    const request: CreateTaskRequest = {\n      title: values.title,\n      description: values.description,\n      assignee_id: values.assignee_id,\n      priority: values.priority,\n      engagement_id: engagementId ?? creationContext.engagementId,\n      sla_deadline: values.sla_deadline?.toISOString(),\n      workflow_stage: 'todo',\n      // Context tracking via source JSONB\n      source: {\n        created_from_route: creationContext.route,\n        created_from_entity: creationContext.createdFromEntity,\n        dossier_ids: creationContext.dossierId ? [creationContext.dossierId] : undefined,\n      },\n    };\n\n    createTaskMutation.mutate(request);\n  };\n\n  return (\n    <Form {...form}>\n      <form\n        onSubmit={form.handleSubmit(onSubmit)}\n        className=\"space-y-4\"\n        dir={isRTL ? 'rtl' : 'ltr'}\n      >\n        {/* Title */}\n        <FormField\n          control={form.control}\n          name=\"title\"\n          render={({ field }) => (\n            <FormItem>\n              <FormLabel className=\"text-start block\">\n                {t('form.taskTitle', 'Task Title')} *\n              </FormLabel>\n              <FormControl>\n                <Input\n                  {...field}\n                  placeholder={t('form.taskTitlePlaceholder', 'Enter task title')}\n                  className=\"min-h-11\"\n                  autoFocus\n                />\n              </FormControl>\n              <FormMessage />\n            </FormItem>\n          )}\n        />\n\n        {/* Description */}\n        <FormField\n          control={form.control}\n          name=\"description\"\n          render={({ field }) => (\n            <FormItem>\n              <FormLabel className=\"text-start block\">\n                {t('form.taskDescription', 'Description')}\n              </FormLabel>\n              <FormControl>\n                <Textarea\n                  {...field}\n                  placeholder={t('form.taskDescriptionPlaceholder', 'Enter task details (optional)')}\n                  className=\"min-h-20 resize-none\"\n                />\n              </FormControl>\n              <FormMessage />\n            </FormItem>\n          )}\n        />\n\n        {/* Assignee - TODO: Replace with user picker */}\n        <FormField\n          control={form.control}\n          name=\"assignee_id\"\n          render={({ field }) => (\n            <FormItem>\n              <FormLabel className=\"text-start block\">\n                {t('form.assignee', 'Assignee')} *\n              </FormLabel>\n              <FormControl>\n                <div className=\"relative\">\n                  <User className={cn('absolute top-3 size-4 text-muted-foreground', isRTL ? 'end-3' : 'start-3')} />\n                  <Input\n                    {...field}\n                    placeholder={t('form.assigneePlaceholder', 'Enter user ID')}\n                    className={cn('min-h-11', isRTL ? 'pe-10' : 'ps-10')}\n                  />\n                </div>\n              </FormControl>\n              <FormDescription className=\"text-start\">\n                {t('form.assigneeHint', 'Enter the user ID of the assignee')}\n              </FormDescription>\n              <FormMessage />\n            </FormItem>\n          )}\n        />\n\n        {/* Priority and SLA Row */}\n        <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\n          {/* Priority */}\n          <FormField\n            control={form.control}\n            name=\"priority\"\n            render={({ field }) => (\n              <FormItem>\n                <FormLabel className=\"text-start block\">\n                  {t('form.priority', 'Priority')}\n                </FormLabel>\n                <Select onValueChange={field.onChange} defaultValue={field.value}>\n                  <FormControl>\n                    <SelectTrigger className=\"min-h-11\">\n                      <SelectValue placeholder={t('form.selectPriority', 'Select priority')} />\n                    </SelectTrigger>\n                  </FormControl>\n                  <SelectContent>\n                    <SelectItem value=\"low\">{t('priority.low', 'Low')}</SelectItem>\n                    <SelectItem value=\"medium\">{t('priority.medium', 'Medium')}</SelectItem>\n                    <SelectItem value=\"high\">{t('priority.high', 'High')}</SelectItem>\n                    <SelectItem value=\"urgent\">{t('priority.urgent', 'Urgent')}</SelectItem>\n                  </SelectContent>\n                </Select>\n                <FormMessage />\n              </FormItem>\n            )}\n          />\n\n          {/* SLA Deadline */}\n          <FormField\n            control={form.control}\n            name=\"sla_deadline\"\n            render={({ field }) => (\n              <FormItem className=\"flex flex-col\">\n                <FormLabel className=\"text-start\">\n                  {t('form.slaDeadline', 'SLA Deadline')}\n                </FormLabel>\n                <Popover>\n                  <PopoverTrigger asChild>\n                    <FormControl>\n                      <Button\n                        variant=\"outline\"\n                        className={cn(\n                          'min-h-11 w-full justify-start text-start font-normal',\n                          !field.value && 'text-muted-foreground'\n                        )}\n                      >\n                        <CalendarIcon className={`size-4 ${isRTL ? 'ms-2' : 'me-2'}`} />\n                        {field.value ? (\n                          format(field.value, 'PPP', {\n                            locale: isRTL ? ar : enUS,\n                          })\n                        ) : (\n                          <span>{t('form.selectDate', 'Select date')}</span>\n                        )}\n                      </Button>\n                    </FormControl>\n                  </PopoverTrigger>\n                  <PopoverContent className=\"w-auto p-0\" align=\"start\">\n                    <Calendar\n                      mode=\"single\"\n                      selected={field.value ?? undefined}\n                      onSelect={field.onChange}\n                      disabled={(date) =>\n                        date < new Date(new Date().setHours(0, 0, 0, 0))\n                      }\n                      initialFocus\n                      locale={isRTL ? ar : enUS}\n                    />\n                  </PopoverContent>\n                </Popover>\n                <FormMessage />\n              </FormItem>\n            )}\n          />\n        </div>\n\n        {/* Action Buttons */}\n        <div className=\"flex flex-col-reverse sm:flex-row gap-3 pt-4 border-t\">\n          <Button\n            type=\"button\"\n            variant=\"outline\"\n            onClick={onCancel}\n            disabled={isPending}\n            className=\"min-h-11 w-full sm:w-auto\"\n          >\n            {t('actions.cancel', 'Cancel')}\n          </Button>\n          <Button\n            type=\"submit\"\n            disabled={isPending}\n            className=\"min-h-11 w-full sm:flex-1\"\n          >\n            {isPending ? (\n              <>\n                <Loader2 className={`size-4 animate-spin ${isRTL ? 'ms-2' : 'me-2'}`} />\n                {t('form.creating', 'Creating...')}\n              </>\n            ) : (\n              t('form.createTask', 'Create Task')\n            )}\n          </Button>\n        </div>\n      </form>\n    </Form>\n  );\n}\n\nexport default TaskQuickForm;\n","/**\n * IntakeQuickForm Component\n * Feature: 033-unified-work-creation-hub\n *\n * Simplified intake ticket creation form for the work creation palette.\n * Includes context tracking for audit trail.\n */\n\nimport { useTranslation } from 'react-i18next';\nimport { useForm } from 'react-hook-form';\nimport { zodResolver } from '@hookform/resolvers/zod';\nimport { z } from 'zod';\nimport { Loader2 } from 'lucide-react';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Textarea } from '@/components/ui/textarea';\nimport {\n  Form,\n  FormControl,\n  FormField,\n  FormItem,\n  FormLabel,\n  FormMessage,\n} from '@/components/ui/form';\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from '@/components/ui/select';\nimport { Badge } from '@/components/ui/badge';\nimport { useMutation, useQueryClient } from '@tanstack/react-query';\nimport { toast } from 'sonner';\nimport { supabase } from '@/lib/supabase';\nimport type { CreationContext } from '../hooks/useCreationContext';\nimport type { CreateTicketRequest } from '@/types/intake';\n\n// Validation schema\nconst intakeQuickFormSchema = z.object({\n  requestType: z.enum(['engagement', 'position', 'mou_action', 'foresight'] as const),\n  title: z\n    .string()\n    .min(1, 'validation.titleRequired')\n    .max(200, 'validation.titleMaxLength'),\n  description: z.string().min(1, 'validation.descriptionRequired'),\n  urgency: z.enum(['low', 'medium', 'high', 'critical'] as const),\n});\n\ntype IntakeQuickFormValues = z.infer<typeof intakeQuickFormSchema>;\n\nexport interface IntakeQuickFormProps {\n  dossierId?: string;\n  creationContext: CreationContext;\n  onSuccess?: (ticket: any) => void;\n  onCancel?: () => void;\n}\n\n// Supabase URL\nconst supabaseUrl = import.meta.env.VITE_SUPABASE_URL;\n\n/**\n * Create intake ticket via Edge Function\n */\nasync function createIntakeTicket(request: CreateTicketRequest): Promise<any> {\n  const { data: { session } } = await supabase.auth.getSession();\n\n  if (!session) {\n    throw new Error('Not authenticated');\n  }\n\n  const response = await fetch(`${supabaseUrl}/functions/v1/intake-tickets/create`, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      'Authorization': `Bearer ${session.access_token}`,\n    },\n    body: JSON.stringify(request),\n  });\n\n  if (!response.ok) {\n    const error = await response.json().catch(() => ({ message: 'Failed to create ticket' }));\n    throw new Error(error.message || 'Failed to create intake ticket');\n  }\n\n  return response.json();\n}\n\nexport function IntakeQuickForm({\n  dossierId,\n  creationContext,\n  onSuccess,\n  onCancel,\n}: IntakeQuickFormProps) {\n  const { t, i18n } = useTranslation(['work-creation', 'intake']);\n  const isRTL = i18n.language === 'ar';\n  const queryClient = useQueryClient();\n\n  const form = useForm<IntakeQuickFormValues>({\n    resolver: zodResolver(intakeQuickFormSchema),\n    defaultValues: {\n      requestType: 'engagement',\n      title: '',\n      description: '',\n      urgency: 'medium',\n    },\n  });\n\n  const createMutation = useMutation({\n    mutationFn: createIntakeTicket,\n    onSuccess: (data) => {\n      // Invalidate intake queries\n      queryClient.invalidateQueries({ queryKey: ['intake-tickets'] });\n      queryClient.invalidateQueries({ queryKey: ['unified-work'] });\n      toast.success(t('form.intakeCreated', 'Intake request created successfully'));\n      form.reset();\n      onSuccess?.(data);\n    },\n    onError: (error: any) => {\n      toast.error(error.message || t('form.intakeError', 'Failed to create intake request'));\n    },\n  });\n\n  const isPending = createMutation.isPending;\n\n  const onSubmit = (values: IntakeQuickFormValues) => {\n    const request: CreateTicketRequest = {\n      requestType: values.requestType,\n      title: values.title,\n      description: values.description,\n      urgency: values.urgency,\n      dossierId: dossierId ?? creationContext.dossierId,\n    };\n\n    createMutation.mutate(request);\n  };\n\n  return (\n    <Form {...form}>\n      <form\n        onSubmit={form.handleSubmit(onSubmit)}\n        className=\"space-y-4\"\n        dir={isRTL ? 'rtl' : 'ltr'}\n      >\n        {/* Dossier context (if linked) */}\n        {(dossierId || creationContext.dossierId) && (\n          <div className=\"flex items-center gap-2 p-2 rounded-md bg-muted/50 text-sm\">\n            <span className=\"text-muted-foreground\">\n              {t('form.linkedTo', 'Linked to dossier')}:\n            </span>\n            <Badge variant=\"outline\">{dossierId || creationContext.dossierId}</Badge>\n          </div>\n        )}\n\n        {/* Request Type */}\n        <FormField\n          control={form.control}\n          name=\"requestType\"\n          render={({ field }) => (\n            <FormItem>\n              <FormLabel className=\"text-start block\">\n                {t('intake:form.requestType', 'Request Type')} *\n              </FormLabel>\n              <Select onValueChange={field.onChange} defaultValue={field.value}>\n                <FormControl>\n                  <SelectTrigger className=\"min-h-11\">\n                    <SelectValue placeholder={t('intake:form.selectType', 'Select type')} />\n                  </SelectTrigger>\n                </FormControl>\n                <SelectContent>\n                  <SelectItem value=\"engagement\">\n                    {t('intake:requestTypes.engagement', 'Engagement')}\n                  </SelectItem>\n                  <SelectItem value=\"position\">\n                    {t('intake:requestTypes.position', 'Position')}\n                  </SelectItem>\n                  <SelectItem value=\"mou_action\">\n                    {t('intake:requestTypes.mou_action', 'MOU Action')}\n                  </SelectItem>\n                  <SelectItem value=\"foresight\">\n                    {t('intake:requestTypes.foresight', 'Foresight')}\n                  </SelectItem>\n                </SelectContent>\n              </Select>\n              <FormMessage />\n            </FormItem>\n          )}\n        />\n\n        {/* Title */}\n        <FormField\n          control={form.control}\n          name=\"title\"\n          render={({ field }) => (\n            <FormItem>\n              <FormLabel className=\"text-start block\">\n                {t('intake:form.title', 'Title')} *\n              </FormLabel>\n              <FormControl>\n                <Input\n                  {...field}\n                  placeholder={t('intake:form.titlePlaceholder', 'Enter request title')}\n                  className=\"min-h-11\"\n                  autoFocus\n                />\n              </FormControl>\n              <FormMessage />\n            </FormItem>\n          )}\n        />\n\n        {/* Description */}\n        <FormField\n          control={form.control}\n          name=\"description\"\n          render={({ field }) => (\n            <FormItem>\n              <FormLabel className=\"text-start block\">\n                {t('intake:form.description', 'Description')} *\n              </FormLabel>\n              <FormControl>\n                <Textarea\n                  {...field}\n                  placeholder={t('intake:form.descriptionPlaceholder', 'Describe your request')}\n                  className=\"min-h-24 resize-none\"\n                />\n              </FormControl>\n              <FormMessage />\n            </FormItem>\n          )}\n        />\n\n        {/* Urgency */}\n        <FormField\n          control={form.control}\n          name=\"urgency\"\n          render={({ field }) => (\n            <FormItem>\n              <FormLabel className=\"text-start block\">\n                {t('intake:form.urgency', 'Urgency')} *\n              </FormLabel>\n              <Select onValueChange={field.onChange} defaultValue={field.value}>\n                <FormControl>\n                  <SelectTrigger className=\"min-h-11\">\n                    <SelectValue placeholder={t('intake:form.selectUrgency', 'Select urgency')} />\n                  </SelectTrigger>\n                </FormControl>\n                <SelectContent>\n                  <SelectItem value=\"low\">{t('intake:urgency.low', 'Low')}</SelectItem>\n                  <SelectItem value=\"medium\">{t('intake:urgency.medium', 'Medium')}</SelectItem>\n                  <SelectItem value=\"high\">{t('intake:urgency.high', 'High')}</SelectItem>\n                  <SelectItem value=\"critical\">{t('intake:urgency.critical', 'Critical')}</SelectItem>\n                </SelectContent>\n              </Select>\n              <FormMessage />\n            </FormItem>\n          )}\n        />\n\n        {/* Action Buttons */}\n        <div className=\"flex flex-col-reverse sm:flex-row gap-3 pt-4 border-t\">\n          <Button\n            type=\"button\"\n            variant=\"outline\"\n            onClick={onCancel}\n            disabled={isPending}\n            className=\"min-h-11 w-full sm:w-auto\"\n          >\n            {t('actions.cancel', 'Cancel')}\n          </Button>\n          <Button\n            type=\"submit\"\n            disabled={isPending}\n            className=\"min-h-11 w-full sm:flex-1\"\n          >\n            {isPending ? (\n              <>\n                <Loader2 className={`size-4 animate-spin ${isRTL ? 'ms-2' : 'me-2'}`} />\n                {t('form.creating', 'Creating...')}\n              </>\n            ) : (\n              t('form.createIntake', 'Submit Request')\n            )}\n          </Button>\n        </div>\n      </form>\n    </Form>\n  );\n}\n\nexport default IntakeQuickForm;\n","/**\n * WorkCreationPalette Component\n * Feature: 033-unified-work-creation-hub\n *\n * Main command palette for creating work items.\n * Supports commitments, tasks, and intake tickets with\n * progressive context capture.\n */\n\nimport { useState, useCallback, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport {\n  CheckSquare,\n  ClipboardList,\n  Inbox,\n  ChevronRight,\n  ArrowLeft,\n} from 'lucide-react';\nimport { cn } from '@/lib/utils';\nimport {\n  CommandDialog,\n  Command,\n  CommandEmpty,\n  CommandGroup,\n  CommandInput,\n  CommandItem,\n  CommandList,\n} from '@/components/ui/command';\nimport { Button } from '@/components/ui/button';\nimport { useCreationContext, type CreationContext } from './hooks/useCreationContext';\nimport { DossierPicker, type DossierOption } from './DossierPicker';\nimport { CommitmentQuickForm } from './forms/CommitmentQuickForm';\nimport { TaskQuickForm } from './forms/TaskQuickForm';\nimport { IntakeQuickForm } from './forms/IntakeQuickForm';\n\nexport type WorkItemType = 'commitment' | 'task' | 'intake';\n\ntype PaletteStep = 'type-select' | 'context-select' | 'form';\n\nexport interface WorkCreationPaletteProps {\n  open: boolean;\n  onOpenChange: (open: boolean) => void;\n  defaultType?: WorkItemType;\n  /** Override automatic context detection */\n  contextOverride?: Partial<CreationContext>;\n  onSuccess?: (type: WorkItemType, item: any) => void;\n}\n\ninterface WorkTypeOption {\n  type: WorkItemType;\n  icon: typeof CheckSquare;\n  labelKey: string;\n  descriptionKey: string;\n  requiresDossier: boolean;\n}\n\nconst WORK_TYPE_OPTIONS: WorkTypeOption[] = [\n  {\n    type: 'commitment',\n    icon: CheckSquare,\n    labelKey: 'palette.createCommitment',\n    descriptionKey: 'palette.commitmentDescription',\n    requiresDossier: true,\n  },\n  {\n    type: 'task',\n    icon: ClipboardList,\n    labelKey: 'palette.createTask',\n    descriptionKey: 'palette.taskDescription',\n    requiresDossier: false,\n  },\n  {\n    type: 'intake',\n    icon: Inbox,\n    labelKey: 'palette.createIntake',\n    descriptionKey: 'palette.intakeDescription',\n    requiresDossier: false,\n  },\n];\n\nexport function WorkCreationPalette({\n  open,\n  onOpenChange,\n  defaultType,\n  contextOverride,\n  onSuccess,\n}: WorkCreationPaletteProps) {\n  const { t, i18n } = useTranslation('work-creation');\n  const isRTL = i18n.language === 'ar';\n\n  // Auto-capture context from route\n  const autoContext = useCreationContext();\n  const context: CreationContext = {\n    ...autoContext,\n    ...contextOverride,\n  };\n\n  // State\n  const [step, setStep] = useState<PaletteStep>('type-select');\n  const [selectedType, setSelectedType] = useState<WorkItemType | null>(defaultType ?? null);\n  const [selectedDossier, setSelectedDossier] = useState<DossierOption | undefined>();\n  const [searchQuery, setSearchQuery] = useState('');\n\n  // Reset state when dialog closes\n  useEffect(() => {\n    if (!open) {\n      // Delay reset to allow close animation\n      const timeout = setTimeout(() => {\n        setStep('type-select');\n        setSelectedType(defaultType ?? null);\n        setSelectedDossier(undefined);\n        setSearchQuery('');\n      }, 200);\n      return () => clearTimeout(timeout);\n    }\n    return undefined;\n  }, [open, defaultType]);\n\n  // Auto-advance if context is available\n  useEffect(() => {\n    if (open && defaultType) {\n      const option = WORK_TYPE_OPTIONS.find((o) => o.type === defaultType);\n      if (option) {\n        if (option.requiresDossier && !context.dossierId) {\n          setStep('context-select');\n        } else {\n          setStep('form');\n        }\n      }\n    }\n  }, [open, defaultType, context.dossierId]);\n\n  const handleTypeSelect = useCallback(\n    (type: WorkItemType) => {\n      setSelectedType(type);\n      const option = WORK_TYPE_OPTIONS.find((o) => o.type === type);\n\n      if (option?.requiresDossier && !context.dossierId) {\n        // Need to select dossier first\n        setStep('context-select');\n      } else {\n        // Can proceed directly to form\n        setStep('form');\n      }\n    },\n    [context.dossierId]\n  );\n\n  const handleDossierSelect = useCallback((dossierId: string | null, dossier?: DossierOption) => {\n    if (dossierId && dossier) {\n      setSelectedDossier(dossier);\n    }\n  }, []);\n\n  const handleDossierContinue = useCallback(() => {\n    if (selectedDossier) {\n      setStep('form');\n    }\n  }, [selectedDossier]);\n\n  const handleBack = useCallback(() => {\n    if (step === 'form') {\n      const option = WORK_TYPE_OPTIONS.find((o) => o.type === selectedType);\n      if (option?.requiresDossier && !context.dossierId) {\n        setStep('context-select');\n      } else {\n        setStep('type-select');\n      }\n    } else if (step === 'context-select') {\n      setStep('type-select');\n      setSelectedType(null);\n    }\n  }, [step, selectedType, context.dossierId]);\n\n  const handleSuccess = useCallback(\n    (item: any) => {\n      onSuccess?.(selectedType!, item);\n      onOpenChange(false);\n    },\n    [selectedType, onSuccess, onOpenChange]\n  );\n\n  const handleCancel = useCallback(() => {\n    onOpenChange(false);\n  }, [onOpenChange]);\n\n  // Determine final dossier ID\n  const finalDossierId = selectedDossier?.id ?? context.dossierId;\n\n  // Filter work types by search\n  const filteredTypes = WORK_TYPE_OPTIONS.filter((option) => {\n    if (!searchQuery) return true;\n    const label = t(option.labelKey).toLowerCase();\n    const desc = t(option.descriptionKey).toLowerCase();\n    const query = searchQuery.toLowerCase();\n    return label.includes(query) || desc.includes(query) || option.type.includes(query);\n  });\n\n  return (\n    <CommandDialog\n      open={open}\n      onOpenChange={onOpenChange}\n      preventCloseOnOutsideClick={step !== 'type-select'}\n    >\n      <div className=\"flex flex-col\" dir={isRTL ? 'rtl' : 'ltr'}>\n        {/* Header with back button */}\n        {step !== 'type-select' && (\n          <div className=\"flex items-center gap-2 px-3 py-2 border-b\">\n            <Button\n              type=\"button\"\n              variant=\"ghost\"\n              size=\"sm\"\n              className=\"size-8 p-0\"\n              onClick={handleBack}\n            >\n              <ArrowLeft className={cn('size-4', isRTL && 'rotate-180')} />\n              <span className=\"sr-only\">{t('actions.back', 'Back')}</span>\n            </Button>\n            <span className=\"text-sm font-medium\">\n              {step === 'context-select'\n                ? t('palette.selectDossier', 'Select Dossier')\n                : selectedType && t(WORK_TYPE_OPTIONS.find((o) => o.type === selectedType)!.labelKey)}\n            </span>\n          </div>\n        )}\n\n        {/* Step: Type Selection */}\n        {step === 'type-select' && (\n          <Command shouldFilter={false} className=\"rounded-lg\">\n            <CommandInput\n              placeholder={t('palette.placeholder', 'What would you like to create?')}\n              value={searchQuery}\n              onValueChange={setSearchQuery}\n            />\n            <CommandList>\n              <CommandEmpty>{t('palette.noResults', 'No results found')}</CommandEmpty>\n              <CommandGroup heading={t('palette.workTypes', 'Work Item Types')}>\n                {filteredTypes.map((option) => {\n                  const Icon = option.icon;\n                  return (\n                    <CommandItem\n                      key={option.type}\n                      value={option.type}\n                      onSelect={() => handleTypeSelect(option.type)}\n                      className=\"min-h-14 flex items-center gap-3 cursor-pointer\"\n                    >\n                      <div className=\"flex size-10 items-center justify-center rounded-lg bg-muted\">\n                        <Icon className=\"size-5\" />\n                      </div>\n                      <div className=\"flex-1 space-y-1\">\n                        <p className=\"text-sm font-medium leading-none\">\n                          {t(option.labelKey)}\n                        </p>\n                        <p className=\"text-xs text-muted-foreground\">\n                          {t(option.descriptionKey)}\n                        </p>\n                      </div>\n                      <ChevronRight\n                        className={cn('size-4 text-muted-foreground', isRTL && 'rotate-180')}\n                      />\n                    </CommandItem>\n                  );\n                })}\n              </CommandGroup>\n            </CommandList>\n          </Command>\n        )}\n\n        {/* Step: Context Selection (Dossier Picker) */}\n        {step === 'context-select' && (\n          <div className=\"p-4 space-y-4\">\n            <p className=\"text-sm text-muted-foreground\">\n              {t(\n                'palette.dossierRequired',\n                'Commitments must be linked to a dossier. Please select one:'\n              )}\n            </p>\n            <DossierPicker\n              value={selectedDossier?.id}\n              onChange={handleDossierSelect}\n              selectedDossier={selectedDossier}\n            />\n            <div className=\"flex gap-3 pt-2\">\n              <Button\n                type=\"button\"\n                variant=\"outline\"\n                onClick={handleCancel}\n                className=\"flex-1 min-h-11\"\n              >\n                {t('actions.cancel', 'Cancel')}\n              </Button>\n              <Button\n                type=\"button\"\n                onClick={handleDossierContinue}\n                disabled={!selectedDossier}\n                className=\"flex-1 min-h-11\"\n              >\n                {t('actions.continue', 'Continue')}\n              </Button>\n            </div>\n          </div>\n        )}\n\n        {/* Step: Form */}\n        {step === 'form' && selectedType && (\n          <div className=\"p-4 max-h-[70vh] overflow-y-auto\">\n            {selectedType === 'commitment' && finalDossierId && (\n              <CommitmentQuickForm\n                dossierId={finalDossierId}\n                creationContext={context}\n                selectedDossier={selectedDossier}\n                onSuccess={handleSuccess}\n                onCancel={handleCancel}\n              />\n            )}\n            {selectedType === 'task' && (\n              <TaskQuickForm\n                creationContext={context}\n                onSuccess={handleSuccess}\n                onCancel={handleCancel}\n              />\n            )}\n            {selectedType === 'intake' && (\n              <IntakeQuickForm\n                dossierId={finalDossierId}\n                creationContext={context}\n                onSuccess={handleSuccess}\n                onCancel={handleCancel}\n              />\n            )}\n          </div>\n        )}\n      </div>\n    </CommandDialog>\n  );\n}\n\nexport default WorkCreationPalette;\n","/**\n * useGlobalKeyboard Hook\n * Feature: 033-unified-work-creation-hub\n *\n * Registers global keyboard shortcuts for the application.\n * Primary: K (Mac) / Ctrl+K (Windows) to open work creation palette.\n */\n\nimport { useEffect, useCallback } from 'react';\n\nexport interface GlobalKeyboardOptions {\n  /** Callback when K / Ctrl+K is pressed */\n  onCreateNew?: () => void;\n  /** Enable/disable the shortcuts */\n  enabled?: boolean;\n}\n\n/**\n * Detect if running on macOS\n */\nfunction isMac(): boolean {\n  if (typeof navigator === 'undefined') return false;\n  return navigator.platform.toUpperCase().indexOf('MAC') >= 0;\n}\n\n/**\n * Hook to register global keyboard shortcuts\n */\nexport function useGlobalKeyboard({\n  onCreateNew,\n  enabled = true,\n}: GlobalKeyboardOptions) {\n  const handleKeyDown = useCallback(\n    (event: KeyboardEvent) => {\n      if (!enabled) return;\n\n      // Check for K (Mac) or Ctrl+K (Windows/Linux)\n      const isCmdOrCtrl = isMac() ? event.metaKey : event.ctrlKey;\n\n      if (isCmdOrCtrl && event.key === 'k') {\n        // Prevent default browser behavior (e.g., Chrome's address bar focus)\n        event.preventDefault();\n        event.stopPropagation();\n\n        // Don't trigger if user is typing in an input\n        const activeElement = document.activeElement;\n        const isTyping =\n          activeElement instanceof HTMLInputElement ||\n          activeElement instanceof HTMLTextAreaElement ||\n          activeElement?.getAttribute('contenteditable') === 'true';\n\n        // Allow K even in inputs if no text is selected\n        // This gives power users quick access\n        if (isTyping && (activeElement as HTMLInputElement).value) {\n          // Only block if there's actual content\n          return;\n        }\n\n        onCreateNew?.();\n      }\n    },\n    [onCreateNew, enabled]\n  );\n\n  useEffect(() => {\n    if (!enabled) return;\n\n    // Use capture phase to handle before other handlers\n    document.addEventListener('keydown', handleKeyDown, true);\n\n    return () => {\n      document.removeEventListener('keydown', handleKeyDown, true);\n    };\n  }, [handleKeyDown, enabled]);\n}\n\n/**\n * Get keyboard shortcut display text\n */\nexport function getShortcutText(): string {\n  return isMac() ? 'K' : 'Ctrl+K';\n}\n\nexport default useGlobalKeyboard;\n","/**\n * WorkCreationProvider Component\n * Feature: 033-unified-work-creation-hub\n *\n * Provides global work creation functionality via context.\n * Wraps the app and handles K shortcut registration.\n */\n\nimport { createContext, useContext, useState, useCallback, type ReactNode } from 'react';\nimport { WorkCreationPalette, type WorkItemType } from './WorkCreationPalette';\nimport { useGlobalKeyboard } from './hooks/useGlobalKeyboard';\nimport { toast } from 'sonner';\nimport { useTranslation } from 'react-i18next';\n\ninterface WorkCreationContextValue {\n  /** Open the creation palette */\n  openPalette: (defaultType?: WorkItemType) => void;\n  /** Close the creation palette */\n  closePalette: () => void;\n  /** Whether the palette is open */\n  isOpen: boolean;\n}\n\nconst WorkCreationContext = createContext<WorkCreationContextValue | null>(null);\n\nexport interface WorkCreationProviderProps {\n  children: ReactNode;\n  /** Disable the K shortcut */\n  disableShortcut?: boolean;\n}\n\nexport function WorkCreationProvider({\n  children,\n  disableShortcut = false,\n}: WorkCreationProviderProps) {\n  const { t } = useTranslation('work-creation');\n  const [isOpen, setIsOpen] = useState(false);\n  const [defaultType, setDefaultType] = useState<WorkItemType | undefined>();\n\n  const openPalette = useCallback((type?: WorkItemType) => {\n    setDefaultType(type);\n    setIsOpen(true);\n  }, []);\n\n  const closePalette = useCallback(() => {\n    setIsOpen(false);\n    setDefaultType(undefined);\n  }, []);\n\n  const handleSuccess = useCallback(\n    (type: WorkItemType, _item: unknown) => {\n      const messages: Record<WorkItemType, string> = {\n        commitment: t('success.commitmentCreated', 'Commitment created successfully'),\n        task: t('success.taskCreated', 'Task created successfully'),\n        intake: t('success.intakeCreated', 'Intake request submitted successfully'),\n      };\n      toast.success(messages[type]);\n    },\n    [t]\n  );\n\n  // Register K shortcut\n  useGlobalKeyboard({\n    onCreateNew: () => openPalette(),\n    enabled: !disableShortcut,\n  });\n\n  return (\n    <WorkCreationContext.Provider value={{ openPalette, closePalette, isOpen }}>\n      {children}\n      <WorkCreationPalette\n        open={isOpen}\n        onOpenChange={setIsOpen}\n        defaultType={defaultType}\n        onSuccess={handleSuccess}\n      />\n    </WorkCreationContext.Provider>\n  );\n}\n\n/**\n * Hook to access work creation functionality\n */\nexport function useWorkCreation() {\n  const context = useContext(WorkCreationContext);\n  if (!context) {\n    throw new Error('useWorkCreation must be used within a WorkCreationProvider');\n  }\n  return context;\n}\n\nexport default WorkCreationProvider;\n","import { createRootRoute, Outlet } from '@tanstack/react-router'\nimport { TanStackRouterDevtools } from '@tanstack/react-router-devtools'\nimport ErrorBoundary from '@/components/ErrorBoundary'\nimport { WorkCreationProvider } from '@/components/work-creation'\n\nexport const Route = createRootRoute({\n  component: () => (\n    <ErrorBoundary>\n      <WorkCreationProvider>\n        <Outlet />\n      </WorkCreationProvider>\n      <TanStackRouterDevtools position=\"bottom-right\" />\n    </ErrorBoundary>\n  ),\n})","import { createFileRoute } from '@tanstack/react-router'\nimport { RegisterPage } from '../auth/RegisterPage'\n\nexport const Route = createFileRoute('/register')({\n component: RegisterPage,\n})","import { createFileRoute } from '@tanstack/react-router'\nimport { useTranslation } from 'react-i18next'\nimport { NavigationShell, MetricCard, ExecutionsTabs } from '@/components/modern-nav'\n\n/**\n * Standalone Modern Navigation Demo\n *\n * This route renders OUTSIDE the main app layout to showcase\n * the complete navigation system without the old sidebar.\n *\n * Access at: /modern-nav-standalone\n */\nexport const Route = createFileRoute('/modern-nav-standalone')({\n  component: StandaloneDemo,\n})\n\nfunction StandaloneDemo() {\n  const { t } = useTranslation()\n\n  const handleLogout = () => {\n    // TODO: Implement logout\n  }\n\n  return (\n    <div className=\"fixed inset-0 overflow-hidden\">\n      <NavigationShell\n        userName=\"John Doe\"\n        userEmail=\"customerpop@gmail.com\"\n        onLogout={handleLogout}\n        defaultPanelOpen={true}\n      >\n        {/* Dashboard Content */}\n        <div className=\"container mx-auto px-4 sm:px-6 lg:px-8 py-6 sm:py-8 lg:py-12\">\n          {/* Page Header */}\n          <header className=\"mb-6 sm:mb-8 lg:mb-12\">\n            <h1 className=\"text-2xl sm:text-3xl md:text-4xl font-bold text-content-text mb-2\">\n              {t('navigation.dashboard', 'Dashboard')}\n            </h1>\n            <p className=\"text-sm sm:text-base text-content-text-muted\">\n              All Your Workflows And Permissions\n            </p>\n          </header>\n\n          {/* Content Grid */}\n          <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6 lg:gap-8\">\n            {/* Large Metric Card */}\n            <div className=\"lg:col-span-2\">\n              <MetricCard\n                label={t('metrics.executions', 'Executions')}\n                value={340}\n                trend={{ value: 23, direction: 'up' }}\n                linkText={t('common.seeReport', 'See Report')}\n                onLinkClick={() => {\n                  /* TODO: Navigate to report */\n                }}\n              />\n            </div>\n\n            {/* Additional Metrics */}\n            <MetricCard\n              label={t('metrics.activeProjects', 'Active Projects')}\n              value={12}\n              trend={{ value: 8, direction: 'up' }}\n              linkText={t('common.viewAll', 'View All')}\n              onLinkClick={() => {\n                /* TODO: Navigate to projects */\n              }}\n            />\n\n            <MetricCard\n              label={t('metrics.teamMembers', 'Team Members')}\n              value={24}\n              trend={{ value: 2, direction: 'neutral' }}\n              linkText={t('common.manage', 'Manage')}\n              onLinkClick={() => {\n                /* TODO: Navigate to team */\n              }}\n            />\n\n            {/* Executions Tabs */}\n            <div className=\"lg:col-span-2\">\n              <ExecutionsTabs title={t('navigation.executions', 'Executions')} />\n            </div>\n          </div>\n\n          {/* Reference Comparison */}\n          <div className=\"mt-12 p-6 bg-panel rounded-lg border border-panel-border\">\n            <h2 className=\"text-lg font-semibold text-content-text mb-4\">\n               Reference Design Match\n            </h2>\n            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm\">\n              <div>\n                <h3 className=\"font-medium text-content-text mb-2\">Icon Rail (Left)</h3>\n                <ul className=\"space-y-1 text-content-text-muted\">\n                  <li> 56px width</li>\n                  <li> Dark background (#1A1D26)</li>\n                  <li> Icon-only buttons</li>\n                  <li> Green active indicator</li>\n                  <li> Settings at bottom</li>\n                </ul>\n              </div>\n              <div>\n                <h3 className=\"font-medium text-content-text mb-2\">Expanded Panel (Middle)</h3>\n                <ul className=\"space-y-1 text-content-text-muted\">\n                  <li> 280px width</li>\n                  <li> Light gray background</li>\n                  <li> User profile at top</li>\n                  <li> Projects with badges</li>\n                  <li> Status (New 3, Updates 2)</li>\n                  <li> Document tree</li>\n                </ul>\n              </div>\n              <div>\n                <h3 className=\"font-medium text-content-text mb-2\">Content Area (Right)</h3>\n                <ul className=\"space-y-1 text-content-text-muted\">\n                  <li> White background</li>\n                  <li> Dashboard title</li>\n                  <li> Executions: 340 +23%</li>\n                  <li> Animated counter</li>\n                  <li> Tabs with search</li>\n                </ul>\n              </div>\n            </div>\n          </div>\n        </div>\n      </NavigationShell>\n    </div>\n  )\n}\n","import { createFileRoute } from '@tanstack/react-router'\nimport Login from '../pages/Login'\n\nexport const Route = createFileRoute('/login')({\n component: Login,\n})\n","import { create } from 'zustand'\nimport { persist } from 'zustand/middleware'\nimport { supabase } from '../lib/supabase'\n\n// Re-export supabase for backward compatibility\nexport { supabase }\n\nexport interface AuthUser {\n  id: string\n  email: string\n  name?: string\n  role?: string\n  avatar?: string\n}\n\nexport interface AuthState {\n  user: AuthUser | null\n  isAuthenticated: boolean\n  isLoading: boolean\n  error: string | null\n\n  // Actions\n  login: (email: string, password: string, mfaCode?: string) => Promise<void>\n  logout: () => Promise<void>\n  checkAuth: () => Promise<void>\n  clearError: () => void\n}\n\nexport const useAuthStore = create<AuthState>()(\n  persist(\n    (set) => ({\n      user: null,\n      isAuthenticated: false,\n      isLoading: false,\n      error: null,\n\n      login: async (email: string, password: string, mfaCode?: string) => {\n        set({ isLoading: true, error: null })\n        try {\n          const { data, error } = await supabase.auth.signInWithPassword({\n            email,\n            password,\n          })\n\n          if (error) {\n            throw error\n          }\n\n          if (data.user) {\n            // Fetch user profile from database\n            const { data: profile } = await supabase\n              .from('users')\n              .select('*')\n              .eq('id', data.user.id)\n              .single()\n\n            set({\n              user: {\n                id: data.user.id,\n                email: data.user.email || '',\n                name: profile?.full_name || profile?.username || data.user.email?.split('@')[0],\n                role: profile?.role || 'viewer',\n                avatar: profile?.avatar_url,\n              },\n              isAuthenticated: true,\n              isLoading: false,\n            })\n          }\n        } catch (error) {\n          set({\n            error: error instanceof Error ? error.message : 'Login failed',\n            isLoading: false,\n            isAuthenticated: false,\n          })\n          throw error\n        }\n      },\n\n      logout: async () => {\n        set({ isLoading: true })\n        try {\n          const { error } = await supabase.auth.signOut()\n\n          if (error) {\n            throw error\n          }\n\n          set({\n            user: null,\n            isAuthenticated: false,\n            isLoading: false,\n            error: null,\n          })\n        } catch (error) {\n          set({\n            error: error instanceof Error ? error.message : 'Logout failed',\n            isLoading: false,\n          })\n          throw error\n        }\n      },\n\n      checkAuth: async () => {\n        set({ isLoading: true })\n        try {\n          const { data: { session } } = await supabase.auth.getSession()\n\n          if (session?.user) {\n            set({\n              user: {\n                id: session.user.id,\n                email: session.user.email || '',\n                name: session.user.user_metadata?.name,\n                role: session.user.user_metadata?.role,\n                avatar: session.user.user_metadata?.avatar_url,\n              },\n              isAuthenticated: true,\n              isLoading: false,\n            })\n          } else {\n            set({\n              user: null,\n              isAuthenticated: false,\n              isLoading: false,\n            })\n          }\n        } catch (error) {\n          set({\n            error: error instanceof Error ? error.message : 'Auth check failed',\n            isLoading: false,\n            isAuthenticated: false,\n          })\n        }\n      },\n\n      clearError: () => set({ error: null }),\n    }),\n    {\n      name: 'auth-storage',\n      partialize: (state) => ({ user: state.user, isAuthenticated: state.isAuthenticated }),\n    }\n  )\n)\n","import { createFileRoute, Outlet, redirect, useNavigate } from '@tanstack/react-router'\nimport { MainLayout } from '../components/Layout/MainLayout'\nimport { useAuthStore, supabase } from '../store/authStore'\nimport { ChatDock } from '@/components/ai/ChatDock'\nimport { ChatProvider } from '@/contexts/ChatContext'\n\nexport const Route = createFileRoute('/_protected')({\n  beforeLoad: async () => {\n    // Check actual Supabase session, not just localStorage\n    const {\n      data: { session },\n    } = await supabase.auth.getSession()\n\n    if (!session) {\n      // Clear stale auth state and redirect to login\n      useAuthStore.setState({ user: null, isAuthenticated: false })\n      throw redirect({\n        to: '/login',\n      })\n    }\n  },\n  component: ProtectedLayout,\n})\n\nfunction ProtectedLayout() {\n  const navigate = useNavigate()\n\n  // Handle citation clicks from chat to navigate to entities\n  const handleCitationClick = (type: string, id: string) => {\n    switch (type) {\n      case 'dossier':\n        navigate({ to: '/dossiers/$id', params: { id } })\n        break\n      case 'commitment':\n        navigate({ to: '/commitments', search: { id } })\n        break\n      case 'engagement':\n        navigate({ to: '/engagements/$engagementId', params: { engagementId: id } })\n        break\n      default:\n        // For other types, try a general search\n        navigate({ to: '/search', search: { q: id, type: undefined, includeArchived: undefined } })\n    }\n  }\n\n  return (\n    <ChatProvider>\n      <MainLayout>\n        <Outlet />\n      </MainLayout>\n      {/* AI Chat Dock - available on all protected pages */}\n      <ChatDock onCitationClick={handleCitationClick} />\n    </ChatProvider>\n  )\n}\n","import { createFileRoute, redirect } from '@tanstack/react-router'\nimport { useAuthStore } from '../store/authStore'\nimport { useEffect } from 'react'\nimport { useNavigate } from '@tanstack/react-router'\n\nexport const Route = createFileRoute('/')({\n  beforeLoad: async () => {\n    const { isAuthenticated } = useAuthStore.getState()\n    if (isAuthenticated) {\n      throw redirect({\n        to: '/dashboard',\n      })\n    }\n  },\n  component: HomePage,\n})\n\nfunction HomePage() {\n  const navigate = useNavigate()\n  const { isAuthenticated } = useAuthStore()\n\n  useEffect(() => {\n    if (isAuthenticated) {\n      navigate({ to: '/dashboard' })\n    }\n  }, [isAuthenticated, navigate])\n\n  return (\n    <div className=\"from-base-50 to-base-100 min-h-screen bg-gradient-to-b\">\n      <div className=\"container mx-auto px-4 py-16\">\n        <div className=\"mx-auto max-w-3xl text-center\">\n          <h1 className=\"font-display text-base-900 mb-6 text-5xl\">\n            GASTAT International Dossier System\n          </h1>\n          <p className=\"font-text text-base-600 mb-8 text-xl\">\n            Welcome to the International Relations Management Platform\n          </p>\n          <div className=\"flex justify-center gap-4\">\n            <button\n              onClick={() => navigate({ to: '/login' })}\n              className=\"font-text rounded-lg bg-primary-600 px-8 py-3 text-primary-50 transition-colors hover:bg-primary-700\"\n            >\n              Sign In\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n  )\n}","import { createFileRoute } from '@tanstack/react-router'\nimport WorkingGroupsPage from '../../pages/WorkingGroupsPage'\n\nexport const Route = createFileRoute('/_protected/working-groups')({\n  component: WorkingGroupsPage,\n})\n","import { createFileRoute } from '@tanstack/react-router'\nimport { WordAssistantPage } from '@/pages/word-assistant/WordAssistantPage'\n\nexport const Route = createFileRoute('/_protected/word-assistant')({\n component: WordAssistantPage\n})","import { createFileRoute } from '@tanstack/react-router'\nimport { UsersPage } from '../../pages/users/UsersPage'\n\nexport const Route = createFileRoute('/_protected/users')({\n component: UsersPage,\n})\n","import { createFileRoute } from '@tanstack/react-router'\nimport Themes from '../../pages/Themes'\n\nexport const Route = createFileRoute('/_protected/themes')({\n component: Themes,\n})\n","import { createFileRoute } from '@tanstack/react-router'\nimport { SettingsPage } from '@/pages/settings/SettingsPage'\n\nexport const Route = createFileRoute('/_protected/settings')({\n component: SettingsPage\n})","import { createFileRoute } from '@tanstack/react-router'\nimport { SearchPage } from '../../pages/SearchPage'\n\nexport const Route = createFileRoute('/_protected/search')({\n component: SearchPage,\n validateSearch: (search: Record<string, unknown>) => {\n return {\n q: (search.q as string) || '',\n type: search.type as string | undefined,\n includeArchived: search.includeArchived as string | undefined,\n }\n },\n})\n","import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Card = React.forwardRef<\n HTMLDivElement,\n React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n <div\n ref={ref}\n className={cn(\n \"rounded-xl border bg-card text-card-foreground shadow\",\n className\n )}\n {...props}\n />\n))\nCard.displayName = \"Card\"\n\nconst CardHeader = React.forwardRef<\n HTMLDivElement,\n React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n <div\n ref={ref}\n className={cn(\"flex flex-col space-y-1.5 p-6\", className)}\n {...props}\n />\n))\nCardHeader.displayName = \"CardHeader\"\n\nconst CardTitle = React.forwardRef<\n HTMLDivElement,\n React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n <div\n ref={ref}\n className={cn(\"font-semibold leading-none tracking-tight\", className)}\n {...props}\n />\n))\nCardTitle.displayName = \"CardTitle\"\n\nconst CardDescription = React.forwardRef<\n HTMLDivElement,\n React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n <div\n ref={ref}\n className={cn(\"text-sm text-muted-foreground\", className)}\n {...props}\n />\n))\nCardDescription.displayName = \"CardDescription\"\n\nconst CardContent = React.forwardRef<\n HTMLDivElement,\n React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\n))\nCardContent.displayName = \"CardContent\"\n\nconst CardFooter = React.forwardRef<\n HTMLDivElement,\n React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n <div\n ref={ref}\n className={cn(\"flex items-center p-6 pt-0\", className)}\n {...props}\n />\n))\nCardFooter.displayName = \"CardFooter\"\n\nexport { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent }\n","import { useEffect, useMemo, useRef, useState } from 'react'\nimport type { BreakpointDeviceType } from '../types/breakpoint'\n\ntype BreakpointAlias = 'xs' | 'sm' | 'md' | 'lg'\n\nexport interface ViewportInfo {\n  width: number\n  height: number\n  orientation: 'portrait' | 'landscape'\n}\n\nexport interface ResponsiveState extends ViewportInfo {\n  alias: BreakpointAlias\n  deviceType: BreakpointDeviceType\n  isMobile: boolean\n  isTablet: boolean\n  isDesktop: boolean\n  isWide: boolean\n  up: (alias: BreakpointAlias) => boolean\n  down: (alias: BreakpointAlias) => boolean\n  between: (min: BreakpointAlias, max: BreakpointAlias) => boolean\n  /** True if container queries are recommended at current size */\n  containerQueries: boolean\n}\n\nfunction readPxVar(variableName: string): number | undefined {\n  if (typeof window === 'undefined') return undefined\n  const raw = getComputedStyle(document.documentElement)\n    .getPropertyValue(variableName)\n    .trim()\n  if (!raw) return undefined\n  const match = raw.match(/(\\d+(?:\\.\\d+)?)px/)\n  return match ? Number(match[1]) : Number(raw)\n}\n\nfunction getBreakpoints(): Record<BreakpointAlias, number> {\n  const xs = readPxVar('--breakpoint-xs') ?? 320\n  const sm = readPxVar('--breakpoint-sm') ?? 768\n  const md = readPxVar('--breakpoint-md') ?? 1024\n  const lg = readPxVar('--breakpoint-lg') ?? 1440\n  return { xs, sm, md, lg }\n}\n\nfunction aliasForWidth(width: number, bp: Record<BreakpointAlias, number>): BreakpointAlias {\n  if (width >= bp.lg) return 'lg'\n  if (width >= bp.md) return 'md'\n  if (width >= bp.sm) return 'sm'\n  return 'xs'\n}\n\nfunction deviceForAlias(alias: BreakpointAlias): BreakpointDeviceType {\n  switch (alias) {\n    case 'xs':\n      return 'mobile'\n    case 'sm':\n      return 'tablet'\n    case 'md':\n      return 'desktop'\n    case 'lg':\n      return 'wide'\n  }\n}\n\nexport function useResponsive(): ResponsiveState {\n  const breakpoints = useMemo(getBreakpoints, [])\n  const [viewport, setViewport] = useState<ViewportInfo>(() => ({\n    width: typeof window !== 'undefined' ? window.innerWidth : 0,\n    height: typeof window !== 'undefined' ? window.innerHeight : 0,\n    orientation:\n      typeof window !== 'undefined' && window.innerWidth < window.innerHeight\n        ? 'portrait'\n        : 'landscape',\n  }))\n  const rafRef = useRef<number | null>(null)\n\n  useEffect(() => {\n    if (typeof window === 'undefined') return\n    const handleResize = () => {\n      if (rafRef.current) cancelAnimationFrame(rafRef.current)\n      rafRef.current = requestAnimationFrame(() => {\n        setViewport({\n          width: window.innerWidth,\n          height: window.innerHeight,\n          orientation: window.innerWidth < window.innerHeight ? 'portrait' : 'landscape',\n        })\n      })\n    }\n\n    window.addEventListener('resize', handleResize, { passive: true })\n    window.addEventListener('orientationchange', handleResize, { passive: true } as any)\n    // Initial in case of late mount\n    handleResize()\n    return () => {\n      window.removeEventListener('resize', handleResize)\n      window.removeEventListener('orientationchange', handleResize as any)\n      if (rafRef.current) cancelAnimationFrame(rafRef.current)\n    }\n  }, [])\n\n  const alias = useMemo(() => aliasForWidth(viewport.width, breakpoints), [viewport.width, breakpoints])\n  const deviceType = useMemo(() => deviceForAlias(alias), [alias])\n\n  const up = (a: BreakpointAlias) => viewport.width >= breakpoints[a]\n  const down = (a: BreakpointAlias) => viewport.width < breakpoints[a]\n  const between = (min: BreakpointAlias, max: BreakpointAlias) =>\n    viewport.width >= breakpoints[min] && viewport.width < breakpoints[max]\n\n  return {\n    ...viewport,\n    alias,\n    deviceType,\n    isMobile: deviceType === 'mobile',\n    isTablet: deviceType === 'tablet',\n    isDesktop: deviceType === 'desktop',\n    isWide: deviceType === 'wide',\n    up,\n    down,\n    between,\n    containerQueries: alias !== 'xs' && alias !== 'sm',\n  }\n}\n\nexport type { BreakpointAlias }\n\n","import { useLanguage as useLanguageFromProvider } from '../components/language-provider/language-provider';\n\n/**\n * Re-export the LanguageProvider hook so feature code can keep importing from hooks/\n */\nexport const useLanguage = useLanguageFromProvider;\n\n/**\n * Hook to get just the current language and direction\n * Useful for components that only need to read language state\n */\nexport function useLanguageValue() {\n  const { language, direction } = useLanguage();\n  \n  return {\n    language,\n    direction,\n    isRtl: direction === 'rtl',\n    isLtr: direction === 'ltr',\n    isArabic: language === 'ar',\n    isEnglish: language === 'en',\n  };\n}\n\n/**\n * Hook to toggle between languages\n */\nexport function useLanguageToggle() {\n  const { language, setLanguage } = useLanguage();\n  \n  const toggleLanguage = () => {\n    setLanguage(language === 'en' ? 'ar' : 'en');\n  };\n  \n  return {\n    language,\n    toggleLanguage,\n  };\n}\n\n/**\n * Hook to get translation function with namespace support\n */\ntype TranslateOptions = Record<string, unknown> | undefined;\n\nexport function useTranslate(namespace: string = 'common') {\n  const { t } = useLanguage();\n  \n  return (key: string, options?: TranslateOptions) => {\n    const fullKey = namespace ? `${namespace}:${key}` : key;\n    return t(fullKey, options);\n  };\n}\n","import { useEffect, useState, useCallback } from 'react'\nimport {\n  useTheme as useThemeFromProvider,\n  AVAILABLE_THEMES,\n} from '../components/theme-provider/theme-provider'\nimport { useLanguage } from './use-language'\n\n/**\n * Re-export the ThemeProvider hook so feature code can keep importing from hooks/\n */\nexport const useTheme = useThemeFromProvider\n\n/**\n * Re-export available themes for UI components\n */\nexport { AVAILABLE_THEMES }\n\n/**\n * Hook to get just the current theme without setters\n * Useful for components that only need to read theme state\n */\nexport function useThemeValue() {\n  const { theme, colorMode, isDark } = useTheme()\n\n  return {\n    theme,\n    colorMode,\n    isDark,\n    isLight: colorMode === 'light',\n  }\n}\n\n/**\n * Hook to toggle between light and dark modes\n */\nexport function useColorModeToggle() {\n  const { colorMode, setColorMode, isDark } = useTheme()\n\n  const toggleColorMode = () => {\n    setColorMode(colorMode === 'light' ? 'dark' : 'light')\n  }\n\n  return {\n    colorMode,\n    toggleColorMode,\n    isDark,\n  }\n}\n\n/**\n * RTL/LTR helpers wired into the theme layer for convenience\n */\nexport function useThemeRtl() {\n  const { direction, language, setLanguage } = useLanguage()\n\n  const isRtl = direction === 'rtl'\n  const setDirection = (dir: 'ltr' | 'rtl') => setLanguage(dir === 'rtl' ? 'ar' : 'en')\n  const toggleDirection = () => setDirection(isRtl ? 'ltr' : 'rtl')\n\n  return {\n    direction,\n    language,\n    isRtl,\n    isLtr: !isRtl,\n    setDirection,\n    toggleDirection,\n  }\n}\n\nexport const useTextDirection = useThemeRtl\n\n/**\n * Hook for RTL/LTR support with theme integration\n */\nexport function useDirection() {\n  const [direction, setDirection] = useState<'ltr' | 'rtl'>(() => {\n    if (typeof window === 'undefined') return 'ltr'\n    return (document.documentElement.dir as 'ltr' | 'rtl') || 'ltr'\n  })\n\n  useEffect(() => {\n    const htmlElement = document.documentElement\n    const observer = new MutationObserver(() => {\n      const newDir = (htmlElement.dir as 'ltr' | 'rtl') || 'ltr'\n      setDirection(newDir)\n    })\n\n    observer.observe(htmlElement, {\n      attributes: true,\n      attributeFilter: ['dir'],\n    })\n\n    return () => observer.disconnect()\n  }, [])\n\n  const toggleDirection = useCallback(() => {\n    const newDirection = direction === 'ltr' ? 'rtl' : 'ltr'\n    document.documentElement.dir = newDirection\n    setDirection(newDirection)\n  }, [direction])\n\n  const setDirectionValue = useCallback((value: 'ltr' | 'rtl') => {\n    document.documentElement.dir = value\n    setDirection(value)\n  }, [])\n\n  return {\n    direction,\n    isRTL: direction === 'rtl',\n    isLTR: direction === 'ltr',\n    toggleDirection,\n    setDirection: setDirectionValue,\n  }\n}\n\n/**\n * Combined hook for theme with RTL support\n */\nexport function useThemeWithRTL() {\n  const theme = useTheme()\n  const direction = useDirection()\n\n  return {\n    ...theme,\n    ...direction,\n  }\n}\n","import React, { useState } from 'react';\nimport { Card, CardContent, CardDescription, CardFooter, CardHeader, CardTitle } from '../ui/card';\nimport { useResponsive } from '../../hooks/use-responsive';\nimport { useDirection } from '../../hooks/use-theme';\nimport { cn } from '../../lib/utils';\nimport { ChevronDown, ChevronUp } from 'lucide-react';\n\nexport interface ResponsiveCardProps {\n title?: React.ReactNode;\n description?: React.ReactNode;\n children: React.ReactNode;\n footer?: React.ReactNode;\n className?: string;\n collapsible?: boolean;\n defaultCollapsed?: boolean;\n priority?: 'high' | 'medium' | 'low';\n showOnMobile?: boolean;\n mobileLayout?: 'stack' | 'inline';\n}\n\nexport function ResponsiveCard({\n title,\n description,\n children,\n footer,\n className,\n collapsible = false,\n defaultCollapsed = false,\n priority = 'medium',\n showOnMobile = true,\n mobileLayout = 'stack',\n}: ResponsiveCardProps) {\n const { viewport, isMobile, isTablet } = useResponsive();\n const { isRTL } = useDirection();\n const [isCollapsed, setIsCollapsed] = useState(defaultCollapsed);\n \n const shouldEnableCollapse = collapsible && (isMobile || isTablet);\n const isCurrentlyCollapsed = shouldEnableCollapse && isCollapsed;\n \n if (isMobile && !showOnMobile) {\n return null;\n }\n \n const priorityClasses = {\n high: 'border-primary',\n medium: '',\n low: 'opacity-90',\n };\n \n const responsivePadding = {\n mobile: 'p-3',\n tablet: 'p-4',\n desktop: 'p-6',\n wide: 'p-8',\n };\n \n return (\n <Card\n className={cn(\n 'transition-all duration-200',\n 'border-[0.5px]',\n responsivePadding[viewport],\n priorityClasses[priority],\n isMobile && mobileLayout === 'stack' && 'space-y-2',\n className\n )}\n dir={isRTL ? 'rtl' : 'ltr'}\n >\n {(title || description) && (\n <CardHeader \n className={cn(\n 'space-y-1.5',\n isMobile && 'p-3',\n shouldEnableCollapse && 'cursor-pointer select-none'\n )}\n onClick={shouldEnableCollapse ? () => setIsCollapsed(!isCollapsed) : undefined}\n >\n <div className=\"flex items-center justify-between\">\n {title && (\n <CardTitle className={cn(\n 'text-base sm:text-lg md:text-xl',\n isMobile && 'text-sm'\n )}>\n {title}\n </CardTitle>\n )}\n {shouldEnableCollapse && (\n <button\n className=\"p-1 hover:bg-accent rounded-md transition-colors\"\n aria-expanded={!isCollapsed}\n aria-label={isCollapsed ? 'Expand' : 'Collapse'}\n >\n {isCollapsed ? (\n <ChevronDown className=\"h-4 w-4\" />\n ) : (\n <ChevronUp className=\"h-4 w-4\" />\n )}\n </button>\n )}\n </div>\n {description && !isCurrentlyCollapsed && (\n <CardDescription className={cn(\n 'text-xs sm:text-sm',\n isMobile && 'text-xs'\n )}>\n {description}\n </CardDescription>\n )}\n </CardHeader>\n )}\n \n {!isCurrentlyCollapsed && (\n <CardContent className={cn(\n 'space-y-2',\n isMobile && 'p-3',\n isMobile && mobileLayout === 'inline' && 'flex flex-wrap gap-2'\n )}>\n {children}\n </CardContent>\n )}\n \n {footer && !isCurrentlyCollapsed && (\n <CardFooter className={cn(\n 'pt-4',\n isMobile && 'p-3 pt-2'\n )}>\n {footer}\n </CardFooter>\n )}\n </Card>\n );\n}\n\nexport interface ResponsiveCardGridProps {\n children: React.ReactNode;\n columns?: {\n mobile?: number;\n tablet?: number;\n desktop?: number;\n wide?: number;\n };\n gap?: 'sm' | 'md' | 'lg';\n className?: string;\n}\n\nexport function ResponsiveCardGrid({\n children,\n columns = {\n mobile: 1,\n tablet: 2,\n desktop: 3,\n wide: 4,\n },\n gap = 'md',\n className,\n}: ResponsiveCardGridProps) {\n const { viewport } = useResponsive();\n \n const columnCount = columns[viewport] || 1;\n \n const gapClasses = {\n sm: 'gap-2',\n md: 'gap-4',\n lg: 'gap-6',\n };\n \n return (\n <div\n className={cn(\n 'grid',\n gapClasses[gap],\n className\n )}\n style={{\n gridTemplateColumns: `repeat(${columnCount}, minmax(0, 1fr))`,\n }}\n >\n {children}\n </div>\n );\n}","import * as React from 'react'\nimport { cn } from '@/lib/utils'\n\n/**\n * TableContainer - Wrapper for horizontal scrolling on mobile\n * Prevents tables from causing horizontal overflow on small screens\n */\nexport function TableContainer({\n  className,\n  children,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) {\n  return (\n    <div\n      className={cn('w-full overflow-x-auto -mx-4 px-4 sm:mx-0 sm:px-0', className)}\n      data-testid=\"table-container\"\n      {...props}\n    >\n      {children}\n    </div>\n  )\n}\n\nexport function Table({ className, ...props }: React.HTMLAttributes<HTMLTableElement>) {\n  return (\n    <table role=\"table\" className={cn('w-full caption-bottom text-sm', className)} {...props} />\n  )\n}\n\nexport function TableHeader({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLTableSectionElement>) {\n  return <thead role=\"rowgroup\" className={cn('[&_tr]:border-b', className)} {...props} />\n}\n\nexport function TableBody({ className, ...props }: React.HTMLAttributes<HTMLTableSectionElement>) {\n  return (\n    <tbody role=\"rowgroup\" className={cn('[&_tr:last-child]:border-0', className)} {...props} />\n  )\n}\n\nexport function TableRow({ className, ...props }: React.HTMLAttributes<HTMLTableRowElement>) {\n  return (\n    <tr\n      role=\"row\"\n      className={cn(\n        'border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted',\n        className,\n      )}\n      {...props}\n    />\n  )\n}\n\nexport function TableHead({ className, ...props }: React.ThHTMLAttributes<HTMLTableCellElement>) {\n  return (\n    <th\n      role=\"columnheader\"\n      className={cn(\n        'h-10 px-2 text-start align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pe-0 [&>[role=checkbox]]:translate-y-[2px]',\n        className,\n      )}\n      {...props}\n    />\n  )\n}\n\nexport function TableCell({ className, ...props }: React.TdHTMLAttributes<HTMLTableCellElement>) {\n  return (\n    <td\n      role=\"cell\"\n      className={cn(\n        'p-2 align-middle [&:has([role=checkbox])]:pe-0 [&>[role=checkbox]]:translate-y-[2px]',\n        className,\n      )}\n      {...props}\n    />\n  )\n}\n","import React from 'react';\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from '../ui/table';\nimport { Card, CardContent, CardHeader, CardTitle } from '../ui/card';\nimport { useResponsive } from '../../hooks/use-responsive';\nimport { useDirection } from '../../hooks/use-theme';\nimport { cn } from '../../lib/utils';\n\nexport interface ResponsiveTableColumn<T> {\n key: string;\n header: string;\n accessor: (item: T) => React.ReactNode;\n priority?: 'high' | 'medium' | 'low';\n hideOnMobile?: boolean;\n mobileLabel?: string;\n align?: 'left' | 'center' | 'right';\n}\n\nexport interface ResponsiveTableProps<T> {\n data: T[];\n columns: ResponsiveTableColumn<T>[];\n className?: string;\n mobileView?: 'card' | 'list' | 'table';\n striped?: boolean;\n hoverable?: boolean;\n emptyMessage?: string;\n}\n\nexport function ResponsiveTable<T extends { id?: string | number }>({\n data,\n columns,\n className,\n mobileView = 'card',\n striped = false,\n hoverable = true,\n emptyMessage = 'No data available',\n}: ResponsiveTableProps<T>) {\n const { viewport, isMobile } = useResponsive();\n const { isRTL } = useDirection();\n \n const visibleColumns = isMobile \n ? columns.filter(col => !col.hideOnMobile)\n : columns;\n \n const highPriorityColumns = columns.filter(col => col.priority === 'high');\n const shouldUseMobileView = isMobile && mobileView !== 'table';\n \n if (data.length === 0) {\n return (\n <div className={cn(\n 'text-center py-8 text-muted-foreground',\n className\n )}>\n {emptyMessage}\n </div>\n );\n }\n \n if (shouldUseMobileView && mobileView === 'card') {\n return (\n <div className={cn('space-y-4', className)}>\n {data.map((item, index) => (\n <Card key={item.id || index} className=\"border-[0.5px]\">\n <CardContent className=\"p-4 space-y-2\">\n {visibleColumns.map(column => (\n <div\n key={column.key}\n className={cn(\n 'flex justify-between items-center',\n column.priority === 'high' && 'font-medium'\n )}\n >\n <span className=\"text-sm text-muted-foreground\">\n {column.mobileLabel || column.header}:\n </span>\n <span className={cn(\n 'text-sm',\n column.align === 'right' && 'text-end',\n column.align === 'center' && 'text-center'\n )}>\n {column.accessor(item)}\n </span>\n </div>\n ))}\n </CardContent>\n </Card>\n ))}\n </div>\n );\n }\n \n if (shouldUseMobileView && mobileView === 'list') {\n return (\n <div className={cn('space-y-2', className)}>\n {data.map((item, index) => (\n <div\n key={item.id || index}\n className={cn(\n 'p-3 border-[0.5px] rounded-md',\n hoverable && 'hover:bg-accent/50 transition-colors'\n )}\n >\n <div className=\"space-y-1\">\n {highPriorityColumns.map(column => (\n <div key={column.key} className=\"font-medium\">\n {column.accessor(item)}\n </div>\n ))}\n {visibleColumns\n .filter(col => col.priority !== 'high')\n .map(column => (\n <div key={column.key} className=\"text-sm text-muted-foreground\">\n <span className=\"font-medium\">{column.mobileLabel || column.header}:</span>{' '}\n {column.accessor(item)}\n </div>\n ))}\n </div>\n </div>\n ))}\n </div>\n );\n }\n \n return (\n <div className={cn(\n 'w-full overflow-auto',\n isMobile && 'max-w-full',\n className\n )}>\n <Table>\n <TableHeader>\n <TableRow>\n {visibleColumns.map(column => (\n <TableHead\n key={column.key}\n className={cn(\n column.align === 'right' && 'text-end',\n column.align === 'center' && 'text-center',\n isRTL && column.align === 'right' && 'text-start',\n isRTL && column.align === 'left' && 'text-end'\n )}\n >\n {column.header}\n </TableHead>\n ))}\n </TableRow>\n </TableHeader>\n <TableBody>\n {data.map((item, index) => (\n <TableRow\n key={item.id || index}\n className={cn(\n striped && index % 2 === 0 && 'bg-accent/20',\n hoverable && 'hover:bg-accent/50 transition-colors'\n )}\n >\n {visibleColumns.map(column => (\n <TableCell\n key={column.key}\n className={cn(\n column.align === 'right' && 'text-end',\n column.align === 'center' && 'text-center',\n isRTL && column.align === 'right' && 'text-start',\n isRTL && column.align === 'left' && 'text-end'\n )}\n >\n {column.accessor(item)}\n </TableCell>\n ))}\n </TableRow>\n ))}\n </TableBody>\n </Table>\n </div>\n );\n}\n\nexport interface ResponsiveDataGridProps {\n children: React.ReactNode;\n className?: string;\n}\n\nexport function ResponsiveDataGrid({ children, className }: ResponsiveDataGridProps) {\n const { viewport } = useResponsive();\n \n const gridClasses = {\n mobile: 'grid-cols-1',\n tablet: 'grid-cols-2 lg:grid-cols-3',\n desktop: 'grid-cols-3 xl:grid-cols-4',\n wide: 'grid-cols-4 2xl:grid-cols-5',\n };\n \n return (\n <div className={cn(\n 'grid gap-4',\n gridClasses[viewport],\n className\n )}>\n {children}\n </div>\n );\n}","import * as React from \"react\"\nimport * as NavigationMenuPrimitive from \"@radix-ui/react-navigation-menu\"\nimport { cva } from \"class-variance-authority\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst NavigationMenu = React.forwardRef<\n React.ElementRef<typeof NavigationMenuPrimitive.Root>,\n React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n <NavigationMenuPrimitive.Root\n ref={ref}\n className={cn(\n \"relative z-10 flex max-w-max flex-1 items-center justify-center\",\n className\n )}\n {...props}\n >\n {children}\n <NavigationMenuViewport />\n </NavigationMenuPrimitive.Root>\n))\nNavigationMenu.displayName = NavigationMenuPrimitive.Root.displayName\n\nconst NavigationMenuList = React.forwardRef<\n React.ElementRef<typeof NavigationMenuPrimitive.List>,\n React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.List>\n>(({ className, ...props }, ref) => (\n <NavigationMenuPrimitive.List\n ref={ref}\n className={cn(\n \"group flex flex-1 list-none items-center justify-center space-x-1\",\n className\n )}\n {...props}\n />\n))\nNavigationMenuList.displayName = NavigationMenuPrimitive.List.displayName\n\nconst NavigationMenuItem = NavigationMenuPrimitive.Item\n\nconst navigationMenuTriggerStyle = cva(\n \"group inline-flex h-9 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[state=open]:text-accent-foreground data-[state=open]:bg-accent/50 data-[state=open]:hover:bg-accent data-[state=open]:focus:bg-accent\"\n)\n\nconst NavigationMenuTrigger = React.forwardRef<\n React.ElementRef<typeof NavigationMenuPrimitive.Trigger>,\n React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n <NavigationMenuPrimitive.Trigger\n ref={ref}\n className={cn(navigationMenuTriggerStyle(), \"group\", className)}\n {...props}\n >\n {children}{\" \"}\n <ChevronDown\n className=\"relative top-[1px] ms-1 h-3 w-3 transition duration-300 group-data-[state=open]:rotate-180\"\n aria-hidden=\"true\"\n />\n </NavigationMenuPrimitive.Trigger>\n))\nNavigationMenuTrigger.displayName = NavigationMenuPrimitive.Trigger.displayName\n\nconst NavigationMenuContent = React.forwardRef<\n React.ElementRef<typeof NavigationMenuPrimitive.Content>,\n React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n <NavigationMenuPrimitive.Content\n ref={ref}\n className={cn(\n \"start-0 top-0 w-full data-[motion^=from-]:animate-in data-[motion^=to-]:animate-out data-[motion^=from-]:fade-in data-[motion^=to-]:fade-out data-[motion=from-end]:slide-in-from-right-52 data-[motion=from-start]:slide-in-from-left-52 data-[motion=to-end]:slide-out-to-right-52 data-[motion=to-start]:slide-out-to-left-52 md:absolute md:w-auto \",\n className\n )}\n {...props}\n />\n))\nNavigationMenuContent.displayName = NavigationMenuPrimitive.Content.displayName\n\nconst NavigationMenuLink = NavigationMenuPrimitive.Link\n\nconst NavigationMenuViewport = React.forwardRef<\n React.ElementRef<typeof NavigationMenuPrimitive.Viewport>,\n React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Viewport>\n>(({ className, ...props }, ref) => (\n <div className={cn(\"absolute start-0 top-full flex justify-center\")}>\n <NavigationMenuPrimitive.Viewport\n className={cn(\n \"origin-top-center relative mt-1.5 h-[var(--radix-navigation-menu-viewport-height)] w-full overflow-hidden rounded-md border bg-popover text-popover-foreground shadow data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-90 md:w-[var(--radix-navigation-menu-viewport-width)]\",\n className\n )}\n ref={ref}\n {...props}\n />\n </div>\n))\nNavigationMenuViewport.displayName =\n NavigationMenuPrimitive.Viewport.displayName\n\nconst NavigationMenuIndicator = React.forwardRef<\n React.ElementRef<typeof NavigationMenuPrimitive.Indicator>,\n React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Indicator>\n>(({ className, ...props }, ref) => (\n <NavigationMenuPrimitive.Indicator\n ref={ref}\n className={cn(\n \"top-full z-[1] flex h-1.5 items-end justify-center overflow-hidden data-[state=visible]:animate-in data-[state=hidden]:animate-out data-[state=hidden]:fade-out data-[state=visible]:fade-in\",\n className\n )}\n {...props}\n >\n <div className=\"relative top-[60%] h-2 w-2 rotate-45 rounded-tl-sm bg-border shadow-md\" />\n </NavigationMenuPrimitive.Indicator>\n))\nNavigationMenuIndicator.displayName =\n NavigationMenuPrimitive.Indicator.displayName\n\nexport {\n navigationMenuTriggerStyle,\n NavigationMenu,\n NavigationMenuList,\n NavigationMenuItem,\n NavigationMenuContent,\n NavigationMenuTrigger,\n NavigationMenuLink,\n NavigationMenuIndicator,\n NavigationMenuViewport,\n}\n","\"use client\"\n\nimport * as React from \"react\"\nimport * as SheetPrimitive from \"@radix-ui/react-dialog\"\nimport { VisuallyHidden } from \"@radix-ui/react-visually-hidden\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Sheet = SheetPrimitive.Root\n\nconst SheetTrigger = SheetPrimitive.Trigger\n\nconst SheetClose = SheetPrimitive.Close\n\nconst SheetPortal = SheetPrimitive.Portal\n\nconst SheetOverlay = React.forwardRef<\n React.ElementRef<typeof SheetPrimitive.Overlay>,\n React.ComponentPropsWithoutRef<typeof SheetPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n <SheetPrimitive.Overlay\n className={cn(\n \"fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n className\n )}\n {...props}\n ref={ref}\n />\n))\nSheetOverlay.displayName = SheetPrimitive.Overlay.displayName\n\nconst sheetVariants = cva(\n \"fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500 data-[state=open]:animate-in data-[state=closed]:animate-out\",\n {\n variants: {\n side: {\n top: \"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top\",\n bottom:\n \"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom\",\n left: \"inset-y-0 start-0 h-full w-3/4 border-e data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm\",\n right:\n \"inset-y-0 end-0 h-full w-3/4 border-s data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm\",\n },\n },\n defaultVariants: {\n side: \"right\",\n },\n }\n)\n\ninterface SheetContentProps\n extends React.ComponentPropsWithoutRef<typeof SheetPrimitive.Content>,\n VariantProps<typeof sheetVariants> {\n  /** Accessible title for screen readers (required by Radix). If not using SheetTitle, provide this. */\n  accessibleTitle?: string;\n}\n\nconst SheetContent = React.forwardRef<\n React.ElementRef<typeof SheetPrimitive.Content>,\n SheetContentProps\n>(({ side = \"right\", className, children, accessibleTitle, ...props }, ref) => (\n <SheetPortal>\n <SheetOverlay />\n <SheetPrimitive.Content\n ref={ref}\n className={cn(sheetVariants({ side }), className)}\n aria-describedby={undefined}\n {...props}\n >\n {/* Visually hidden title for accessibility when no SheetTitle is used */}\n {accessibleTitle && (\n   <VisuallyHidden>\n     <SheetPrimitive.Title>{accessibleTitle}</SheetPrimitive.Title>\n   </VisuallyHidden>\n )}\n <SheetPrimitive.Close className=\"absolute end-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary\">\n <X className=\"h-4 w-4\" />\n <span className=\"sr-only\">Close</span>\n </SheetPrimitive.Close>\n {children}\n </SheetPrimitive.Content>\n </SheetPortal>\n))\nSheetContent.displayName = SheetPrimitive.Content.displayName\n\nconst SheetHeader = ({\n className,\n ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n <div\n className={cn(\n \"flex flex-col space-y-2 text-center sm:text-start\",\n className\n )}\n {...props}\n />\n)\nSheetHeader.displayName = \"SheetHeader\"\n\nconst SheetFooter = ({\n className,\n ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n <div\n className={cn(\n \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n className\n )}\n {...props}\n />\n)\nSheetFooter.displayName = \"SheetFooter\"\n\nconst SheetTitle = React.forwardRef<\n React.ElementRef<typeof SheetPrimitive.Title>,\n React.ComponentPropsWithoutRef<typeof SheetPrimitive.Title>\n>(({ className, ...props }, ref) => (\n <SheetPrimitive.Title\n ref={ref}\n className={cn(\"text-lg font-semibold text-foreground\", className)}\n {...props}\n />\n))\nSheetTitle.displayName = SheetPrimitive.Title.displayName\n\nconst SheetDescription = React.forwardRef<\n React.ElementRef<typeof SheetPrimitive.Description>,\n React.ComponentPropsWithoutRef<typeof SheetPrimitive.Description>\n>(({ className, ...props }, ref) => (\n <SheetPrimitive.Description\n ref={ref}\n className={cn(\"text-sm text-muted-foreground\", className)}\n {...props}\n />\n))\nSheetDescription.displayName = SheetPrimitive.Description.displayName\n\nexport {\n Sheet,\n SheetPortal,\n SheetOverlay,\n SheetTrigger,\n SheetClose,\n SheetContent,\n SheetHeader,\n SheetFooter,\n SheetTitle,\n SheetDescription,\n}\n","import React, { useState } from 'react';\nimport { NavigationMenu, NavigationMenuItem, NavigationMenuLink, NavigationMenuList } from '../ui/navigation-menu';\nimport { Sheet, SheetContent, SheetHeader, SheetTitle, SheetTrigger } from '../ui/sheet';\nimport { Button } from '../ui/button';\nimport { useResponsive } from '../../hooks/use-responsive';\nimport { useDirection } from '../../hooks/use-theme';\nimport { cn } from '../../lib/utils';\nimport { Menu, X } from 'lucide-react';\n\nexport interface NavItem {\n id: string;\n label: string;\n href?: string;\n onClick?: () => void;\n icon?: React.ReactNode;\n badge?: string | number;\n children?: NavItem[];\n priority?: 'high' | 'medium' | 'low';\n hideOnMobile?: boolean;\n}\n\nexport interface ResponsiveNavProps {\n items: NavItem[];\n logo?: React.ReactNode;\n actions?: React.ReactNode;\n className?: string;\n mobileBreakpoint?: 'sm' | 'md' | 'lg';\n position?: 'top' | 'bottom';\n}\n\nexport function ResponsiveNav({\n items,\n logo,\n actions,\n className,\n mobileBreakpoint = 'md',\n position = 'top',\n}: ResponsiveNavProps) {\n const { viewport, isMobile, isTablet } = useResponsive();\n const { isRTL } = useDirection();\n const [mobileMenuOpen, setMobileMenuOpen] = useState(false);\n \n const showMobileNav = (mobileBreakpoint === 'sm' && isMobile) ||\n (mobileBreakpoint === 'md' && (isMobile || isTablet)) ||\n (mobileBreakpoint === 'lg' && viewport !== 'wide');\n \n const visibleItems = items.filter(item => \n !item.hideOnMobile || !isMobile\n );\n \n const highPriorityItems = visibleItems.filter(item => item.priority === 'high');\n const regularItems = visibleItems.filter(item => item.priority !== 'high');\n \n if (showMobileNav) {\n return (\n <nav className={cn(\n 'flex items-center justify-between p-4',\n position === 'bottom' && 'fixed bottom-0 left-0 right-0 bg-background border-t',\n position === 'top' && 'sticky top-0 bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60 border-b',\n className\n )}>\n {logo && <div className=\"flex-shrink-0\">{logo}</div>}\n \n <div className=\"flex items-center gap-2\">\n {highPriorityItems.slice(0, 2).map(item => (\n <Button\n key={item.id}\n variant=\"ghost\"\n size=\"sm\"\n onClick={item.onClick}\n className=\"gap-2\"\n >\n {item.icon}\n <span className=\"hidden xs:inline\">{item.label}</span>\n {item.badge && (\n <span className=\"ms-1 px-1.5 py-0.5 text-xs bg-primary text-primary-foreground rounded-full\">\n {item.badge}\n </span>\n )}\n </Button>\n ))}\n \n <Sheet open={mobileMenuOpen} onOpenChange={setMobileMenuOpen}>\n <SheetTrigger asChild>\n <Button variant=\"ghost\" size=\"icon\" aria-label=\"Menu\">\n <Menu className=\"h-5 w-5\" />\n </Button>\n </SheetTrigger>\n <SheetContent side={isRTL ? 'left' : 'right'} className=\"w-[280px]\">\n <SheetHeader>\n <SheetTitle>Navigation</SheetTitle>\n </SheetHeader>\n <nav className=\"mt-6 space-y-1\">\n {visibleItems.map(item => (\n <MobileNavItem\n key={item.id}\n item={item}\n onItemClick={() => setMobileMenuOpen(false)}\n />\n ))}\n </nav>\n {actions && (\n <div className=\"mt-6 pt-6 border-t\">\n {actions}\n </div>\n )}\n </SheetContent>\n </Sheet>\n </div>\n </nav>\n );\n }\n \n return (\n <nav className={cn(\n 'flex items-center justify-between px-6 py-3',\n 'border-b bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60',\n className\n )}>\n {logo && <div className=\"flex-shrink-0\">{logo}</div>}\n \n <NavigationMenu>\n <NavigationMenuList>\n {visibleItems.map(item => (\n <NavigationMenuItem key={item.id}>\n <NavigationMenuLink\n className={cn(\n 'group inline-flex h-10 w-max items-center justify-center rounded-md bg-background px-4 py-2',\n 'text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground',\n 'focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50',\n item.priority === 'high' && 'font-semibold'\n )}\n href={item.href}\n onClick={item.onClick}\n >\n {item.icon && <span className=\"me-2\">{item.icon}</span>}\n {item.label}\n {item.badge && (\n <span className=\"ms-2 px-1.5 py-0.5 text-xs bg-primary text-primary-foreground rounded-full\">\n {item.badge}\n </span>\n )}\n </NavigationMenuLink>\n </NavigationMenuItem>\n ))}\n </NavigationMenuList>\n </NavigationMenu>\n \n {actions && <div className=\"flex items-center gap-2\">{actions}</div>}\n </nav>\n );\n}\n\ninterface MobileNavItemProps {\n item: NavItem;\n depth?: number;\n onItemClick?: () => void;\n}\n\nfunction MobileNavItem({ item, depth = 0, onItemClick }: MobileNavItemProps) {\n const [expanded, setExpanded] = useState(false);\n const hasChildren = item.children && item.children.length > 0;\n \n return (\n <div>\n <button\n className={cn(\n 'w-full flex items-center justify-between px-3 py-2 rounded-md',\n 'text-sm hover:bg-accent hover:text-accent-foreground transition-colors',\n item.priority === 'high' && 'font-semibold',\n depth > 0 && 'ms-4'\n )}\n onClick={() => {\n if (hasChildren) {\n setExpanded(!expanded);\n } else {\n item.onClick?.();\n onItemClick?.();\n }\n }}\n >\n <div className=\"flex items-center gap-2\">\n {item.icon}\n <span>{item.label}</span>\n {item.badge && (\n <span className=\"px-1.5 py-0.5 text-xs bg-primary text-primary-foreground rounded-full\">\n {item.badge}\n </span>\n )}\n </div>\n {hasChildren && (\n <span className={cn(\n 'transition-transform duration-200',\n expanded && 'rotate-180'\n )}>\n \n </span>\n )}\n </button>\n \n {hasChildren && expanded && (\n <div className=\"mt-1 space-y-1\">\n {item.children!.map(child => (\n <MobileNavItem\n key={child.id}\n item={child}\n depth={depth + 1}\n onItemClick={onItemClick}\n />\n ))}\n </div>\n )}\n </div>\n );\n}","import React, { useState } from 'react'\nimport { useTheme, AVAILABLE_THEMES } from '../../hooks/use-theme'\nimport { useLanguage } from '../../hooks/use-language'\nimport { ChevronDown, Palette, Sun, Moon, Check } from 'lucide-react'\n\ninterface ThemeOption {\n  id: 'canvas'\n  name: { en: string; ar: string }\n  preview: {\n    primary: string\n    secondary: string\n    accent: string\n  }\n}\n\n// Canvas theme with Eucalyptus green primary\nconst themes: ThemeOption[] = [\n  {\n    id: 'canvas',\n    name: { en: 'Canvas', ar: '' },\n    preview: {\n      primary: 'hsl(155 50.6% 37.3%)', // Eucalyptus green\n      secondary: 'hsl(0 0% 89.8%)', // Alabaster gray\n      accent: 'hsl(155 55.8% 58.4%)', // Light eucalyptus\n    },\n  },\n]\n\nexport function ThemeSelector() {\n  const { theme, setTheme, colorMode, setColorMode } = useTheme()\n  const { language } = useLanguage()\n  const [isOpen, setIsOpen] = useState(false)\n\n  const currentTheme = themes.find((t) => t.id === theme) || themes[0]\n\n  const handleThemeSelect = (themeId: 'canvas') => {\n    setTheme(themeId)\n    setIsOpen(false)\n\n    // Announce change for screen readers\n    const announcement = document.createElement('div')\n    announcement.setAttribute('role', 'status')\n    announcement.setAttribute('aria-live', 'polite')\n    announcement.className = 'sr-only'\n    announcement.textContent = `Theme changed to ${themeId}`\n    document.body.appendChild(announcement)\n    setTimeout(() => document.body.removeChild(announcement), 1000)\n  }\n\n  const toggleColorMode = () => {\n    const newMode = colorMode === 'light' ? 'dark' : 'light'\n    setColorMode(newMode)\n\n    // Announce change for screen readers\n    const announcement = document.createElement('div')\n    announcement.setAttribute('role', 'status')\n    announcement.setAttribute('aria-live', 'polite')\n    announcement.className = 'sr-only'\n    announcement.textContent = `Color mode changed to ${newMode}`\n    document.body.appendChild(announcement)\n    setTimeout(() => document.body.removeChild(announcement), 1000)\n  }\n\n  // If only one theme, show simplified selector\n  const singleTheme = themes.length === 1\n\n  return (\n    <div className=\"relative\">\n      <div className=\"flex items-center gap-1\">\n        {/* Theme Dropdown - shows when multiple themes available */}\n        {singleTheme ? (\n          // Single theme: just display the name with the primary color indicator\n          <div className=\"flex items-center gap-1.5 px-2 py-1 rounded-md border border-border bg-background\">\n            <div\n              className=\"w-3 h-3 rounded-full\"\n              style={{ backgroundColor: currentTheme.preview.primary }}\n              aria-hidden=\"true\"\n            />\n            <span className=\"text-xs font-medium\">{currentTheme.name[language]}</span>\n          </div>\n        ) : (\n          // Multiple themes: show dropdown\n          <div className=\"relative\">\n            <button\n              onClick={() => setIsOpen(!isOpen)}\n              className=\"flex items-center gap-1 px-2 py-1 rounded-md border border-border bg-background hover:bg-accent transition-colors\"\n              aria-label={language === 'en' ? 'Select theme' : ' '}\n              aria-expanded={isOpen}\n              aria-haspopup=\"true\"\n            >\n              <Palette className=\"w-3.5 h-3.5\" aria-hidden=\"true\" />\n              <span className=\"text-xs font-medium\">{currentTheme.name[language]}</span>\n              <ChevronDown\n                className={`w-3 h-3 transition-transform ${isOpen ? 'rotate-180' : ''}`}\n                aria-hidden=\"true\"\n              />\n            </button>\n\n            {isOpen && (\n              <>\n                {/* Backdrop */}\n                <div\n                  className=\"fixed inset-0 z-10\"\n                  onClick={() => setIsOpen(false)}\n                  aria-hidden=\"true\"\n                />\n\n                {/* Dropdown Menu */}\n                <div\n                  className=\"absolute top-full mt-2 start-0 z-20 w-56 rounded-lg border border-border bg-popover shadow-lg\"\n                  role=\"menu\"\n                  aria-orientation=\"vertical\"\n                >\n                  {themes.map((themeOption) => (\n                    <button\n                      key={themeOption.id}\n                      onClick={() => handleThemeSelect(themeOption.id)}\n                      className=\"w-full px-3 py-2 flex items-center justify-between hover:bg-accent transition-colors first:rounded-t-lg last:rounded-b-lg\"\n                      role=\"menuitem\"\n                      aria-selected={theme === themeOption.id}\n                    >\n                      <div className=\"flex items-center gap-2\">\n                        {/* Theme Preview */}\n                        <div className=\"flex gap-0.5\" aria-hidden=\"true\">\n                          <div\n                            className=\"w-3 h-3 rounded-full\"\n                            style={{ backgroundColor: themeOption.preview.primary }}\n                          />\n                          <div\n                            className=\"w-3 h-3 rounded-full\"\n                            style={{ backgroundColor: themeOption.preview.secondary }}\n                          />\n                          <div\n                            className=\"w-3 h-3 rounded-full\"\n                            style={{ backgroundColor: themeOption.preview.accent }}\n                          />\n                        </div>\n\n                        {/* Theme Name */}\n                        <span className=\"text-xs font-medium\">{themeOption.name[language]}</span>\n                      </div>\n\n                      {/* Selected Indicator */}\n                      {theme === themeOption.id && (\n                        <Check className=\"w-3.5 h-3.5 text-primary\" aria-label=\"Selected\" />\n                      )}\n                    </button>\n                  ))}\n                </div>\n              </>\n            )}\n          </div>\n        )}\n\n        {/* Color Mode Toggle */}\n        <button\n          onClick={toggleColorMode}\n          className=\"p-1.5 rounded-md border border-border bg-background hover:bg-accent transition-colors\"\n          aria-label={\n            colorMode === 'light'\n              ? language === 'en'\n                ? 'Switch to dark mode'\n                : '   '\n              : language === 'en'\n                ? 'Switch to light mode'\n                : '   '\n          }\n        >\n          {colorMode === 'light' ? (\n            <Moon className=\"w-3.5 h-3.5\" aria-hidden=\"true\" />\n          ) : (\n            <Sun className=\"w-3.5 h-3.5\" aria-hidden=\"true\" />\n          )}\n        </button>\n      </div>\n    </div>\n  )\n}\n","import * as React from \"react\"\nimport * as DropdownMenuPrimitive from \"@radix-ui/react-dropdown-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst DropdownMenu = DropdownMenuPrimitive.Root\n\nconst DropdownMenuTrigger = DropdownMenuPrimitive.Trigger\n\nconst DropdownMenuGroup = DropdownMenuPrimitive.Group\n\nconst DropdownMenuPortal = DropdownMenuPrimitive.Portal\n\nconst DropdownMenuSub = DropdownMenuPrimitive.Sub\n\nconst DropdownMenuRadioGroup = DropdownMenuPrimitive.RadioGroup\n\nconst DropdownMenuSubTrigger = React.forwardRef<\n React.ElementRef<typeof DropdownMenuPrimitive.SubTrigger>,\n React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubTrigger> & {\n inset?: boolean\n }\n>(({ className, inset, children, ...props }, ref) => (\n <DropdownMenuPrimitive.SubTrigger\n ref={ref}\n className={cn(\n \"flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n inset && \"ps-8\",\n className\n )}\n {...props}\n >\n {children}\n <ChevronRight className=\"ms-auto\" />\n </DropdownMenuPrimitive.SubTrigger>\n))\nDropdownMenuSubTrigger.displayName =\n DropdownMenuPrimitive.SubTrigger.displayName\n\nconst DropdownMenuSubContent = React.forwardRef<\n React.ElementRef<typeof DropdownMenuPrimitive.SubContent>,\n React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n <DropdownMenuPrimitive.SubContent\n ref={ref}\n className={cn(\n \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n className\n )}\n {...props}\n />\n))\nDropdownMenuSubContent.displayName =\n DropdownMenuPrimitive.SubContent.displayName\n\nconst DropdownMenuContent = React.forwardRef<\n React.ElementRef<typeof DropdownMenuPrimitive.Content>,\n React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n <DropdownMenuPrimitive.Portal>\n <DropdownMenuPrimitive.Content\n ref={ref}\n sideOffset={sideOffset}\n className={cn(\n \"z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md\",\n \"data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n className\n )}\n {...props}\n />\n </DropdownMenuPrimitive.Portal>\n))\nDropdownMenuContent.displayName = DropdownMenuPrimitive.Content.displayName\n\nconst DropdownMenuItem = React.forwardRef<\n React.ElementRef<typeof DropdownMenuPrimitive.Item>,\n React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Item> & {\n inset?: boolean\n }\n>(({ className, inset, ...props }, ref) => (\n <DropdownMenuPrimitive.Item\n ref={ref}\n className={cn(\n \"relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&>svg]:size-4 [&>svg]:shrink-0\",\n inset && \"ps-8\",\n className\n )}\n {...props}\n />\n))\nDropdownMenuItem.displayName = DropdownMenuPrimitive.Item.displayName\n\nconst DropdownMenuCheckboxItem = React.forwardRef<\n React.ElementRef<typeof DropdownMenuPrimitive.CheckboxItem>,\n React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n <DropdownMenuPrimitive.CheckboxItem\n ref={ref}\n className={cn(\n \"relative flex cursor-default select-none items-center rounded-sm py-1.5 ps-8 pe-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n className\n )}\n checked={checked}\n {...props}\n >\n <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n <DropdownMenuPrimitive.ItemIndicator>\n <Check className=\"h-4 w-4\" />\n </DropdownMenuPrimitive.ItemIndicator>\n </span>\n {children}\n </DropdownMenuPrimitive.CheckboxItem>\n))\nDropdownMenuCheckboxItem.displayName =\n DropdownMenuPrimitive.CheckboxItem.displayName\n\nconst DropdownMenuRadioItem = React.forwardRef<\n React.ElementRef<typeof DropdownMenuPrimitive.RadioItem>,\n React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n <DropdownMenuPrimitive.RadioItem\n ref={ref}\n className={cn(\n \"relative flex cursor-default select-none items-center rounded-sm py-1.5 ps-8 pe-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n className\n )}\n {...props}\n >\n <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n <DropdownMenuPrimitive.ItemIndicator>\n <Circle className=\"h-2 w-2 fill-current\" />\n </DropdownMenuPrimitive.ItemIndicator>\n </span>\n {children}\n </DropdownMenuPrimitive.RadioItem>\n))\nDropdownMenuRadioItem.displayName = DropdownMenuPrimitive.RadioItem.displayName\n\nconst DropdownMenuLabel = React.forwardRef<\n React.ElementRef<typeof DropdownMenuPrimitive.Label>,\n React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Label> & {\n inset?: boolean\n }\n>(({ className, inset, ...props }, ref) => (\n <DropdownMenuPrimitive.Label\n ref={ref}\n className={cn(\n \"px-2 py-1.5 text-sm font-semibold\",\n inset && \"ps-8\",\n className\n )}\n {...props}\n />\n))\nDropdownMenuLabel.displayName = DropdownMenuPrimitive.Label.displayName\n\nconst DropdownMenuSeparator = React.forwardRef<\n React.ElementRef<typeof DropdownMenuPrimitive.Separator>,\n React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n <DropdownMenuPrimitive.Separator\n ref={ref}\n className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n {...props}\n />\n))\nDropdownMenuSeparator.displayName = DropdownMenuPrimitive.Separator.displayName\n\nconst DropdownMenuShortcut = ({\n className,\n ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n return (\n <span\n className={cn(\"ms-auto text-xs tracking-widest opacity-60\", className)}\n {...props}\n />\n )\n}\nDropdownMenuShortcut.displayName = \"DropdownMenuShortcut\"\n\nexport {\n DropdownMenu,\n DropdownMenuTrigger,\n DropdownMenuContent,\n DropdownMenuItem,\n DropdownMenuCheckboxItem,\n DropdownMenuRadioItem,\n DropdownMenuLabel,\n DropdownMenuSeparator,\n DropdownMenuShortcut,\n DropdownMenuGroup,\n DropdownMenuPortal,\n DropdownMenuSub,\n DropdownMenuSubContent,\n DropdownMenuSubTrigger,\n DropdownMenuRadioGroup,\n}\n","import { create } from 'zustand'\nimport { persist } from 'zustand/middleware'\nimport type { SupportedLanguage } from '../i18n'\n\ninterface UIState {\n  // Sidebar\n  isSidebarOpen: boolean\n  isSidebarCollapsed: boolean\n\n  // Theme\n  theme: 'light' | 'dark' | 'system'\n\n  // Language\n  language: SupportedLanguage\n\n  // Notifications\n  notifications: Notification[]\n  unreadCount: number\n\n  // Modals\n  modals: Record<string, boolean>\n\n  // Loading states\n  globalLoading: boolean\n  loadingMessage: string | null\n\n  // Actions\n  toggleSidebar: () => void\n  setSidebarCollapsed: (collapsed: boolean) => void\n  setTheme: (theme: 'light' | 'dark' | 'system') => void\n  setLanguage: (lang: SupportedLanguage) => void\n  addNotification: (notification: Omit<Notification, 'id'>) => void\n  removeNotification: (id: string) => void\n  markNotificationAsRead: (id: string) => void\n  openModal: (modalId: string) => void\n  closeModal: (modalId: string) => void\n  setGlobalLoading: (loading: boolean, message?: string) => void\n}\n\ninterface Notification {\n  id: string\n  type: 'info' | 'success' | 'warning' | 'error'\n  title: string\n  message?: string\n  timestamp: Date\n  read: boolean\n}\n\nexport const useUIStore = create<UIState>()(\n  persist(\n    (set) => ({\n      // Initial state\n      isSidebarOpen: true,\n      isSidebarCollapsed: false,\n      theme: 'system',\n      language: 'en',\n      notifications: [],\n      unreadCount: 0,\n      modals: {},\n      globalLoading: false,\n      loadingMessage: null,\n\n      // Actions\n      toggleSidebar: () =>\n        set((state) => ({ isSidebarOpen: !state.isSidebarOpen })),\n\n      setSidebarCollapsed: (collapsed) =>\n        set({ isSidebarCollapsed: collapsed }),\n\n      setTheme: (theme) => {\n        set({ theme })\n        // Apply theme to document\n        if (theme === 'dark' ||\n            (theme === 'system' && window.matchMedia('(prefers-color-scheme: dark)').matches)) {\n          document.documentElement.classList.add('dark')\n        } else {\n          document.documentElement.classList.remove('dark')\n        }\n      },\n\n      setLanguage: (language) => set({ language }),\n\n      addNotification: (notification) =>\n        set((state) => {\n          const newNotification: Notification = {\n            ...notification,\n            id: Math.random().toString(36).substr(2, 9),\n            timestamp: new Date(),\n            read: false,\n          }\n          return {\n            notifications: [newNotification, ...state.notifications],\n            unreadCount: state.unreadCount + 1,\n          }\n        }),\n\n      removeNotification: (id) =>\n        set((state) => {\n          const notification = state.notifications.find((n) => n.id === id)\n          const wasUnread = notification && !notification.read\n          return {\n            notifications: state.notifications.filter((n) => n.id !== id),\n            unreadCount: wasUnread ? state.unreadCount - 1 : state.unreadCount,\n          }\n        }),\n\n      markNotificationAsRead: (id) =>\n        set((state) => {\n          const notifications = state.notifications.map((n) =>\n            n.id === id ? { ...n, read: true } : n\n          )\n          const notification = state.notifications.find((n) => n.id === id)\n          const wasUnread = notification && !notification.read\n          return {\n            notifications,\n            unreadCount: wasUnread ? state.unreadCount - 1 : state.unreadCount,\n          }\n        }),\n\n      openModal: (modalId) =>\n        set((state) => ({\n          modals: { ...state.modals, [modalId]: true },\n        })),\n\n      closeModal: (modalId) =>\n        set((state) => ({\n          modals: { ...state.modals, [modalId]: false },\n        })),\n\n      setGlobalLoading: (loading, message) =>\n        set({\n          globalLoading: loading,\n          loadingMessage: message || null,\n        }),\n    }),\n    {\n      name: 'ui-storage',\n      partialize: (state) => ({\n        theme: state.theme,\n        language: state.language,\n        isSidebarCollapsed: state.isSidebarCollapsed,\n      }),\n    }\n  )\n)","import { useCallback } from 'react'\nimport { useTranslation } from 'react-i18next'\nimport { Globe, Check } from 'lucide-react'\nimport { Button } from './ui/button'\nimport {\n DropdownMenu,\n DropdownMenuContent,\n DropdownMenuItem,\n DropdownMenuTrigger,\n} from './ui/dropdown-menu'\nimport { switchLanguage, type SupportedLanguage } from '../i18n'\nimport { useUIStore } from '../store/uiStore'\n\ninterface LanguageSwitcherProps {\n compact?: boolean\n}\n\nexport function LanguageSwitcher({ compact = false }: LanguageSwitcherProps) {\n const { i18n } = useTranslation()\n const { language, setLanguage } = useUIStore()\n\n const handleChange = useCallback(\n async (next: SupportedLanguage) => {\n if (next === language) return\n await switchLanguage(next)\n setLanguage(next)\n },\n [language, setLanguage]\n )\n\n const labelMap: Record<SupportedLanguage, string> = {\n en: i18n.getFixedT('en')('languages.english', 'English'),\n ar: i18n.getFixedT('ar')('languages.arabic', ''),\n }\n\n return (\n <DropdownMenu>\n <DropdownMenuTrigger asChild>\n <Button\n variant=\"outline\"\n size={compact ? 'icon' : 'sm'}\n className=\"gap-2\"\n aria-label={i18n.t('languages.switch', 'Switch language')}\n >\n <Globe className=\"size-4\" />\n {!compact && <span>{labelMap[language]}</span>}\n </Button>\n </DropdownMenuTrigger>\n <DropdownMenuContent align=\"end\" className=\"min-w-36\">\n {(Object.keys(labelMap) as SupportedLanguage[]).map((lang) => (\n <DropdownMenuItem\n key={lang}\n onSelect={() => handleChange(lang)}\n className=\"flex items-center justify-between\"\n >\n <span>{labelMap[lang]}</span>\n {language === lang && <Check className=\"size-4 text-primary-500\" />}\n </DropdownMenuItem>\n ))}\n </DropdownMenuContent>\n </DropdownMenu>\n )\n}\n","import { createFileRoute } from '@tanstack/react-router'\nimport React from 'react'\nimport { ResponsiveCard } from '@/components/responsive/responsive-card'\nimport { ResponsiveCardGrid } from '@/components/responsive/responsive-card'\nimport { ResponsiveTable } from '@/components/responsive/responsive-table'\nimport { ResponsiveNav, type NavItem } from '@/components/responsive/responsive-nav'\nimport { ThemeSelector } from '@/components/theme-selector/theme-selector'\nimport { LanguageSwitcher } from '@/components/LanguageSwitcher'\nimport { useResponsive } from '@/hooks/use-responsive'\n\nfunction ViewInfo() {\n const r = useResponsive()\n return (\n <div data-testid=\"viewport-info\" className=\"text-sm text-muted-foreground\">\n alias:{' '}\n <span data-testid=\"alias\">{r.alias}</span>  device:{' '}\n <span data-testid=\"device\">{r.deviceType}</span>  width:{' '}\n <span data-testid=\"width\">{r.width}</span>\n </div>\n )\n}\n\nexport function DemoPage() {\n const items: NavItem[] = [\n { id: 'home', label: 'Home', href: '#' },\n { id: 'reports', label: 'Reports', href: '#', priority: 'high' },\n { id: 'settings', label: 'Settings', href: '#' },\n ]\n\n const rows = [\n { id: 1, name: 'Saudi Arabia', status: 'Active', mou: 'MoU-001' },\n { id: 2, name: 'UAE', status: 'Draft', mou: 'MoU-002' },\n ]\n\n return (\n <div className=\"container mx-auto p-4 space-y-6\">\n <h1 className=\"text-2xl font-semibold\">Responsive Demo</h1>\n <div className=\"flex gap-3\">\n <ThemeSelector />\n <LanguageSwitcher />\n </div>\n <ViewInfo />\n\n <div data-testid=\"responsive-nav\">\n <ResponsiveNav items={items} mobileBreakpoint=\"md\" />\n </div>\n\n <ResponsiveCardGrid>\n <ResponsiveCard\n collapsible\n defaultCollapsed={false}\n title={<span>Progressive Disclosure</span>}\n description={<span>Tap the header on mobile to collapse/expand</span>}\n className=\"border\"\n >\n <div data-testid=\"collapsible-card-content\">This is card content</div>\n </ResponsiveCard>\n </ResponsiveCardGrid>\n\n <div data-testid=\"responsive-table\">\n <ResponsiveTable\n data={rows}\n mobileView=\"card\"\n columns={[\n { key: 'name', header: 'Name', accessor: (r) => r.name, priority: 'high' },\n { key: 'status', header: 'Status', accessor: (r) => r.status },\n { key: 'mou', header: 'MoU', accessor: (r) => r.mou, hideOnMobile: true },\n ]}\n />\n </div>\n </div>\n )\n}\n\nexport const Route = createFileRoute('/_protected/responsive-demo')({ component: DemoPage })\n","import { createFileRoute } from '@tanstack/react-router'\nimport { ReportsPage } from '@/pages/reports/ReportsPage'\n\nexport const Route = createFileRoute('/_protected/reports')({\n component: ReportsPage\n})","import { createFileRoute } from '@tanstack/react-router'\nimport { DossierPrototypePage } from '../../pages/prototype-dossier'\n\nexport const Route = createFileRoute('/_protected/prototype-dossier')({\n component: DossierPrototypePage,\n})\n\n\n\n\n\n\n\n","/**\n * TanStack Query hooks for positions (infinite scroll)\n *\n * Provides infinite query for position list with filtering capabilities\n * Query key: ['positions', filters]\n * Cache: staleTime 30s, gcTime 5min\n */\n\nimport { useInfiniteQuery } from '@tanstack/react-query';\nimport { supabase } from '../lib/supabase';\nimport type { PositionFilters, PositionListResponse } from '../types/position';\n\n// API base URL\nconst API_BASE_URL = import.meta.env.VITE_SUPABASE_URL + '/functions/v1';\n\n// Query keys\nexport const positionKeys = {\n  all: ['positions'] as const,\n  lists: () => [...positionKeys.all, 'list'] as const,\n  list: (filters?: PositionFilters) => [...positionKeys.lists(), filters] as const,\n  details: () => [...positionKeys.all, 'detail'] as const,\n  detail: (id: string) => [...positionKeys.details(), id] as const,\n  versions: (id: string) => [...positionKeys.all, 'versions', id] as const,\n  attachments: (id: string) => [...positionKeys.all, 'attachments', id] as const,\n};\n\n// Helper to get auth headers\nconst getAuthHeaders = async () => {\n  const { data: { session } } = await supabase.auth.getSession();\n  return {\n    'Content-Type': 'application/json',\n    'Authorization': `Bearer ${session?.access_token}`,\n  };\n};\n\n/**\n * Hook to list positions with infinite scroll\n */\nexport const usePositions = (filters?: Omit<PositionFilters, 'offset'>) => {\n  const pageSize = filters?.limit || 20;\n\n  return useInfiniteQuery({\n    queryKey: positionKeys.list(filters),\n    queryFn: async ({ pageParam = 0 }): Promise<PositionListResponse> => {\n      const headers = await getAuthHeaders();\n      const params = new URLSearchParams();\n\n      // Add filters to params\n      if (filters) {\n        Object.entries(filters).forEach(([key, value]) => {\n          if (value !== undefined && value !== null && key !== 'limit') {\n            params.append(key, String(value));\n          }\n        });\n      }\n\n      // Add pagination\n      params.append('limit', String(pageSize));\n      params.append('offset', String(pageParam));\n\n      const response = await fetch(\n        `${API_BASE_URL}/positions-list?${params.toString()}`,\n        { headers }\n      );\n\n      if (!response.ok) {\n        const error = await response.json();\n        throw new Error(error.error || 'Failed to fetch positions');\n      }\n\n      return response.json();\n    },\n    getNextPageParam: (lastPage) => {\n      // Return next offset if there are more items\n      if (lastPage.has_more) {\n        return lastPage.offset + lastPage.limit;\n      }\n      return undefined;\n    },\n    initialPageParam: 0,\n    staleTime: 30_000, // 30 seconds\n    gcTime: 5 * 60_000, // 5 minutes\n  });\n};\n","/**\n * useDebouncedValue Hook\n * Debounces a value to prevent excessive updates (e.g., search input)\n */\n\nimport { useState, useEffect } from 'react';\n\nexport function useDebouncedValue<T>(value: T, delay: number = 300): T {\n  const [debouncedValue, setDebouncedValue] = useState<T>(value);\n\n  useEffect(() => {\n    // Set debounced value after delay\n    const handler = setTimeout(() => {\n      setDebouncedValue(value);\n    }, delay);\n\n    // Cleanup timeout if value changes before delay completes\n    return () => {\n      clearTimeout(handler);\n    };\n  }, [value, delay]);\n\n  return debouncedValue;\n}\n","/**\n * PositionCard Component (T044)\n * Displays position information with attachment actions\n */\n\nimport React from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Link2, Trash2, Eye, Calendar } from 'lucide-react';\nimport { Card, CardContent, CardFooter, CardHeader } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { format } from 'date-fns';\nimport { ar, enUS } from 'date-fns/locale';\nimport type { Position } from '@/types/position';\n\nexport interface PositionCardProps {\n position: Position & { link_type?: 'primary' | 'related' | 'reference' };\n onClick?: () => void;\n onAttach?: () => void;\n onDetach?: () => void;\n context?: 'dossier' | 'engagement' | 'all';\n engagementAttachmentCount?: number;\n isAttached?: boolean;\n}\n\nexport const PositionCard: React.FC<PositionCardProps> = ({\n position,\n onClick,\n onAttach,\n onDetach,\n context = 'all',\n engagementAttachmentCount = 0,\n isAttached = false,\n}) => {\n const { t, i18n } = useTranslation('positions');\n const isRTL = i18n.language === 'ar';\n const locale = i18n.language === 'ar' ? ar : enUS;\n\n // Get localized title and content - handle both old and new schema\n const title = (position as any).topic || (i18n.language === 'ar' ? position.title_ar : position.title_en);\n const content = (position as any).rationale || (i18n.language === 'ar' ? position.content_ar : position.content_en);\n\n // Get status from approval object or direct field\n const positionStatus = (position as any).approval?.status || position.status || 'draft';\n\n // Get category for display\n const category = (position as any).category || position.thematic_category;\n\n // Truncate content for preview (200 characters)\n const contentPreview = content\n ? content.length > 200\n ? `${content.substring(0, 200)}...`\n : content\n : t('card.noContent');\n\n // Status badge variant\n const getStatusVariant = (status: string) => {\n switch (status) {\n case 'published':\n case 'approved':\n return 'success';\n case 'under_review':\n case 'review':\n return 'secondary';\n case 'draft':\n return 'outline';\n case 'unpublished':\n return 'destructive';\n default:\n return 'default';\n }\n };\n\n // Link type badge configuration (T059)\n const getLinkTypeBadge = (linkType?: 'primary' | 'related' | 'reference') => {\n if (!linkType) return null;\n\n const config = {\n primary: { label: 'Primary', className: 'bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200' },\n related: { label: 'Related', className: 'bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-200' },\n reference: { label: 'Reference', className: 'bg-gray-50 text-gray-600 dark:bg-gray-800 dark:text-gray-400' },\n };\n\n return config[linkType];\n };\n\n return (\n <Card\n className=\"h-full transition-shadow hover:shadow-md flex flex-col\"\n role=\"article\"\n aria-label={title}\n >\n <CardHeader className=\"pb-3\">\n <div className=\"flex flex-col gap-2\">\n <div className=\"flex items-start justify-between gap-2\">\n <h3\n className=\"line-clamp-2 text-lg font-semibold leading-tight\"\n onClick={onClick}\n style={{ cursor: onClick ? 'pointer' : 'default' }}\n >\n {title}\n </h3>\n <Badge variant={getStatusVariant(positionStatus)} className=\"shrink-0\">\n {t(`status.${positionStatus}`)}\n </Badge>\n </div>\n {/* Link Type Badge - T059 */}\n {position.link_type && (\n <div className=\"flex items-center gap-2\">\n <Badge\n className={`text-xs ${getLinkTypeBadge(position.link_type)?.className}`}\n variant=\"outline\"\n >\n {getLinkTypeBadge(position.link_type)?.label}\n </Badge>\n </div>\n )}\n </div>\n </CardHeader>\n\n <CardContent className=\"pb-3 flex-1 flex flex-col\">\n {/* Content Preview */}\n <p\n className=\"line-clamp-3 text-sm text-muted-foreground\"\n dir={isRTL ? 'rtl' : 'ltr'}\n >\n {contentPreview}\n </p>\n\n {/* Metadata - Pushed to bottom of CardContent */}\n <div className=\"mt-auto pt-3 flex flex-wrap items-center gap-3 text-xs text-muted-foreground\">\n {position.thematic_category && (\n <Badge variant=\"outline\" className=\"text-xs\">\n {position.thematic_category}\n </Badge>\n )}\n\n {engagementAttachmentCount > 0 && (\n <div className=\"flex items-center gap-1\">\n <Link2 className=\"h-3 w-3\" />\n <span>\n {t('card.attachedTo', { count: engagementAttachmentCount })}\n </span>\n </div>\n )}\n </div>\n\n {/* Date - Always above the button */}\n <div className=\"mt-2 flex items-center gap-1 text-xs text-muted-foreground\">\n <Calendar className=\"h-3 w-3\" />\n <span>{format(new Date(position.created_at), 'PP', { locale })}</span>\n </div>\n </CardContent>\n\n <CardFooter className=\"flex items-center justify-between gap-2 pt-3\">\n {/* View Button */}\n {onClick && (\n <Button\n variant=\"outline\"\n size=\"sm\"\n onClick={onClick}\n aria-label={t('card.view', { title })}\n className=\"flex-1\"\n >\n <Eye className=\"me-2 h-4 w-4\" />\n {t('card.viewButton')}\n </Button>\n )}\n\n {/* Attach/Detach Actions */}\n {context === 'engagement' && (\n <>\n {isAttached ? (\n <Button\n variant=\"ghost\"\n size=\"sm\"\n onClick={onDetach}\n disabled={!onDetach}\n aria-label={t('card.detach', { title })}\n aria-keyshortcuts=\"Delete\"\n >\n <Trash2 className=\"me-2 h-4 w-4\" />\n {t('card.detachButton')}\n </Button>\n ) : (\n <Button\n variant=\"default\"\n size=\"sm\"\n onClick={onAttach}\n disabled={!onAttach}\n aria-label={t('card.attach', { title })}\n aria-keyshortcuts=\"Enter\"\n >\n <Link2 className=\"me-2 h-4 w-4\" />\n {t('card.attachButton')}\n </Button>\n )}\n </>\n )}\n </CardFooter>\n </Card>\n );\n};\n","/**\n * PositionList Component (T043)\n * Virtual scrolling position list with context filtering and search\n */\n\nimport React, { useRef, useState, useMemo } from 'react';\nimport { useVirtualizer } from '@tanstack/react-virtual';\nimport { useTranslation } from 'react-i18next';\nimport { Search, Filter } from 'lucide-react';\nimport { Input } from '@/components/ui/input';\nimport { Button } from '@/components/ui/button';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\nimport { useDebouncedValue } from '@/hooks/useDebouncedValue';\nimport { PositionCard } from './PositionCard';\nimport type { Position } from '@/types/position';\n\nexport interface PositionListProps {\n positions: Position[];\n context?: 'dossier' | 'engagement' | 'all' | 'library';\n contextId?: string;\n onPositionClick?: (position: Position) => void;\n onAttach?: (positionId: string) => void;\n onDetach?: (positionId: string) => void;\n isLoading?: boolean;\n emptyMessage?: string;\n hideFilters?: boolean;\n layout?: 'grid' | 'list'; // New prop for layout mode\n}\n\nexport const PositionList: React.FC<PositionListProps> = ({\n positions,\n context = 'all',\n contextId,\n onPositionClick,\n onAttach,\n onDetach,\n isLoading = false,\n emptyMessage,\n hideFilters = false,\n layout = 'list', // Default to list for backward compatibility\n}) => {\n const { t, i18n } = useTranslation('positions');\n const parentRef = useRef<HTMLDivElement>(null);\n\n // Search and filter state\n const [searchInput, setSearchInput] = useState('');\n const [statusFilter, setStatusFilter] = useState<string>('all');\n const [typeFilter, setTypeFilter] = useState<string>('all');\n const [dateRangeFilter, setDateRangeFilter] = useState<string>('all');\n\n // Debounced search (300ms)\n const debouncedSearch = useDebouncedValue(searchInput, 300);\n\n // Filtered positions\n const filteredPositions = useMemo(() => {\n let filtered = [...positions];\n\n // Search filter\n if (debouncedSearch) {\n const searchLower = debouncedSearch.toLowerCase();\n const lang = i18n.language;\n filtered = filtered.filter((position) => {\n const title = lang === 'ar' ? position.title_ar : position.title_en;\n const content = lang === 'ar' ? position.content_ar : position.content_en;\n return (\n title.toLowerCase().includes(searchLower) ||\n content?.toLowerCase().includes(searchLower)\n );\n });\n }\n\n // Status filter\n if (statusFilter !== 'all') {\n filtered = filtered.filter((p) => p.status === statusFilter);\n }\n\n // Type filter\n if (typeFilter !== 'all') {\n filtered = filtered.filter((p) => p.position_type_id === typeFilter);\n }\n\n // Date range filter\n if (dateRangeFilter !== 'all') {\n const now = new Date();\n const filterDate = new Date();\n\n switch (dateRangeFilter) {\n case '7d':\n filterDate.setDate(now.getDate() - 7);\n break;\n case '30d':\n filterDate.setDate(now.getDate() - 30);\n break;\n case '90d':\n filterDate.setDate(now.getDate() - 90);\n break;\n }\n\n filtered = filtered.filter((p) => new Date(p.created_at) >= filterDate);\n }\n\n return filtered;\n }, [positions, debouncedSearch, statusFilter, typeFilter, dateRangeFilter, i18n.language]);\n\n // Virtual scrolling setup\n const virtualizer = useVirtualizer({\n count: filteredPositions.length,\n getScrollElement: () => parentRef.current,\n estimateSize: () => 120, // Estimated position card height\n overscan: 5, // Render 5 extra items above/below viewport\n });\n\n const isRTL = i18n.language === 'ar';\n\n if (isLoading && positions.length === 0) {\n return layout === 'grid' ? (\n <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n {/* Skeleton loading cards - Grid */}\n {Array.from({ length: 6 }).map((_, i) => (\n <div key={i} className=\"rounded-lg border bg-card p-4 animate-pulse\">\n <div className=\"flex items-start justify-between gap-4\">\n <div className=\"flex-1 space-y-2\">\n <div className=\"h-5 bg-muted rounded w-3/4\" />\n <div className=\"h-4 bg-muted rounded w-1/2\" />\n </div>\n <div className=\"h-6 w-20 bg-muted rounded\" />\n </div>\n </div>\n ))}\n </div>\n ) : (\n <div className=\"space-y-3\">\n {/* Skeleton loading cards - List */}\n {Array.from({ length: 3 }).map((_, i) => (\n <div key={i} className=\"rounded-lg border bg-card p-4 animate-pulse\">\n <div className=\"flex items-start justify-between gap-4\">\n <div className=\"flex-1 space-y-2\">\n <div className=\"h-5 bg-muted rounded w-3/4\" />\n <div className=\"h-4 bg-muted rounded w-1/2\" />\n </div>\n <div className=\"h-6 w-20 bg-muted rounded\" />\n </div>\n </div>\n ))}\n </div>\n );\n }\n\n return (\n <div className=\"flex flex-col gap-4\">\n {/* Search and Filter Controls - only show if not hidden */}\n {!hideFilters && (\n <div className=\"flex flex-col gap-3 rounded-lg border bg-card p-4\">\n {/* Search Input */}\n <div className=\"relative\">\n <Search className={`absolute ${isRTL ? 'right-3' : 'left-3'} top-3 h-4 w-4 text-muted-foreground`} />\n <Input\n type=\"search\"\n placeholder={t('search.placeholder')}\n value={searchInput}\n onChange={(e) => setSearchInput(e.target.value)}\n className={isRTL ? 'pe-10' : 'ps-10'}\n aria-label={t('search.label')}\n />\n </div>\n\n {/* Filter Controls */}\n <div className=\"flex flex-wrap gap-2\">\n <Select value={statusFilter} onValueChange={setStatusFilter}>\n <SelectTrigger className=\"w-[180px]\" aria-label={t('filter.status')}>\n <SelectValue placeholder={t('filter.status')} />\n </SelectTrigger>\n <SelectContent>\n <SelectItem value=\"all\">{t('filter.all')}</SelectItem>\n <SelectItem value=\"draft\">{t('status.draft')}</SelectItem>\n <SelectItem value=\"under_review\">{t('status.under_review')}</SelectItem>\n <SelectItem value=\"approved\">{t('status.approved')}</SelectItem>\n <SelectItem value=\"published\">{t('status.published')}</SelectItem>\n <SelectItem value=\"unpublished\">{t('status.unpublished')}</SelectItem>\n </SelectContent>\n </Select>\n\n <Select value={typeFilter} onValueChange={setTypeFilter}>\n <SelectTrigger className=\"w-[180px]\" aria-label={t('filter.type')}>\n <SelectValue placeholder={t('filter.type')} />\n </SelectTrigger>\n <SelectContent>\n <SelectItem value=\"all\">{t('filter.all')}</SelectItem>\n <SelectItem value=\"policy_brief\">{t('type.policy_brief')}</SelectItem>\n <SelectItem value=\"talking_point\">{t('type.talking_point')}</SelectItem>\n <SelectItem value=\"statement\">{t('type.statement')}</SelectItem>\n </SelectContent>\n </Select>\n\n <Select value={dateRangeFilter} onValueChange={setDateRangeFilter}>\n <SelectTrigger className=\"w-[180px]\" aria-label={t('filter.dateRange')}>\n <SelectValue placeholder={t('filter.dateRange')} />\n </SelectTrigger>\n <SelectContent>\n <SelectItem value=\"all\">{t('filter.allTime')}</SelectItem>\n <SelectItem value=\"7d\">{t('filter.last7Days')}</SelectItem>\n <SelectItem value=\"30d\">{t('filter.last30Days')}</SelectItem>\n <SelectItem value=\"90d\">{t('filter.last90Days')}</SelectItem>\n </SelectContent>\n </Select>\n\n {(statusFilter !== 'all' || typeFilter !== 'all' || dateRangeFilter !== 'all' || searchInput) && (\n <Button\n variant=\"ghost\"\n size=\"sm\"\n onClick={() => {\n setSearchInput('');\n setStatusFilter('all');\n setTypeFilter('all');\n setDateRangeFilter('all');\n }}\n >\n <Filter className=\"me-2 h-4 w-4\" />\n {t('filter.clear')}\n </Button>\n )}\n </div>\n\n {/* Results count */}\n <p className=\"text-sm text-muted-foreground\">\n {t('results.count', { count: filteredPositions.length, total: positions.length })}\n </p>\n </div>\n )}\n\n {/* Position Display - Grid or Virtual Scrolling List */}\n {filteredPositions.length === 0 ? (\n <div className=\"flex flex-col items-center justify-center rounded-lg border border-dashed py-12\">\n <p className=\"text-center text-muted-foreground\">\n {emptyMessage || t('empty.noResults')}\n </p>\n {!hideFilters && (statusFilter !== 'all' || typeFilter !== 'all' || dateRangeFilter !== 'all' || searchInput) && (\n <Button\n variant=\"link\"\n onClick={() => {\n setSearchInput('');\n setStatusFilter('all');\n setTypeFilter('all');\n setDateRangeFilter('all');\n }}\n className=\"mt-2\"\n >\n {t('empty.clearFilters')}\n </Button>\n )}\n </div>\n ) : layout === 'grid' ? (\n // Grid Layout\n <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\" role=\"list\" aria-label={t('list.label')}>\n {filteredPositions.map((position, index) => (\n <div key={position.id} role=\"listitem\" aria-posinset={index + 1} aria-setsize={filteredPositions.length}>\n <PositionCard\n position={position}\n onClick={() => onPositionClick?.(position)}\n onAttach={onAttach ? () => onAttach(position.id) : undefined}\n onDetach={onDetach ? () => onDetach(position.id) : undefined}\n context={context}\n />\n </div>\n ))}\n </div>\n ) : (\n // Virtual Scrolling List Layout\n <div\n ref={parentRef}\n className=\"relative h-[600px] overflow-auto rounded-lg border\"\n role=\"list\"\n aria-label={t('list.label')}\n >\n <div\n style={{\n height: `${virtualizer.getTotalSize()}px`,\n width: '100%',\n position: 'relative',\n }}\n >\n {virtualizer.getVirtualItems().map((virtualItem) => {\n const position = filteredPositions[virtualItem.index];\n return (\n <div\n key={virtualItem.key}\n style={{\n position: 'absolute',\n top: 0,\n left: 0,\n width: '100%',\n height: `${virtualItem.size}px`,\n transform: `translateY(${virtualItem.start}px)`,\n }}\n role=\"listitem\"\n aria-posinset={virtualItem.index + 1}\n aria-setsize={filteredPositions.length}\n >\n <PositionCard\n position={position}\n onClick={() => onPositionClick?.(position)}\n onAttach={onAttach ? () => onAttach(position.id) : undefined}\n onDetach={onDetach ? () => onDetach(position.id) : undefined}\n context={context}\n />\n </div>\n );\n })}\n </div>\n </div>\n )}\n </div>\n );\n};\n","import * as React from \"react\"\nimport * as CheckboxPrimitive from \"@radix-ui/react-checkbox\"\nimport { cn } from \"@/lib/utils\"\nimport { CheckIcon } from \"@radix-ui/react-icons\"\n\nconst Checkbox = React.forwardRef<\n React.ElementRef<typeof CheckboxPrimitive.Root>,\n React.ComponentPropsWithoutRef<typeof CheckboxPrimitive.Root>\n>(({ className, ...props }, ref) => (\n <CheckboxPrimitive.Root\n ref={ref}\n className={cn(\n \"peer h-4 w-4 shrink-0 rounded-sm border border-primary shadow focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground\",\n className\n )}\n {...props}\n >\n <CheckboxPrimitive.Indicator\n className={cn(\"flex items-center justify-center text-current\")}\n >\n <CheckIcon className=\"h-4 w-4\" />\n </CheckboxPrimitive.Indicator>\n </CheckboxPrimitive.Root>\n))\nCheckbox.displayName = CheckboxPrimitive.Root.displayName\n\nexport { Checkbox }\n","import * as React from \"react\"\nimport * as ScrollAreaPrimitive from \"@radix-ui/react-scroll-area\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ScrollArea = React.forwardRef<\n React.ElementRef<typeof ScrollAreaPrimitive.Root>,\n React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n <ScrollAreaPrimitive.Root\n ref={ref}\n className={cn(\"relative overflow-hidden\", className)}\n {...props}\n >\n <ScrollAreaPrimitive.Viewport className=\"h-full w-full rounded-[inherit]\">\n {children}\n </ScrollAreaPrimitive.Viewport>\n <ScrollBar />\n <ScrollAreaPrimitive.Corner />\n </ScrollAreaPrimitive.Root>\n))\nScrollArea.displayName = ScrollAreaPrimitive.Root.displayName\n\nconst ScrollBar = React.forwardRef<\n React.ElementRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>,\n React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>\n>(({ className, orientation = \"vertical\", ...props }, ref) => (\n <ScrollAreaPrimitive.ScrollAreaScrollbar\n ref={ref}\n orientation={orientation}\n className={cn(\n \"flex touch-none select-none transition-colors\",\n orientation === \"vertical\" &&\n \"h-full w-2.5 border-l border-l-transparent p-[1px]\",\n orientation === \"horizontal\" &&\n \"h-2.5 flex-col border-t border-t-transparent p-[1px]\",\n className\n )}\n {...props}\n >\n <ScrollAreaPrimitive.ScrollAreaThumb className=\"relative flex-1 rounded-full bg-border\" />\n </ScrollAreaPrimitive.ScrollAreaScrollbar>\n))\nScrollBar.displayName = ScrollAreaPrimitive.ScrollAreaScrollbar.displayName\n\nexport { ScrollArea, ScrollBar }\n","import * as React from \"react\"\nimport * as SeparatorPrimitive from \"@radix-ui/react-separator\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Separator = React.forwardRef<\n React.ElementRef<typeof SeparatorPrimitive.Root>,\n React.ComponentPropsWithoutRef<typeof SeparatorPrimitive.Root>\n>(\n (\n { className, orientation = \"horizontal\", decorative = true, ...props },\n ref\n ) => (\n <SeparatorPrimitive.Root\n ref={ref}\n decorative={decorative}\n orientation={orientation}\n className={cn(\n \"shrink-0 bg-border\",\n orientation === \"horizontal\" ? \"h-[1px] w-full\" : \"h-full w-[1px]\",\n className\n )}\n {...props}\n />\n )\n)\nSeparator.displayName = SeparatorPrimitive.Root.displayName\n\nexport { Separator }\n","/**\n * AttachPositionDialog Component (T046)\n * Searchable dialog for attaching positions to engagements\n */\n\nimport React, { useState, useMemo } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Search, Link2, Eye, X, Check } from 'lucide-react';\nimport {\n Dialog,\n DialogContent,\n DialogDescription,\n DialogFooter,\n DialogHeader,\n DialogTitle,\n DialogTrigger,\n} from '@/components/ui/dialog';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Checkbox } from '@/components/ui/checkbox';\nimport { Badge } from '@/components/ui/badge';\nimport { ScrollArea } from '@/components/ui/scroll-area';\nimport { Separator } from '@/components/ui/separator';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport { useDebouncedValue } from '@/hooks/useDebouncedValue';\nimport { usePositions } from '@/hooks/usePositions';\nimport { format } from 'date-fns';\nimport { ar, enUS } from 'date-fns/locale';\nimport type { Position } from '@/types/position';\n\nexport interface AttachPositionDialogProps {\n engagementId: string;\n dossierId: string;\n onAttach: (positionIds: string[]) => Promise<void>;\n attachedPositionIds?: string[];\n trigger?: React.ReactNode;\n maxSelections?: number;\n}\n\nexport const AttachPositionDialog: React.FC<AttachPositionDialogProps> = ({\n engagementId,\n dossierId,\n onAttach,\n attachedPositionIds = [],\n trigger,\n maxSelections = 100,\n}) => {\n const { t, i18n } = useTranslation();\n const isRTL = i18n.language === 'ar';\n const locale = i18n.language === 'ar' ? ar : enUS;\n\n // Dialog state\n const [open, setOpen] = useState(false);\n const [searchInput, setSearchInput] = useState('');\n const [selectedIds, setSelectedIds] = useState<string[]>([]);\n const [previewPosition, setPreviewPosition] = useState<Position | null>(null);\n const [isAttaching, setIsAttaching] = useState(false);\n\n // Debounced search\n const debouncedSearch = useDebouncedValue(searchInput, 300);\n\n // Fetch positions for this dossier\n const { data: positionsData, isLoading } = usePositions({\n dossierId,\n status: 'published',\n });\n const positions = positionsData?.positions || [];\n\n // Filter positions\n const filteredPositions = useMemo(() => {\n let filtered = positions.filter((p) => !attachedPositionIds.includes(p.id));\n\n if (debouncedSearch) {\n const searchLower = debouncedSearch.toLowerCase();\n filtered = filtered.filter((position) => {\n const title = i18n.language === 'ar' ? position.title_ar : position.title_en;\n const content = i18n.language === 'ar' ? position.content_ar : position.content_en;\n return (\n title.toLowerCase().includes(searchLower) ||\n content?.toLowerCase().includes(searchLower) ||\n position.thematic_category?.toLowerCase().includes(searchLower)\n );\n });\n }\n\n return filtered;\n }, [positions, debouncedSearch, attachedPositionIds, i18n.language]);\n\n // Get localized position title\n const getPositionTitle = (position: Position) => {\n return i18n.language === 'ar' ? position.title_ar : position.title_en;\n };\n\n // Get localized position content\n const getPositionContent = (position: Position) => {\n return i18n.language === 'ar' ? position.content_ar : position.content_en;\n };\n\n // Handle selection toggle\n const toggleSelection = (positionId: string) => {\n setSelectedIds((prev) => {\n if (prev.includes(positionId)) {\n return prev.filter((id) => id !== positionId);\n } else {\n if (prev.length >= maxSelections) {\n return prev;\n }\n return [...prev, positionId];\n }\n });\n };\n\n // Handle attach\n const handleAttach = async () => {\n if (selectedIds.length === 0) return;\n\n setIsAttaching(true);\n try {\n await onAttach(selectedIds);\n setSelectedIds([]);\n setSearchInput('');\n setPreviewPosition(null);\n setOpen(false);\n } catch (error) {\n console.error('Failed to attach positions:', error);\n } finally {\n setIsAttaching(false);\n }\n };\n\n // Reset on close\n const handleOpenChange = (open: boolean) => {\n setOpen(open);\n if (!open) {\n setSelectedIds([]);\n setSearchInput('');\n setPreviewPosition(null);\n }\n };\n\n return (\n <Dialog open={open} onOpenChange={handleOpenChange}>\n <DialogTrigger asChild>\n {trigger || (\n <Button>\n <Link2 className=\"me-2 h-4 w-4\" />\n {t('positions.attach.dialogTrigger')}\n </Button>\n )}\n </DialogTrigger>\n\n <DialogContent className=\"max-h-[90vh] max-w-6xl p-0\">\n <DialogHeader className=\"p-6 pb-0\">\n <DialogTitle>{t('positions.attach.dialogTitle')}</DialogTitle>\n <DialogDescription>{t('positions.attach.dialogDescription')}</DialogDescription>\n </DialogHeader>\n\n <div className=\"flex h-[70vh] gap-4 p-6 pt-4\">\n {/* Left Panel: Search & List */}\n <div className=\"flex flex-1 flex-col gap-4\">\n {/* Search */}\n <div className=\"relative\">\n <Search\n className={`absolute ${isRTL ? 'right-3' : 'left-3'} top-3 h-4 w-4 text-muted-foreground`}\n />\n <Input\n type=\"search\"\n placeholder={t('positions.attach.searchPlaceholder')}\n value={searchInput}\n onChange={(e) => setSearchInput(e.target.value)}\n className={isRTL ? 'pe-10' : 'ps-10'}\n autoFocus\n />\n </div>\n\n {/* Selection Info */}\n <div className=\"flex items-center justify-between rounded-lg border bg-muted/50 px-3 py-2 text-sm\">\n <span>\n {t('positions.attach.selected', {\n count: selectedIds.length,\n max: maxSelections,\n })}\n </span>\n {selectedIds.length > 0 && (\n <Button variant=\"ghost\" size=\"sm\" onClick={() => setSelectedIds([])}>\n {t('positions.attach.clearSelection')}\n </Button>\n )}\n </div>\n\n {/* Warning for max selections */}\n {selectedIds.length >= maxSelections && (\n <Alert>\n <AlertDescription>\n {t('positions.attach.maxSelectionsReached', { max: maxSelections })}\n </AlertDescription>\n </Alert>\n )}\n\n {/* Positions List */}\n <ScrollArea className=\"flex-1 rounded-lg border\">\n {isLoading ? (\n <div className=\"flex items-center justify-center py-12\">\n <div className=\"flex flex-col items-center gap-2\">\n <div className=\"h-8 w-8 animate-spin rounded-full border-4 border-primary border-t-transparent\" />\n <p className=\"text-sm text-muted-foreground\">{t('positions.loading')}</p>\n </div>\n </div>\n ) : filteredPositions.length === 0 ? (\n <div className=\"flex flex-col items-center justify-center py-12\">\n <p className=\"text-center text-muted-foreground\">\n {debouncedSearch\n ? t('positions.attach.noResults')\n : t('positions.attach.allAttached')}\n </p>\n </div>\n ) : (\n <div className=\"space-y-2 p-4\">\n {filteredPositions.map((position) => {\n const isSelected = selectedIds.includes(position.id);\n const isPreviewed = previewPosition?.id === position.id;\n\n return (\n <div\n key={position.id}\n className={`flex items-start gap-3 rounded-lg border p-3 transition-colors ${\n isPreviewed ? 'border-primary bg-primary/5' : 'hover:bg-muted/50'\n }`}\n >\n {/* Checkbox */}\n <Checkbox\n checked={isSelected}\n onCheckedChange={() => toggleSelection(position.id)}\n disabled={!isSelected && selectedIds.length >= maxSelections}\n aria-label={t('positions.attach.selectLabel', {\n title: getPositionTitle(position),\n })}\n />\n\n {/* Position Info */}\n <div className=\"flex-1 space-y-1\">\n <h4 className=\"font-medium leading-tight\" dir={isRTL ? 'rtl' : 'ltr'}>\n {getPositionTitle(position)}\n </h4>\n <div className=\"flex flex-wrap items-center gap-2 text-xs text-muted-foreground\">\n <Badge variant=\"outline\">{t(`positions.type.${position.position_type_id}`)}</Badge>\n {position.thematic_category && (\n <Badge variant=\"outline\">{position.thematic_category}</Badge>\n )}\n <span>{format(new Date(position.created_at), 'PP', { locale })}</span>\n </div>\n </div>\n\n {/* Preview Button */}\n <Button\n variant=\"ghost\"\n size=\"sm\"\n onClick={() => setPreviewPosition(position)}\n aria-label={t('positions.attach.previewLabel', {\n title: getPositionTitle(position),\n })}\n >\n <Eye className=\"h-4 w-4\" />\n </Button>\n </div>\n );\n })}\n </div>\n )}\n </ScrollArea>\n </div>\n\n {/* Right Panel: Preview */}\n <div className=\"w-[400px] rounded-lg border bg-muted/20\">\n {previewPosition ? (\n <div className=\"flex h-full flex-col\">\n {/* Preview Header */}\n <div className=\"flex items-start justify-between border-b p-4\">\n <h3 className=\"font-semibold\" dir={isRTL ? 'rtl' : 'ltr'}>\n {t('positions.attach.previewTitle')}\n </h3>\n <Button variant=\"ghost\" size=\"sm\" onClick={() => setPreviewPosition(null)}>\n <X className=\"h-4 w-4\" />\n </Button>\n </div>\n\n {/* Preview Content */}\n <ScrollArea className=\"flex-1 p-4\">\n <div className=\"space-y-4\">\n <div>\n <h4 className=\"mb-1 text-lg font-semibold\" dir={isRTL ? 'rtl' : 'ltr'}>\n {getPositionTitle(previewPosition)}\n </h4>\n <div className=\"flex flex-wrap gap-2\">\n <Badge>{t(`positions.status.${previewPosition.status}`)}</Badge>\n <Badge variant=\"outline\">\n {t(`positions.type.${previewPosition.position_type_id}`)}\n </Badge>\n </div>\n </div>\n\n <Separator />\n\n <div>\n <p className=\"mb-1 text-sm font-medium\">{t('positions.attach.content')}</p>\n <p\n className=\"whitespace-pre-wrap text-sm text-muted-foreground\"\n dir={isRTL ? 'rtl' : 'ltr'}\n >\n {getPositionContent(previewPosition)}\n </p>\n </div>\n\n {previewPosition.key_messages && (\n <>\n <Separator />\n <div>\n <p className=\"mb-1 text-sm font-medium\">{t('positions.attach.keyMessages')}</p>\n <p className=\"text-sm text-muted-foreground\" dir={isRTL ? 'rtl' : 'ltr'}>\n {previewPosition.key_messages}\n </p>\n </div>\n </>\n )}\n </div>\n </ScrollArea>\n\n {/* Quick Select */}\n <div className=\"border-t p-4\">\n <Button\n variant=\"outline\"\n className=\"w-full\"\n onClick={() => toggleSelection(previewPosition.id)}\n disabled={\n !selectedIds.includes(previewPosition.id) && selectedIds.length >= maxSelections\n }\n >\n {selectedIds.includes(previewPosition.id) ? (\n <>\n <Check className=\"me-2 h-4 w-4\" />\n {t('positions.attach.selected')}\n </>\n ) : (\n <>\n <Link2 className=\"me-2 h-4 w-4\" />\n {t('positions.attach.selectThis')}\n </>\n )}\n </Button>\n </div>\n </div>\n ) : (\n <div className=\"flex h-full items-center justify-center p-8 text-center\">\n <div className=\"space-y-2\">\n <Eye className=\"mx-auto h-12 w-12 text-muted-foreground\" />\n <p className=\"text-sm text-muted-foreground\">{t('positions.attach.previewEmpty')}</p>\n </div>\n </div>\n )}\n </div>\n </div>\n\n <DialogFooter className=\"p-6 pt-0\">\n <Button variant=\"outline\" onClick={() => setOpen(false)} disabled={isAttaching}>\n {t('common.cancel')}\n </Button>\n <Button onClick={handleAttach} disabled={selectedIds.length === 0 || isAttaching}>\n {isAttaching ? (\n <>\n <div className=\"me-2 h-4 w-4 animate-spin rounded-full border-2 border-current border-t-transparent\" />\n {t('positions.attach.attaching')}\n </>\n ) : (\n <>\n <Link2 className=\"me-2 h-4 w-4\" />\n {t('positions.attach.attachSelected', { count: selectedIds.length })}\n </>\n )}\n </Button>\n </DialogFooter>\n </DialogContent>\n </Dialog>\n );\n};\n","/**\n * Standalone Positions Library (T055)\n *\n * Global positions library accessible from all accessible dossiers\n * Features: Advanced search, multi-filter, analytics dashboard, quick navigation\n * Integration: Top-level navigation route\n */\n\nimport { createFileRoute, Link, Outlet, useMatches } from '@tanstack/react-router';\nimport { useState, useMemo } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { usePositions } from '../../hooks/usePositions';\nimport { PositionList } from '../../components/positions/PositionList';\nimport { AttachPositionDialog } from '../../components/positions/AttachPositionDialog';\nimport { Button } from '../../components/ui/button';\nimport { Input } from '../../components/ui/input';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '../../components/ui/select';\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '../../components/ui/card';\nimport { Badge } from '../../components/ui/badge';\nimport { useDebouncedValue } from '../../hooks/useDebouncedValue';\nimport { FileText, Plus, TrendingUp, Search } from 'lucide-react';\nimport type { PositionStatus, PositionType } from '../../types/position';\n\n// Search params for filters\ninterface PositionsSearchParams {\n search?: string;\n status?: PositionStatus;\n type?: PositionType;\n sort?: 'title' | 'updated_at' | 'created_at' | 'popularity';\n order?: 'asc' | 'desc';\n}\n\nexport const Route = createFileRoute('/_protected/positions')({\n component: () => <Outlet />,\n validateSearch: (search: Record<string, unknown>): PositionsSearchParams => {\n return {\n search: search.search as string | undefined,\n status: search.status as PositionStatus | undefined,\n type: search.type as PositionType | undefined,\n sort: (search.sort as any) || 'updated_at',\n order: (search.order as any) || 'desc',\n };\n },\n});\n\nexport function PositionsLibraryPage() {\n const { t } = useTranslation(['positions', 'common']);\n const navigate = Route.useNavigate();\n const searchParams = Route.useSearch();\n\n // Local state for filters\n const [searchQuery, setSearchQuery] = useState(searchParams.search || '');\n const [statusFilter, setStatusFilter] = useState<PositionStatus | 'all'>(\n searchParams.status || 'all'\n );\n const [typeFilter, setTypeFilter] = useState<PositionType | 'all'>(\n searchParams.type || 'all'\n );\n const [sortBy, setSortBy] = useState(searchParams.sort || 'updated_at');\n const [sortOrder, setSortOrder] = useState(searchParams.order || 'desc');\n const [showCreateDialog, setShowCreateDialog] = useState(false);\n\n // Debounce search input\n const debouncedSearch = useDebouncedValue(searchQuery, 300);\n\n // Fetch positions with filters\n const { data, isLoading, error } = usePositions({\n search: debouncedSearch,\n status: statusFilter === 'all' ? undefined : statusFilter,\n type: typeFilter === 'all' ? undefined : typeFilter,\n sort: sortBy,\n order: sortOrder,\n });\n\n const positions = useMemo(() => data?.pages?.[0]?.data || [], [data]);\n const totalCount = data?.pages?.[0]?.total || 0;\n const stats = {\n total: totalCount,\n byStatus: {},\n byType: {},\n };\n\n // Update URL when filters change\n const updateFilters = (updates: Partial<PositionsSearchParams>) => {\n navigate({\n search: {\n ...searchParams,\n ...updates,\n } as any,\n replace: true,\n });\n };\n\n // Handler for clearing filters\n const handleClearFilters = () => {\n setSearchQuery('');\n setStatusFilter('all');\n setTypeFilter('all');\n updateFilters({ search: undefined, status: undefined, type: undefined });\n };\n\n const hasActiveFilters =\n searchQuery ||\n statusFilter !== 'all' ||\n typeFilter !== 'all' ||\n sortBy !== 'updated_at';\n\n return (\n <div className=\"min-h-screen bg-gray-50 dark:bg-gray-900\">\n {/* Page Header */}\n <div className=\"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700\">\n <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\n <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4\">\n <div className=\"space-y-1\">\n <h1 className=\"text-3xl font-bold text-gray-900 dark:text-gray-100 flex items-center gap-3\">\n <FileText className=\"h-8 w-8\" />\n {t('positions:library.title')}\n </h1>\n <p className=\"text-gray-500 dark:text-gray-400\">\n {t('positions:library.subtitle', { count: totalCount })}\n </p>\n </div>\n <Button onClick={() => setShowCreateDialog(true)} className=\"gap-2\">\n <Plus className=\"h-5 w-5\" />\n {t('positions:library.create_position')}\n </Button>\n </div>\n\n {/* Quick Stats */}\n <div className=\"mt-8 grid gap-4 sm:grid-cols-2 lg:grid-cols-3 2xl:grid-cols-4\">\n <Card>\n <CardHeader className=\"pb-2\">\n <CardDescription className=\"text-xs\">\n {t('positions:library.stats.total')}\n </CardDescription>\n </CardHeader>\n <CardContent>\n <div className=\"text-2xl font-bold\">{stats.total}</div>\n </CardContent>\n </Card>\n <Card>\n <CardHeader className=\"pb-2\">\n <CardDescription className=\"text-xs\">\n {t('positions:library.stats.published')}\n </CardDescription>\n </CardHeader>\n <CardContent>\n <div className=\"text-2xl font-bold text-green-600 dark:text-green-400\">\n {stats.byStatus?.published || 0}\n </div>\n </CardContent>\n </Card>\n <Card>\n <CardHeader className=\"pb-2\">\n <CardDescription className=\"text-xs\">\n {t('positions:library.stats.in_review')}\n </CardDescription>\n </CardHeader>\n <CardContent>\n <div className=\"text-2xl font-bold text-yellow-600 dark:text-yellow-400\">\n {stats.byStatus?.review || 0}\n </div>\n </CardContent>\n </Card>\n <Card>\n <CardHeader className=\"pb-2\">\n <CardDescription className=\"text-xs\">\n {t('positions:library.stats.drafts')}\n </CardDescription>\n </CardHeader>\n <CardContent>\n <div className=\"text-2xl font-bold text-gray-600 dark:text-gray-400\">\n {stats.byStatus?.draft || 0}\n </div>\n </CardContent>\n </Card>\n </div>\n </div>\n </div>\n\n {/* Main Content */}\n <main className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\n {/* Search and Filters */}\n <Card className=\"mb-6\">\n <CardHeader>\n <CardTitle className=\"flex items-center gap-2\">\n <Search className=\"h-5 w-5\" />\n {t('positions:library.search_and_filter')}\n </CardTitle>\n </CardHeader>\n <CardContent>\n <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4\">\n {/* Search Input */}\n <div className=\"lg:col-span-2\">\n <Input\n type=\"search\"\n placeholder={t('positions:library.search_placeholder')}\n value={searchQuery}\n onChange={(e) => {\n setSearchQuery(e.target.value);\n updateFilters({ search: e.target.value || undefined });\n }}\n className=\"w-full\"\n aria-label={t('positions:library.search_label')}\n />\n </div>\n\n {/* Status Filter */}\n <div>\n <Select\n value={statusFilter}\n onValueChange={(value) => {\n const newStatus = value as PositionStatus | 'all';\n setStatusFilter(newStatus);\n updateFilters({ status: newStatus === 'all' ? undefined : newStatus });\n }}\n >\n <SelectTrigger aria-label={t('positions:library.status_filter')}>\n <SelectValue placeholder={t('positions:library.all_statuses')} />\n </SelectTrigger>\n <SelectContent>\n <SelectItem value=\"all\">{t('positions:library.all_statuses')}</SelectItem>\n <SelectItem value=\"draft\">{t('positions:status.draft')}</SelectItem>\n <SelectItem value=\"review\">{t('positions:status.review')}</SelectItem>\n <SelectItem value=\"approved\">{t('positions:status.approved')}</SelectItem>\n <SelectItem value=\"published\">{t('positions:status.published')}</SelectItem>\n <SelectItem value=\"archived\">{t('positions:status.archived')}</SelectItem>\n </SelectContent>\n </Select>\n </div>\n\n {/* Type Filter */}\n <div>\n <Select\n value={typeFilter}\n onValueChange={(value) => {\n const newType = value as PositionType | 'all';\n setTypeFilter(newType);\n updateFilters({ type: newType === 'all' ? undefined : newType });\n }}\n >\n <SelectTrigger aria-label={t('positions:library.type_filter')}>\n <SelectValue placeholder={t('positions:library.all_types')} />\n </SelectTrigger>\n <SelectContent>\n <SelectItem value=\"all\">{t('positions:library.all_types')}</SelectItem>\n <SelectItem value=\"statement\">{t('positions:type.statement')}</SelectItem>\n <SelectItem value=\"brief\">{t('positions:type.brief')}</SelectItem>\n <SelectItem value=\"talking_points\">\n {t('positions:type.talking_points')}\n </SelectItem>\n <SelectItem value=\"q_and_a\">{t('positions:type.q_and_a')}</SelectItem>\n <SelectItem value=\"guidance\">{t('positions:type.guidance')}</SelectItem>\n </SelectContent>\n </Select>\n </div>\n\n {/* Sort By */}\n <div>\n <Select\n value={sortBy}\n onValueChange={(value) => {\n setSortBy(value);\n updateFilters({ sort: value as any });\n }}\n >\n <SelectTrigger aria-label={t('positions:library.sort_by')}>\n <SelectValue />\n </SelectTrigger>\n <SelectContent>\n <SelectItem value=\"updated_at\">\n {t('positions:library.sort.updated')}\n </SelectItem>\n <SelectItem value=\"created_at\">\n {t('positions:library.sort.created')}\n </SelectItem>\n <SelectItem value=\"title\">{t('positions:library.sort.title')}</SelectItem>\n <SelectItem value=\"popularity\">\n {t('positions:library.sort.popularity')}\n </SelectItem>\n </SelectContent>\n </Select>\n </div>\n </div>\n\n {/* Clear Filters Button */}\n {hasActiveFilters && (\n <div className=\"mt-4 flex justify-end\">\n <Button\n variant=\"ghost\"\n size=\"sm\"\n onClick={handleClearFilters}\n aria-label={t('positions:library.clear_filters')}\n >\n {t('common:clear_filters')}\n </Button>\n </div>\n )}\n </CardContent>\n </Card>\n\n {/* Positions List */}\n {error ? (\n <div\n className=\"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-6 text-center\"\n role=\"alert\"\n >\n <p className=\"text-sm text-red-700 dark:text-red-300\">\n {error instanceof Error ? error.message : t('positions:library.error_loading')}\n </p>\n </div>\n ) : (\n <PositionList\n positions={positions}\n isLoading={isLoading}\n context=\"library\"\n layout=\"grid\"\n onPositionClick={(position) => {\n navigate({ to: '/positions/$positionId', params: { positionId: position.id } });\n }}\n emptyMessage={\n hasActiveFilters\n ? t('positions:library.no_results')\n : t('positions:library.no_positions')\n }\n />\n )}\n </main>\n\n {/* Create Position Dialog */}\n {showCreateDialog && (\n <AttachPositionDialog\n open={showCreateDialog}\n onClose={() => setShowCreateDialog(false)}\n context=\"library\"\n />\n )}\n </div>\n );\n}\n","/**\n * Persons Layout Route\n * Feature: persons-entity-management\n *\n * Layout route for persons feature.\n * Renders child routes via Outlet.\n */\n\nimport { createFileRoute, Outlet } from '@tanstack/react-router'\n\nexport const Route = createFileRoute('/_protected/persons')({\n  component: () => <Outlet />,\n})\n","import { createFileRoute } from '@tanstack/react-router'\nimport Organizations from '../../pages/Organizations'\n\nexport const Route = createFileRoute('/_protected/organizations')({\n component: Organizations,\n})\n","import { createFileRoute, Outlet } from '@tanstack/react-router';\n\nexport const Route = createFileRoute('/_protected/my-work')({\n  component: MyWorkLayout,\n});\n\nfunction MyWorkLayout() {\n  return <Outlet />;\n}\n","import { createFileRoute } from '@tanstack/react-router'\nimport MoUs from '../../pages/MoUs'\n\nexport const Route = createFileRoute('/_protected/mous')({\n component: MoUs,\n})\n","import { createFileRoute } from '@tanstack/react-router'\nimport MonitoringDashboard from '@/pages/monitoring/Dashboard'\n\nexport const Route = createFileRoute('/_protected/monitoring')({\n component: MonitoringDashboard,\n})\n\n","import { createFileRoute } from '@tanstack/react-router'\nimport { useTranslation } from 'react-i18next'\nimport { NavigationShell, MetricCard, ExecutionsTabs } from '@/components/modern-nav'\n\n/**\n * Modern Navigation Demo Page\n *\n * Showcases the complete navigation design system:\n * - Material Design 3 Navigation Rail (56px)\n * - Expanded Panel (280px) with all sections\n * - Dashboard content with animated metrics\n * - Responsive 3-column layout\n * - Dark/Light mode support\n * - RTL support for Arabic\n */\nexport const Route = createFileRoute('/_protected/modern-nav-demo')({\n  component: ModernNavDemo,\n})\n\nfunction ModernNavDemo() {\n  const { t } = useTranslation()\n\n  const handleLogout = () => {\n    // TODO: Add your logout logic here\n  }\n\n  return (\n    <NavigationShell\n      userName=\"John Doe\"\n      userEmail=\"customerpop@gmail.com\"\n      onLogout={handleLogout}\n      defaultPanelOpen={true}\n    >\n      {/* Dashboard Content */}\n      <div className=\"container mx-auto px-4 sm:px-6 lg:px-8 py-6 sm:py-8 lg:py-12\">\n        {/* Page Header */}\n        <header className=\"mb-6 sm:mb-8 lg:mb-12\">\n          <h1 className=\"text-2xl sm:text-3xl md:text-4xl font-bold text-content-text mb-2\">\n            {t('navigation.dashboard', 'Dashboard')}\n          </h1>\n          <p className=\"text-sm sm:text-base text-content-text-muted\">\n            {t('demo.subtitle', 'Modern navigation design system demonstration')}\n          </p>\n        </header>\n\n        {/* Content Grid - Mobile: 1 column, Desktop: 2 columns */}\n        <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6 lg:gap-8\">\n          {/* Metric Card - Large */}\n          <div className=\"lg:col-span-2\">\n            <MetricCard\n              label={t('metrics.executions', 'Executions')}\n              value={340}\n              trend={{ value: 23, direction: 'up' }}\n              linkText={t('common.seeReport', 'See Report')}\n              onLinkClick={() => {\n                /* TODO: Navigate to report */\n              }}\n            />\n          </div>\n\n          {/* Additional Metric Cards */}\n          <MetricCard\n            label={t('metrics.activeProjects', 'Active Projects')}\n            value={12}\n            trend={{ value: 8, direction: 'up' }}\n            linkText={t('common.viewAll', 'View All')}\n            onLinkClick={() => {\n              /* TODO: Navigate to projects */\n            }}\n          />\n\n          <MetricCard\n            label={t('metrics.teamMembers', 'Team Members')}\n            value={24}\n            trend={{ value: 2, direction: 'neutral' }}\n            linkText={t('common.manage', 'Manage')}\n            onLinkClick={() => {\n              /* TODO: Navigate to team */\n            }}\n          />\n\n          {/* Executions Tabs - Full width */}\n          <div className=\"lg:col-span-2\">\n            <ExecutionsTabs title={t('navigation.executions', 'Executions')} />\n          </div>\n        </div>\n\n        {/* Demo Information */}\n        <div className=\"mt-12 p-6 bg-panel rounded-lg border border-panel-border\">\n          <h2 className=\"text-lg font-semibold text-content-text mb-4\">\n            {t('demo.features', 'Features Demonstrated')}\n          </h2>\n          <ul className=\"space-y-2 text-sm text-content-text-muted\">\n            <li className=\"flex items-start gap-2\">\n              <span className=\"text-icon-rail-active-indicator\"></span>\n              <span>\n                Material Design 3 Navigation Rail (56px) with hover states and active indicators\n              </span>\n            </li>\n            <li className=\"flex items-start gap-2\">\n              <span className=\"text-icon-rail-active-indicator\"></span>\n              <span>\n                Expanded Panel (280px) with user profile, projects, status, history, and documents\n              </span>\n            </li>\n            <li className=\"flex items-start gap-2\">\n              <span className=\"text-icon-rail-active-indicator\"></span>\n              <span>Animated metric cards with trend indicators and smooth counter animations</span>\n            </li>\n            <li className=\"flex items-start gap-2\">\n              <span className=\"text-icon-rail-active-indicator\"></span>\n              <span>\n                Tabbed interface with search functionality (Workflows, Permissions, Members)\n              </span>\n            </li>\n            <li className=\"flex items-start gap-2\">\n              <span className=\"text-icon-rail-active-indicator\"></span>\n              <span>Collapsible document tree with nested folders and search</span>\n            </li>\n            <li className=\"flex items-start gap-2\">\n              <span className=\"text-icon-rail-active-indicator\"></span>\n              <span>\n                Responsive design: Mobile hamburger menu  Tablet icon rail  Desktop full layout\n              </span>\n            </li>\n            <li className=\"flex items-start gap-2\">\n              <span className=\"text-icon-rail-active-indicator\"></span>\n              <span>Full RTL support for Arabic language with logical properties</span>\n            </li>\n            <li className=\"flex items-start gap-2\">\n              <span className=\"text-icon-rail-active-indicator\"></span>\n              <span>Dark/Light mode support with CSS custom properties design tokens</span>\n            </li>\n          </ul>\n        </div>\n\n        {/* Testing Guide */}\n        <div className=\"mt-6 p-6 bg-background rounded-lg border border-content-border\">\n          <h2 className=\"text-lg font-semibold text-content-text mb-4\">\n            {t('demo.testing', 'Testing Guide')}\n          </h2>\n          <div className=\"space-y-4 text-sm text-content-text-muted\">\n            <div>\n              <h3 className=\"font-medium text-content-text mb-2\">Responsive Testing:</h3>\n              <ul className=\"list-disc list-inside space-y-1 ms-4\">\n                <li>Mobile (&lt;768px): Hamburger menu, full-screen overlay</li>\n                <li>Tablet (768-1024px): Icon rail visible, panel collapsed</li>\n                <li>Desktop (&gt;1024px): Full 3-column layout</li>\n              </ul>\n            </div>\n            <div>\n              <h3 className=\"font-medium text-content-text mb-2\">RTL Testing:</h3>\n              <ul className=\"list-disc list-inside space-y-1 ms-4\">\n                <li>Switch to Arabic language to test RTL layout</li>\n                <li>All icons, text, and layout should flip correctly</li>\n                <li>Logical properties ensure proper RTL behavior</li>\n              </ul>\n            </div>\n            <div>\n              <h3 className=\"font-medium text-content-text mb-2\">Dark Mode Testing:</h3>\n              <ul className=\"list-disc list-inside space-y-1 ms-4\">\n                <li>Toggle theme via settings to test dark mode</li>\n                <li>All colors should adapt via CSS custom properties</li>\n                <li>Icon rail background: #1A1D26 (dark gray)</li>\n              </ul>\n            </div>\n          </div>\n        </div>\n      </div>\n    </NavigationShell>\n  )\n}\n","/**\n * Feature: kanban-task-board\n *\n * Full-featured Kanban Task Board with:\n * - Drag-and-drop between columns\n * - Swimlanes (by assignee or priority)\n * - WIP (Work In Progress) limits with warnings\n * - Bulk operations (multi-select, bulk move, bulk assign)\n * - Real-time collaboration\n * - Mobile-first responsive design\n * - RTL support for Arabic\n */\n\nimport { createFileRoute } from '@tanstack/react-router'\nimport { z } from 'zod'\nimport { useTranslation } from 'react-i18next'\nimport { useCallback, useMemo } from 'react'\nimport { useAuth } from '@/hooks/useAuth'\nimport {\n  useUnifiedKanban,\n  useUnifiedKanbanStatusUpdate,\n  useUnifiedKanbanRealtime,\n} from '@/hooks/useUnifiedKanban'\nimport { EnhancedKanbanBoard } from '@/components/unified-kanban'\nimport { Button } from '@/components/ui/button'\nimport { List } from 'lucide-react'\nimport type { KanbanColumnMode, WorkSource, WorkItem, SwimlaneMode, WipLimits } from '@/types/work-item.types'\n\n// URL search params schema\nconst kanbanSearchSchema = z.object({\n  mode: z.enum(['status', 'priority', 'tracking_type']).optional().default('status'),\n  sources: z\n    .string()\n    .optional()\n    .transform((val) => (val ? (val.split(',') as WorkSource[]) : undefined)),\n  swimlane: z.enum(['none', 'assignee', 'priority']).optional().default('none'),\n  wipInProgress: z.coerce.number().optional().default(5),\n  wipReview: z.coerce.number().optional().default(3),\n})\n\nexport type KanbanSearchParams = z.infer<typeof kanbanSearchSchema>\n\nexport const Route = createFileRoute('/_protected/kanban')({\n  component: KanbanTaskBoardPage,\n  validateSearch: (search) => kanbanSearchSchema.parse(search),\n})\n\nfunction KanbanTaskBoardPage() {\n  const { t, i18n } = useTranslation('unified-kanban')\n  const isRTL = i18n.language === 'ar'\n  const { user } = useAuth()\n  const { mode, sources, swimlane, wipInProgress, wipReview } = Route.useSearch()\n\n  // Parse sources from URL\n  const sourceFilter = sources as WorkSource[] | undefined\n\n  // Build WIP limits from URL params\n  const wipLimits: WipLimits = useMemo(() => ({\n    in_progress: wipInProgress,\n    review: wipReview,\n  }), [wipInProgress, wipReview])\n\n  // Fetch kanban data\n  const { items, isLoading, isError, refetch, isRefetching } =\n    useUnifiedKanban({\n      contextType: 'personal',\n      columnMode: mode as KanbanColumnMode,\n      sourceFilter,\n    })\n\n  // Status update mutation\n  const statusMutation = useUnifiedKanbanStatusUpdate()\n\n  // Real-time updates\n  useUnifiedKanbanRealtime('personal', null, user?.id || '', !!user)\n\n  // Handle swimlane mode change\n  const handleSwimlaneChange = useCallback(\n    (newSwimlane: SwimlaneMode) => {\n      const params = new URLSearchParams()\n      params.set('mode', mode)\n      params.set('swimlane', newSwimlane)\n      params.set('wipInProgress', String(wipInProgress))\n      params.set('wipReview', String(wipReview))\n      window.location.href = `/kanban?${params.toString()}`\n    },\n    [mode, wipInProgress, wipReview],\n  )\n\n  // Handle status change from drag and drop\n  const handleStatusChange = useCallback(\n    async (itemId: string, source: WorkSource, newStatus: string, workflowStage?: string) => {\n      await statusMutation.mutateAsync({\n        itemId,\n        source,\n        newStatus,\n        newWorkflowStage: workflowStage,\n      })\n    },\n    [statusMutation],\n  )\n\n  // Handle item click - navigate to detail page\n  const handleItemClick = useCallback(\n    (item: WorkItem) => {\n      switch (item.source) {\n        case 'task':\n          // Navigate using window.location for cross-route navigation\n          window.location.href = `/tasks/${item.id}`\n          break\n        case 'commitment':\n          window.location.href = '/commitments'\n          break\n        case 'intake':\n          window.location.href = `/intake/tickets/${item.id}`\n          break\n      }\n    },\n    [],\n  )\n\n  // Navigate to list view\n  const handleSwitchToList = useCallback(() => {\n    window.location.href = '/my-work'\n  }, [])\n\n  return (\n    <div className=\"flex flex-col h-full\" dir={isRTL ? 'rtl' : 'ltr'}>\n      {/* Top bar with view toggle */}\n      <div className=\"flex items-center justify-between px-4 sm:px-6 py-3 border-b bg-background\">\n        <div className=\"flex items-center gap-3\">\n          <h1 className=\"text-xl sm:text-2xl font-bold\">{t('title')}</h1>\n        </div>\n        <div className=\"flex items-center gap-2\">\n          <Button\n            variant=\"outline\"\n            size=\"sm\"\n            onClick={handleSwitchToList}\n            className=\"flex items-center gap-2\"\n          >\n            <List className=\"h-4 w-4\" />\n            <span className=\"hidden sm:inline\">{t('viewModes.list')}</span>\n          </Button>\n        </div>\n      </div>\n\n      {/* Kanban Board */}\n      <div className=\"flex-1 overflow-hidden\">\n        <EnhancedKanbanBoard\n          contextType=\"personal\"\n          columnMode={mode as KanbanColumnMode}\n          sourceFilter={sourceFilter}\n          items={items}\n          isLoading={isLoading}\n          isError={isError}\n          onStatusChange={handleStatusChange}\n          onItemClick={handleItemClick}\n          onRefresh={() => refetch()}\n          isRefreshing={isRefetching}\n          showFilters\n          showModeSwitch\n          swimlaneMode={swimlane as SwimlaneMode}\n          onSwimlaneChange={handleSwimlaneChange}\n          wipLimits={wipLimits}\n          enableBulkOperations\n          enableWipWarnings\n          className=\"h-full\"\n        />\n      </div>\n    </div>\n  )\n}\n","import { createFileRoute } from '@tanstack/react-router'\nimport Intelligence from '../../pages/Intelligence'\n\nexport const Route = createFileRoute('/_protected/intelligence')({\n component: Intelligence,\n})\n","import { createFileRoute, Outlet } from '@tanstack/react-router';\n\nexport const Route = createFileRoute('/_protected/intake')({\n component: IntakeLayout,\n});\n\nfunction IntakeLayout() {\n return (\n <div className=\"intake-layout\">\n <Outlet />\n </div>\n );\n}","import { createFileRoute } from '@tanstack/react-router'\nimport { ForumsPage } from '@/pages/forums/ForumsPage'\n\nexport const Route = createFileRoute('/_protected/forums')({\n component: ForumsPage\n})","/**\n * Export/Import Route\n * Feature: export-import-templates\n *\n * Route for the export/import demo page.\n */\n\nimport { createFileRoute } from '@tanstack/react-router';\nimport ExportImportPage from '@/pages/export-import/ExportImportPage';\n\nexport const Route = createFileRoute('/_protected/export-import')({\n  component: ExportImportPage,\n});\n","import { createFileRoute } from '@tanstack/react-router'\nimport ExportDialog from '@/components/export/ExportDialog'\n\nexport const Route = createFileRoute('/_protected/export')({\n component: ExportDialog,\n})\n","import { createFileRoute } from '@tanstack/react-router'\nimport Events from '../../pages/Events'\n\nexport const Route = createFileRoute('/_protected/events')({\n component: Events,\n})\n","/**\n * Engagements Layout Route\n * Feature: engagements-entity-management\n *\n * Layout route for engagements feature.\n * Renders child routes via Outlet.\n */\n\nimport { createFileRoute, Outlet } from '@tanstack/react-router'\n\nexport const Route = createFileRoute('/_protected/engagements')({\n  component: () => <Outlet />,\n})\n","/**\n * Delegations Route\n * Route for delegation management page\n *\n * Feature: delegation-management\n */\n\nimport { createFileRoute } from '@tanstack/react-router';\nimport { DelegationManagementPage } from '@/pages/delegations';\n\nexport const Route = createFileRoute('/_protected/delegations')({\n  component: DelegationManagementPage,\n});\n","import { createFileRoute } from '@tanstack/react-router'\nimport DataLibrary from '../../pages/DataLibrary'\n\nexport const Route = createFileRoute('/_protected/data-library')({\n component: DataLibrary,\n})\n","import { createFileRoute } from '@tanstack/react-router'\nimport { DashboardPage } from '../../pages/Dashboard'\n\nexport const Route = createFileRoute('/_protected/dashboard')({\n component: DashboardPage,\n})\n","/**\n * Custom Dashboard Route\n *\n * Protected route for the customizable dashboard with drag-and-drop widgets.\n */\n\nimport { createFileRoute } from '@tanstack/react-router'\nimport { CustomDashboardPage } from '@/pages/custom-dashboard'\n\nexport const Route = createFileRoute('/_protected/custom-dashboard')({\n  component: CustomDashboardPage,\n})\n","import { createFileRoute } from '@tanstack/react-router'\nimport Countries from '../../pages/Countries'\n\nexport const Route = createFileRoute('/_protected/countries')({\n component: Countries,\n})\n","/**\n * Contacts Directory Route - Main Index\n * Part of: 027-contact-directory implementation\n *\n * Route: /contacts\n * Displays the contact directory with search and filtering\n */\n\nimport { createFileRoute } from '@tanstack/react-router';\nimport { ContactsDirectory } from '@/pages/contacts/ContactsDirectory';\n\nexport const Route = createFileRoute('/_protected/contacts')({\n component: ContactsDirectory,\n meta: () => [\n {\n title: 'Contact Directory - GASTAT',\n },\n ],\n});\n","/**\n * Commitments Page v1.1\n * Feature: 031-commitments-management\n * Tasks: T030, T039, T040\n *\n * Main commitments page with:\n * - URL-synced filtering (T039, T040)\n * - Dossier context support\n * - Personal dashboard view\n * - Mobile-first, RTL-compatible\n */\n\nimport { useCallback } from 'react';\nimport { createFileRoute, Link } from '@tanstack/react-router';\nimport { useTranslation } from 'react-i18next';\nimport { CommitmentsList } from '@/components/commitments/CommitmentsList';\nimport { CommitmentDetailDrawer } from '@/components/commitments/CommitmentDetailDrawer';\nimport { PersonalCommitmentsDashboard } from '@/components/commitments/PersonalCommitmentsDashboard';\nimport { useDossier } from '@/hooks/useDossier';\nimport { Button } from '@/components/ui/button';\nimport { ArrowLeft, Home } from 'lucide-react';\nimport type { CommitmentStatus, CommitmentPriority, CommitmentFilters } from '@/types/commitment.types';\n\n// Type-specific route mapping for dossier navigation\nconst DOSSIER_TYPE_TO_ROUTE: Record<string, string> = {\n  country: 'countries',\n  organization: 'organizations',\n  person: 'persons',\n  engagement: 'engagements',\n  forum: 'forums',\n  working_group: 'working_groups',\n  topic: 'topics',\n};\n\n// T039: Search params schema for URL filter synchronization\ninterface CommitmentsSearchParams {\n  dossierId?: string;\n  status?: string; // Comma-separated status values\n  priority?: string; // Comma-separated priority values (T039)\n  ownerId?: string;\n  overdue?: boolean;\n  dueDateFrom?: string;\n  dueDateTo?: string;\n  search?: string;\n  id?: string; // For deep-linking to specific commitment\n  view?: 'list' | 'dashboard';\n}\n\nexport const Route = createFileRoute('/_protected/commitments')({\n  component: CommitmentsPage,\n  validateSearch: (search: Record<string, unknown>): CommitmentsSearchParams => {\n    return {\n      dossierId: search.dossierId as string | undefined,\n      status: search.status as string | undefined,\n      priority: search.priority as string | undefined,\n      ownerId: search.ownerId as string | undefined,\n      overdue: search.overdue === 'true' || search.overdue === true,\n      dueDateFrom: search.dueDateFrom as string | undefined,\n      dueDateTo: search.dueDateTo as string | undefined,\n      search: search.search as string | undefined,\n      id: search.id as string | undefined,\n      view: (search.view as 'list' | 'dashboard') || 'dashboard',\n    };\n  },\n});\n\nfunction CommitmentsPage() {\n  const { t, i18n } = useTranslation('commitments');\n  const searchParams = Route.useSearch();\n  const navigate = Route.useNavigate();\n  const isRTL = i18n.language === 'ar';\n\n  // Fetch dossier details when dossierId is present (for type-specific navigation)\n  const { data: dossier } = useDossier(\n    searchParams.dossierId ?? '',\n    undefined,\n    { enabled: !!searchParams.dossierId }\n  );\n\n  // Parse status from comma-separated string to typed array\n  const statusArray: CommitmentStatus[] | undefined = searchParams.status\n    ? (searchParams.status.split(',').filter(Boolean) as CommitmentStatus[])\n    : undefined;\n\n  // Parse priority from comma-separated string to typed array (T039)\n  const priorityArray: CommitmentPriority[] | undefined = searchParams.priority\n    ? (searchParams.priority.split(',').filter(Boolean) as CommitmentPriority[])\n    : undefined;\n\n  // T040: Handler to sync filter changes with URL query parameters\n  const handleFiltersChange = useCallback(\n    (filters: CommitmentFilters) => {\n      navigate({\n        search: (prev) => ({\n          ...prev,\n          // Convert arrays to comma-separated strings for URL\n          status: filters.status?.length ? filters.status.join(',') : undefined,\n          priority: filters.priority?.length ? filters.priority.join(',') : undefined,\n          ownerId: filters.ownerId || undefined,\n          overdue: filters.overdue || undefined,\n          dueDateFrom: filters.dueDateFrom || undefined,\n          dueDateTo: filters.dueDateTo || undefined,\n          // Preserve dossierId from current params\n          dossierId: filters.dossierId || prev.dossierId,\n        }),\n        replace: true, // Replace history entry instead of pushing new\n      });\n    },\n    [navigate]\n  );\n\n  // T061: Handler to close detail drawer (remove id from URL)\n  const handleDetailDrawerClose = useCallback(\n    (open: boolean) => {\n      if (!open) {\n        navigate({\n          search: (prev) => ({\n            ...prev,\n            id: undefined,\n          }),\n          replace: true,\n        });\n      }\n    },\n    [navigate]\n  );\n\n  // Determine view mode: dashboard (default) or list (when dossier context)\n  const showDashboard = searchParams.view === 'dashboard' && !searchParams.dossierId;\n\n  // If showing dashboard, render personal commitments view with detail drawer\n  if (showDashboard) {\n    return (\n      <>\n        <PersonalCommitmentsDashboard />\n        {/* Detail Drawer - opens when id is in URL */}\n        <CommitmentDetailDrawer\n          commitmentId={searchParams.id ?? null}\n          open={!!searchParams.id}\n          onOpenChange={handleDetailDrawerClose}\n        />\n      </>\n    );\n  }\n\n  // List view with optional dossier context\n  return (\n    <div\n      className=\"min-h-screen bg-gray-50 dark:bg-gray-900\"\n      dir={isRTL ? 'rtl' : 'ltr'}\n    >\n      {/* Page Header */}\n      <div className=\"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 sm:py-6\">\n          <div className=\"flex flex-col sm:flex-row sm:items-center gap-4\">\n            {/* Navigation */}\n            <div className=\"flex items-center gap-2\">\n              {searchParams.dossierId ? (\n                <Button\n                  variant=\"ghost\"\n                  size=\"sm\"\n                  className=\"min-h-11\"\n                  onClick={() => {\n                    // Navigate to type-specific dossier route\n                    const routeSegment = dossier?.type\n                      ? DOSSIER_TYPE_TO_ROUTE[dossier.type] || 'countries'\n                      : 'countries';\n                    navigate({\n                      to: `/dossiers/${routeSegment}/$id`,\n                      params: { id: searchParams.dossierId! },\n                    });\n                  }}\n                >\n                  <ArrowLeft\n                    className={`size-4 ${isRTL ? 'ms-2 rotate-180' : 'me-2'}`}\n                  />\n                  {t('detail.dossier')}\n                </Button>\n              ) : (\n                <Link to=\"/commitments\" search={{ view: 'dashboard' }}>\n                  <Button variant=\"ghost\" size=\"sm\" className=\"min-h-11\">\n                    <Home className={`size-4 ${isRTL ? 'ms-2' : 'me-2'}`} />\n                    {t('pageTitle')}\n                  </Button>\n                </Link>\n              )}\n            </div>\n\n            {/* Title */}\n            <div className=\"flex-1\">\n              <h1 className=\"text-2xl sm:text-3xl font-bold text-foreground text-start\">\n                {t('title')}\n              </h1>\n              {searchParams.dossierId && (\n                <p className=\"mt-1 text-sm text-muted-foreground text-start\">\n                  {t('subtitle')}\n                </p>\n              )}\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Main Content */}\n      <main className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6 sm:py-8\">\n        <CommitmentsList\n          dossierId={searchParams.dossierId}\n          status={statusArray}\n          priority={priorityArray}\n          ownerId={searchParams.ownerId}\n          overdue={searchParams.overdue}\n          dueDateFrom={searchParams.dueDateFrom}\n          dueDateTo={searchParams.dueDateTo}\n          showFilters={true}\n          showCreateButton={!!searchParams.dossierId}\n          onFiltersChange={handleFiltersChange}\n        />\n      </main>\n\n      {/* T061: Detail Drawer - opens when id is in URL */}\n      <CommitmentDetailDrawer\n        commitmentId={searchParams.id ?? null}\n        open={!!searchParams.id}\n        onOpenChange={handleDetailDrawerClose}\n      />\n    </div>\n  );\n}\n","import { useState } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { createFileRoute, Link } from '@tanstack/react-router';\nimport { Button } from '@/components/ui/button';\nimport { Card, CardContent } from '@/components/ui/card';\nimport { Calendar as CalendarIcon, Plus } from 'lucide-react';\nimport { UnifiedCalendar } from '@/components/Calendar/UnifiedCalendar';\n\nexport const Route = createFileRoute('/_protected/calendar')({\n component: CalendarPage,\n});\n\nfunction CalendarPage() {\n const { t, i18n } = useTranslation('dossiers');\n const isRTL = i18n.language === 'ar';\n\n const [viewMode, setViewMode] = useState<'month' | 'week' | 'day'>('month');\n\n return (\n <div className=\"container mx-auto px-4 sm:px-6 lg:px-8 py-6\" dir={isRTL ? 'rtl' : 'ltr'}>\n {/* Page Header */}\n <div className=\"mb-6\">\n <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4\">\n <div>\n <h1 className=\"text-2xl sm:text-3xl font-bold text-start flex items-center gap-2\">\n <CalendarIcon className=\"h-6 w-6 sm:h-7 sm:w-7\" />\n {t('calendar.page.title')}\n </h1>\n <p className=\"text-sm sm:text-base text-muted-foreground mt-1 text-start\">\n {t('calendar.page.description')}\n </p>\n </div>\n\n <div className=\"flex gap-2\">\n <Link to=\"/calendar/new\">\n <Button className=\"w-full sm:w-auto\">\n <Plus className=\"h-4 w-4 me-2\" />\n {t('calendar.page.create_event')}\n </Button>\n </Link>\n </div>\n </div>\n </div>\n\n {/* View Mode Toggle */}\n <Card className=\"mb-6\">\n <CardContent className=\"pt-6\">\n <div className=\"flex items-center gap-2 justify-center sm:justify-start\">\n <Button\n variant={viewMode === 'month' ? 'default' : 'outline'}\n size=\"sm\"\n onClick={() => setViewMode('month')}\n >\n {t('calendar.view_mode.month')}\n </Button>\n <Button\n variant={viewMode === 'week' ? 'default' : 'outline'}\n size=\"sm\"\n onClick={() => setViewMode('week')}\n >\n {t('calendar.view_mode.week')}\n </Button>\n <Button\n variant={viewMode === 'day' ? 'default' : 'outline'}\n size=\"sm\"\n onClick={() => setViewMode('day')}\n >\n {t('calendar.view_mode.day')}\n </Button>\n </div>\n </CardContent>\n </Card>\n\n {/* Unified Calendar Component */}\n <UnifiedCalendar viewMode={viewMode} />\n </div>\n );\n}\n","import { createFileRoute } from '@tanstack/react-router';\nimport { BulkActionsDemo } from '@/pages/bulk-actions/BulkActionsDemo';\n\nexport const Route = createFileRoute('/_protected/bulk-actions-demo')({\n  component: BulkActionsDemo,\n});\n","import { createFileRoute } from '@tanstack/react-router'\nimport { BriefsPage } from '@/pages/briefs/BriefsPage'\n\nexport const Route = createFileRoute('/_protected/briefs')({\n component: BriefsPage\n})","import { createFileRoute } from '@tanstack/react-router'\nimport { AuditLogsPage } from '@/pages/audit-logs/AuditLogsPage'\n\nexport const Route = createFileRoute('/_protected/audit-logs')({\n  component: AuditLogsPage,\n})\n","import { createFileRoute } from '@tanstack/react-router'\nimport ClusterVisualization from '@/components/analytics/ClusterVisualization'\n\nfunction AnalyticsPage() {\n const points = [\n [1, 1, 0],\n [2, 2, 0],\n [8, 8, 0],\n ]\n const labels = [0, 0, 1]\n const pts2d = points.map(([x, y]) => [x, y])\n return (\n <div style={{ padding: 16 }}>\n <h2>Clustering</h2>\n <ClusterVisualization points={pts2d as any} labels={labels} />\n </div>\n )\n}\n\nexport const Route = createFileRoute('/_protected/analytics')({\n component: AnalyticsPage,\n})\n\n","import { createFileRoute } from '@tanstack/react-router'\nimport { AdvancedSearchPage } from '@/pages/advanced-search'\n\nexport const Route = createFileRoute('/_protected/advanced-search')({\n  component: AdvancedSearchPage,\n})\n","import { createFileRoute } from '@tanstack/react-router'\nimport AccessibilitySettings from '@/components/settings/AccessibilitySettings'\n\nexport const Route = createFileRoute('/_protected/accessibility')({\n component: AccessibilitySettings,\n})\n\n","import { createFileRoute } from '@tanstack/react-router'\nimport { MyAssignmentsPage } from '../../../pages/MyAssignments'\n\nexport const Route = createFileRoute('/_protected/tasks/')({\n component: MyAssignmentsPage,\n})\n","/**\n * Positions Library Index Route (T055)\n * Renders the main positions list page\n */\n\nimport { createFileRoute } from '@tanstack/react-router';\nimport { PositionsLibraryPage } from '../positions';\n\nexport const Route = createFileRoute('/_protected/positions/')({\n component: PositionsLibraryPage,\n});\n","/**\n * Persons List Index Route\n * Feature: persons-entity-management\n *\n * Route: /persons\n * Displays the list of person dossiers.\n */\n\nimport { createFileRoute } from '@tanstack/react-router'\nimport PersonsListPage from '@/pages/persons/PersonsListPage'\n\nexport const Route = createFileRoute('/_protected/persons/')({\n  component: PersonsListPage,\n})\n","/**\n * Feature 032: Unified Work Management - My Work Dashboard\n *\n * This is the unified \"My Work\" dashboard that combines:\n * - Commitments (from aa_commitments)\n * - Tasks (from tasks table)\n * - Intake Tickets (from intake_tickets table)\n *\n * Features:\n * - Summary stats header (total active, overdue, due today/week)\n * - Productivity metrics (completion rate, avg completion time)\n * - Tabbed view by source (All, Commitments, Tasks, Intake)\n * - Filter by tracking type (Delivery, Follow-up, SLA)\n * - Cursor-based pagination with infinite scroll\n * - URL state sync for filters\n * - Real-time updates with debouncing\n * - Mobile-first, RTL-compatible design\n */\n\nimport { createFileRoute } from '@tanstack/react-router';\nimport { z } from 'zod';\nimport MyWorkDashboard from '@/pages/my-work/MyWorkDashboard';\n\n// URL search params schema for type-safe routing\nconst myWorkSearchSchema = z.object({\n  tab: z.enum(['all', 'commitments', 'tasks', 'intake']).optional().default('all'),\n  filter: z.enum(['active', 'overdue', 'due-today', 'due-week']).optional(),\n  trackingType: z.enum(['delivery', 'follow_up', 'sla']).optional(),\n  search: z.string().optional(),\n  sortBy: z.enum(['deadline', 'created_at', 'priority']).optional().default('deadline'),\n  sortOrder: z.enum(['asc', 'desc']).optional().default('asc'),\n});\n\nexport type MyWorkSearchParams = z.infer<typeof myWorkSearchSchema>;\n\nexport const Route = createFileRoute('/_protected/my-work/')({\n  component: MyWorkDashboard,\n  validateSearch: (search) => myWorkSearchSchema.parse(search),\n});\n","import { createFileRoute, Navigate } from '@tanstack/react-router';\n\nexport const Route = createFileRoute('/_protected/intake/')({\n component: IntakeIndex,\n});\n\nfunction IntakeIndex() {\n return <Navigate to=\"/intake/queue\" />;\n}\n","import { createFileRoute } from '@tanstack/react-router'\nimport { HelpPage } from '../../../pages/help/HelpPage'\n\nexport const Route = createFileRoute('/_protected/help/')({\n  component: HelpPage,\n})\n","/**\n * Engagements List Index Route\n * Feature: engagements-entity-management\n *\n * Route: /engagements\n * Displays the list of engagement dossiers.\n */\n\nimport { createFileRoute } from '@tanstack/react-router'\nimport EngagementsListPage from '@/pages/engagements/EngagementsListPage'\n\nexport const Route = createFileRoute('/_protected/engagements/')({\n  component: EngagementsListPage,\n})\n","/**\n * Dossiers List Page (Feature 028 - Enhanced)\n *\n * Enhanced dossier list view with:\n * - Header statistics cards with click-to-filter functionality\n * - Expandable dossier cards combining map/flag with Aceternity expandable behavior\n * - Mobile-first, RTL-compatible, WCAG AA compliant\n */\n\nimport { createFileRoute } from '@tanstack/react-router';\nimport { DossierListPage } from '@/pages/dossiers/DossierListPage';\n\nexport const Route = createFileRoute('/_protected/dossiers/')({\n  component: DossierListPage,\n});\n","/**\n * Route: /approvals\n * My Approvals dashboard - positions pending current user's approval\n */\n\nimport { createFileRoute } from '@tanstack/react-router';\nimport { useState } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Card } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { Button } from '@/components/ui/button';\nimport { useQuery } from '@tanstack/react-query';\nimport { supabase } from '@/lib/supabase';\nimport { Link } from '@tanstack/react-router';\nimport { Clock, CheckCircle, XCircle } from 'lucide-react';\nimport { Skeleton } from '@/components/ui/skeleton';\n\nexport const Route = createFileRoute('/_protected/approvals/')({\n component: MyApprovalsPage,\n});\n\nconst API_BASE_URL = import.meta.env.VITE_SUPABASE_URL + '/functions/v1';\n\nasync function fetchMyApprovals() {\n const { data: { session } } = await supabase.auth.getSession();\n\n // This would need a dedicated endpoint, but for now we'll filter positions\n const response = await fetch(`${API_BASE_URL}/positions-list?status=under_review`, {\n headers: {\n 'Authorization': `Bearer ${session?.access_token}`,\n 'Content-Type': 'application/json',\n },\n });\n\n if (!response.ok) {\n throw new Error('Failed to fetch approvals');\n }\n\n const data = await response.json();\n return data.data || [];\n}\n\nfunction MyApprovalsPage() {\n const { t } = useTranslation();\n const [filter, setFilter] = useState<'all' | 'pending' | 'completed'>('pending');\n\n const { data: positions, isLoading } = useQuery({\n queryKey: ['approvals', 'my', filter],\n queryFn: fetchMyApprovals,\n staleTime: 30 * 1000, // 30 seconds\n });\n\n if (isLoading) {\n return (\n <div className=\"container mx-auto py-6 space-y-4\">\n <Skeleton className=\"h-8 w-64\" />\n <Skeleton className=\"h-96\" />\n </div>\n );\n }\n\n return (\n <div className=\"container mx-auto py-6 space-y-6\">\n {/* Header */}\n <div className=\"flex items-center justify-between\">\n <div>\n <h1 className=\"text-3xl font-bold\">\n {t('approvals.myApprovals', 'My Approvals')}\n </h1>\n <p className=\"text-muted-foreground\">\n {t('approvals.subtitle', 'Positions pending your review and approval')}\n </p>\n </div>\n\n <div className=\"flex gap-2\">\n <Badge variant={filter === 'all' ? 'default' : 'outline'} className=\"cursor-pointer\" onClick={() => setFilter('all')}>\n {t('approvals.filter.all', 'All')}\n </Badge>\n <Badge variant={filter === 'pending' ? 'default' : 'outline'} className=\"cursor-pointer\" onClick={() => setFilter('pending')}>\n {t('approvals.filter.pending', 'Pending')}\n </Badge>\n <Badge variant={filter === 'completed' ? 'default' : 'outline'} className=\"cursor-pointer\" onClick={() => setFilter('completed')}>\n {t('approvals.filter.completed', 'Completed')}\n </Badge>\n </div>\n </div>\n\n {/* Stats Cards */}\n <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n <Card className=\"p-4\">\n <div className=\"flex items-center gap-4\">\n <div className=\"p-3 bg-yellow-100 dark:bg-yellow-900 rounded-lg\">\n <Clock className=\"h-6 w-6 text-yellow-600 dark:text-yellow-400\" />\n </div>\n <div>\n <p className=\"text-2xl font-bold\">{positions?.length || 0}</p>\n <p className=\"text-sm text-muted-foreground\">\n {t('approvals.stats.pending', 'Pending')}\n </p>\n </div>\n </div>\n </Card>\n\n <Card className=\"p-4\">\n <div className=\"flex items-center gap-4\">\n <div className=\"p-3 bg-green-100 dark:bg-green-900 rounded-lg\">\n <CheckCircle className=\"h-6 w-6 text-green-600 dark:text-green-400\" />\n </div>\n <div>\n <p className=\"text-2xl font-bold\">0</p>\n <p className=\"text-sm text-muted-foreground\">\n {t('approvals.stats.approved', 'Approved This Month')}\n </p>\n </div>\n </div>\n </Card>\n\n <Card className=\"p-4\">\n <div className=\"flex items-center gap-4\">\n <div className=\"p-3 bg-red-100 dark:bg-red-900 rounded-lg\">\n <XCircle className=\"h-6 w-6 text-red-600 dark:text-red-400\" />\n </div>\n <div>\n <p className=\"text-2xl font-bold\">0</p>\n <p className=\"text-sm text-muted-foreground\">\n {t('approvals.stats.rejected', 'Returned for Revisions')}\n </p>\n </div>\n </div>\n </Card>\n </div>\n\n {/* Positions List */}\n <Card className=\"p-6\">\n {positions && positions.length > 0 ? (\n <div className=\"space-y-4\">\n {positions.map((position: any) => (\n <Link\n key={position.id}\n to=\"/positions/$id\"\n params={{ id: position.id }}\n className=\"block p-4 border rounded-lg hover:border-primary transition-colors\"\n >\n <div className=\"flex items-center justify-between\">\n <div className=\"flex-1\">\n <div className=\"flex items-center gap-3 mb-2\">\n <h3 className=\"font-semibold\">{position.title_en}</h3>\n <Badge variant=\"secondary\">\n {t('approvals.stage', 'Stage')} {position.current_stage}\n </Badge>\n </div>\n <p className=\"text-sm text-muted-foreground\">{position.title_ar}</p>\n <p className=\"text-xs text-muted-foreground mt-2\">\n {t('approvals.submittedBy', 'Submitted by')}: {position.author_id}\n </p>\n </div>\n\n <div className=\"flex flex-col items-end gap-2\">\n <Badge>{position.thematic_category || t('approvals.uncategorized', 'Uncategorized')}</Badge>\n <span className=\"text-xs text-muted-foreground\">\n {new Date(position.created_at).toLocaleDateString()}\n </span>\n </div>\n </div>\n </Link>\n ))}\n </div>\n ) : (\n <div className=\"text-center py-12\">\n <p className=\"text-lg text-muted-foreground\">\n {t('approvals.noPositions', 'No positions pending your approval')}\n </p>\n </div>\n )}\n </Card>\n </div>\n );\n}\n","import { createFileRoute, useNavigate } from '@tanstack/react-router';\nimport { useTranslation } from 'react-i18next';\nimport { FileText, Plus } from 'lucide-react';\nimport { Button } from '../../../components/ui/button';\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '../../../components/ui/card';\n\nexport const Route = createFileRoute('/_protected/after-actions/')({\n component: AfterActionsIndexPage,\n});\n\nfunction AfterActionsIndexPage() {\n const { t } = useTranslation(['common']);\n const navigate = useNavigate();\n\n return (\n <div className=\"min-h-screen bg-gray-50 dark:bg-gray-900\">\n <div className=\"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700\">\n <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\n <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4\">\n <div className=\"space-y-1\">\n <h1 className=\"text-3xl font-bold text-gray-900 dark:text-gray-100 flex items-center gap-3\">\n <FileText className=\"h-8 w-8\" />\n After Action Records\n </h1>\n <p className=\"text-gray-500 dark:text-gray-400\">\n Manage engagement outcomes and commitments\n </p>\n </div>\n <Button\n className=\"gap-2\"\n onClick={() => navigate({ to: '/engagements' })}\n >\n <Plus className=\"h-5 w-5\" />\n Create After Action\n </Button>\n </div>\n </div>\n </div>\n\n <main className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\n <Card>\n <CardHeader>\n <CardTitle>After Actions</CardTitle>\n <CardDescription>\n After action records are created from engagement details.\n </CardDescription>\n </CardHeader>\n <CardContent>\n <p className=\"text-gray-600 dark:text-gray-400 text-center py-8\">\n No after action records available. Create an engagement to get started.\n </p>\n </CardContent>\n </Card>\n </main>\n </div>\n );\n}\n","import { createFileRoute } from '@tanstack/react-router'\nimport { AssignmentQueuePage } from '../../../pages/AssignmentQueue'\n\nexport const Route = createFileRoute('/_protected/tasks/queue')({\n component: AssignmentQueuePage,\n})\n","import { createFileRoute } from '@tanstack/react-router'\nimport { EscalationsPage } from '../../../pages/Escalations'\n\nexport const Route = createFileRoute('/_protected/tasks/escalations')({\n component: EscalationsPage,\n})\n","import { createFileRoute } from '@tanstack/react-router'\nimport { TaskDetailPage } from '../../../pages/TaskDetailPage'\n\nexport const Route = createFileRoute('/_protected/tasks/$id')({\n component: TaskDetailPage,\n\n // Loader to prefetch task data\n loader: async ({ params, context }) => {\n const { id } = params\n\n // Return task ID for the page to use\n // The actual data fetching will be done by the useTask hook\n // to leverage TanStack Query caching and real-time subscriptions\n return { taskId: id }\n },\n\n // Error handling for invalid routes\n errorComponent: ({ error }) => {\n return (\n <div className=\"flex flex-col items-center justify-center min-h-screen gap-4\">\n <h1 className=\"text-2xl font-bold text-red-600\">Error Loading Task</h1>\n <p className=\"text-gray-600\">{error.message}</p>\n </div>\n )\n },\n})\n","// TanStack Router route for Relationship Graph Page\n// User Story 3: Traverse Entity Relationships as Graph\nimport { createFileRoute } from '@tanstack/react-router';\nimport { RelationshipGraphPage } from '@/pages/relationships/RelationshipGraphPage';\n\nexport const Route = createFileRoute('/_protected/relationships/graph')({\n component: RelationshipGraphPage,\n validateSearch: (search: Record<string, unknown>) => {\n return {\n dossierId: (search.dossierId as string) || undefined,\n };\n },\n});\n","/**\n * Position Detail Page (T056)\n *\n * Detailed view of a single position with analytics and related engagements\n * Features: Full content display, version history, analytics card, cross-navigation\n * Integration: Accessible from library, dossier, and engagement contexts\n */\n\nimport { createFileRoute, Link, useNavigate } from '@tanstack/react-router';\nimport { useTranslation } from 'react-i18next';\nimport { usePosition } from '../../../hooks/usePosition';\nimport { usePositionAnalytics } from '../../../hooks/usePositionAnalytics';\nimport { useEngagementPositions } from '../../../hooks/useEngagementPositions';\nimport { PositionAnalyticsCard } from '../../../components/positions/PositionAnalyticsCard';\nimport { PositionEditor } from '../../../components/positions/PositionEditor';\nimport { Button } from '../../../components/ui/button';\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '../../../components/ui/card';\nimport { Badge } from '../../../components/ui/badge';\nimport { Skeleton } from '../../../components/ui/skeleton';\nimport { Separator } from '../../../components/ui/separator';\nimport {\n ArrowLeft,\n FileText,\n Calendar,\n User,\n Building,\n Link as LinkIcon,\n Edit,\n Archive,\n TrendingUp,\n} from 'lucide-react';\nimport { format } from 'date-fns';\nimport { ar, enUS } from 'date-fns/locale';\n\nexport const Route = createFileRoute('/_protected/positions/$positionId')({\n component: PositionDetailPage,\n});\n\nfunction PositionDetailPage() {\n const { positionId } = Route.useParams();\n const navigate = useNavigate();\n const { t, i18n } = useTranslation(['positions', 'common']);\n const isRTL = i18n.language === 'ar';\n const locale = isRTL ? ar : enUS;\n\n // Fetch position data\n const {\n data: position,\n isLoading,\n error,\n } = usePosition(positionId);\n\n // Fetch analytics\n const { data: analytics } = usePositionAnalytics(positionId);\n\n // Fetch related engagements (where this position is attached)\n // Note: This would need a new endpoint or query parameter\n // For now, we'll show a placeholder\n\n if (isLoading) {\n return (\n <div className=\"container mx-auto p-6 space-y-6\">\n <Skeleton className=\"h-8 w-64\" />\n <Skeleton className=\"h-96 w-full\" />\n <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n <Skeleton className=\"lg:col-span-2 h-64\" />\n <Skeleton className=\"h-64\" />\n </div>\n </div>\n );\n }\n\n if (error) {\n return (\n <div className=\"container mx-auto p-6\">\n <Card className=\"border-destructive\">\n <CardHeader>\n <CardTitle className=\"text-destructive flex items-center gap-2\">\n <FileText className=\"h-5 w-5\" />\n {t('common:error')}\n </CardTitle>\n <CardDescription>\n {error instanceof Error && error.message.includes('404')\n ? t('positions:detail.not_found')\n : t('positions:detail.error_loading')}\n </CardDescription>\n </CardHeader>\n <CardContent>\n <Button onClick={() => navigate({ to: '/positions' })} variant=\"outline\">\n <ArrowLeft className={`h-4 w-4 ${isRTL ? 'rotate-180' : ''}`} />\n {t('positions:detail.back_to_library')}\n </Button>\n </CardContent>\n </Card>\n </div>\n );\n }\n\n if (!position) return null;\n\n const statusColors = {\n draft: 'bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-200',\n review: 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-200',\n approved: 'bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-200',\n published: 'bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-200',\n archived: 'bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-200',\n };\n\n return (\n <div className={`min-h-screen bg-gray-50 dark:bg-gray-900 ${isRTL ? 'rtl' : 'ltr'}`}>\n {/* Header */}\n <div className=\"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700\">\n <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6\">\n <div className=\"flex items-start justify-between gap-4\">\n <div className=\"flex-1 min-w-0\">\n {/* Back Button */}\n <Button\n variant=\"ghost\"\n size=\"sm\"\n onClick={() => navigate({ to: '/positions' })}\n className=\"mb-4\"\n >\n <ArrowLeft className={`h-4 w-4 ${isRTL ? 'rotate-180' : ''}`} />\n {t('positions:detail.back_to_library')}\n </Button>\n\n {/* Title and Metadata */}\n <div className=\"space-y-2\">\n <div className=\"flex items-center gap-2 flex-wrap\">\n <h1 className=\"text-3xl font-bold text-gray-900 dark:text-gray-100\">\n {isRTL ? position.title_ar : position.title_en}\n </h1>\n <Badge className={statusColors[position.status]}>\n {t(`positions:status.${position.status}`)}\n </Badge>\n <Badge variant=\"outline\">\n {t(`positions:type.${position.type}`)}\n </Badge>\n </div>\n <div className=\"flex items-center gap-4 text-sm text-gray-500 dark:text-gray-400\">\n <span className=\"flex items-center gap-1\">\n <Calendar className=\"h-4 w-4\" />\n {format(new Date(position.updated_at), 'PPP', { locale })}\n </span>\n {position.created_by && (\n <span className=\"flex items-center gap-1\">\n <User className=\"h-4 w-4\" />\n {position.created_by}\n </span>\n )}\n </div>\n </div>\n </div>\n\n {/* Action Buttons */}\n <div className=\"flex items-center gap-2\">\n {position.status !== 'archived' && (\n <Button variant=\"outline\" size=\"sm\">\n <Edit className=\"h-4 w-4\" />\n {t('positions:detail.edit')}\n </Button>\n )}\n <Button variant=\"outline\" size=\"sm\">\n <Archive className=\"h-4 w-4\" />\n {position.status === 'archived'\n ? t('positions:detail.restore')\n : t('positions:detail.archive')}\n </Button>\n </div>\n </div>\n </div>\n </div>\n\n {/* Main Content */}\n <main className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\n <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n {/* Main Column - Position Content */}\n <div className=\"lg:col-span-2 space-y-6\">\n {/* Position Content */}\n <Card>\n <CardHeader>\n <CardTitle>{t('positions:detail.content_title')}</CardTitle>\n <CardDescription>\n {t('positions:detail.content_description')}\n </CardDescription>\n </CardHeader>\n <CardContent>\n <div className=\"prose dark:prose-invert max-w-none\">\n {/* English Content */}\n <div className=\"space-y-4\">\n <h3 className=\"text-lg font-semibold\">\n {t('positions:detail.english_version')}\n </h3>\n <div className=\"whitespace-pre-wrap\">{position.content_en}</div>\n </div>\n\n <Separator className=\"my-6\" />\n\n {/* Arabic Content */}\n <div className=\"space-y-4 text-end\" dir=\"rtl\">\n <h3 className=\"text-lg font-semibold\">\n {t('positions:detail.arabic_version')}\n </h3>\n <div className=\"whitespace-pre-wrap\">{position.content_ar}</div>\n </div>\n </div>\n </CardContent>\n </Card>\n\n {/* Related Engagements */}\n <Card>\n <CardHeader>\n <CardTitle className=\"flex items-center gap-2\">\n <LinkIcon className=\"h-5 w-5\" />\n {t('positions:detail.related_engagements')}\n </CardTitle>\n <CardDescription>\n {t('positions:detail.related_engagements_description')}\n </CardDescription>\n </CardHeader>\n <CardContent>\n {/* This would be populated with actual engagement data */}\n <div className=\"text-center py-8 text-gray-500 dark:text-gray-400\">\n <Building className=\"h-12 w-12 mx-auto mb-4 opacity-50\" />\n <p className=\"text-sm\">\n {t('positions:detail.no_related_engagements')}\n </p>\n </div>\n </CardContent>\n </Card>\n </div>\n\n {/* Sidebar - Analytics and Metadata */}\n <div className=\"space-y-6\">\n {/* Analytics Card */}\n {analytics && (\n <PositionAnalyticsCard positionId={positionId} analytics={analytics} />\n )}\n\n {/* Metadata Card */}\n <Card>\n <CardHeader>\n <CardTitle>{t('positions:detail.metadata_title')}</CardTitle>\n </CardHeader>\n <CardContent className=\"space-y-4\">\n <div>\n <p className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\n {t('positions:detail.dossier')}\n </p>\n {position.dossier_id ? (\n <Link\n to=\"/dossiers/$dossierId\"\n params={{ dossierId: position.dossier_id }}\n className=\"text-sm text-blue-600 dark:text-blue-400 hover:underline\"\n >\n {t('positions:detail.view_dossier')}\n </Link>\n ) : (\n <p className=\"text-sm text-gray-900 dark:text-gray-100\">\n {t('positions:detail.no_dossier')}\n </p>\n )}\n </div>\n\n <Separator />\n\n <div>\n <p className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\n {t('positions:detail.created')}\n </p>\n <p className=\"text-sm text-gray-900 dark:text-gray-100\">\n {format(new Date(position.created_at), 'PPP', { locale })}\n </p>\n </div>\n\n <div>\n <p className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\n {t('positions:detail.last_updated')}\n </p>\n <p className=\"text-sm text-gray-900 dark:text-gray-100\">\n {format(new Date(position.updated_at), 'PPP', { locale })}\n </p>\n </div>\n\n {position.version && (\n <>\n <Separator />\n <div>\n <p className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\n {t('positions:detail.version')}\n </p>\n <p className=\"text-sm text-gray-900 dark:text-gray-100\">\n v{position.version}\n </p>\n </div>\n </>\n )}\n </CardContent>\n </Card>\n </div>\n </div>\n </main>\n </div>\n );\n}\n","/**\n * Route: /positions/:id\n * Position detail/editor page with approval chain, consistency panel, and attachments\n */\n\nimport { createFileRoute } from '@tanstack/react-router';\nimport { useTranslation } from 'react-i18next';\nimport { Button } from '@/components/ui/button';\nimport { Card, CardContent } from '@/components/ui/card';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\nimport { Save, Send, CheckCircle, FileText, History, Users } from 'lucide-react';\nimport { usePosition } from '@/hooks/usePosition';\nimport { useUpdatePosition } from '@/hooks/useUpdatePosition';\nimport { useSubmitPosition } from '@/hooks/useSubmitPosition';\nimport { PositionEditor } from '@/components/PositionEditor';\nimport { ApprovalChain } from '@/components/ApprovalChain';\nimport { ConsistencyPanel } from '@/components/ConsistencyPanel';\nimport { AttachmentUploader } from '@/components/AttachmentUploader';\nimport { Badge } from '@/components/ui/badge';\nimport { Skeleton } from '@/components/ui/skeleton';\n\nexport const Route = createFileRoute('/_protected/positions/$id')({\n component: PositionDetailPage,\n});\n\nfunction PositionDetailPage() {\n const { id } = Route.useParams();\n const { t } = useTranslation('positions');\n const { data: position, isLoading } = usePosition(id);\n const updatePosition = useUpdatePosition();\n const submitPosition = useSubmitPosition();\n\n if (isLoading) {\n return (\n <div className=\"container mx-auto py-6 space-y-6\">\n <Skeleton className=\"h-8 w-64\" />\n <Skeleton className=\"h-96\" />\n </div>\n );\n }\n\n if (!position) {\n return (\n <div className=\"container mx-auto py-6\">\n <Card className=\"p-6 text-center\">\n <p className=\"text-lg text-muted-foreground\">\n {t('notFound', 'Position not found')}\n </p>\n </Card>\n </div>\n );\n }\n\n const handleSave = async (data: any) => {\n await updatePosition.mutateAsync({\n id: position.id,\n data: {\n ...data,\n version: position.version,\n },\n });\n };\n\n const handleSubmit = async () => {\n await submitPosition.mutateAsync(position.id);\n };\n\n const getStatusColor = (status: string) => {\n switch (status) {\n case 'draft':\n return 'default';\n case 'under_review':\n return 'secondary';\n case 'approved':\n return 'success';\n case 'published':\n return 'primary';\n default:\n return 'default';\n }\n };\n\n return (\n <div className=\"container mx-auto py-6 space-y-6\">\n {/* Header */}\n <div className=\"flex items-center justify-between\">\n <div className=\"space-y-1\">\n <div className=\"flex items-center gap-3\">\n <h1 className=\"text-3xl font-bold\">{position.title_en}</h1>\n <Badge variant={getStatusColor(position.status)}>\n {t(`status.${position.status}`, position.status)}\n </Badge>\n </div>\n <p className=\"text-sm text-muted-foreground\">{position.title_ar}</p>\n </div>\n\n <div className=\"flex gap-2\">\n {position.status === 'draft' && (\n <>\n <Button variant=\"outline\" onClick={handleSubmit}>\n <Send className=\"me-2 h-4 w-4\" />\n {t('submit', 'Submit for Review')}\n </Button>\n </>\n )}\n {position.status === 'approved' && (\n <Button>\n <CheckCircle className=\"me-2 h-4 w-4\" />\n {t('publish', 'Publish')}\n </Button>\n )}\n </div>\n </div>\n\n {/* Main Content Tabs */}\n <Tabs defaultValue=\"editor\" className=\"space-y-4\">\n <TabsList>\n <TabsTrigger value=\"editor\">\n <FileText className=\"me-2 h-4 w-4\" />\n {t('tabs.editor', 'Editor')}\n </TabsTrigger>\n {(position.status === 'under_review' || position.status === 'approved' || position.status === 'published') && (\n <TabsTrigger value=\"approvals\">\n <Users className=\"me-2 h-4 w-4\" />\n {t('tabs.approvals', 'Approvals')}\n </TabsTrigger>\n )}\n <TabsTrigger value=\"versions\">\n <History className=\"me-2 h-4 w-4\" />\n {t('tabs.versions', 'Versions')}\n </TabsTrigger>\n </TabsList>\n\n <TabsContent value=\"editor\" className=\"space-y-6\">\n {/* Editor Status Banner */}\n {position.status !== 'draft' && (\n <Card className=\"bg-muted/50 border-border\">\n <CardContent className=\"pt-3 pb-3\">\n <div className=\"flex items-start gap-2\">\n <FileText className=\"h-4 w-4 text-muted-foreground mt-0.5 flex-shrink-0\" />\n <p className=\"text-xs font-bold text-foreground\">\n {position.status === 'under_review' &&\n 'Position Under Review - Read Only. This position is currently under review and cannot be edited. It must go through the approval chain before any changes can be made.'}\n {position.status === 'approved' &&\n 'Position Approved - Read Only. This position has been approved and is awaiting publication. Contact an administrator to make changes.'}\n {position.status === 'published' &&\n 'Position Published - Read Only. This position has been published. To make changes, you must use the Emergency Correction workflow or create a new version.'}\n </p>\n </div>\n </CardContent>\n </Card>\n )}\n\n {position.status === 'draft' && (\n <Card className=\"bg-muted/50 border-border\">\n <CardContent className=\"pt-3 pb-3\">\n <div className=\"flex items-start gap-2\">\n <FileText className=\"h-4 w-4 text-muted-foreground mt-0.5 flex-shrink-0\" />\n <p className=\"text-xs font-bold text-foreground\">\n Draft Mode - Editing Enabled. You can edit this position. Changes are auto-saved every 30 seconds. Click \"Submit for Review\" when ready to start the approval process.\n </p>\n </div>\n </CardContent>\n </Card>\n )}\n\n <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n <div className=\"lg:col-span-2 space-y-6\">\n <Card className=\"p-6\">\n <PositionEditor\n initialData={position}\n onSave={handleSave}\n readOnly={position.status !== 'draft'}\n autoSaveInterval={30000}\n />\n </Card>\n\n <Card className=\"p-6\">\n <h3 className=\"text-lg font-semibold mb-4\">\n {t('attachments', 'Attachments')}\n </h3>\n <AttachmentUploader positionId={position.id} />\n </Card>\n </div>\n\n <div className=\"space-y-6\">\n {position.consistency_score !== undefined && (\n <Card className=\"p-6\">\n <h3 className=\"text-lg font-semibold mb-4\">\n {t('consistency.title', 'Consistency Check')}\n </h3>\n <ConsistencyPanel positionId={position.id} />\n </Card>\n )}\n\n {(position.status === 'under_review' || position.status === 'approved') && (\n <Card className=\"p-6\">\n <h3 className=\"text-lg font-semibold mb-4\">\n {t('approvalChain', 'Approval Progress')}\n </h3>\n <ApprovalChain positionId={position.id} currentStage={position.current_stage} />\n </Card>\n )}\n </div>\n </div>\n </TabsContent>\n\n <TabsContent value=\"approvals\">\n <Card className=\"p-6\">\n <ApprovalChain\n positionId={position.id}\n currentStage={position.current_stage}\n detailed={true}\n />\n </Card>\n </TabsContent>\n\n <TabsContent value=\"versions\">\n <Card className=\"p-6\">\n <p className=\"text-muted-foreground\">\n {t('versions.description', 'View version history and compare changes')}\n </p>\n </Card>\n </TabsContent>\n </Tabs>\n </div>\n );\n}\n","/**\n * Person Create Route\n * Feature: persons-entity-management\n *\n * Route for creating a new person dossier.\n * Mobile-first, RTL-compatible.\n */\n\nimport { createFileRoute } from '@tanstack/react-router'\nimport PersonCreatePage from '@/pages/persons/PersonCreatePage'\n\nexport const Route = createFileRoute('/_protected/persons/create')({\n  component: PersonCreatePage,\n})\n","/**\n * Person Detail Route\n * Feature: persons-entity-management\n *\n * Route for viewing a person dossier's details.\n * Mobile-first, RTL-compatible.\n */\n\nimport { createFileRoute } from '@tanstack/react-router'\nimport PersonDetailPage from '@/pages/persons/PersonDetailPage'\n\nexport const Route = createFileRoute('/_protected/persons/$personId')({\n  component: PersonDetailPage,\n})\n","/**\n * Waiting Queue Route (FR-033)\n *\n * Work-Queue-First Navigation: Priority route for blocked items\n * Displays work items awaiting external dependencies or approvals\n * - Items waiting for approvals\n * - Items waiting for external responses\n * - Items waiting for capacity\n * - Aging indicators\n * - Escalation actions\n */\n\nimport { createFileRoute } from '@tanstack/react-router'\nimport { WaitingQueuePage } from '../../../pages/WaitingQueue'\n\nexport const Route = createFileRoute('/_protected/my-work/waiting')({\n component: WaitingQueuePage,\n})\n","/**\n * Intake Queue Route (FR-033)\n *\n * Work-Queue-First Navigation: Priority route for new requests\n * Displays incoming tickets awaiting triage and classification\n * - AI triage suggestions\n * - Batch classification\n * - Quick preview and action buttons\n * - Filter by source, priority, date\n * - SLA countdown for triage deadlines\n */\n\nimport { createFileRoute } from '@tanstack/react-router'\nimport { IntakeQueuePage } from '../../../pages/IntakeQueue'\n\nexport const Route = createFileRoute('/_protected/my-work/intake')({\n component: IntakeQueuePage,\n})\n","/**\n * Feature 034: Unified Kanban Board - My Work Board View\n *\n * Kanban board view of the unified work items:\n * - Tasks (from tasks table)\n * - Commitments (from aa_commitments)\n * - Intake Tickets (from intake_tickets)\n *\n * Features:\n * - Drag and drop between columns\n * - Multiple column modes (Status, Priority, Tracking Type)\n * - Source filtering (Task, Commitment, Intake)\n * - Real-time updates\n * - Mobile-first, RTL-compatible design\n */\n\nimport { createFileRoute, useNavigate } from '@tanstack/react-router'\nimport { z } from 'zod'\nimport { useTranslation } from 'react-i18next'\nimport { useCallback } from 'react'\nimport { useAuth } from '@/hooks/useAuth'\nimport {\n  useUnifiedKanban,\n  useUnifiedKanbanStatusUpdate,\n  useUnifiedKanbanRealtime,\n} from '@/hooks/useUnifiedKanban'\nimport { UnifiedKanbanBoard } from '@/components/unified-kanban'\nimport { Button } from '@/components/ui/button'\nimport { List } from 'lucide-react'\nimport { cn } from '@/lib/utils'\nimport type { KanbanColumnMode, WorkSource, WorkItem } from '@/types/work-item.types'\n\n// URL search params schema\nconst boardSearchSchema = z.object({\n  mode: z.enum(['status', 'priority', 'tracking_type']).optional().default('status'),\n  sources: z\n    .string()\n    .optional()\n    .transform((val) => (val ? (val.split(',') as WorkSource[]) : undefined)),\n})\n\nexport type BoardSearchParams = z.infer<typeof boardSearchSchema>\n\nexport const Route = createFileRoute('/_protected/my-work/board')({\n  component: MyWorkBoardPage,\n  validateSearch: (search) => boardSearchSchema.parse(search),\n})\n\nfunction MyWorkBoardPage() {\n  const { t, i18n } = useTranslation('unified-kanban')\n  const isRTL = i18n.language === 'ar'\n  const navigate = useNavigate()\n  const { user } = useAuth()\n  const { mode, sources } = Route.useSearch()\n\n  // Parse sources from URL\n  const sourceFilter = sources as WorkSource[] | undefined\n\n  // Fetch kanban data\n  const { items, columns, totalCount, isLoading, isError, refetch, isRefetching } =\n    useUnifiedKanban({\n      contextType: 'personal',\n      columnMode: mode as KanbanColumnMode,\n      sourceFilter,\n    })\n\n  // Status update mutation\n  const statusMutation = useUnifiedKanbanStatusUpdate()\n\n  // Real-time updates\n  useUnifiedKanbanRealtime('personal', null, user?.id || '', !!user)\n\n  // Handle column mode change\n  const handleColumnModeChange = useCallback(\n    (newMode: KanbanColumnMode) => {\n      navigate({\n        to: '/my-work/board',\n        search: { mode: newMode, sources: sourceFilter?.join(',') },\n      })\n    },\n    [navigate, sourceFilter],\n  )\n\n  // Handle source filter change\n  const handleSourceFilterChange = useCallback(\n    (newSources: WorkSource[]) => {\n      navigate({\n        to: '/my-work/board',\n        search: {\n          mode: mode as KanbanColumnMode,\n          sources: newSources.length > 0 ? newSources.join(',') : undefined,\n        },\n      })\n    },\n    [navigate, mode],\n  )\n\n  // Handle status change from drag and drop\n  const handleStatusChange = useCallback(\n    async (itemId: string, source: WorkSource, newStatus: string, workflowStage?: string) => {\n      await statusMutation.mutateAsync({\n        itemId,\n        source,\n        newStatus,\n        newWorkflowStage: workflowStage,\n      })\n    },\n    [statusMutation],\n  )\n\n  // Handle item click - navigate to detail page\n  const handleItemClick = useCallback(\n    (item: WorkItem) => {\n      switch (item.source) {\n        case 'task':\n          navigate({ to: '/my-work/assignments' })\n          break\n        case 'commitment':\n          // Navigate to commitment detail if exists\n          break\n        case 'intake':\n          navigate({ to: '/my-work/intake' })\n          break\n      }\n    },\n    [navigate],\n  )\n\n  // Navigate to list view\n  const handleSwitchToList = useCallback(() => {\n    navigate({ to: '/my-work' })\n  }, [navigate])\n\n  return (\n    <div className=\"flex flex-col h-full\" dir={isRTL ? 'rtl' : 'ltr'}>\n      {/* Top bar with view toggle */}\n      <div className=\"flex items-center justify-between px-4 sm:px-6 py-2 border-b bg-background\">\n        <div className=\"flex items-center gap-2\">\n          <h1 className=\"text-lg font-semibold\">{t('context.personal')}</h1>\n        </div>\n        <Button\n          variant=\"outline\"\n          size=\"sm\"\n          onClick={handleSwitchToList}\n          className=\"flex items-center gap-2\"\n        >\n          <List className=\"h-4 w-4\" />\n          <span className=\"hidden sm:inline\">{t('viewModes.list')}</span>\n        </Button>\n      </div>\n\n      {/* Kanban Board */}\n      <div className=\"flex-1 overflow-hidden\">\n        <UnifiedKanbanBoard\n          contextType=\"personal\"\n          columnMode={mode as KanbanColumnMode}\n          sourceFilter={sourceFilter}\n          items={items}\n          isLoading={isLoading}\n          isError={isError}\n          onStatusChange={handleStatusChange}\n          onItemClick={handleItemClick}\n          onRefresh={() => refetch()}\n          isRefreshing={isRefetching}\n          showFilters\n          showModeSwitch\n          className=\"h-full\"\n        />\n      </div>\n    </div>\n  )\n}\n","/**\n * My Assignments Route (FR-033)\n *\n * Work-Queue-First Navigation: Priority route for active work items\n * Displays user's assigned tasks in Kanban board format\n * - Columns: Assigned, In Progress, Under Review, Completed\n * - SLA countdown with color-coded urgency\n * - Drag-and-drop to change status\n * - Filters by dossier, type, priority\n */\n\nimport { createFileRoute } from '@tanstack/react-router'\nimport { MyAssignmentsPage } from '../../../pages/MyAssignments'\n\nexport const Route = createFileRoute('/_protected/my-work/assignments')({\n component: MyAssignmentsPage,\n})\n","import { createFileRoute } from '@tanstack/react-router';\nimport { Queue } from '../../../pages/Queue';\n\nexport const Route = createFileRoute('/_protected/intake/queue')({\n component: QueuePage,\n});\n\nfunction QueuePage() {\n return <Queue />;\n}","import { createFileRoute } from '@tanstack/react-router';\nimport { IntakeForm } from '../../../components/IntakeForm';\n\nexport const Route = createFileRoute('/_protected/intake/new')({\n component: NewIntakeTicket,\n});\n\nfunction NewIntakeTicket() {\n return (\n <div className=\"container mx-auto px-4 py-8\">\n <IntakeForm />\n </div>\n );\n}","import { createFileRoute } from '@tanstack/react-router'\nimport { CommitmentsHelpPage } from '../../../pages/help/CommitmentsHelpPage'\n\nexport const Route = createFileRoute('/_protected/help/commitments')({\n  component: CommitmentsHelpPage,\n})\n","/**\n * Engagement Detail Route\n * Feature: engagements-entity-management\n *\n * Route for viewing an engagement dossier's details.\n * Mobile-first, RTL-compatible.\n */\n\nimport { createFileRoute } from '@tanstack/react-router'\nimport EngagementDetailPage from '@/pages/engagements/EngagementDetailPage'\n\nexport const Route = createFileRoute('/_protected/engagements/$engagementId')({\n  component: EngagementDetailPage,\n})\n","/**\n * Dossier Create Route\n *\n * Static route for creating new dossiers.\n * This route takes precedence over /$id.tsx when navigating to /dossiers/create\n */\n\nimport { createFileRoute } from '@tanstack/react-router'\nimport { DossierCreatePage } from '@/pages/dossiers/DossierCreatePage'\n\nexport const Route = createFileRoute('/_protected/dossiers/create')({\n  component: DossierCreatePage,\n})\n","/**\n * Dossier Detail Page (T039)\n *\n * Displays comprehensive dossier information with tabs\n * Components: DossierHeader, DossierStats, DossierTimeline, KeyContactsPanel, DossierActions\n * Tabs: Timeline (default), Positions, MoUs, Commitments, Files, Intelligence\n * Accessibility: Tab navigation, focus management\n */\n\nimport { createFileRoute, useNavigate } from '@tanstack/react-router'\nimport { useState } from 'react'\nimport { useTranslation } from 'react-i18next'\nimport { useDossier } from '../../../hooks/useDossier'\nimport { useArchiveDossier } from '../../../hooks/useArchiveDossier'\nimport { DossierHeader } from '../../../components/DossierHeader'\nimport { DossierStats } from '../../../components/DossierStats'\nimport { DossierActions } from '../../../components/DossierActions'\nimport { KeyContactsPanel } from '../../../components/KeyContactsPanel'\nimport { ConflictDialog } from '../../../components/ConflictDialog'\nimport { DossierPositionsTab } from '../../../components/positions/DossierPositionsTab'\nimport { RelationshipGraph } from '../../../components/dossiers/RelationshipGraph'\nimport { DossierMoUsTab } from '../../../components/dossiers/DossierMoUsTab'\nimport { DossierIntelligenceTab } from '../../../components/dossiers/DossierIntelligenceTab'\nimport { CountryTimeline } from '../../../components/timeline/CountryTimeline'\nimport { EngagementTimeline } from '../../../components/timeline/EngagementTimeline'\nimport { OrganizationTimeline } from '../../../components/timeline/OrganizationTimeline'\nimport { PersonTimeline } from '../../../components/timeline/PersonTimeline'\nimport type { ConflictError } from '../../../types/dossier'\n\n// Search params for tabs and filters\ninterface DossierDetailSearchParams {\n  tab?: string\n  event_type?: string\n}\n\nexport const Route = createFileRoute('/_protected/dossiers/$id')({\n  component: DossierDetailPage,\n  validateSearch: (search: Record<string, unknown>): DossierDetailSearchParams => {\n    return {\n      tab: search.tab as string | undefined,\n      event_type: search.event_type as string | undefined,\n    }\n  },\n})\n\ntype TabType =\n  | 'timeline'\n  | 'relationships'\n  | 'positions'\n  | 'mous'\n  | 'intelligence'\n  | 'contacts'\n  | 'commitments'\n  | 'files'\n\nfunction DossierDetailPage() {\n  const { t } = useTranslation('dossiers')\n  const navigate = useNavigate()\n  const { id } = Route.useParams()\n  const searchParams = Route.useSearch()\n\n  // Active tab state\n  const [activeTab, setActiveTab] = useState<TabType>((searchParams.tab as TabType) || 'timeline')\n\n  // Conflict dialog state (unused for now, but will be needed when edit functionality is added)\n  const [showConflictDialog, setShowConflictDialog] = useState(false)\n  const [conflictData] = useState<ConflictError | null>(null)\n\n  // Fetch dossier with includes\n  const {\n    data: dossier,\n    isLoading,\n    error,\n  } = useDossier(id, ['stats', 'owners', 'contacts', 'recent_briefs'])\n\n  // Mutations (updateMutation unused until edit functionality is added)\n  const archiveMutation = useArchiveDossier(id)\n\n  // Handlers\n  const handleEdit = () => {\n    // TODO: Open edit modal or navigate to edit page\n  }\n\n  const handleArchive = async () => {\n    if (!confirm(t('detail.confirm_archive'))) return\n\n    try {\n      await archiveMutation.mutateAsync()\n      navigate({ to: '/dossiers' })\n    } catch (error) {\n      console.error('Failed to archive dossier:', error)\n    }\n  }\n\n  const handleGenerateBrief = () => {\n    // TODO: Navigate to brief generation page when route is implemented\n  }\n\n  const handleTabChange = (tab: TabType) => {\n    setActiveTab(tab)\n    // Update URL to reflect active tab\n    navigate({\n      search: { tab } as any,\n      replace: true,\n    })\n  }\n\n  const handleConflictResolve = (resolution: 'keep-mine' | 'use-theirs' | 'cancel') => {\n    if (resolution === 'use-theirs') {\n      // Refresh the page to get latest data\n      window.location.reload()\n    } else if (resolution === 'keep-mine') {\n      // TODO: Keep local changes - retry with force flag\n    }\n    setShowConflictDialog(false)\n  }\n\n  const handleStatClick = (statType: 'engagements' | 'positions' | 'mous') => {\n    // Map stat types to their corresponding tabs and event filters\n    const tabMap: Record<typeof statType, TabType> = {\n      engagements: 'timeline',\n      positions: 'positions',\n      mous: 'mous',\n    }\n\n    const eventTypeMap: Record<typeof statType, string | undefined> = {\n      engagements: 'engagement',\n      positions: 'position',\n      mous: 'mou',\n    }\n\n    // Navigate to tab with event_type filter for timeline\n    const targetTab = tabMap[statType]\n    const eventType = eventTypeMap[statType]\n\n    setActiveTab(targetTab)\n    navigate({\n      search: {\n        tab: targetTab,\n        ...(targetTab === 'timeline' && eventType ? { event_type: eventType } : {}),\n      } as any,\n      replace: true,\n    })\n  }\n\n  // Loading state\n  if (isLoading) {\n    return (\n      <div className=\"min-h-screen bg-gray-50 dark:bg-gray-900\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\n          <div className=\"space-y-6\">\n            <div className=\"h-32 bg-gray-200 dark:bg-gray-700 rounded-lg animate-pulse\" />\n            <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n              <div className=\"lg:col-span-2 space-y-6\">\n                <div className=\"h-48 bg-gray-200 dark:bg-gray-700 rounded-lg animate-pulse\" />\n                <div className=\"h-96 bg-gray-200 dark:bg-gray-700 rounded-lg animate-pulse\" />\n              </div>\n              <div className=\"space-y-6\">\n                <div className=\"h-64 bg-gray-200 dark:bg-gray-700 rounded-lg animate-pulse\" />\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n  // Error state\n  if (error) {\n    const isNotFound = error instanceof Error && error.message === 'DOSSIER_NOT_FOUND'\n\n    return (\n      <div className=\"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center px-4\">\n        <div className=\"max-w-md w-full\">\n          <div\n            className=\"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-6\"\n            role=\"alert\"\n          >\n            <h2 className=\"text-lg font-medium text-red-800 dark:text-red-200\">\n              {isNotFound\n                ? t('detail.not_found_title', 'Dossier Not Found')\n                : t('detail.error_title', 'Error Loading Dossier')}\n            </h2>\n            <p className=\"mt-2 text-sm text-red-700 dark:text-red-300\">\n              {isNotFound\n                ? t(\n                    'detail.not_found_message',\n                    'The dossier you are looking for does not exist or may have been removed. This could be due to a data integrity issue where an assignment references a non-existent dossier.',\n                  )\n                : error instanceof Error\n                  ? error.message\n                  : t(\n                      'detail.error_generic',\n                      'An unexpected error occurred while loading the dossier.',\n                    )}\n            </p>\n            <div className=\"mt-4 flex flex-col sm:flex-row gap-2\">\n              <button\n                onClick={() => navigate({ to: '/my-work/waiting' })}\n                className=\"inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-red-700 bg-red-100 hover:bg-red-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500\"\n              >\n                {t('detail.back_to_waiting_queue', 'Back to Waiting Queue')}\n              </button>\n              <button\n                onClick={() => navigate({ to: '/dossiers' })}\n                className=\"inline-flex items-center justify-center px-4 py-2 border border-red-300 text-sm font-medium rounded-md text-red-700 bg-white hover:bg-red-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500\"\n              >\n                {t('detail.back_to_hub', 'Go to Dossiers')}\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n  if (!dossier) return null\n\n  // Check if dossier is a country type (intelligence only available for countries)\n  const isCountryDossier = dossier.type === 'country' || dossier.dossier_type === 'Country'\n\n  // Tab definitions\n  const tabs: Array<{ id: TabType; label: string; disabled?: boolean }> = [\n    { id: 'timeline', label: t('tabs.timeline') },\n    { id: 'relationships', label: t('tabs.relationships') },\n    { id: 'positions', label: t('tabs.positions') },\n    { id: 'mous', label: t('tabs.mous') },\n    // Intelligence tab only enabled for country dossiers\n    { id: 'intelligence', label: t('tabs.intelligence'), disabled: !isCountryDossier },\n    { id: 'contacts', label: t('tabs.contacts') },\n    { id: 'commitments', label: t('tabs.commitments'), disabled: true },\n    { id: 'files', label: t('tabs.files'), disabled: true },\n  ]\n\n  return (\n    <div className=\"min-h-screen bg-gray-50 dark:bg-gray-900\">\n      {/* Dossier Header */}\n      <DossierHeader\n        dossier={dossier}\n        onEdit={handleEdit}\n        onArchive={handleArchive}\n        onGenerateBrief={handleGenerateBrief}\n      />\n\n      {/* Main Content */}\n      <main className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\n        <div className=\"space-y-6\">\n          {/* Stats Cards */}\n          <div>\n            <DossierStats dossierId={id} onStatClick={handleStatClick} />\n          </div>\n\n          {/* Tabs Navigation - Mobile First Responsive */}\n          <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow\">\n            <div className=\"border-b border-gray-200 dark:border-gray-700\">\n              {/* Mobile: Horizontal Scrollable Tabs */}\n              <nav\n                className=\"-mb-px flex overflow-x-auto scrollbar-hide px-4 sm:px-6\"\n                aria-label={t('detail.tabs_label')}\n                role=\"tablist\"\n              >\n                {tabs.map((tab) => (\n                  <button\n                    key={tab.id}\n                    onClick={() => !tab.disabled && handleTabChange(tab.id)}\n                    disabled={tab.disabled}\n                    role=\"tab\"\n                    aria-selected={activeTab === tab.id}\n                    aria-controls={`${tab.id}-panel`}\n                    className={`\n flex-shrink-0 min-h-11 py-3 px-3 sm:px-4 md:px-6 border-b-2 font-medium text-xs sm:text-sm md:text-base\n transition-all duration-200 ease-in-out\n ${\n   activeTab === tab.id\n     ? 'border-blue-500 text-blue-600 dark:text-blue-400 bg-blue-50/50 dark:bg-blue-900/10'\n     : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700/50'\n }\n ${tab.disabled ? 'opacity-50 cursor-not-allowed' : 'cursor-pointer'}\n focus:outline-none focus:ring-2 focus:ring-inset focus:ring-blue-500 rounded-t-md\n `}\n                  >\n                    <span className=\"whitespace-nowrap\">{tab.label}</span>\n                  </button>\n                ))}\n              </nav>\n            </div>\n\n            {/* Tab Panels - Responsive Padding */}\n            <div className=\"p-4 sm:p-6\">\n              {/* Timeline Tab - Type-Specific Unified Timeline */}\n              {activeTab === 'timeline' && (\n                <div id=\"timeline-panel\" role=\"tabpanel\" aria-labelledby=\"timeline-tab\">\n                  {dossier.dossier_type === 'Country' && <CountryTimeline dossierId={id} />}\n                  {dossier.dossier_type === 'Organization' && (\n                    <OrganizationTimeline dossierId={id} />\n                  )}\n                  {dossier.dossier_type === 'Person' && <PersonTimeline dossierId={id} />}\n                  {dossier.dossier_type === 'Engagement' && <EngagementTimeline dossierId={id} />}\n                  {!['Country', 'Organization', 'Person', 'Engagement'].includes(\n                    dossier.dossier_type,\n                  ) && (\n                    <div className=\"text-center py-12 text-muted-foreground\">\n                      <p>\n                        {t(\n                          'timeline.not_supported',\n                          'Timeline not yet supported for this dossier type',\n                        )}\n                      </p>\n                    </div>\n                  )}\n                </div>\n              )}\n\n              {/* Relationships Tab */}\n              {activeTab === 'relationships' && (\n                <div id=\"relationships-panel\" role=\"tabpanel\" aria-labelledby=\"relationships-tab\">\n                  <RelationshipGraph dossierId={id} />\n                </div>\n              )}\n\n              {/* Positions Tab */}\n              {activeTab === 'positions' && (\n                <div id=\"positions-panel\" role=\"tabpanel\" aria-labelledby=\"positions-tab\">\n                  <DossierPositionsTab dossierId={id} />\n                </div>\n              )}\n\n              {/* MoUs Tab */}\n              {activeTab === 'mous' && (\n                <div id=\"mous-panel\" role=\"tabpanel\" aria-labelledby=\"mous-tab\">\n                  <DossierMoUsTab dossierId={id} />\n                </div>\n              )}\n\n              {/* Intelligence Tab - Only for Country Dossiers */}\n              {activeTab === 'intelligence' && (\n                <div id=\"intelligence-panel\" role=\"tabpanel\" aria-labelledby=\"intelligence-tab\">\n                  {isCountryDossier ? (\n                    <DossierIntelligenceTab dossierId={id} />\n                  ) : (\n                    <div className=\"text-center py-12 text-muted-foreground\">\n                      <p>\n                        {t(\n                          'intelligence.country_only',\n                          'Intelligence reports are only available for country dossiers',\n                        )}\n                      </p>\n                    </div>\n                  )}\n                </div>\n              )}\n\n              {/* Contacts Tab */}\n              {activeTab === 'contacts' && (\n                <div id=\"contacts-panel\" role=\"tabpanel\" aria-labelledby=\"contacts-tab\">\n                  <KeyContactsPanel dossierId={id} />\n                </div>\n              )}\n\n              {/* Other tabs - placeholder */}\n              {![\n                'timeline',\n                'relationships',\n                'positions',\n                'mous',\n                'intelligence',\n                'contacts',\n              ].includes(activeTab) && (\n                <div className=\"text-center py-12 text-gray-500 dark:text-gray-400\">\n                  <p>{t('detail.tab_coming_soon')}</p>\n                </div>\n              )}\n            </div>\n          </div>\n\n          {/* Actions Panel */}\n          <DossierActions dossierId={id} />\n        </div>\n      </main>\n\n      {/* Conflict Dialog - shown when edit conflicts occur */}\n      {showConflictDialog && conflictData && dossier && (\n        <ConflictDialog\n          open={showConflictDialog}\n          currentData={dossier}\n          remoteData={{} as any}\n          onResolve={handleConflictResolve}\n        />\n      )}\n    </div>\n  )\n}\n","/**\n * Notes Search Route\n * Part of: 027-contact-directory Phase 7 implementation\n *\n * Route: /contacts/notes-search\n * Global search page for interaction notes across all contacts\n */\n\nimport { createFileRoute } from '@tanstack/react-router';\nimport { NotesSearch } from '@/pages/contacts/NotesSearch';\n\nexport const Route = createFileRoute('/_protected/contacts/notes-search')({\n component: NotesSearch,\n meta: () => [\n {\n title: 'Search Interaction Notes - GASTAT',\n },\n ],\n});\n","/**\n * Contact Create Route\n * Part of: 027-contact-directory implementation\n *\n * Route: /contacts/create\n * Manual contact entry form\n */\n\nimport { createFileRoute } from '@tanstack/react-router';\nimport { ContactCreate } from '@/pages/contacts/ContactCreate';\n\nexport const Route = createFileRoute('/_protected/contacts/create')({\n component: ContactCreate,\n meta: () => [\n {\n title: 'Create Contact - GASTAT',\n },\n ],\n});\n","/**\n * Contact Details Route\n * Part of: 027-contact-directory implementation\n *\n * Route: /contacts/:contactId\n * Displays full contact details with edit/archive actions\n */\n\nimport { createFileRoute } from '@tanstack/react-router';\nimport { ContactDetails } from '@/pages/contacts/ContactDetails';\n\nexport const Route = createFileRoute('/_protected/contacts/$contactId')({\n component: ContactDetails,\n meta: ({ params }) => [\n {\n title: `Contact Details - ${params.contactId} - GASTAT`,\n },\n ],\n});\n","import { useTranslation } from 'react-i18next';\nimport { createFileRoute, useNavigate } from '@tanstack/react-router';\nimport { Button } from '@/components/ui/button';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { ArrowLeft } from 'lucide-react';\nimport { CalendarEntryForm } from '@/components/Calendar/CalendarEntryForm';\n\nexport const Route = createFileRoute('/_protected/calendar/new')({\n component: NewCalendarEntryPage,\n});\n\nfunction NewCalendarEntryPage() {\n const { t, i18n } = useTranslation();\n const isRTL = i18n.language === 'ar';\n const navigate = useNavigate();\n\n const handleSuccess = () => {\n navigate({ to: '/calendar' });\n };\n\n const handleCancel = () => {\n navigate({ to: '/calendar' });\n };\n\n return (\n <div className=\"container mx-auto px-4 sm:px-6 lg:px-8 py-6 max-w-4xl\" dir={isRTL ? 'rtl' : 'ltr'}>\n {/* Breadcrumb */}\n <div className=\"mb-6\">\n <Button\n variant=\"ghost\"\n size=\"sm\"\n onClick={handleCancel}\n className=\"mb-2\"\n >\n <ArrowLeft className={`h-4 w-4 ${isRTL ? 'rotate-180 ms-2' : 'me-2'}`} />\n {t('calendar.new_event.back_to_calendar')}\n </Button>\n <h1 className=\"text-2xl sm:text-3xl font-bold text-start\">\n {t('calendar.new_event.title')}\n </h1>\n <p className=\"text-sm sm:text-base text-muted-foreground mt-1 text-start\">\n {t('calendar.new_event.description')}\n </p>\n </div>\n\n {/* Form Card */}\n <Card>\n <CardHeader>\n <CardTitle className=\"text-base sm:text-lg text-start\">\n {t('calendar.new_event.form_title')}\n </CardTitle>\n </CardHeader>\n <CardContent>\n <CalendarEntryForm\n onSuccess={handleSuccess}\n onCancel={handleCancel}\n />\n </CardContent>\n </Card>\n </div>\n );\n}\n","import { createFileRoute, Link } from '@tanstack/react-router';\nimport { useAfterAction } from '@/hooks/useAfterAction';\nimport { usePublishAfterAction } from '@/hooks/usePublishAfterAction';\nimport { useRequestEdit } from '@/hooks/useEditWorkflow';\nimport { useTranslation } from 'react-i18next';\nimport { Button } from '@/components/ui/button';\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { Skeleton } from '@/components/ui/skeleton';\nimport { Separator } from '@/components/ui/separator';\nimport { PDFGeneratorButton } from '@/components/PDFGeneratorButton';\nimport { EditApprovalFlow } from '@/components/EditApprovalFlow';\nimport {\n Calendar,\n FileText,\n Users,\n ArrowLeft,\n CheckCircle,\n AlertCircle,\n Lock,\n Edit,\n History\n} from 'lucide-react';\nimport { format } from 'date-fns';\nimport { ar, enUS } from 'date-fns/locale';\nimport { toast } from 'sonner';\nimport { useAuth } from '@/hooks/useAuth';\n\nexport const Route = createFileRoute('/_protected/after-actions/$afterActionId')({\n component: AfterActionDetailPage,\n});\n\nfunction AfterActionDetailPage() {\n const { afterActionId } = Route.useParams();\n const { t, i18n } = useTranslation();\n const isRTL = i18n.language === 'ar';\n const locale = isRTL ? ar : enUS;\n const { user } = useAuth();\n\n const { data: afterAction, isLoading, error } = useAfterAction(afterActionId);\n const publishMutation = usePublishAfterAction();\n const requestEditMutation = useRequestEdit();\n\n if (isLoading) {\n return (\n <div className=\"container mx-auto p-6 space-y-6\">\n <Skeleton className=\"h-8 w-64\" />\n <Skeleton className=\"h-screen w-full\" />\n </div>\n );\n }\n\n if (error) {\n return (\n <div className=\"container mx-auto p-6\">\n <Card className=\"border-destructive\">\n <CardHeader>\n <CardTitle className=\"text-destructive\">{t('common.error')}</CardTitle>\n <CardDescription>{t('afterActions.loadError')}</CardDescription>\n </CardHeader>\n </Card>\n </div>\n );\n }\n\n if (!afterAction) {\n return (\n <div className=\"container mx-auto p-6\">\n <Card>\n <CardHeader>\n <CardTitle>{t('afterActions.notFound')}</CardTitle>\n <CardDescription>{t('afterActions.notFoundDescription')}</CardDescription>\n </CardHeader>\n </Card>\n </div>\n );\n }\n\n const canPublish = ['supervisor', 'admin'].includes(user?.role || '');\n const canEdit = afterAction.publication_status === 'draft' ||\n (afterAction.publication_status === 'published' &&\n (user?.id === afterAction.created_by || canPublish));\n\n const isReadOnly = afterAction.publication_status === 'published';\n const isEditRequested = afterAction.publication_status === 'edit_requested';\n\n const handlePublish = async () => {\n try {\n await publishMutation.mutateAsync({\n afterActionId,\n isConfidential: afterAction.is_confidential,\n });\n toast.success(t('afterActions.publishSuccess'));\n } catch (error: any) {\n toast.error(error.message || t('afterActions.publishFailed'));\n }\n };\n\n const handleRequestEdit = async () => {\n // This will open a modal in practice\n toast.info(t('afterActions.editRequestFeature'));\n };\n\n const statusMap: Record<string, { label: string; variant: any }> = {\n draft: { label: t('afterActions.status.draft'), variant: 'secondary' },\n published: { label: t('afterActions.status.published'), variant: 'default' },\n edit_requested: { label: t('afterActions.status.editRequested'), variant: 'warning' },\n };\n\n const statusConfig = statusMap[afterAction.publication_status] || {\n label: afterAction.publication_status,\n variant: 'secondary'\n };\n\n return (\n <div className={`container mx-auto p-6 space-y-6 ${isRTL ? 'rtl' : 'ltr'}`}>\n {/* Header */}\n <div className=\"flex items-center justify-between\">\n <div className=\"flex items-center gap-4\">\n <Button variant=\"ghost\" size=\"icon\" asChild>\n <Link\n to=\"/dossiers/$dossierId\"\n params={{ dossierId: afterAction.dossier_id }}\n >\n <ArrowLeft className={`h-4 w-4 ${isRTL ? 'rotate-180' : ''}`} />\n </Link>\n </Button>\n <div>\n <h1 className=\"text-3xl font-bold\">{t('afterActions.detail')}</h1>\n <p className=\"text-muted-foreground\">\n {format(new Date(afterAction.created_at), 'PPP', { locale })}\n </p>\n </div>\n </div>\n <div className=\"flex items-center gap-2\">\n <Badge variant={statusConfig.variant as any}>\n {statusConfig.label}\n </Badge>\n {afterAction.is_confidential && (\n <Badge variant=\"destructive\">\n <Lock className=\"h-3 w-3 me-1\" />\n {t('afterActions.confidential')}\n </Badge>\n )}\n </div>\n </div>\n\n {/* Actions */}\n <div className=\"flex items-center gap-2 justify-end flex-wrap\">\n {afterAction.publication_status === 'draft' && canPublish && (\n <Button\n onClick={handlePublish}\n disabled={publishMutation.isPending}\n >\n <CheckCircle className=\"h-4 w-4 me-2\" />\n {t('afterActions.publish')}\n </Button>\n )}\n\n {isReadOnly && canEdit && (\n <Button\n variant=\"outline\"\n onClick={handleRequestEdit}\n disabled={requestEditMutation.isPending}\n >\n <Edit className=\"h-4 w-4 me-2\" />\n {t('afterActions.requestEdit')}\n </Button>\n )}\n\n <Button variant=\"outline\" asChild>\n <Link\n to=\"/after-actions/$afterActionId/versions\"\n params={{ afterActionId }}\n >\n <History className=\"h-4 w-4 me-2\" />\n {t('afterActions.versionHistory')}\n </Link>\n </Button>\n\n <PDFGeneratorButton\n afterActionId={afterActionId}\n isConfidential={afterAction.is_confidential}\n />\n </div>\n\n {/* Edit Approval Flow (for supervisors) */}\n {isEditRequested && canPublish && (\n <EditApprovalFlow afterActionId={afterActionId} />\n )}\n\n {/* Main Content */}\n <div className=\"grid gap-6\">\n {/* Attendees */}\n <Card>\n <CardHeader>\n <CardTitle className=\"flex items-center gap-2\">\n <Users className=\"h-5 w-5\" />\n {t('afterActions.attendees')}\n </CardTitle>\n </CardHeader>\n <CardContent>\n <div className=\"flex flex-wrap gap-2\">\n {afterAction.attendees && afterAction.attendees.length > 0 ? (\n afterAction.attendees.map((attendee, index) => (\n <Badge key={index} variant=\"outline\">\n {attendee}\n </Badge>\n ))\n ) : (\n <p className=\"text-sm text-muted-foreground\">\n {t('afterActions.noAttendees')}\n </p>\n )}\n </div>\n </CardContent>\n </Card>\n\n {/* Decisions */}\n {afterAction.decisions && afterAction.decisions.length > 0 && (\n <Card>\n <CardHeader>\n <CardTitle>{t('afterActions.decisions')}</CardTitle>\n <CardDescription>\n {t('afterActions.decisionsCount', { count: afterAction.decisions.length })}\n </CardDescription>\n </CardHeader>\n <CardContent className=\"space-y-4\">\n {afterAction.decisions.map((decision, index) => (\n <div key={decision.id} className=\"space-y-2\">\n {index > 0 && <Separator />}\n <div className=\"pt-2\">\n <p className=\"font-medium\">{decision.description}</p>\n {decision.rationale && (\n <p className=\"text-sm text-muted-foreground mt-1\">\n {t('afterActions.rationale')}: {decision.rationale}\n </p>\n )}\n <div className=\"flex items-center gap-4 mt-2 text-sm text-muted-foreground\">\n <span>{t('afterActions.decisionMaker')}: {decision.decision_maker}</span>\n <span>\n {format(new Date(decision.decision_date), 'PP', { locale })}\n </span>\n </div>\n </div>\n </div>\n ))}\n </CardContent>\n </Card>\n )}\n\n {/* Commitments */}\n {afterAction.commitments && afterAction.commitments.length > 0 && (\n <Card>\n <CardHeader>\n <CardTitle>{t('afterActions.commitments')}</CardTitle>\n <CardDescription>\n {t('afterActions.commitmentsCount', { count: afterAction.commitments.length })}\n </CardDescription>\n </CardHeader>\n <CardContent className=\"space-y-4\">\n {afterAction.commitments.map((commitment, index) => (\n <div key={commitment.id} className=\"space-y-2\">\n {index > 0 && <Separator />}\n <div className=\"pt-2\">\n <div className=\"flex items-start justify-between gap-4\">\n <div className=\"flex-1\">\n <p className=\"font-medium\">{commitment.description}</p>\n <div className=\"flex items-center gap-4 mt-2 text-sm text-muted-foreground flex-wrap\">\n <span>\n {t('afterActions.owner')}: {\n commitment.owner_type === 'internal'\n ? commitment.owner_user_id\n : commitment.owner_contact_id\n }\n </span>\n <span>\n {t('afterActions.dueDate')}: {format(new Date(commitment.due_date), 'PP', { locale })}\n </span>\n <Badge variant=\"outline\">{commitment.priority}</Badge>\n <Badge>{commitment.status}</Badge>\n </div>\n </div>\n </div>\n </div>\n </div>\n ))}\n </CardContent>\n </Card>\n )}\n\n {/* Risks */}\n {afterAction.risks && afterAction.risks.length > 0 && (\n <Card>\n <CardHeader>\n <CardTitle className=\"flex items-center gap-2\">\n <AlertCircle className=\"h-5 w-5\" />\n {t('afterActions.risks')}\n </CardTitle>\n <CardDescription>\n {t('afterActions.risksCount', { count: afterAction.risks.length })}\n </CardDescription>\n </CardHeader>\n <CardContent className=\"space-y-4\">\n {afterAction.risks.map((risk, index) => (\n <div key={risk.id} className=\"space-y-2\">\n {index > 0 && <Separator />}\n <div className=\"pt-2\">\n <p className=\"font-medium\">{risk.description}</p>\n <div className=\"flex items-center gap-2 mt-2 flex-wrap\">\n <Badge variant={risk.severity === 'critical' || risk.severity === 'high' ? 'destructive' : 'outline'}>\n {t('afterActions.severity')}: {risk.severity}\n </Badge>\n <Badge variant=\"outline\">\n {t('afterActions.likelihood')}: {risk.likelihood}\n </Badge>\n </div>\n {risk.mitigation_strategy && (\n <p className=\"text-sm text-muted-foreground mt-2\">\n {t('afterActions.mitigation')}: {risk.mitigation_strategy}\n </p>\n )}\n </div>\n </div>\n ))}\n </CardContent>\n </Card>\n )}\n\n {/* Follow-up Actions */}\n {afterAction.follow_up_actions && afterAction.follow_up_actions.length > 0 && (\n <Card>\n <CardHeader>\n <CardTitle>{t('afterActions.followUps')}</CardTitle>\n <CardDescription>\n {t('afterActions.followUpsCount', { count: afterAction.follow_up_actions.length })}\n </CardDescription>\n </CardHeader>\n <CardContent className=\"space-y-4\">\n {afterAction.follow_up_actions.map((action, index) => (\n <div key={action.id} className=\"space-y-2\">\n {index > 0 && <Separator />}\n <div className=\"pt-2\">\n <div className=\"flex items-start gap-2\">\n {action.completed ? (\n <CheckCircle className=\"h-5 w-5 text-green-600 mt-0.5\" />\n ) : (\n <div className=\"h-5 w-5 rounded-full border-2 border-muted-foreground mt-0.5\" />\n )}\n <div className=\"flex-1\">\n <p className={action.completed ? 'line-through text-muted-foreground' : ''}>\n {action.description}\n </p>\n {action.assigned_to || action.target_date ? (\n <div className=\"flex items-center gap-4 mt-1 text-sm text-muted-foreground\">\n {action.assigned_to && <span>{action.assigned_to}</span>}\n {action.target_date && (\n <span>{format(new Date(action.target_date), 'PP', { locale })}</span>\n )}\n </div>\n ) : null}\n </div>\n </div>\n </div>\n </div>\n ))}\n </CardContent>\n </Card>\n )}\n\n {/* Notes */}\n {afterAction.notes && (\n <Card>\n <CardHeader>\n <CardTitle className=\"flex items-center gap-2\">\n <FileText className=\"h-5 w-5\" />\n {t('afterActions.notes')}\n </CardTitle>\n </CardHeader>\n <CardContent>\n <p className=\"text-sm whitespace-pre-wrap\">{afterAction.notes}</p>\n </CardContent>\n </Card>\n )}\n\n {/* Metadata */}\n <Card>\n <CardHeader>\n <CardTitle>{t('afterActions.metadata')}</CardTitle>\n </CardHeader>\n <CardContent className=\"space-y-2 text-sm\">\n <div className=\"flex items-center justify-between\">\n <span className=\"text-muted-foreground\">{t('afterActions.createdAt')}</span>\n <span>{format(new Date(afterAction.created_at), 'PPp', { locale })}</span>\n </div>\n {afterAction.updated_at && (\n <div className=\"flex items-center justify-between\">\n <span className=\"text-muted-foreground\">{t('afterActions.updatedAt')}</span>\n <span>{format(new Date(afterAction.updated_at), 'PPp', { locale })}</span>\n </div>\n )}\n {afterAction.published_at && (\n <div className=\"flex items-center justify-between\">\n <span className=\"text-muted-foreground\">{t('afterActions.publishedAt')}</span>\n <span>{format(new Date(afterAction.published_at), 'PPp', { locale })}</span>\n </div>\n )}\n <div className=\"flex items-center justify-between\">\n <span className=\"text-muted-foreground\">{t('afterActions.version')}</span>\n <span>v{afterAction.version}</span>\n </div>\n </CardContent>\n </Card>\n </div>\n </div>\n );\n}\n","/**\n * Route: /admin/system\n * Admin system utilities and maintenance\n */\n\nimport { createFileRoute } from '@tanstack/react-router';\nimport { useState, useEffect, useRef } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport { Progress } from '@/components/ui/progress';\nimport { useMutation } from '@tanstack/react-query';\nimport { supabase } from '@/lib/supabase';\nimport { \n  Settings, \n  Globe, \n  RefreshCw, \n  CheckCircle2, \n  XCircle, \n  AlertCircle,\n  Database,\n  Download\n} from 'lucide-react';\nimport { Skeleton } from '@/components/ui/skeleton';\n\nexport const Route = createFileRoute('/_protected/admin/system')({\n  component: AdminSystemPage,\n  beforeLoad: async () => {\n    // Check admin role\n    const { data: { session } } = await supabase.auth.getSession();\n    const user = session?.user;\n    const isAdmin = user?.user_metadata?.role === 'admin' || user?.app_metadata?.role === 'admin';\n\n    if (!isAdmin) {\n      throw new Error('Admin access required');\n    }\n  },\n});\n\nconst API_BASE_URL = import.meta.env.VITE_SUPABASE_URL + '/functions/v1';\n\ninterface PopulateCountriesResponse {\n  success: boolean;\n  progress_id?: string;\n  summary: {\n    total: number;\n    processed: number;\n    successful: number;\n    failed: number;\n  };\n  errors?: string[];\n  message_en: string;\n  message_ar: string;\n  error?: string;\n}\n\ninterface ProgressData {\n  id: string;\n  operation_type: string;\n  total_items: number;\n  processed_items: number;\n  successful_items: number;\n  failed_items: number;\n  status: 'running' | 'completed' | 'failed';\n  percentage: number;\n  is_complete: boolean;\n}\n\nasync function populateCountries(): Promise<PopulateCountriesResponse> {\n  const { data: { session } } = await supabase.auth.getSession();\n  \n  const response = await fetch(`${API_BASE_URL}/populate-countries-v2`, {\n    method: 'POST',\n    headers: {\n      'Authorization': `Bearer ${session?.access_token}`,\n      'Content-Type': 'application/json',\n    },\n  });\n\n  if (!response.ok) {\n    const error = await response.json();\n    throw new Error(error.message_en || error.error || 'Failed to populate countries');\n  }\n\n  return response.json();\n}\n\nasync function fetchProgress(progressId: string): Promise<ProgressData> {\n  const { data: { session } } = await supabase.auth.getSession();\n  \n  const response = await fetch(`${API_BASE_URL}/operation-progress?id=${progressId}`, {\n    method: 'GET',\n    headers: {\n      'Authorization': `Bearer ${session?.access_token}`,\n    },\n  });\n\n  if (!response.ok) {\n    throw new Error('Failed to fetch progress');\n  }\n\n  const data = await response.json();\n  return data.progress;\n}\n\nfunction AdminSystemPage() {\n  const { t, i18n } = useTranslation('admin');\n  const isRTL = i18n.language === 'ar';\n  const [result, setResult] = useState<PopulateCountriesResponse | null>(null);\n  const [progress, setProgress] = useState<ProgressData | null>(null);\n  const [progressId, setProgressId] = useState<string | null>(null);\n  const pollingIntervalRef = useRef<NodeJS.Timeout | null>(null);\n\n  const populateMutation = useMutation({\n    mutationFn: populateCountries,\n    onSuccess: (data) => {\n      if (data.progress_id) {\n        setProgressId(data.progress_id);\n        // Start polling for progress\n        startProgressPolling(data.progress_id);\n      } else {\n        // If no progress_id, operation completed immediately\n        setResult(data);\n      }\n    },\n    onError: (error: Error) => {\n      setResult({\n        success: false,\n        summary: { total: 0, processed: 0, successful: 0, failed: 1 },\n        message_en: error.message,\n        message_ar: '    ',\n        error: error.message,\n      });\n      stopProgressPolling();\n    },\n  });\n\n  // Poll for progress updates\n  const startProgressPolling = (id: string) => {\n    // Clear any existing interval\n    stopProgressPolling();\n\n    // Poll immediately\n    pollProgress(id);\n\n    // Then poll every 2 seconds\n    pollingIntervalRef.current = setInterval(() => {\n      pollProgress(id);\n    }, 2000);\n  };\n\n  const stopProgressPolling = () => {\n    if (pollingIntervalRef.current) {\n      clearInterval(pollingIntervalRef.current);\n      pollingIntervalRef.current = null;\n    }\n  };\n\n  const pollProgress = async (id: string) => {\n    try {\n      const progressData = await fetchProgress(id);\n      setProgress(progressData);\n\n      // If completed, stop polling and show final result\n      if (progressData.is_complete) {\n        stopProgressPolling();\n        setResult({\n          success: progressData.status === 'completed',\n          summary: {\n            total: progressData.total_items,\n            processed: progressData.processed_items,\n            successful: progressData.successful_items,\n            failed: progressData.failed_items,\n          },\n          message_en: `Successfully processed ${progressData.successful_items} countries`,\n          message_ar: `  ${progressData.successful_items}  `,\n        });\n      }\n    } catch (error) {\n      console.error('Failed to fetch progress:', error);\n      // Don't stop polling on error, might be temporary\n    }\n  };\n\n  // Cleanup polling on unmount\n  useEffect(() => {\n    return () => {\n      stopProgressPolling();\n    };\n  }, []);\n\n  const handlePopulateCountries = () => {\n    setResult(null);\n    setProgress(null);\n    setProgressId(null);\n    populateMutation.mutate();\n  };\n\n  return (\n    <div className=\"container mx-auto py-6 space-y-6\" dir={isRTL ? 'rtl' : 'ltr'}>\n      {/* Header */}\n      <div className=\"flex items-center gap-3\">\n        <div className=\"p-3 bg-primary/10 rounded-lg\">\n          <Settings className=\"h-6 w-6 text-primary\" />\n        </div>\n        <div>\n          <h1 className=\"text-3xl font-bold\">\n            {t('system.title', 'System Utilities')}\n          </h1>\n          <p className=\"text-muted-foreground\">\n            {t('system.subtitle', 'Maintenance and data management tools')}\n          </p>\n        </div>\n      </div>\n\n      {/* Warning Banner */}\n      <Alert variant=\"default\" className=\"border-yellow-500 bg-yellow-50 dark:bg-yellow-900/20\">\n        <AlertCircle className=\"h-5 w-5 text-yellow-600 dark:text-yellow-400\" />\n        <AlertDescription className=\"text-yellow-800 dark:text-yellow-200\">\n          <p className=\"font-medium\">\n            {t('system.warning', 'Admin Privileges Active')}\n          </p>\n          <p className=\"text-sm mt-1\">\n            {t('system.warningText', 'These operations modify system data. Use with caution.')}\n          </p>\n        </AlertDescription>\n      </Alert>\n\n      {/* Countries Population Card */}\n      <Card>\n        <CardHeader>\n          <div className=\"flex items-start justify-between\">\n            <div className=\"flex items-center gap-3\">\n              <div className=\"p-2 bg-emerald-100 dark:bg-emerald-900 rounded-lg\">\n                <Globe className=\"h-5 w-5 text-emerald-600 dark:text-emerald-400\" />\n              </div>\n              <div>\n                <CardTitle className=\"text-xl\">\n                  {t('system.populateCountries.title', 'Populate Country Data')}\n                </CardTitle>\n                <CardDescription>\n                  {t('system.populateCountries.description', 'Fetch and update geographic data for all countries from REST Countries API')}\n                </CardDescription>\n              </div>\n            </div>\n          </div>\n        </CardHeader>\n\n        <CardContent className=\"space-y-4\">\n          {/* Information */}\n          <div className=\"space-y-2\">\n            <h3 className=\"text-sm font-medium\">\n              {t('system.populateCountries.whatIsIncluded', 'What will be updated:')}\n            </h3>\n            <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-2 text-sm text-muted-foreground\">\n              <div className=\"flex items-center gap-2\">\n                <CheckCircle2 className=\"h-4 w-4 text-emerald-600\" />\n                <span>{t('system.populateCountries.isoCodes', 'ISO Codes (2 & 3 letter)')}</span>\n              </div>\n              <div className=\"flex items-center gap-2\">\n                <CheckCircle2 className=\"h-4 w-4 text-emerald-600\" />\n                <span>{t('system.populateCountries.capitals', 'Capital Cities')}</span>\n              </div>\n              <div className=\"flex items-center gap-2\">\n                <CheckCircle2 className=\"h-4 w-4 text-emerald-600\" />\n                <span>{t('system.populateCountries.regions', 'Regions & Subregions')}</span>\n              </div>\n              <div className=\"flex items-center gap-2\">\n                <CheckCircle2 className=\"h-4 w-4 text-emerald-600\" />\n                <span>{t('system.populateCountries.population', 'Population Data')}</span>\n              </div>\n              <div className=\"flex items-center gap-2\">\n                <CheckCircle2 className=\"h-4 w-4 text-emerald-600\" />\n                <span>{t('system.populateCountries.area', 'Area (km)')}</span>\n              </div>\n              <div className=\"flex items-center gap-2\">\n                <CheckCircle2 className=\"h-4 w-4 text-emerald-600\" />\n                <span>{t('system.populateCountries.flags', 'Flag URLs')}</span>\n              </div>\n            </div>\n          </div>\n\n          {/* Data Source Badge */}\n          <div className=\"flex items-center gap-2\">\n            <Database className=\"h-4 w-4 text-muted-foreground\" />\n            <span className=\"text-sm text-muted-foreground\">\n              {t('system.populateCountries.dataSource', 'Data Source:')}\n            </span>\n            <Badge variant=\"secondary\" className=\"gap-1\">\n              <Download className=\"h-3 w-3\" />\n              REST Countries API\n            </Badge>\n            <span className=\"text-xs text-muted-foreground\">\n              ({t('system.populateCountries.countriesCount', '~250 countries')})\n            </span>\n          </div>\n\n          {/* Action Button */}\n          <Button\n            onClick={handlePopulateCountries}\n            disabled={populateMutation.isPending}\n            size=\"lg\"\n            className=\"w-full sm:w-auto\"\n          >\n            {populateMutation.isPending ? (\n              <>\n                <RefreshCw className=\"h-4 w-4 animate-spin\" />\n                <span>{t('system.populateCountries.processing', 'Processing...')}</span>\n              </>\n            ) : (\n              <>\n                <RefreshCw className=\"h-4 w-4\" />\n                <span>{t('system.populateCountries.updateButton', 'Update Country Data')}</span>\n              </>\n            )}\n          </Button>\n\n          {/* Progress Indicator with Real-time Updates */}\n          {(populateMutation.isPending || progress) && !result && (\n            <div className=\"space-y-3 p-4 bg-muted/30 rounded-lg border\">\n              <div className=\"flex items-center justify-between text-sm\">\n                <span className=\"text-muted-foreground font-medium\">\n                  {progress && progress.processed_items > 0 ? (\n                    <>\n                      {t('system.populateCountries.processing', 'Processing')}:{' '}\n                      <span className=\"font-bold text-foreground\">\n                        {progress.processed_items}/{progress.total_items}\n                      </span>\n                      {' '}\n                      {t('system.populateCountries.countries', 'countries')}\n                    </>\n                  ) : (\n                    t('system.populateCountries.fetching', 'Fetching and updating countries...')\n                  )}\n                </span>\n                {progress && (\n                  <span className=\"text-lg font-bold text-emerald-600\">\n                    {progress.percentage}%\n                  </span>\n                )}\n              </div>\n              \n              {/* Progress Bar */}\n              <div className=\"relative\">\n                <Progress \n                  value={progress?.percentage || 0} \n                  className=\"w-full h-3\"\n                />\n              </div>\n\n              {/* Progress Details */}\n              {progress && (\n                <div className=\"grid grid-cols-3 gap-2 text-xs\">\n                  <div className=\"text-center p-2 bg-background rounded\">\n                    <div className=\"font-bold text-blue-600\">{progress.successful_items}</div>\n                    <div className=\"text-muted-foreground\">{t('system.populateCountries.successful', 'Successful')}</div>\n                  </div>\n                  <div className=\"text-center p-2 bg-background rounded\">\n                    <div className=\"font-bold text-yellow-600\">{progress.processed_items - progress.successful_items - progress.failed_items}</div>\n                    <div className=\"text-muted-foreground\">{t('system.populateCountries.pending', 'Pending')}</div>\n                  </div>\n                  <div className=\"text-center p-2 bg-background rounded\">\n                    <div className=\"font-bold text-red-600\">{progress.failed_items}</div>\n                    <div className=\"text-muted-foreground\">{t('system.populateCountries.failed', 'Failed')}</div>\n                  </div>\n                </div>\n              )}\n\n              <p className=\"text-xs text-muted-foreground text-center\">\n                {!progress && t('system.populateCountries.estimatedTime', 'This may take 2-3 minutes')}\n                {progress && progress.percentage < 100 && (\n                  <span className=\"flex items-center justify-center gap-1\">\n                    <RefreshCw className=\"h-3 w-3 animate-spin inline\" />\n                    {t('system.populateCountries.inProgress', 'Operation in progress...')}\n                  </span>\n                )}\n              </p>\n            </div>\n          )}\n\n          {/* Results */}\n          {result && (\n            <Alert\n              variant={result.success ? 'default' : 'destructive'}\n              className={result.success ? 'border-emerald-500 bg-emerald-50 dark:bg-emerald-900/20' : ''}\n            >\n              {result.success ? (\n                <CheckCircle2 className=\"h-5 w-5 text-emerald-600 dark:text-emerald-400\" />\n              ) : (\n                <XCircle className=\"h-5 w-5\" />\n              )}\n              <AlertDescription>\n                <div className=\"space-y-3\">\n                  {/* Message */}\n                  <p className={result.success ? 'text-emerald-800 dark:text-emerald-200 font-medium' : 'font-medium'}>\n                    {isRTL ? result.message_ar : result.message_en}\n                  </p>\n\n                  {/* Summary Stats */}\n                  {result.success && result.summary && (\n                    <div className=\"grid grid-cols-2 sm:grid-cols-4 gap-3 pt-2\">\n                      <div className=\"text-center p-2 bg-background rounded\">\n                        <div className=\"text-2xl font-bold text-emerald-600\">\n                          {result.summary.total}\n                        </div>\n                        <div className=\"text-xs text-muted-foreground\">\n                          {t('system.populateCountries.total', 'Total')}\n                        </div>\n                      </div>\n                      <div className=\"text-center p-2 bg-background rounded\">\n                        <div className=\"text-2xl font-bold text-blue-600\">\n                          {result.summary.processed}\n                        </div>\n                        <div className=\"text-xs text-muted-foreground\">\n                          {t('system.populateCountries.processed', 'Processed')}\n                        </div>\n                      </div>\n                      <div className=\"text-center p-2 bg-background rounded\">\n                        <div className=\"text-2xl font-bold text-green-600\">\n                          {result.summary.successful}\n                        </div>\n                        <div className=\"text-xs text-muted-foreground\">\n                          {t('system.populateCountries.successful', 'Successful')}\n                        </div>\n                      </div>\n                      <div className=\"text-center p-2 bg-background rounded\">\n                        <div className={`text-2xl font-bold ${result.summary.failed > 0 ? 'text-red-600' : 'text-gray-400'}`}>\n                          {result.summary.failed}\n                        </div>\n                        <div className=\"text-xs text-muted-foreground\">\n                          {t('system.populateCountries.failed', 'Failed')}\n                        </div>\n                      </div>\n                    </div>\n                  )}\n\n                  {/* Error Details */}\n                  {result.errors && result.errors.length > 0 && (\n                    <details className=\"text-sm\">\n                      <summary className=\"cursor-pointer text-muted-foreground hover:text-foreground\">\n                        {t('system.populateCountries.viewErrors', 'View error details')} ({result.errors.length})\n                      </summary>\n                      <ul className=\"mt-2 space-y-1 text-xs max-h-40 overflow-y-auto\">\n                        {result.errors.map((error, idx) => (\n                          <li key={idx} className=\"flex items-start gap-2\">\n                            <XCircle className=\"h-3 w-3 mt-0.5 flex-shrink-0 text-red-500\" />\n                            <span>{error}</span>\n                          </li>\n                        ))}\n                      </ul>\n                    </details>\n                  )}\n                </div>\n              </AlertDescription>\n            </Alert>\n          )}\n\n          {/* Help Text */}\n          <div className=\"text-xs text-muted-foreground space-y-1 pt-2 border-t\">\n            <p>\n               {t('system.populateCountries.tip1', 'This operation is safe to run multiple times - it will update existing countries.')}\n            </p>\n            <p>\n               {t('system.populateCountries.tip2', 'Run this annually to keep population and area data up to date.')}\n            </p>\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n\n","/**\n * Skeleton Component\n *\n * Task: T096 [Polish]\n * Reusable loading skeleton components for async operations\n * Provides visual feedback during data loading\n */\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Skeleton({\n className,\n ...props\n}: React.HTMLAttributes<HTMLDivElement>) {\n return (\n <div\n className={cn(\"animate-pulse rounded-md bg-muted\", className)}\n {...props}\n />\n )\n}\n\n/**\n * SkeletonCard\n * Preset skeleton for card layouts\n */\nfunction SkeletonCard() {\n return (\n <div className=\"space-y-3 p-4 sm:p-6 rounded-lg border border-border bg-card\">\n <div className=\"flex items-start gap-3\">\n <Skeleton className=\"h-5 w-5\" />\n <div className=\"flex-1 space-y-2\">\n <Skeleton className=\"h-5 w-3/4\" />\n <Skeleton className=\"h-4 w-full\" />\n <Skeleton className=\"h-4 w-2/3\" />\n </div>\n </div>\n </div>\n )\n}\n\n/**\n * SkeletonText\n * Preset skeleton for text lines\n */\nfunction SkeletonText({ lines = 3 }: { lines?: number }) {\n return (\n <div className=\"space-y-2\">\n {Array.from({ length: lines }).map((_, i) => (\n <Skeleton\n key={i}\n className={cn(\n \"h-4\",\n i === lines - 1 ? \"w-2/3\" : \"w-full\"\n )}\n />\n ))}\n </div>\n )\n}\n\n/**\n * SkeletonTable\n * Preset skeleton for table rows\n */\nfunction SkeletonTable({ rows = 5, columns = 4 }: { rows?: number; columns?: number }) {\n return (\n <div className=\"space-y-3\">\n {/* Header */}\n <div className=\"flex gap-4 pb-3 border-b\">\n {Array.from({ length: columns }).map((_, i) => (\n <Skeleton key={i} className=\"h-5 flex-1\" />\n ))}\n </div>\n {/* Rows */}\n {Array.from({ length: rows }).map((_, rowIdx) => (\n <div key={rowIdx} className=\"flex gap-4\">\n {Array.from({ length: columns }).map((_, colIdx) => (\n <Skeleton key={colIdx} className=\"h-9 flex-1\" />\n ))}\n </div>\n ))}\n </div>\n )\n}\n\n/**\n * SkeletonAvatar\n * Preset skeleton for avatar/profile images\n */\nfunction SkeletonAvatar({ size = \"md\" }: { size?: \"sm\" | \"md\" | \"lg\" }) {\n const sizeClasses = {\n sm: \"h-8 w-8\",\n md: \"h-10 w-10\",\n lg: \"h-12 w-12\"\n }\n\n return <Skeleton className={cn(\"rounded-full\", sizeClasses[size])} />\n}\n\n/**\n * SkeletonButton\n * Preset skeleton for button loading state\n */\nfunction SkeletonButton({ size = \"md\" }: { size?: \"sm\" | \"md\" | \"lg\" }) {\n const sizeClasses = {\n sm: \"h-9 w-20\",\n md: \"h-10 w-24\",\n lg: \"h-11 w-28\"\n }\n\n return <Skeleton className={cn(\"rounded-md\", sizeClasses[size])} />\n}\n\nexport {\n Skeleton,\n SkeletonCard,\n SkeletonText,\n SkeletonTable,\n SkeletonAvatar,\n SkeletonButton\n}\n","import * as React from 'react'\nimport * as TabsPrimitive from '@radix-ui/react-tabs'\n\nimport { cn } from '@/lib/utils'\n\nconst Tabs = TabsPrimitive.Root\n\nconst TabsList = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.List\n    ref={ref}\n    className={cn(\n      'inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground',\n      className,\n    )}\n    {...props}\n  />\n))\nTabsList.displayName = TabsPrimitive.List.displayName\n\nconst TabsTrigger = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      'inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm bidi-isolate',\n      className,\n    )}\n    {...props}\n  />\n))\nTabsTrigger.displayName = TabsPrimitive.Trigger.displayName\n\nconst TabsContent = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Content\n    ref={ref}\n    className={cn(\n      'mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2',\n      className,\n    )}\n    {...props}\n  />\n))\nTabsContent.displayName = TabsPrimitive.Content.displayName\n\nexport { Tabs, TabsList, TabsTrigger, TabsContent }\n","import * as React from \"react\"\nimport * as SwitchPrimitives from \"@radix-ui/react-switch\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Switch = React.forwardRef<\n React.ElementRef<typeof SwitchPrimitives.Root>,\n React.ComponentPropsWithoutRef<typeof SwitchPrimitives.Root>\n>(({ className, ...props }, ref) => (\n <SwitchPrimitives.Root\n className={cn(\n \"peer inline-flex h-5 w-9 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input\",\n className\n )}\n {...props}\n ref={ref}\n >\n <SwitchPrimitives.Thumb\n className={cn(\n \"pointer-events-none block h-4 w-4 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-4 data-[state=unchecked]:translate-x-0\"\n )}\n />\n </SwitchPrimitives.Root>\n))\nSwitch.displayName = SwitchPrimitives.Root.displayName\n\nexport { Switch }","/**\n * Data Retention Policies Hook\n * Feature: data-retention-policies\n *\n * TanStack Query hooks for data retention policy management:\n * - List/create/update retention policies\n * - Manage legal holds\n * - View retention statistics\n * - Execute retention processor\n */\n\nimport { useMutation, useQuery, useQueryClient, type UseQueryOptions } from '@tanstack/react-query'\nimport { useTranslation } from 'react-i18next'\nimport { toast } from 'sonner'\nimport { supabase } from '@/lib/supabase'\nimport type {\n  RetentionPolicy,\n  RetentionPolicyInput,\n  RetentionPolicyFilters,\n  RetentionPolicyListResponse,\n  RetentionPolicyResponse,\n  LegalHold,\n  LegalHoldInput,\n  LegalHoldFilters,\n  LegalHoldListResponse,\n  LegalHoldResponse,\n  RetentionStatistics,\n  RetentionStatisticsResponse,\n  PendingRetentionAction,\n  PendingActionsResponse,\n  PendingActionsFilters,\n  ExpiringEntity,\n  ExpiringEntitiesResponse,\n  ExpiringEntitiesFilters,\n  RetentionExecutionLog,\n  ExecutionLogResponse,\n  ProcessorConfig,\n  ProcessorResultResponse,\n  RetentionEntityType,\n  DocumentClass,\n} from '@/types/retention-policy.types'\n\n// API Base URL\nconst API_BASE_URL = import.meta.env.VITE_SUPABASE_URL + '/functions/v1'\n\n// ============================================================================\n// Query Keys\n// ============================================================================\n\nexport const retentionPolicyKeys = {\n  all: ['retention-policies'] as const,\n  policies: () => [...retentionPolicyKeys.all, 'policies'] as const,\n  policyList: (filters?: RetentionPolicyFilters) => [...retentionPolicyKeys.policies(), filters] as const,\n  policyDetail: (id: string) => [...retentionPolicyKeys.policies(), 'detail', id] as const,\n  legalHolds: () => [...retentionPolicyKeys.all, 'legal-holds'] as const,\n  legalHoldList: (filters?: LegalHoldFilters) => [...retentionPolicyKeys.legalHolds(), filters] as const,\n  legalHoldDetail: (id: string) => [...retentionPolicyKeys.legalHolds(), 'detail', id] as const,\n  statistics: () => [...retentionPolicyKeys.all, 'statistics'] as const,\n  pendingActions: (filters?: PendingActionsFilters) => [...retentionPolicyKeys.all, 'pending', filters] as const,\n  expiring: (filters?: ExpiringEntitiesFilters) => [...retentionPolicyKeys.all, 'expiring', filters] as const,\n  executionLog: () => [...retentionPolicyKeys.all, 'execution-log'] as const,\n}\n\n// ============================================================================\n// Auth Helper\n// ============================================================================\n\nconst getAuthHeaders = async () => {\n  const { data: { session } } = await supabase.auth.getSession()\n  return {\n    'Content-Type': 'application/json',\n    Authorization: `Bearer ${session?.access_token}`,\n  }\n}\n\n// ============================================================================\n// Retention Policies Hooks\n// ============================================================================\n\n/**\n * Hook to list retention policies\n */\nexport function useRetentionPolicies(\n  filters?: RetentionPolicyFilters,\n  options?: Omit<UseQueryOptions<RetentionPolicy[], Error>, 'queryKey' | 'queryFn'>\n) {\n  return useQuery({\n    queryKey: retentionPolicyKeys.policyList(filters),\n    queryFn: async (): Promise<RetentionPolicy[]> => {\n      const headers = await getAuthHeaders()\n      const searchParams = new URLSearchParams()\n\n      if (filters?.status) searchParams.set('status', filters.status)\n      if (filters?.entity_type) searchParams.set('entity_type', filters.entity_type)\n      if (filters?.document_class) searchParams.set('document_class', filters.document_class)\n\n      const response = await fetch(`${API_BASE_URL}/data-retention/policies?${searchParams}`, { headers })\n\n      if (!response.ok) {\n        const error = await response.json()\n        throw new Error(error.error?.message_en || 'Failed to fetch retention policies')\n      }\n\n      const result: RetentionPolicyListResponse = await response.json()\n      return result.data\n    },\n    staleTime: 60_000,\n    gcTime: 5 * 60_000,\n    ...options,\n  })\n}\n\n/**\n * Hook to get a single retention policy\n */\nexport function useRetentionPolicy(\n  id: string,\n  options?: Omit<UseQueryOptions<RetentionPolicy, Error>, 'queryKey' | 'queryFn'>\n) {\n  return useQuery({\n    queryKey: retentionPolicyKeys.policyDetail(id),\n    queryFn: async (): Promise<RetentionPolicy> => {\n      const headers = await getAuthHeaders()\n      const response = await fetch(`${API_BASE_URL}/data-retention/policies/${id}`, { headers })\n\n      if (!response.ok) {\n        const error = await response.json()\n        throw new Error(error.error?.message_en || 'Failed to fetch retention policy')\n      }\n\n      const result: RetentionPolicyResponse = await response.json()\n      return result.data\n    },\n    enabled: !!id,\n    staleTime: 60_000,\n    ...options,\n  })\n}\n\n/**\n * Hook to create a retention policy\n */\nexport function useCreateRetentionPolicy() {\n  const queryClient = useQueryClient()\n  const { t } = useTranslation('retention-policies')\n\n  return useMutation({\n    mutationFn: async (data: RetentionPolicyInput): Promise<RetentionPolicy> => {\n      const headers = await getAuthHeaders()\n      const response = await fetch(`${API_BASE_URL}/data-retention/policies`, {\n        method: 'POST',\n        headers,\n        body: JSON.stringify(data),\n      })\n\n      if (!response.ok) {\n        const error = await response.json()\n        throw new Error(error.error?.message_en || 'Failed to create retention policy')\n      }\n\n      const result: RetentionPolicyResponse = await response.json()\n      return result.data\n    },\n    onSuccess: (data) => {\n      queryClient.invalidateQueries({ queryKey: retentionPolicyKeys.policies() })\n      toast.success(t('messages.policyCreated', { name: data.name_en }))\n    },\n    onError: (error: Error) => {\n      toast.error(t('messages.policyCreateError', { error: error.message }))\n    },\n  })\n}\n\n/**\n * Hook to update a retention policy\n */\nexport function useUpdateRetentionPolicy() {\n  const queryClient = useQueryClient()\n  const { t } = useTranslation('retention-policies')\n\n  return useMutation({\n    mutationFn: async ({ id, updates }: { id: string; updates: Partial<RetentionPolicyInput> }): Promise<RetentionPolicy> => {\n      const headers = await getAuthHeaders()\n      const response = await fetch(`${API_BASE_URL}/data-retention/policies/${id}`, {\n        method: 'PATCH',\n        headers,\n        body: JSON.stringify(updates),\n      })\n\n      if (!response.ok) {\n        const error = await response.json()\n        throw new Error(error.error?.message_en || 'Failed to update retention policy')\n      }\n\n      const result: RetentionPolicyResponse = await response.json()\n      return result.data\n    },\n    onSuccess: (data, { id }) => {\n      queryClient.setQueryData(retentionPolicyKeys.policyDetail(id), data)\n      queryClient.invalidateQueries({ queryKey: retentionPolicyKeys.policies() })\n      toast.success(t('messages.policyUpdated'))\n    },\n    onError: (error: Error) => {\n      toast.error(t('messages.policyUpdateError', { error: error.message }))\n    },\n  })\n}\n\n/**\n * Hook to archive (soft delete) a retention policy\n */\nexport function useArchiveRetentionPolicy() {\n  const queryClient = useQueryClient()\n  const { t } = useTranslation('retention-policies')\n\n  return useMutation({\n    mutationFn: async (id: string): Promise<void> => {\n      const headers = await getAuthHeaders()\n      const response = await fetch(`${API_BASE_URL}/data-retention/policies/${id}`, {\n        method: 'DELETE',\n        headers,\n      })\n\n      if (!response.ok) {\n        const error = await response.json()\n        throw new Error(error.error?.message_en || 'Failed to archive retention policy')\n      }\n    },\n    onSuccess: (_, id) => {\n      queryClient.removeQueries({ queryKey: retentionPolicyKeys.policyDetail(id) })\n      queryClient.invalidateQueries({ queryKey: retentionPolicyKeys.policies() })\n      toast.success(t('messages.policyArchived'))\n    },\n    onError: (error: Error) => {\n      toast.error(t('messages.policyArchiveError', { error: error.message }))\n    },\n  })\n}\n\n// ============================================================================\n// Legal Holds Hooks\n// ============================================================================\n\n/**\n * Hook to list legal holds\n */\nexport function useLegalHolds(\n  filters?: LegalHoldFilters,\n  options?: Omit<UseQueryOptions<LegalHold[], Error>, 'queryKey' | 'queryFn'>\n) {\n  return useQuery({\n    queryKey: retentionPolicyKeys.legalHoldList(filters),\n    queryFn: async (): Promise<LegalHold[]> => {\n      const headers = await getAuthHeaders()\n      const searchParams = new URLSearchParams()\n\n      if (filters?.status) searchParams.set('status', filters.status)\n\n      const response = await fetch(`${API_BASE_URL}/data-retention/legal-holds?${searchParams}`, { headers })\n\n      if (!response.ok) {\n        const error = await response.json()\n        throw new Error(error.error?.message_en || 'Failed to fetch legal holds')\n      }\n\n      const result: LegalHoldListResponse = await response.json()\n      return result.data\n    },\n    staleTime: 60_000,\n    ...options,\n  })\n}\n\n/**\n * Hook to get a single legal hold\n */\nexport function useLegalHold(\n  id: string,\n  options?: Omit<UseQueryOptions<LegalHold, Error>, 'queryKey' | 'queryFn'>\n) {\n  return useQuery({\n    queryKey: retentionPolicyKeys.legalHoldDetail(id),\n    queryFn: async (): Promise<LegalHold> => {\n      const headers = await getAuthHeaders()\n      const response = await fetch(`${API_BASE_URL}/data-retention/legal-holds/${id}`, { headers })\n\n      if (!response.ok) {\n        const error = await response.json()\n        throw new Error(error.error?.message_en || 'Failed to fetch legal hold')\n      }\n\n      const result: LegalHoldResponse = await response.json()\n      return result.data\n    },\n    enabled: !!id,\n    staleTime: 60_000,\n    ...options,\n  })\n}\n\n/**\n * Hook to create a legal hold\n */\nexport function useCreateLegalHold() {\n  const queryClient = useQueryClient()\n  const { t } = useTranslation('retention-policies')\n\n  return useMutation({\n    mutationFn: async (data: LegalHoldInput): Promise<LegalHold> => {\n      const headers = await getAuthHeaders()\n      const response = await fetch(`${API_BASE_URL}/data-retention/legal-holds`, {\n        method: 'POST',\n        headers,\n        body: JSON.stringify(data),\n      })\n\n      if (!response.ok) {\n        const error = await response.json()\n        throw new Error(error.error?.message_en || 'Failed to create legal hold')\n      }\n\n      const result: LegalHoldResponse = await response.json()\n      return result.data\n    },\n    onSuccess: (data) => {\n      queryClient.invalidateQueries({ queryKey: retentionPolicyKeys.legalHolds() })\n      queryClient.invalidateQueries({ queryKey: retentionPolicyKeys.statistics() })\n      toast.success(t('messages.legalHoldCreated', { name: data.name_en }))\n    },\n    onError: (error: Error) => {\n      toast.error(t('messages.legalHoldCreateError', { error: error.message }))\n    },\n  })\n}\n\n/**\n * Hook to update a legal hold\n */\nexport function useUpdateLegalHold() {\n  const queryClient = useQueryClient()\n  const { t } = useTranslation('retention-policies')\n\n  return useMutation({\n    mutationFn: async ({ id, updates }: { id: string; updates: Partial<LegalHoldInput> }): Promise<LegalHold> => {\n      const headers = await getAuthHeaders()\n      const response = await fetch(`${API_BASE_URL}/data-retention/legal-holds/${id}`, {\n        method: 'PATCH',\n        headers,\n        body: JSON.stringify(updates),\n      })\n\n      if (!response.ok) {\n        const error = await response.json()\n        throw new Error(error.error?.message_en || 'Failed to update legal hold')\n      }\n\n      const result: LegalHoldResponse = await response.json()\n      return result.data\n    },\n    onSuccess: (data, { id }) => {\n      queryClient.setQueryData(retentionPolicyKeys.legalHoldDetail(id), data)\n      queryClient.invalidateQueries({ queryKey: retentionPolicyKeys.legalHolds() })\n      toast.success(t('messages.legalHoldUpdated'))\n    },\n    onError: (error: Error) => {\n      toast.error(t('messages.legalHoldUpdateError', { error: error.message }))\n    },\n  })\n}\n\n/**\n * Hook to release a legal hold\n */\nexport function useReleaseLegalHold() {\n  const queryClient = useQueryClient()\n  const { t } = useTranslation('retention-policies')\n\n  return useMutation({\n    mutationFn: async (id: string): Promise<{ affected_count: number }> => {\n      const headers = await getAuthHeaders()\n      const response = await fetch(`${API_BASE_URL}/data-retention/release-hold`, {\n        method: 'POST',\n        headers,\n        body: JSON.stringify({ legal_hold_id: id }),\n      })\n\n      if (!response.ok) {\n        const error = await response.json()\n        throw new Error(error.error?.message_en || 'Failed to release legal hold')\n      }\n\n      return response.json()\n    },\n    onSuccess: (data, id) => {\n      queryClient.invalidateQueries({ queryKey: retentionPolicyKeys.legalHoldDetail(id) })\n      queryClient.invalidateQueries({ queryKey: retentionPolicyKeys.legalHolds() })\n      queryClient.invalidateQueries({ queryKey: retentionPolicyKeys.statistics() })\n      toast.success(t('messages.legalHoldReleased', { count: data.affected_count }))\n    },\n    onError: (error: Error) => {\n      toast.error(t('messages.legalHoldReleaseError', { error: error.message }))\n    },\n  })\n}\n\n/**\n * Hook to delete a legal hold (only if not active)\n */\nexport function useDeleteLegalHold() {\n  const queryClient = useQueryClient()\n  const { t } = useTranslation('retention-policies')\n\n  return useMutation({\n    mutationFn: async (id: string): Promise<void> => {\n      const headers = await getAuthHeaders()\n      const response = await fetch(`${API_BASE_URL}/data-retention/legal-holds/${id}`, {\n        method: 'DELETE',\n        headers,\n      })\n\n      if (!response.ok) {\n        const error = await response.json()\n        throw new Error(error.error?.message_en || 'Failed to delete legal hold')\n      }\n    },\n    onSuccess: (_, id) => {\n      queryClient.removeQueries({ queryKey: retentionPolicyKeys.legalHoldDetail(id) })\n      queryClient.invalidateQueries({ queryKey: retentionPolicyKeys.legalHolds() })\n      toast.success(t('messages.legalHoldDeleted'))\n    },\n    onError: (error: Error) => {\n      toast.error(t('messages.legalHoldDeleteError', { error: error.message }))\n    },\n  })\n}\n\n// ============================================================================\n// Statistics & Status Hooks\n// ============================================================================\n\n/**\n * Hook to get retention statistics\n */\nexport function useRetentionStatistics(\n  options?: Omit<UseQueryOptions<RetentionStatistics[], Error>, 'queryKey' | 'queryFn'>\n) {\n  return useQuery({\n    queryKey: retentionPolicyKeys.statistics(),\n    queryFn: async (): Promise<RetentionStatistics[]> => {\n      const headers = await getAuthHeaders()\n      const response = await fetch(`${API_BASE_URL}/data-retention/statistics`, { headers })\n\n      if (!response.ok) {\n        const error = await response.json()\n        throw new Error(error.error?.message_en || 'Failed to fetch retention statistics')\n      }\n\n      const result: RetentionStatisticsResponse = await response.json()\n      return result.data\n    },\n    staleTime: 30_000,\n    ...options,\n  })\n}\n\n/**\n * Hook to get pending retention actions\n */\nexport function usePendingRetentionActions(\n  filters?: PendingActionsFilters,\n  options?: Omit<UseQueryOptions<PendingRetentionAction[], Error>, 'queryKey' | 'queryFn'>\n) {\n  return useQuery({\n    queryKey: retentionPolicyKeys.pendingActions(filters),\n    queryFn: async (): Promise<PendingRetentionAction[]> => {\n      const headers = await getAuthHeaders()\n      const searchParams = new URLSearchParams()\n\n      if (filters?.entity_type) searchParams.set('entity_type', filters.entity_type)\n      if (filters?.action) searchParams.set('action', filters.action)\n      if (filters?.limit) searchParams.set('limit', String(filters.limit))\n\n      const response = await fetch(`${API_BASE_URL}/data-retention/pending-actions?${searchParams}`, { headers })\n\n      if (!response.ok) {\n        const error = await response.json()\n        throw new Error(error.error?.message_en || 'Failed to fetch pending actions')\n      }\n\n      const result: PendingActionsResponse = await response.json()\n      return result.data\n    },\n    staleTime: 30_000,\n    ...options,\n  })\n}\n\n/**\n * Hook to get expiring entities\n */\nexport function useExpiringEntities(\n  filters?: ExpiringEntitiesFilters,\n  options?: Omit<UseQueryOptions<ExpiringEntity[], Error>, 'queryKey' | 'queryFn'>\n) {\n  return useQuery({\n    queryKey: retentionPolicyKeys.expiring(filters),\n    queryFn: async (): Promise<ExpiringEntity[]> => {\n      const headers = await getAuthHeaders()\n      const searchParams = new URLSearchParams()\n\n      if (filters?.days) searchParams.set('days', String(filters.days))\n      if (filters?.entity_type) searchParams.set('entity_type', filters.entity_type)\n      if (filters?.limit) searchParams.set('limit', String(filters.limit))\n\n      const response = await fetch(`${API_BASE_URL}/data-retention/expiring?${searchParams}`, { headers })\n\n      if (!response.ok) {\n        const error = await response.json()\n        throw new Error(error.error?.message_en || 'Failed to fetch expiring entities')\n      }\n\n      const result: ExpiringEntitiesResponse = await response.json()\n      return result.data\n    },\n    staleTime: 30_000,\n    ...options,\n  })\n}\n\n/**\n * Hook to get execution log\n */\nexport function useRetentionExecutionLog(\n  options?: Omit<UseQueryOptions<RetentionExecutionLog[], Error>, 'queryKey' | 'queryFn'>\n) {\n  return useQuery({\n    queryKey: retentionPolicyKeys.executionLog(),\n    queryFn: async (): Promise<RetentionExecutionLog[]> => {\n      const headers = await getAuthHeaders()\n      const response = await fetch(`${API_BASE_URL}/data-retention/execution-log`, { headers })\n\n      if (!response.ok) {\n        const error = await response.json()\n        throw new Error(error.error?.message_en || 'Failed to fetch execution log')\n      }\n\n      const result: ExecutionLogResponse = await response.json()\n      return result.data\n    },\n    staleTime: 60_000,\n    ...options,\n  })\n}\n\n// ============================================================================\n// Processor Hooks\n// ============================================================================\n\n/**\n * Hook to run the retention processor\n */\nexport function useRunRetentionProcessor() {\n  const queryClient = useQueryClient()\n  const { t } = useTranslation('retention-policies')\n\n  return useMutation({\n    mutationFn: async (config: ProcessorConfig): Promise<ProcessorResultResponse['data']> => {\n      const headers = await getAuthHeaders()\n      const response = await fetch(`${API_BASE_URL}/retention-processor`, {\n        method: 'POST',\n        headers,\n        body: JSON.stringify(config),\n      })\n\n      if (!response.ok) {\n        const error = await response.json()\n        throw new Error(error.error?.message_en || 'Failed to run retention processor')\n      }\n\n      const result: ProcessorResultResponse = await response.json()\n      return result.data\n    },\n    onSuccess: (data) => {\n      queryClient.invalidateQueries({ queryKey: retentionPolicyKeys.statistics() })\n      queryClient.invalidateQueries({ queryKey: retentionPolicyKeys.pendingActions() })\n      queryClient.invalidateQueries({ queryKey: retentionPolicyKeys.expiring() })\n      queryClient.invalidateQueries({ queryKey: retentionPolicyKeys.executionLog() })\n\n      const isDryRun = data.items_archived === 0 && data.items_deleted === 0 && data.items_anonymized === 0 && data.items_processed > 0\n\n      if (isDryRun) {\n        toast.info(t('messages.dryRunComplete', {\n          processed: data.items_processed,\n          archived: data.items_archived,\n          deleted: data.items_deleted,\n        }))\n      } else {\n        toast.success(t('messages.processorComplete', {\n          processed: data.items_processed,\n          archived: data.items_archived,\n          deleted: data.items_deleted,\n          warned: data.items_warned,\n        }))\n      }\n    },\n    onError: (error: Error) => {\n      toast.error(t('messages.processorError', { error: error.message }))\n    },\n  })\n}\n\n/**\n * Hook to apply retention policy to specific entity\n */\nexport function useApplyRetentionPolicy() {\n  const queryClient = useQueryClient()\n  const { t } = useTranslation('retention-policies')\n\n  return useMutation({\n    mutationFn: async (params: {\n      entity_type: RetentionEntityType\n      entity_id: string\n      document_class?: DocumentClass\n      sensitivity_level?: number\n      dossier_type?: string\n    }): Promise<{ status_id: string }> => {\n      const headers = await getAuthHeaders()\n      const response = await fetch(`${API_BASE_URL}/data-retention/apply-policy`, {\n        method: 'POST',\n        headers,\n        body: JSON.stringify(params),\n      })\n\n      if (!response.ok) {\n        const error = await response.json()\n        throw new Error(error.error?.message_en || 'Failed to apply retention policy')\n      }\n\n      return response.json()\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: retentionPolicyKeys.statistics() })\n      toast.success(t('messages.policyApplied'))\n    },\n    onError: (error: Error) => {\n      toast.error(t('messages.policyApplyError', { error: error.message }))\n    },\n  })\n}\n\n/**\n * Hook to set manual hold on entity\n */\nexport function useSetManualHold() {\n  const queryClient = useQueryClient()\n  const { t } = useTranslation('retention-policies')\n\n  return useMutation({\n    mutationFn: async (params: {\n      entity_type: RetentionEntityType\n      entity_id: string\n      reason: string\n      until?: string\n    }): Promise<{ data: unknown }> => {\n      const headers = await getAuthHeaders()\n      const response = await fetch(`${API_BASE_URL}/data-retention/manual-hold`, {\n        method: 'POST',\n        headers,\n        body: JSON.stringify(params),\n      })\n\n      if (!response.ok) {\n        const error = await response.json()\n        throw new Error(error.error?.message_en || 'Failed to set manual hold')\n      }\n\n      return response.json()\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: retentionPolicyKeys.statistics() })\n      toast.success(t('messages.manualHoldSet'))\n    },\n    onError: (error: Error) => {\n      toast.error(t('messages.manualHoldError', { error: error.message }))\n    },\n  })\n}\n\n// ============================================================================\n// Cache Invalidation Helper\n// ============================================================================\n\n/**\n * Hook to invalidate all retention policy queries\n */\nexport function useInvalidateRetentionPolicies() {\n  const queryClient = useQueryClient()\n\n  return () => {\n    queryClient.invalidateQueries({ queryKey: retentionPolicyKeys.all })\n  }\n}\n","/**\n * Route: /admin/data-retention\n * Data Retention Policies Administration\n * Feature: data-retention-policies\n *\n * Configurable retention policies for different entity types and document classes.\n * Includes legal hold support and policy execution.\n */\n\nimport { createFileRoute } from '@tanstack/react-router'\nimport { useState } from 'react'\nimport { useTranslation } from 'react-i18next'\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Button } from '@/components/ui/button'\nimport { Badge } from '@/components/ui/badge'\nimport { Input } from '@/components/ui/input'\nimport { Label } from '@/components/ui/label'\nimport { Skeleton } from '@/components/ui/skeleton'\nimport { Alert, AlertDescription, AlertTitle } from '@/components/ui/alert'\nimport { Separator } from '@/components/ui/separator'\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs'\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from '@/components/ui/select'\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from '@/components/ui/table'\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n} from '@/components/ui/dialog'\nimport { Textarea } from '@/components/ui/textarea'\nimport { Switch } from '@/components/ui/switch'\nimport { Progress } from '@/components/ui/progress'\nimport { supabase } from '@/lib/supabase'\nimport {\n  Shield,\n  Database,\n  Clock,\n  Archive,\n  Trash2,\n  AlertTriangle,\n  CheckCircle2,\n  Play,\n  Pause,\n  FileText,\n  Lock,\n  Unlock,\n  Plus,\n  Settings,\n  BarChart3,\n  History,\n  Calendar,\n  RefreshCw,\n} from 'lucide-react'\nimport {\n  useRetentionPolicies,\n  useRetentionStatistics,\n  usePendingRetentionActions,\n  useExpiringEntities,\n  useRetentionExecutionLog,\n  useLegalHolds,\n  useRunRetentionProcessor,\n  useCreateRetentionPolicy,\n  useUpdateRetentionPolicy,\n  useCreateLegalHold,\n  useReleaseLegalHold,\n} from '@/hooks/useRetentionPolicies'\nimport type {\n  RetentionPolicy,\n  RetentionPolicyInput,\n  LegalHold,\n  LegalHoldInput,\n  RetentionEntityType,\n  DocumentClass,\n  RetentionActionType,\n  ProcessorConfig,\n} from '@/types/retention-policy.types'\n\nexport const Route = createFileRoute('/_protected/admin/data-retention')({\n  component: DataRetentionPage,\n  beforeLoad: async () => {\n    const {\n      data: { session },\n    } = await supabase.auth.getSession()\n    const user = session?.user\n    const isAdmin = user?.user_metadata?.role === 'admin' || user?.app_metadata?.role === 'admin'\n    if (!isAdmin) {\n      throw new Error('Admin access required')\n    }\n  },\n})\n\n// Entity type options\nconst ENTITY_TYPES: Array<{ value: RetentionEntityType; label: string }> = [\n  { value: 'dossier', label: 'Dossiers' },\n  { value: 'intake_ticket', label: 'Intake Tickets' },\n  { value: 'document', label: 'Documents' },\n  { value: 'attachment', label: 'Attachments' },\n  { value: 'audit_log', label: 'Audit Logs' },\n  { value: 'ai_interaction_log', label: 'AI Interaction Logs' },\n  { value: 'commitment', label: 'Commitments' },\n  { value: 'after_action_record', label: 'After Action Records' },\n  { value: 'position', label: 'Positions' },\n  { value: 'engagement', label: 'Engagements' },\n  { value: 'calendar_event', label: 'Calendar Events' },\n  { value: 'notification', label: 'Notifications' },\n  { value: 'activity_feed', label: 'Activity Feed' },\n]\n\n// Document class options\nconst DOCUMENT_CLASSES: Array<{ value: DocumentClass; label: string }> = [\n  { value: 'operational', label: 'Operational' },\n  { value: 'regulatory', label: 'Regulatory' },\n  { value: 'legal', label: 'Legal' },\n  { value: 'correspondence', label: 'Correspondence' },\n  { value: 'financial', label: 'Financial' },\n  { value: 'personnel', label: 'Personnel' },\n  { value: 'research', label: 'Research' },\n  { value: 'archive_permanent', label: 'Permanent Archive' },\n]\n\n// Action type options\nconst RETENTION_ACTIONS: Array<{ value: RetentionActionType; label: string }> = [\n  { value: 'archive', label: 'Archive' },\n  { value: 'soft_delete', label: 'Soft Delete' },\n  { value: 'hard_delete', label: 'Hard Delete' },\n  { value: 'anonymize', label: 'Anonymize' },\n]\n\nfunction DataRetentionPage() {\n  const { t, i18n } = useTranslation('retention-policies')\n  const isRTL = i18n.language === 'ar'\n\n  // State\n  const [activeTab, setActiveTab] = useState('overview')\n  const [showPolicyDialog, setShowPolicyDialog] = useState(false)\n  const [showLegalHoldDialog, setShowLegalHoldDialog] = useState(false)\n  const [showProcessorDialog, setShowProcessorDialog] = useState(false)\n  const [selectedPolicy, setSelectedPolicy] = useState<RetentionPolicy | null>(null)\n\n  // Hooks\n  const { data: policies = [], isLoading: policiesLoading } = useRetentionPolicies({ status: 'active' })\n  const { data: statistics = [], isLoading: statsLoading } = useRetentionStatistics()\n  const { data: pendingActions = [], isLoading: pendingLoading } = usePendingRetentionActions({ limit: 10 })\n  const { data: expiringEntities = [], isLoading: expiringLoading } = useExpiringEntities({ days: 30, limit: 10 })\n  const { data: executionLog = [], isLoading: logLoading } = useRetentionExecutionLog()\n  const { data: legalHolds = [], isLoading: holdsLoading } = useLegalHolds({ status: 'active' })\n\n  // Mutations\n  const createPolicy = useCreateRetentionPolicy()\n  const updatePolicy = useUpdateRetentionPolicy()\n  const createLegalHold = useCreateLegalHold()\n  const releaseLegalHold = useReleaseLegalHold()\n  const runProcessor = useRunRetentionProcessor()\n\n  // Calculate summary stats\n  const totalPolicies = policies.length\n  const activeLegalHolds = legalHolds.filter((h) => h.status === 'active').length\n  const totalPendingActions = pendingActions.length\n  const totalExpiringSoon = expiringEntities.length\n  const entitiesUnderHold = statistics.reduce((sum, s) => sum + s.under_hold, 0)\n\n  // Format retention period\n  const formatRetentionPeriod = (days: number) => {\n    if (days === 0) return t('period.permanent', 'Permanent')\n    if (days >= 365) {\n      const years = Math.floor(days / 365)\n      return `${years} ${years === 1 ? t('period.year', 'Year') : t('period.years', 'Years')}`\n    }\n    return `${days} ${t('period.days', 'Days')}`\n  }\n\n  // Format action\n  const formatAction = (action: RetentionActionType) => {\n    const map: Record<RetentionActionType, string> = {\n      archive: t('action.archive', 'Archive'),\n      soft_delete: t('action.softDelete', 'Soft Delete'),\n      hard_delete: t('action.hardDelete', 'Hard Delete'),\n      anonymize: t('action.anonymize', 'Anonymize'),\n    }\n    return map[action] || action\n  }\n\n  // Get status badge color\n  const getStatusColor = (status: string) => {\n    switch (status) {\n      case 'active':\n        return 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-100'\n      case 'draft':\n        return 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-100'\n      case 'disabled':\n        return 'bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-100'\n      case 'released':\n        return 'bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-100'\n      default:\n        return 'bg-gray-100 text-gray-800'\n    }\n  }\n\n  return (\n    <div className=\"container mx-auto px-4 py-6 sm:py-8\" dir={isRTL ? 'rtl' : 'ltr'}>\n      {/* Header */}\n      <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6\">\n        <div>\n          <h1 className=\"text-2xl sm:text-3xl font-bold flex items-center gap-2\">\n            <Database className=\"h-7 w-7 text-primary\" />\n            {t('title', 'Data Retention Policies')}\n          </h1>\n          <p className=\"text-muted-foreground mt-1\">\n            {t('description', 'Configure data lifecycle, retention periods, and legal holds')}\n          </p>\n        </div>\n        <div className=\"flex items-center gap-3\">\n          <Button variant=\"outline\" onClick={() => setShowProcessorDialog(true)}>\n            <Play className=\"h-4 w-4 me-2\" />\n            {t('actions.runProcessor', 'Run Processor')}\n          </Button>\n          <Button onClick={() => setShowPolicyDialog(true)}>\n            <Plus className=\"h-4 w-4 me-2\" />\n            {t('actions.newPolicy', 'New Policy')}\n          </Button>\n        </div>\n      </div>\n\n      {/* Summary Cards */}\n      <div className=\"grid grid-cols-2 lg:grid-cols-5 gap-4 mb-6\">\n        <Card>\n          <CardContent className=\"pt-6\">\n            <div className=\"flex items-center gap-3\">\n              <div className=\"p-2 bg-primary/10 rounded-lg\">\n                <FileText className=\"h-5 w-5 text-primary\" />\n              </div>\n              <div>\n                <p className=\"text-2xl font-bold\">{totalPolicies}</p>\n                <p className=\"text-sm text-muted-foreground\">{t('stats.activePolicies', 'Active Policies')}</p>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardContent className=\"pt-6\">\n            <div className=\"flex items-center gap-3\">\n              <div className=\"p-2 bg-red-100 dark:bg-red-900/30 rounded-lg\">\n                <Lock className=\"h-5 w-5 text-red-600 dark:text-red-400\" />\n              </div>\n              <div>\n                <p className=\"text-2xl font-bold\">{activeLegalHolds}</p>\n                <p className=\"text-sm text-muted-foreground\">{t('stats.legalHolds', 'Legal Holds')}</p>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardContent className=\"pt-6\">\n            <div className=\"flex items-center gap-3\">\n              <div className=\"p-2 bg-yellow-100 dark:bg-yellow-900/30 rounded-lg\">\n                <Clock className=\"h-5 w-5 text-yellow-600 dark:text-yellow-400\" />\n              </div>\n              <div>\n                <p className=\"text-2xl font-bold\">{totalPendingActions}</p>\n                <p className=\"text-sm text-muted-foreground\">{t('stats.pendingActions', 'Pending Actions')}</p>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardContent className=\"pt-6\">\n            <div className=\"flex items-center gap-3\">\n              <div className=\"p-2 bg-orange-100 dark:bg-orange-900/30 rounded-lg\">\n                <AlertTriangle className=\"h-5 w-5 text-orange-600 dark:text-orange-400\" />\n              </div>\n              <div>\n                <p className=\"text-2xl font-bold\">{totalExpiringSoon}</p>\n                <p className=\"text-sm text-muted-foreground\">{t('stats.expiringSoon', 'Expiring Soon')}</p>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardContent className=\"pt-6\">\n            <div className=\"flex items-center gap-3\">\n              <div className=\"p-2 bg-blue-100 dark:bg-blue-900/30 rounded-lg\">\n                <Shield className=\"h-5 w-5 text-blue-600 dark:text-blue-400\" />\n              </div>\n              <div>\n                <p className=\"text-2xl font-bold\">{entitiesUnderHold}</p>\n                <p className=\"text-sm text-muted-foreground\">{t('stats.underHold', 'Under Hold')}</p>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Main Content Tabs */}\n      <Tabs value={activeTab} onValueChange={setActiveTab} className=\"space-y-6\">\n        <TabsList className=\"grid w-full grid-cols-2 sm:grid-cols-5 h-auto\">\n          <TabsTrigger value=\"overview\" className=\"gap-2 py-2\">\n            <BarChart3 className=\"h-4 w-4\" />\n            <span className=\"hidden sm:inline\">{t('tabs.overview', 'Overview')}</span>\n          </TabsTrigger>\n          <TabsTrigger value=\"policies\" className=\"gap-2 py-2\">\n            <Settings className=\"h-4 w-4\" />\n            <span className=\"hidden sm:inline\">{t('tabs.policies', 'Policies')}</span>\n          </TabsTrigger>\n          <TabsTrigger value=\"legal-holds\" className=\"gap-2 py-2\">\n            <Lock className=\"h-4 w-4\" />\n            <span className=\"hidden sm:inline\">{t('tabs.legalHolds', 'Legal Holds')}</span>\n          </TabsTrigger>\n          <TabsTrigger value=\"pending\" className=\"gap-2 py-2\">\n            <Clock className=\"h-4 w-4\" />\n            <span className=\"hidden sm:inline\">{t('tabs.pending', 'Pending')}</span>\n          </TabsTrigger>\n          <TabsTrigger value=\"history\" className=\"gap-2 py-2\">\n            <History className=\"h-4 w-4\" />\n            <span className=\"hidden sm:inline\">{t('tabs.history', 'History')}</span>\n          </TabsTrigger>\n        </TabsList>\n\n        {/* Overview Tab */}\n        <TabsContent value=\"overview\" className=\"space-y-6\">\n          <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n            {/* Statistics by Entity Type */}\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <BarChart3 className=\"h-5 w-5\" />\n                  {t('overview.byEntityType', 'Statistics by Entity Type')}\n                </CardTitle>\n              </CardHeader>\n              <CardContent>\n                {statsLoading ? (\n                  <div className=\"space-y-3\">\n                    {[1, 2, 3].map((i) => (\n                      <Skeleton key={i} className=\"h-12 w-full\" />\n                    ))}\n                  </div>\n                ) : statistics.length === 0 ? (\n                  <p className=\"text-muted-foreground text-center py-8\">\n                    {t('overview.noStats', 'No retention tracking data yet')}\n                  </p>\n                ) : (\n                  <div className=\"space-y-4\">\n                    {statistics.slice(0, 6).map((stat) => (\n                      <div key={stat.entity_type} className=\"space-y-2\">\n                        <div className=\"flex items-center justify-between\">\n                          <span className=\"font-medium capitalize\">\n                            {stat.entity_type.replace(/_/g, ' ')}\n                          </span>\n                          <span className=\"text-sm text-muted-foreground\">\n                            {stat.total_tracked} {t('overview.tracked', 'tracked')}\n                          </span>\n                        </div>\n                        <div className=\"flex gap-2\">\n                          {stat.under_hold > 0 && (\n                            <Badge variant=\"destructive\" className=\"text-xs\">\n                              {stat.under_hold} held\n                            </Badge>\n                          )}\n                          {stat.archived > 0 && (\n                            <Badge variant=\"secondary\" className=\"text-xs\">\n                              {stat.archived} archived\n                            </Badge>\n                          )}\n                          {stat.pending_action > 0 && (\n                            <Badge variant=\"outline\" className=\"text-xs\">\n                              {stat.pending_action} pending\n                            </Badge>\n                          )}\n                          {stat.expiring_soon > 0 && (\n                            <Badge className=\"text-xs bg-yellow-100 text-yellow-800\">\n                              {stat.expiring_soon} expiring\n                            </Badge>\n                          )}\n                        </div>\n                      </div>\n                    ))}\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n\n            {/* Recent Execution */}\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <History className=\"h-5 w-5\" />\n                  {t('overview.recentExecutions', 'Recent Executions')}\n                </CardTitle>\n              </CardHeader>\n              <CardContent>\n                {logLoading ? (\n                  <div className=\"space-y-3\">\n                    {[1, 2, 3].map((i) => (\n                      <Skeleton key={i} className=\"h-12 w-full\" />\n                    ))}\n                  </div>\n                ) : executionLog.length === 0 ? (\n                  <p className=\"text-muted-foreground text-center py-8\">\n                    {t('overview.noExecutions', 'No processor executions yet')}\n                  </p>\n                ) : (\n                  <div className=\"space-y-4\">\n                    {executionLog.slice(0, 5).map((log) => (\n                      <div key={log.id} className=\"flex items-center justify-between p-3 bg-muted/50 rounded-lg\">\n                        <div>\n                          <div className=\"flex items-center gap-2\">\n                            <Badge variant={log.execution_type === 'dry_run' ? 'outline' : 'default'}>\n                              {log.execution_type}\n                            </Badge>\n                            <span className=\"text-sm text-muted-foreground\">\n                              {new Date(log.started_at).toLocaleDateString()}\n                            </span>\n                          </div>\n                          <p className=\"text-sm mt-1\">\n                            {log.items_processed} processed, {log.items_archived} archived, {log.items_deleted} deleted\n                          </p>\n                        </div>\n                        {log.completed_at ? (\n                          <CheckCircle2 className=\"h-5 w-5 text-green-500\" />\n                        ) : (\n                          <RefreshCw className=\"h-5 w-5 text-yellow-500 animate-spin\" />\n                        )}\n                      </div>\n                    ))}\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n          </div>\n\n          {/* Expiring Soon Alert */}\n          {totalExpiringSoon > 0 && (\n            <Alert>\n              <AlertTriangle className=\"h-4 w-4\" />\n              <AlertTitle>{t('overview.expiringAlert', 'Entities Expiring Soon')}</AlertTitle>\n              <AlertDescription>\n                {t('overview.expiringAlertDesc', '{{count}} entities will expire within the next 30 days. Review them in the Pending tab.', { count: totalExpiringSoon })}\n              </AlertDescription>\n            </Alert>\n          )}\n        </TabsContent>\n\n        {/* Policies Tab */}\n        <TabsContent value=\"policies\">\n          <Card>\n            <CardHeader>\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <CardTitle>{t('policies.title', 'Retention Policies')}</CardTitle>\n                  <CardDescription>\n                    {t('policies.description', 'Configure how long data is retained and what happens when it expires')}\n                  </CardDescription>\n                </div>\n                <Button onClick={() => setShowPolicyDialog(true)}>\n                  <Plus className=\"h-4 w-4 me-2\" />\n                  {t('actions.newPolicy', 'New Policy')}\n                </Button>\n              </div>\n            </CardHeader>\n            <CardContent>\n              {policiesLoading ? (\n                <div className=\"space-y-3\">\n                  {[1, 2, 3, 4, 5].map((i) => (\n                    <Skeleton key={i} className=\"h-16 w-full\" />\n                  ))}\n                </div>\n              ) : policies.length === 0 ? (\n                <div className=\"text-center py-12\">\n                  <FileText className=\"h-12 w-12 mx-auto text-muted-foreground mb-4\" />\n                  <p className=\"text-lg font-medium\">{t('policies.empty', 'No Policies')}</p>\n                  <p className=\"text-muted-foreground mb-4\">\n                    {t('policies.emptyDesc', 'Create your first retention policy to start managing data lifecycle')}\n                  </p>\n                  <Button onClick={() => setShowPolicyDialog(true)}>\n                    <Plus className=\"h-4 w-4 me-2\" />\n                    {t('actions.newPolicy', 'Create Policy')}\n                  </Button>\n                </div>\n              ) : (\n                <Table>\n                  <TableHeader>\n                    <TableRow>\n                      <TableHead>{t('policies.name', 'Name')}</TableHead>\n                      <TableHead>{t('policies.entityType', 'Entity Type')}</TableHead>\n                      <TableHead>{t('policies.retention', 'Retention')}</TableHead>\n                      <TableHead>{t('policies.action', 'Action')}</TableHead>\n                      <TableHead>{t('policies.status', 'Status')}</TableHead>\n                      <TableHead className=\"text-end\">{t('policies.actions', 'Actions')}</TableHead>\n                    </TableRow>\n                  </TableHeader>\n                  <TableBody>\n                    {policies.map((policy) => (\n                      <TableRow key={policy.id}>\n                        <TableCell>\n                          <div>\n                            <p className=\"font-medium\">{policy.name_en}</p>\n                            <p className=\"text-sm text-muted-foreground\">{policy.code}</p>\n                          </div>\n                        </TableCell>\n                        <TableCell className=\"capitalize\">\n                          {policy.entity_type.replace(/_/g, ' ')}\n                          {policy.document_class && (\n                            <span className=\"text-muted-foreground\"> / {policy.document_class}</span>\n                          )}\n                        </TableCell>\n                        <TableCell>{formatRetentionPeriod(policy.retention_days)}</TableCell>\n                        <TableCell>\n                          <Badge variant=\"outline\">{formatAction(policy.action)}</Badge>\n                        </TableCell>\n                        <TableCell>\n                          <Badge className={getStatusColor(policy.status)}>{policy.status}</Badge>\n                        </TableCell>\n                        <TableCell className=\"text-end\">\n                          <Button\n                            variant=\"ghost\"\n                            size=\"sm\"\n                            onClick={() => {\n                              setSelectedPolicy(policy)\n                              setShowPolicyDialog(true)\n                            }}\n                          >\n                            {t('actions.edit', 'Edit')}\n                          </Button>\n                        </TableCell>\n                      </TableRow>\n                    ))}\n                  </TableBody>\n                </Table>\n              )}\n            </CardContent>\n          </Card>\n        </TabsContent>\n\n        {/* Legal Holds Tab */}\n        <TabsContent value=\"legal-holds\">\n          <Card>\n            <CardHeader>\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <Lock className=\"h-5 w-5\" />\n                    {t('legalHolds.title', 'Legal Holds')}\n                  </CardTitle>\n                  <CardDescription>\n                    {t('legalHolds.description', 'Prevent data from being archived or deleted during legal proceedings')}\n                  </CardDescription>\n                </div>\n                <Button onClick={() => setShowLegalHoldDialog(true)}>\n                  <Plus className=\"h-4 w-4 me-2\" />\n                  {t('actions.newLegalHold', 'New Legal Hold')}\n                </Button>\n              </div>\n            </CardHeader>\n            <CardContent>\n              {holdsLoading ? (\n                <div className=\"space-y-3\">\n                  {[1, 2, 3].map((i) => (\n                    <Skeleton key={i} className=\"h-16 w-full\" />\n                  ))}\n                </div>\n              ) : legalHolds.length === 0 ? (\n                <div className=\"text-center py-12\">\n                  <Lock className=\"h-12 w-12 mx-auto text-muted-foreground mb-4\" />\n                  <p className=\"text-lg font-medium\">{t('legalHolds.empty', 'No Legal Holds')}</p>\n                  <p className=\"text-muted-foreground mb-4\">\n                    {t('legalHolds.emptyDesc', 'Legal holds prevent data deletion during legal proceedings')}\n                  </p>\n                  <Button onClick={() => setShowLegalHoldDialog(true)}>\n                    <Plus className=\"h-4 w-4 me-2\" />\n                    {t('actions.newLegalHold', 'Create Legal Hold')}\n                  </Button>\n                </div>\n              ) : (\n                <Table>\n                  <TableHeader>\n                    <TableRow>\n                      <TableHead>{t('legalHolds.reference', 'Reference')}</TableHead>\n                      <TableHead>{t('legalHolds.name', 'Name')}</TableHead>\n                      <TableHead>{t('legalHolds.matter', 'Legal Matter')}</TableHead>\n                      <TableHead>{t('legalHolds.effectiveDate', 'Effective Date')}</TableHead>\n                      <TableHead>{t('legalHolds.status', 'Status')}</TableHead>\n                      <TableHead className=\"text-end\">{t('legalHolds.actions', 'Actions')}</TableHead>\n                    </TableRow>\n                  </TableHeader>\n                  <TableBody>\n                    {legalHolds.map((hold) => (\n                      <TableRow key={hold.id}>\n                        <TableCell className=\"font-mono text-sm\">{hold.reference_number}</TableCell>\n                        <TableCell>\n                          <p className=\"font-medium\">{hold.name_en}</p>\n                          {hold.entity_type && (\n                            <p className=\"text-sm text-muted-foreground capitalize\">\n                              {hold.entity_type.replace(/_/g, ' ')}\n                            </p>\n                          )}\n                        </TableCell>\n                        <TableCell>{hold.legal_matter || '-'}</TableCell>\n                        <TableCell>{new Date(hold.effective_date).toLocaleDateString()}</TableCell>\n                        <TableCell>\n                          <Badge className={getStatusColor(hold.status)}>{hold.status}</Badge>\n                        </TableCell>\n                        <TableCell className=\"text-end\">\n                          {hold.status === 'active' && (\n                            <Button\n                              variant=\"ghost\"\n                              size=\"sm\"\n                              onClick={() => releaseLegalHold.mutate(hold.id)}\n                              disabled={releaseLegalHold.isPending}\n                            >\n                              <Unlock className=\"h-4 w-4 me-2\" />\n                              {t('actions.release', 'Release')}\n                            </Button>\n                          )}\n                        </TableCell>\n                      </TableRow>\n                    ))}\n                  </TableBody>\n                </Table>\n              )}\n            </CardContent>\n          </Card>\n        </TabsContent>\n\n        {/* Pending Actions Tab */}\n        <TabsContent value=\"pending\" className=\"space-y-6\">\n          <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n            {/* Pending Retention Actions */}\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Clock className=\"h-5 w-5\" />\n                  {t('pending.actions', 'Pending Retention Actions')}\n                </CardTitle>\n                <CardDescription>\n                  {t('pending.actionsDesc', 'Entities that have exceeded their retention period')}\n                </CardDescription>\n              </CardHeader>\n              <CardContent>\n                {pendingLoading ? (\n                  <div className=\"space-y-3\">\n                    {[1, 2, 3].map((i) => (\n                      <Skeleton key={i} className=\"h-12 w-full\" />\n                    ))}\n                  </div>\n                ) : pendingActions.length === 0 ? (\n                  <p className=\"text-muted-foreground text-center py-8\">\n                    {t('pending.noActions', 'No pending actions')}\n                  </p>\n                ) : (\n                  <div className=\"space-y-3\">\n                    {pendingActions.map((action) => (\n                      <div key={action.entity_id} className=\"flex items-center justify-between p-3 bg-muted/50 rounded-lg\">\n                        <div>\n                          <p className=\"font-medium capitalize\">\n                            {action.entity_type.replace(/_/g, ' ')}\n                          </p>\n                          <p className=\"text-sm text-muted-foreground\">\n                            {action.policy_name_en}  {formatAction(action.action)}\n                          </p>\n                        </div>\n                        <Badge variant=\"destructive\">\n                          {Math.abs(action.days_until_expiration)} days overdue\n                        </Badge>\n                      </div>\n                    ))}\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n\n            {/* Expiring Soon */}\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <AlertTriangle className=\"h-5 w-5\" />\n                  {t('pending.expiring', 'Expiring Soon')}\n                </CardTitle>\n                <CardDescription>\n                  {t('pending.expiringDesc', 'Entities expiring within 30 days')}\n                </CardDescription>\n              </CardHeader>\n              <CardContent>\n                {expiringLoading ? (\n                  <div className=\"space-y-3\">\n                    {[1, 2, 3].map((i) => (\n                      <Skeleton key={i} className=\"h-12 w-full\" />\n                    ))}\n                  </div>\n                ) : expiringEntities.length === 0 ? (\n                  <p className=\"text-muted-foreground text-center py-8\">\n                    {t('pending.noExpiring', 'No entities expiring soon')}\n                  </p>\n                ) : (\n                  <div className=\"space-y-3\">\n                    {expiringEntities.map((entity) => (\n                      <div key={entity.entity_id} className=\"flex items-center justify-between p-3 bg-muted/50 rounded-lg\">\n                        <div>\n                          <p className=\"font-medium capitalize\">\n                            {entity.entity_type.replace(/_/g, ' ')}\n                          </p>\n                          <p className=\"text-sm text-muted-foreground\">\n                            {entity.policy_name_en}  {formatAction(entity.action)}\n                          </p>\n                        </div>\n                        <Badge variant=\"outline\" className=\"bg-yellow-50 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-200\">\n                          {entity.days_until_expiration} days left\n                        </Badge>\n                      </div>\n                    ))}\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n          </div>\n        </TabsContent>\n\n        {/* History Tab */}\n        <TabsContent value=\"history\">\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2\">\n                <History className=\"h-5 w-5\" />\n                {t('history.title', 'Execution History')}\n              </CardTitle>\n              <CardDescription>\n                {t('history.description', 'Log of all retention processor executions')}\n              </CardDescription>\n            </CardHeader>\n            <CardContent>\n              {logLoading ? (\n                <div className=\"space-y-3\">\n                  {[1, 2, 3, 4, 5].map((i) => (\n                    <Skeleton key={i} className=\"h-16 w-full\" />\n                  ))}\n                </div>\n              ) : executionLog.length === 0 ? (\n                <div className=\"text-center py-12\">\n                  <History className=\"h-12 w-12 mx-auto text-muted-foreground mb-4\" />\n                  <p className=\"text-lg font-medium\">{t('history.empty', 'No Execution History')}</p>\n                  <p className=\"text-muted-foreground\">\n                    {t('history.emptyDesc', 'Run the retention processor to see execution history')}\n                  </p>\n                </div>\n              ) : (\n                <Table>\n                  <TableHeader>\n                    <TableRow>\n                      <TableHead>{t('history.date', 'Date')}</TableHead>\n                      <TableHead>{t('history.type', 'Type')}</TableHead>\n                      <TableHead>{t('history.processed', 'Processed')}</TableHead>\n                      <TableHead>{t('history.archived', 'Archived')}</TableHead>\n                      <TableHead>{t('history.deleted', 'Deleted')}</TableHead>\n                      <TableHead>{t('history.warned', 'Warned')}</TableHead>\n                      <TableHead>{t('history.errors', 'Errors')}</TableHead>\n                      <TableHead>{t('history.status', 'Status')}</TableHead>\n                    </TableRow>\n                  </TableHeader>\n                  <TableBody>\n                    {executionLog.map((log) => (\n                      <TableRow key={log.id}>\n                        <TableCell>{new Date(log.started_at).toLocaleString()}</TableCell>\n                        <TableCell>\n                          <Badge variant={log.execution_type === 'dry_run' ? 'outline' : 'default'}>\n                            {log.execution_type}\n                          </Badge>\n                        </TableCell>\n                        <TableCell>{log.items_processed}</TableCell>\n                        <TableCell>{log.items_archived}</TableCell>\n                        <TableCell>{log.items_deleted}</TableCell>\n                        <TableCell>{log.items_warned}</TableCell>\n                        <TableCell>\n                          {log.errors.length > 0 ? (\n                            <Badge variant=\"destructive\">{log.errors.length}</Badge>\n                          ) : (\n                            <span className=\"text-muted-foreground\">0</span>\n                          )}\n                        </TableCell>\n                        <TableCell>\n                          {log.completed_at ? (\n                            <CheckCircle2 className=\"h-5 w-5 text-green-500\" />\n                          ) : (\n                            <RefreshCw className=\"h-5 w-5 text-yellow-500 animate-spin\" />\n                          )}\n                        </TableCell>\n                      </TableRow>\n                    ))}\n                  </TableBody>\n                </Table>\n              )}\n            </CardContent>\n          </Card>\n        </TabsContent>\n      </Tabs>\n\n      {/* Policy Dialog */}\n      <PolicyDialog\n        open={showPolicyDialog}\n        onOpenChange={(open) => {\n          setShowPolicyDialog(open)\n          if (!open) setSelectedPolicy(null)\n        }}\n        policy={selectedPolicy}\n        onSave={(data) => {\n          if (selectedPolicy) {\n            updatePolicy.mutate({ id: selectedPolicy.id, updates: data })\n          } else {\n            createPolicy.mutate(data)\n          }\n          setShowPolicyDialog(false)\n          setSelectedPolicy(null)\n        }}\n        isLoading={createPolicy.isPending || updatePolicy.isPending}\n      />\n\n      {/* Legal Hold Dialog */}\n      <LegalHoldDialog\n        open={showLegalHoldDialog}\n        onOpenChange={setShowLegalHoldDialog}\n        onSave={(data) => {\n          createLegalHold.mutate(data)\n          setShowLegalHoldDialog(false)\n        }}\n        isLoading={createLegalHold.isPending}\n      />\n\n      {/* Processor Dialog */}\n      <ProcessorDialog\n        open={showProcessorDialog}\n        onOpenChange={setShowProcessorDialog}\n        onRun={(config) => {\n          runProcessor.mutate(config)\n          setShowProcessorDialog(false)\n        }}\n        isLoading={runProcessor.isPending}\n      />\n    </div>\n  )\n}\n\n// Policy Dialog Component\nfunction PolicyDialog({\n  open,\n  onOpenChange,\n  policy,\n  onSave,\n  isLoading,\n}: {\n  open: boolean\n  onOpenChange: (open: boolean) => void\n  policy: RetentionPolicy | null\n  onSave: (data: RetentionPolicyInput) => void\n  isLoading: boolean\n}) {\n  const { t } = useTranslation('retention-policies')\n  const [formData, setFormData] = useState<Partial<RetentionPolicyInput>>({})\n\n  const handleSubmit = () => {\n    if (!formData.code || !formData.name_en || !formData.name_ar || !formData.entity_type) {\n      return\n    }\n    onSave({\n      code: formData.code,\n      name_en: formData.name_en,\n      name_ar: formData.name_ar,\n      description_en: formData.description_en,\n      description_ar: formData.description_ar,\n      entity_type: formData.entity_type,\n      document_class: formData.document_class,\n      sensitivity_level: formData.sensitivity_level,\n      retention_days: formData.retention_days || 0,\n      warning_days: formData.warning_days || 30,\n      action: formData.action || 'archive',\n      status: formData.status || 'active',\n      priority: formData.priority || 100,\n      regulatory_reference: formData.regulatory_reference,\n      compliance_notes: formData.compliance_notes,\n    })\n  }\n\n  return (\n    <Dialog open={open} onOpenChange={onOpenChange}>\n      <DialogContent className=\"max-w-2xl max-h-[90vh] overflow-y-auto\">\n        <DialogHeader>\n          <DialogTitle>\n            {policy ? t('dialog.editPolicy', 'Edit Policy') : t('dialog.newPolicy', 'New Retention Policy')}\n          </DialogTitle>\n          <DialogDescription>\n            {t('dialog.policyDesc', 'Configure how long data should be retained and what happens when it expires')}\n          </DialogDescription>\n        </DialogHeader>\n\n        <div className=\"grid gap-4 py-4\">\n          <div className=\"grid grid-cols-2 gap-4\">\n            <div className=\"space-y-2\">\n              <Label>{t('dialog.code', 'Policy Code')}</Label>\n              <Input\n                placeholder=\"POL-DOC-3Y\"\n                value={formData.code || policy?.code || ''}\n                onChange={(e) => setFormData({ ...formData, code: e.target.value })}\n              />\n            </div>\n            <div className=\"space-y-2\">\n              <Label>{t('dialog.priority', 'Priority')}</Label>\n              <Input\n                type=\"number\"\n                placeholder=\"100\"\n                value={formData.priority || policy?.priority || 100}\n                onChange={(e) => setFormData({ ...formData, priority: parseInt(e.target.value) })}\n              />\n            </div>\n          </div>\n\n          <div className=\"grid grid-cols-2 gap-4\">\n            <div className=\"space-y-2\">\n              <Label>{t('dialog.nameEn', 'Name (English)')}</Label>\n              <Input\n                value={formData.name_en || policy?.name_en || ''}\n                onChange={(e) => setFormData({ ...formData, name_en: e.target.value })}\n              />\n            </div>\n            <div className=\"space-y-2\">\n              <Label>{t('dialog.nameAr', 'Name (Arabic)')}</Label>\n              <Input\n                value={formData.name_ar || policy?.name_ar || ''}\n                onChange={(e) => setFormData({ ...formData, name_ar: e.target.value })}\n                dir=\"rtl\"\n              />\n            </div>\n          </div>\n\n          <div className=\"grid grid-cols-2 gap-4\">\n            <div className=\"space-y-2\">\n              <Label>{t('dialog.entityType', 'Entity Type')}</Label>\n              <Select\n                value={formData.entity_type || policy?.entity_type || ''}\n                onValueChange={(v) => setFormData({ ...formData, entity_type: v as RetentionEntityType })}\n              >\n                <SelectTrigger>\n                  <SelectValue placeholder=\"Select entity type\" />\n                </SelectTrigger>\n                <SelectContent>\n                  {ENTITY_TYPES.map((type) => (\n                    <SelectItem key={type.value} value={type.value}>\n                      {type.label}\n                    </SelectItem>\n                  ))}\n                </SelectContent>\n              </Select>\n            </div>\n            <div className=\"space-y-2\">\n              <Label>{t('dialog.documentClass', 'Document Class (Optional)')}</Label>\n              <Select\n                value={formData.document_class || policy?.document_class || '__none__'}\n                onValueChange={(v) => setFormData({ ...formData, document_class: v === '__none__' ? undefined : v as DocumentClass })}\n              >\n                <SelectTrigger>\n                  <SelectValue placeholder=\"All classes\" />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"__none__\">All Classes</SelectItem>\n                  {DOCUMENT_CLASSES.map((cls) => (\n                    <SelectItem key={cls.value} value={cls.value}>\n                      {cls.label}\n                    </SelectItem>\n                  ))}\n                </SelectContent>\n              </Select>\n            </div>\n          </div>\n\n          <div className=\"grid grid-cols-3 gap-4\">\n            <div className=\"space-y-2\">\n              <Label>{t('dialog.retentionDays', 'Retention Days')}</Label>\n              <Input\n                type=\"number\"\n                placeholder=\"0 = Permanent\"\n                value={formData.retention_days ?? policy?.retention_days ?? ''}\n                onChange={(e) => setFormData({ ...formData, retention_days: parseInt(e.target.value) || 0 })}\n              />\n              <p className=\"text-xs text-muted-foreground\">0 = Permanent</p>\n            </div>\n            <div className=\"space-y-2\">\n              <Label>{t('dialog.warningDays', 'Warning Days')}</Label>\n              <Input\n                type=\"number\"\n                value={formData.warning_days ?? policy?.warning_days ?? 30}\n                onChange={(e) => setFormData({ ...formData, warning_days: parseInt(e.target.value) })}\n              />\n            </div>\n            <div className=\"space-y-2\">\n              <Label>{t('dialog.action', 'Action')}</Label>\n              <Select\n                value={formData.action || policy?.action || 'archive'}\n                onValueChange={(v) => setFormData({ ...formData, action: v as RetentionActionType })}\n              >\n                <SelectTrigger>\n                  <SelectValue />\n                </SelectTrigger>\n                <SelectContent>\n                  {RETENTION_ACTIONS.map((action) => (\n                    <SelectItem key={action.value} value={action.value}>\n                      {action.label}\n                    </SelectItem>\n                  ))}\n                </SelectContent>\n              </Select>\n            </div>\n          </div>\n\n          <Separator />\n\n          <div className=\"space-y-2\">\n            <Label>{t('dialog.regulatoryReference', 'Regulatory Reference (Optional)')}</Label>\n            <Input\n              placeholder=\"ISO 27001, GDPR, etc.\"\n              value={formData.regulatory_reference || policy?.regulatory_reference || ''}\n              onChange={(e) => setFormData({ ...formData, regulatory_reference: e.target.value })}\n            />\n          </div>\n\n          <div className=\"space-y-2\">\n            <Label>{t('dialog.complianceNotes', 'Compliance Notes')}</Label>\n            <Textarea\n              placeholder=\"Additional compliance information...\"\n              value={formData.compliance_notes || policy?.compliance_notes || ''}\n              onChange={(e) => setFormData({ ...formData, compliance_notes: e.target.value })}\n            />\n          </div>\n        </div>\n\n        <DialogFooter>\n          <Button variant=\"outline\" onClick={() => onOpenChange(false)}>\n            {t('dialog.cancel', 'Cancel')}\n          </Button>\n          <Button onClick={handleSubmit} disabled={isLoading}>\n            {isLoading ? t('dialog.saving', 'Saving...') : t('dialog.save', 'Save Policy')}\n          </Button>\n        </DialogFooter>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\n// Legal Hold Dialog Component\nfunction LegalHoldDialog({\n  open,\n  onOpenChange,\n  onSave,\n  isLoading,\n}: {\n  open: boolean\n  onOpenChange: (open: boolean) => void\n  onSave: (data: LegalHoldInput) => void\n  isLoading: boolean\n}) {\n  const { t } = useTranslation('retention-policies')\n  const [formData, setFormData] = useState<Partial<LegalHoldInput>>({\n    status: 'active',\n    notify_custodians: true,\n  })\n\n  const handleSubmit = () => {\n    if (!formData.name_en || !formData.name_ar || !formData.reference_number || !formData.reason_en || !formData.reason_ar) {\n      return\n    }\n    onSave({\n      name_en: formData.name_en,\n      name_ar: formData.name_ar,\n      description_en: formData.description_en,\n      description_ar: formData.description_ar,\n      reference_number: formData.reference_number,\n      entity_type: formData.entity_type,\n      status: 'active',\n      reason_en: formData.reason_en,\n      reason_ar: formData.reason_ar,\n      legal_matter: formData.legal_matter,\n      effective_date: formData.effective_date || new Date().toISOString(),\n      expiry_date: formData.expiry_date,\n      notify_custodians: formData.notify_custodians,\n    })\n    setFormData({ status: 'active', notify_custodians: true })\n  }\n\n  return (\n    <Dialog open={open} onOpenChange={onOpenChange}>\n      <DialogContent className=\"max-w-2xl max-h-[90vh] overflow-y-auto\">\n        <DialogHeader>\n          <DialogTitle>{t('dialog.newLegalHold', 'New Legal Hold')}</DialogTitle>\n          <DialogDescription>\n            {t('dialog.legalHoldDesc', 'Create a legal hold to prevent data from being archived or deleted')}\n          </DialogDescription>\n        </DialogHeader>\n\n        <div className=\"grid gap-4 py-4\">\n          <div className=\"space-y-2\">\n            <Label>{t('dialog.reference', 'Reference Number')}</Label>\n            <Input\n              placeholder=\"LH-2026-001\"\n              value={formData.reference_number || ''}\n              onChange={(e) => setFormData({ ...formData, reference_number: e.target.value })}\n            />\n          </div>\n\n          <div className=\"grid grid-cols-2 gap-4\">\n            <div className=\"space-y-2\">\n              <Label>{t('dialog.nameEn', 'Name (English)')}</Label>\n              <Input\n                value={formData.name_en || ''}\n                onChange={(e) => setFormData({ ...formData, name_en: e.target.value })}\n              />\n            </div>\n            <div className=\"space-y-2\">\n              <Label>{t('dialog.nameAr', 'Name (Arabic)')}</Label>\n              <Input\n                value={formData.name_ar || ''}\n                onChange={(e) => setFormData({ ...formData, name_ar: e.target.value })}\n                dir=\"rtl\"\n              />\n            </div>\n          </div>\n\n          <div className=\"space-y-2\">\n            <Label>{t('dialog.legalMatter', 'Legal Matter')}</Label>\n            <Input\n              placeholder=\"Case name or matter reference\"\n              value={formData.legal_matter || ''}\n              onChange={(e) => setFormData({ ...formData, legal_matter: e.target.value })}\n            />\n          </div>\n\n          <div className=\"grid grid-cols-2 gap-4\">\n            <div className=\"space-y-2\">\n              <Label>{t('dialog.reasonEn', 'Reason (English)')}</Label>\n              <Textarea\n                value={formData.reason_en || ''}\n                onChange={(e) => setFormData({ ...formData, reason_en: e.target.value })}\n              />\n            </div>\n            <div className=\"space-y-2\">\n              <Label>{t('dialog.reasonAr', 'Reason (Arabic)')}</Label>\n              <Textarea\n                value={formData.reason_ar || ''}\n                onChange={(e) => setFormData({ ...formData, reason_ar: e.target.value })}\n                dir=\"rtl\"\n              />\n            </div>\n          </div>\n\n          <div className=\"space-y-2\">\n            <Label>{t('dialog.entityType', 'Entity Type (Optional)')}</Label>\n            <Select\n              value={formData.entity_type || '__all__'}\n              onValueChange={(v) => setFormData({ ...formData, entity_type: v === '__all__' ? undefined : v as RetentionEntityType })}\n            >\n              <SelectTrigger>\n                <SelectValue placeholder=\"All entity types\" />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"__all__\">All Types</SelectItem>\n                {ENTITY_TYPES.map((type) => (\n                  <SelectItem key={type.value} value={type.value}>\n                    {type.label}\n                  </SelectItem>\n                ))}\n              </SelectContent>\n            </Select>\n          </div>\n\n          <div className=\"flex items-center space-x-2\">\n            <Switch\n              id=\"notify\"\n              checked={formData.notify_custodians}\n              onCheckedChange={(checked) => setFormData({ ...formData, notify_custodians: checked })}\n            />\n            <Label htmlFor=\"notify\">{t('dialog.notifyCustodians', 'Notify custodians')}</Label>\n          </div>\n        </div>\n\n        <DialogFooter>\n          <Button variant=\"outline\" onClick={() => onOpenChange(false)}>\n            {t('dialog.cancel', 'Cancel')}\n          </Button>\n          <Button onClick={handleSubmit} disabled={isLoading}>\n            {isLoading ? t('dialog.creating', 'Creating...') : t('dialog.createHold', 'Create Legal Hold')}\n          </Button>\n        </DialogFooter>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\n// Processor Dialog Component\nfunction ProcessorDialog({\n  open,\n  onOpenChange,\n  onRun,\n  isLoading,\n}: {\n  open: boolean\n  onOpenChange: (open: boolean) => void\n  onRun: (config: ProcessorConfig) => void\n  isLoading: boolean\n}) {\n  const { t } = useTranslation('retention-policies')\n  const [config, setConfig] = useState<ProcessorConfig>({\n    dry_run: true,\n    batch_size: 100,\n    send_warnings: true,\n    warning_days: 30,\n  })\n\n  return (\n    <Dialog open={open} onOpenChange={onOpenChange}>\n      <DialogContent>\n        <DialogHeader>\n          <DialogTitle>{t('processor.title', 'Run Retention Processor')}</DialogTitle>\n          <DialogDescription>\n            {t('processor.description', 'Execute retention policies on expired entities')}\n          </DialogDescription>\n        </DialogHeader>\n\n        <div className=\"grid gap-4 py-4\">\n          <Alert>\n            <AlertTriangle className=\"h-4 w-4\" />\n            <AlertTitle>{t('processor.warning', 'Warning')}</AlertTitle>\n            <AlertDescription>\n              {t('processor.warningDesc', 'Running the processor will archive or delete expired data. Use dry run first to preview changes.')}\n            </AlertDescription>\n          </Alert>\n\n          <div className=\"flex items-center space-x-2\">\n            <Switch\n              id=\"dry-run\"\n              checked={config.dry_run}\n              onCheckedChange={(checked) => setConfig({ ...config, dry_run: checked })}\n            />\n            <Label htmlFor=\"dry-run\">{t('processor.dryRun', 'Dry Run (Preview Only)')}</Label>\n          </div>\n\n          <div className=\"flex items-center space-x-2\">\n            <Switch\n              id=\"send-warnings\"\n              checked={config.send_warnings}\n              onCheckedChange={(checked) => setConfig({ ...config, send_warnings: checked })}\n            />\n            <Label htmlFor=\"send-warnings\">{t('processor.sendWarnings', 'Send expiration warnings')}</Label>\n          </div>\n\n          <div className=\"space-y-2\">\n            <Label>{t('processor.batchSize', 'Batch Size')}</Label>\n            <Input\n              type=\"number\"\n              value={config.batch_size}\n              onChange={(e) => setConfig({ ...config, batch_size: parseInt(e.target.value) || 100 })}\n            />\n          </div>\n\n          <div className=\"space-y-2\">\n            <Label>{t('processor.entityType', 'Entity Type (Optional)')}</Label>\n            <Select\n              value={config.entity_type || '__all__'}\n              onValueChange={(v) => setConfig({ ...config, entity_type: v === '__all__' ? undefined : v as RetentionEntityType })}\n            >\n              <SelectTrigger>\n                <SelectValue placeholder=\"All entity types\" />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"__all__\">All Types</SelectItem>\n                {ENTITY_TYPES.map((type) => (\n                  <SelectItem key={type.value} value={type.value}>\n                    {type.label}\n                  </SelectItem>\n                ))}\n              </SelectContent>\n            </Select>\n          </div>\n        </div>\n\n        <DialogFooter>\n          <Button variant=\"outline\" onClick={() => onOpenChange(false)}>\n            {t('dialog.cancel', 'Cancel')}\n          </Button>\n          <Button onClick={() => onRun(config)} disabled={isLoading}>\n            {isLoading ? (\n              <>\n                <RefreshCw className=\"h-4 w-4 me-2 animate-spin\" />\n                {t('processor.running', 'Running...')}\n              </>\n            ) : (\n              <>\n                <Play className=\"h-4 w-4 me-2\" />\n                {config.dry_run ? t('processor.preview', 'Preview') : t('processor.run', 'Run Processor')}\n              </>\n            )}\n          </Button>\n        </DialogFooter>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\nexport default DataRetentionPage\n","/**\n * Route: /admin/approvals\n * Admin reassignment panel for stuck approvals\n */\n\nimport { createFileRoute } from '@tanstack/react-router';\nimport { useState } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Card } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { Textarea } from '@/components/ui/textarea';\nimport { Dialog, DialogContent, DialogDescription, DialogFooter, DialogHeader, DialogTitle } from '@/components/ui/dialog';\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from '@/components/ui/table';\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\nimport { supabase } from '@/lib/supabase';\nimport { AlertCircle, Users, Shield } from 'lucide-react';\nimport { Skeleton } from '@/components/ui/skeleton';\n\nexport const Route = createFileRoute('/_protected/admin/approvals')({\n component: AdminApprovalsPage,\n beforeLoad: async () => {\n // Check admin role\n const { data: { session } } = await supabase.auth.getSession();\n const user = session?.user;\n const isAdmin = user?.user_metadata?.role === 'admin' || user?.app_metadata?.role === 'admin';\n\n if (!isAdmin) {\n throw new Error('Admin access required');\n }\n },\n});\n\nconst API_BASE_URL = import.meta.env.VITE_SUPABASE_URL + '/functions/v1';\n\nasync function fetchUnderReviewPositions() {\n const { data: { session } } = await supabase.auth.getSession();\n const response = await fetch(`${API_BASE_URL}/positions-list?status=under_review`, {\n headers: {\n 'Authorization': `Bearer ${session?.access_token}`,\n 'Content-Type': 'application/json',\n },\n });\n\n if (!response.ok) {\n throw new Error('Failed to fetch positions');\n }\n\n const data = await response.json();\n return data.data || [];\n}\n\nasync function reassignApproval(approvalId: string, newApproverId: string, reason: string) {\n const { data: { session } } = await supabase.auth.getSession();\n const response = await fetch(`${API_BASE_URL}/approvals-reassign?id=${approvalId}`, {\n method: 'PUT',\n headers: {\n 'Authorization': `Bearer ${session?.access_token}`,\n 'Content-Type': 'application/json',\n },\n body: JSON.stringify({\n reassign_to: newApproverId,\n reason,\n }),\n });\n\n if (!response.ok) {\n throw new Error('Failed to reassign approval');\n }\n\n return response.json();\n}\n\nfunction AdminApprovalsPage() {\n const { t } = useTranslation();\n const queryClient = useQueryClient();\n const [isReassignDialogOpen, setIsReassignDialogOpen] = useState(false);\n const [selectedPosition, setSelectedPosition] = useState<any>(null);\n const [reassignData, setReassignData] = useState({\n newApproverId: '',\n reason: '',\n });\n\n const { data: positions, isLoading } = useQuery({\n queryKey: ['admin', 'approvals', 'under_review'],\n queryFn: fetchUnderReviewPositions,\n staleTime: 30 * 1000, // 30 seconds\n });\n\n const reassignMutation = useMutation({\n mutationFn: ({ approvalId, newApproverId, reason }: { approvalId: string; newApproverId: string; reason: string }) =>\n reassignApproval(approvalId, newApproverId, reason),\n onSuccess: () => {\n queryClient.invalidateQueries({ queryKey: ['admin', 'approvals'] });\n setIsReassignDialogOpen(false);\n setReassignData({ newApproverId: '', reason: '' });\n },\n });\n\n const handleReassign = (position: any) => {\n setSelectedPosition(position);\n setIsReassignDialogOpen(true);\n };\n\n const handleReassignSubmit = () => {\n if (selectedPosition && reassignData.newApproverId && reassignData.reason) {\n reassignMutation.mutate({\n approvalId: selectedPosition.current_approval_id || '', // This would need to come from the position\n newApproverId: reassignData.newApproverId,\n reason: reassignData.reason,\n });\n }\n };\n\n if (isLoading) {\n return (\n <div className=\"container mx-auto py-6 space-y-4\">\n <Skeleton className=\"h-8 w-64\" />\n <Skeleton className=\"h-96\" />\n </div>\n );\n }\n\n return (\n <div className=\"container mx-auto py-6 space-y-6\">\n {/* Header */}\n <div className=\"flex items-center gap-3\">\n <div className=\"p-3 bg-red-100 dark:bg-red-900 rounded-lg\">\n <Shield className=\"h-6 w-6 text-red-600 dark:text-red-400\" />\n </div>\n <div>\n <h1 className=\"text-3xl font-bold\">\n {t('admin.approvals.title', 'Admin: Approval Management')}\n </h1>\n <p className=\"text-muted-foreground\">\n {t('admin.approvals.subtitle', 'Reassign stuck approvals and manage approval chains')}\n </p>\n </div>\n </div>\n\n {/* Warning Banner */}\n <Card className=\"p-4 border-yellow-500 bg-yellow-50 dark:bg-yellow-900/20\">\n <div className=\"flex items-start gap-3\">\n <AlertCircle className=\"h-5 w-5 text-yellow-600 dark:text-yellow-400 mt-0.5\" />\n <div>\n <p className=\"font-medium text-yellow-800 dark:text-yellow-200\">\n {t('admin.approvals.warning', 'Admin Privileges Active')}\n </p>\n <p className=\"text-sm text-yellow-700 dark:text-yellow-300\">\n {t('admin.approvals.warningText', 'All reassignments are logged and require a reason for audit trail compliance.')}\n </p>\n </div>\n </div>\n </Card>\n\n {/* Positions Under Review Table */}\n <Card className=\"p-6\">\n <div className=\"mb-4\">\n <h2 className=\"text-xl font-semibold\">\n {t('admin.approvals.underReview', 'Positions Under Review')}\n </h2>\n <p className=\"text-sm text-muted-foreground\">\n {t('admin.approvals.underReviewDesc', 'All positions currently in the approval workflow')}\n </p>\n </div>\n\n <Table>\n <TableHeader>\n <TableRow>\n <TableHead>{t('admin.approvals.position', 'Position')}</TableHead>\n <TableHead>{t('admin.approvals.stage', 'Current Stage')}</TableHead>\n <TableHead>{t('admin.approvals.category', 'Category')}</TableHead>\n <TableHead>{t('admin.approvals.submittedDate', 'Submitted')}</TableHead>\n <TableHead>{t('admin.approvals.actions', 'Actions')}</TableHead>\n </TableRow>\n </TableHeader>\n <TableBody>\n {positions && positions.length > 0 ? (\n positions.map((position: any) => (\n <TableRow key={position.id}>\n <TableCell>\n <div>\n <p className=\"font-medium\">{position.title_en}</p>\n <p className=\"text-sm text-muted-foreground\">{position.title_ar}</p>\n </div>\n </TableCell>\n <TableCell>\n <Badge variant=\"secondary\">\n {t('admin.approvals.stageOf', 'Stage {{current}} of {{total}}', {\n current: position.current_stage,\n total: position.approval_chain_config?.stages?.length || 0,\n })}\n </Badge>\n </TableCell>\n <TableCell>{position.thematic_category || '-'}</TableCell>\n <TableCell className=\"text-sm text-muted-foreground\">\n {new Date(position.created_at).toLocaleDateString()}\n </TableCell>\n <TableCell>\n <Button\n variant=\"outline\"\n size=\"sm\"\n onClick={() => handleReassign(position)}\n >\n <Users className=\"me-2 h-4 w-4\" />\n {t('admin.approvals.reassign', 'Reassign')}\n </Button>\n </TableCell>\n </TableRow>\n ))\n ) : (\n <TableRow>\n <TableCell colSpan={5} className=\"text-center text-muted-foreground\">\n {t('admin.approvals.noPositions', 'No positions under review')}\n </TableCell>\n </TableRow>\n )}\n </TableBody>\n </Table>\n </Card>\n\n {/* Reassign Dialog */}\n <Dialog open={isReassignDialogOpen} onOpenChange={setIsReassignDialogOpen}>\n <DialogContent className=\"sm:max-w-[500px]\">\n <DialogHeader>\n <DialogTitle>{t('admin.approvals.reassignTitle', 'Reassign Approval')}</DialogTitle>\n <DialogDescription>\n {t('admin.approvals.reassignDesc', 'Reassign this approval to a different user. A reason is required for audit purposes.')}\n </DialogDescription>\n </DialogHeader>\n\n <div className=\"space-y-4 py-4\">\n <div className=\"space-y-2\">\n <Label htmlFor=\"position\">\n {t('admin.approvals.position', 'Position')}\n </Label>\n <p className=\"text-sm font-medium\">{selectedPosition?.title_en}</p>\n </div>\n\n <div className=\"space-y-2\">\n <Label htmlFor=\"newApprover\">\n {t('admin.approvals.newApprover', 'New Approver')} *\n </Label>\n <Input\n id=\"newApprover\"\n placeholder={t('admin.approvals.newApproverPlaceholder', 'Enter user ID or search')}\n value={reassignData.newApproverId}\n onChange={(e) => setReassignData({ ...reassignData, newApproverId: e.target.value })}\n />\n </div>\n\n <div className=\"space-y-2\">\n <Label htmlFor=\"reason\">\n {t('admin.approvals.reason', 'Reason for Reassignment')} *\n </Label>\n <Textarea\n id=\"reason\"\n placeholder={t('admin.approvals.reasonPlaceholder', 'e.g., Original approver is on leave, organizational change')}\n value={reassignData.reason}\n onChange={(e) => setReassignData({ ...reassignData, reason: e.target.value })}\n rows={3}\n />\n </div>\n </div>\n\n <DialogFooter>\n <Button variant=\"outline\" onClick={() => setIsReassignDialogOpen(false)}>\n {t('common.cancel', 'Cancel')}\n </Button>\n <Button\n onClick={handleReassignSubmit}\n disabled={!reassignData.newApproverId || !reassignData.reason}\n >\n {t('admin.approvals.confirmReassign', 'Confirm Reassignment')}\n </Button>\n </DialogFooter>\n </DialogContent>\n </Dialog>\n </div>\n );\n}\n","import * as React from \"react\"\nimport * as ProgressPrimitive from \"@radix-ui/react-progress\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Progress = React.forwardRef<\n React.ElementRef<typeof ProgressPrimitive.Root>,\n React.ComponentPropsWithoutRef<typeof ProgressPrimitive.Root>\n>(({ className, value, ...props }, ref) => (\n <ProgressPrimitive.Root\n ref={ref}\n className={cn(\n \"relative h-2 w-full overflow-hidden rounded-full bg-primary/20\",\n className\n )}\n {...props}\n >\n <ProgressPrimitive.Indicator\n className=\"h-full w-full flex-1 bg-primary transition-all\"\n style={{ transform: `translateX(-${100 - (value || 0)}%)` }}\n />\n </ProgressPrimitive.Root>\n))\nProgress.displayName = ProgressPrimitive.Root.displayName\n\nexport { Progress }","/**\n * Route: /admin/ai-usage\n * AI Usage Dashboard\n * Feature: 033-ai-brief-generation\n * Tasks: T051, T052\n */\n\nimport { createFileRoute } from '@tanstack/react-router'\nimport { useState } from 'react'\nimport { useTranslation } from 'react-i18next'\nimport { useQuery } from '@tanstack/react-query'\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Button } from '@/components/ui/button'\nimport { Badge } from '@/components/ui/badge'\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs'\nimport { Skeleton } from '@/components/ui/skeleton'\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from '@/components/ui/select'\nimport { Progress } from '@/components/ui/progress'\nimport { cn } from '@/lib/utils'\nimport { supabase } from '@/lib/supabase'\nimport {\n  BarChart3,\n  TrendingUp,\n  TrendingDown,\n  DollarSign,\n  Zap,\n  Users,\n  FileText,\n  MessageSquare,\n  Link2,\n  Calendar,\n  RefreshCw,\n} from 'lucide-react'\n\nexport const Route = createFileRoute('/_protected/admin/ai-usage')({\n  component: AIUsageDashboard,\n  beforeLoad: async () => {\n    const {\n      data: { session },\n    } = await supabase.auth.getSession()\n    const user = session?.user\n    const isAdmin = user?.user_metadata?.role === 'admin' || user?.app_metadata?.role === 'admin'\n    if (!isAdmin) {\n      throw new Error('Admin access required')\n    }\n  },\n})\n\ninterface UsageMetrics {\n  totalRuns: number\n  totalTokens: number\n  totalCost: number\n  averageLatency: number\n  successRate: number\n  runsByType: Record<string, number>\n  costByProvider: Record<string, number>\n  dailyUsage: Array<{ date: string; runs: number; tokens: number; cost: number }>\n  topUsers: Array<{ user_id: string; email: string; runs: number; cost: number }>\n}\n\n// API base URL for future direct API calls\n// const API_BASE = import.meta.env.VITE_API_URL || '/api';\n\nfunction AIUsageDashboard() {\n  const { t, i18n } = useTranslation('ai-admin')\n  const isRTL = i18n.language === 'ar'\n  const [dateRange, setDateRange] = useState<'7d' | '30d' | '90d'>('30d')\n  const [activeTab, setActiveTab] = useState<'overview' | 'users' | 'breakdown'>('overview')\n\n  const {\n    data: metrics,\n    isLoading,\n    refetch,\n    isRefetching,\n  } = useQuery({\n    queryKey: ['ai-usage-metrics', dateRange],\n    queryFn: async (): Promise<UsageMetrics> => {\n      // Ensure user is authenticated (session is validated by route beforeLoad)\n      await supabase.auth.getSession()\n\n      // Calculate date range\n      const days = dateRange === '7d' ? 7 : dateRange === '30d' ? 30 : 90\n      const startDate = new Date()\n      startDate.setDate(startDate.getDate() - days)\n\n      // Fetch runs data from ai_runs table\n      const { data: runs, error } = await supabase\n        .from('ai_runs')\n        .select('*')\n        .gte('created_at', startDate.toISOString())\n        .order('created_at', { ascending: false })\n\n      if (error) throw error\n\n      // Calculate metrics\n      const totalRuns = runs?.length || 0\n      const totalTokens = runs?.reduce((sum, r) => sum + (r.total_tokens || 0), 0) || 0\n      const totalCost = runs?.reduce((sum, r) => sum + (r.total_cost || 0), 0) || 0\n      const successfulRuns = runs?.filter((r) => r.status === 'completed').length || 0\n      const successRate = totalRuns > 0 ? (successfulRuns / totalRuns) * 100 : 0\n      const totalLatency = runs?.reduce((sum, r) => sum + (r.latency_ms || 0), 0) || 0\n      const averageLatency = totalRuns > 0 ? totalLatency / totalRuns : 0\n\n      // Group by run type\n      const runsByType: Record<string, number> = {}\n      runs?.forEach((r) => {\n        runsByType[r.run_type] = (runsByType[r.run_type] || 0) + 1\n      })\n\n      // Group by provider\n      const costByProvider: Record<string, number> = {}\n      runs?.forEach((r) => {\n        const provider = r.model_id?.split('/')[0] || 'unknown'\n        costByProvider[provider] = (costByProvider[provider] || 0) + (r.total_cost || 0)\n      })\n\n      // Daily usage\n      const dailyMap = new Map<string, { runs: number; tokens: number; cost: number }>()\n      runs?.forEach((r) => {\n        if (!r.created_at) return\n        const date = new Date(r.created_at).toISOString().split('T')[0] as string\n        const existing = dailyMap.get(date) || { runs: 0, tokens: 0, cost: 0 }\n        dailyMap.set(date, {\n          runs: existing.runs + 1,\n          tokens: existing.tokens + (r.total_tokens || 0),\n          cost: existing.cost + (r.total_cost || 0),\n        })\n      })\n      const dailyUsage = Array.from(dailyMap.entries())\n        .map(([date, data]) => ({ date, ...data }))\n        .sort((a, b) => a.date.localeCompare(b.date))\n\n      // Top users\n      const userMap = new Map<string, { runs: number; cost: number }>()\n      runs?.forEach((r) => {\n        const existing = userMap.get(r.user_id) || { runs: 0, cost: 0 }\n        userMap.set(r.user_id, {\n          runs: existing.runs + 1,\n          cost: existing.cost + (r.total_cost || 0),\n        })\n      })\n\n      // Get user emails\n      const userIds = Array.from(userMap.keys())\n      const { data: profiles } = await supabase\n        .from('profiles')\n        .select('id, email')\n        .in('id', userIds)\n\n      const emailMap = new Map(profiles?.map((p) => [p.id, p.email]) || [])\n\n      const topUsers = Array.from(userMap.entries())\n        .map(([user_id, data]) => ({\n          user_id,\n          email: emailMap.get(user_id) || 'Unknown',\n          ...data,\n        }))\n        .sort((a, b) => b.cost - a.cost)\n        .slice(0, 10)\n\n      return {\n        totalRuns,\n        totalTokens,\n        totalCost,\n        averageLatency,\n        successRate,\n        runsByType,\n        costByProvider,\n        dailyUsage,\n        topUsers,\n      }\n    },\n    staleTime: 60 * 1000,\n  })\n\n  const formatCost = (cost: number) => {\n    return new Intl.NumberFormat(i18n.language, {\n      style: 'currency',\n      currency: 'USD',\n      minimumFractionDigits: 4,\n    }).format(cost)\n  }\n\n  const formatNumber = (num: number) => {\n    return new Intl.NumberFormat(i18n.language).format(num)\n  }\n\n  const RUN_TYPE_ICONS: Record<string, typeof FileText> = {\n    brief_generation: FileText,\n    chat: MessageSquare,\n    entity_linking: Link2,\n  }\n\n  return (\n    <div className=\"container mx-auto px-4 py-6 sm:py-8\" dir={isRTL ? 'rtl' : 'ltr'}>\n      {/* Header */}\n      <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6\">\n        <div>\n          <h1 className=\"text-2xl sm:text-3xl font-bold flex items-center gap-2\">\n            <BarChart3 className=\"h-7 w-7 text-primary\" />\n            {t('usage.title', 'AI Usage Dashboard')}\n          </h1>\n          <p className=\"text-muted-foreground mt-1\">\n            {t('usage.description', 'Monitor AI feature usage, costs, and performance')}\n          </p>\n        </div>\n        <div className=\"flex items-center gap-3\">\n          <Select value={dateRange} onValueChange={(v) => setDateRange(v as typeof dateRange)}>\n            <SelectTrigger className=\"w-32\">\n              <Calendar className=\"h-4 w-4 me-2\" />\n              <SelectValue />\n            </SelectTrigger>\n            <SelectContent>\n              <SelectItem value=\"7d\">{t('usage.dateRange.7d', 'Last 7 days')}</SelectItem>\n              <SelectItem value=\"30d\">{t('usage.dateRange.30d', 'Last 30 days')}</SelectItem>\n              <SelectItem value=\"90d\">{t('usage.dateRange.90d', 'Last 90 days')}</SelectItem>\n            </SelectContent>\n          </Select>\n          <Button variant=\"outline\" size=\"icon\" onClick={() => refetch()} disabled={isRefetching}>\n            <RefreshCw className={cn('h-4 w-4', isRefetching && 'animate-spin')} />\n          </Button>\n        </div>\n      </div>\n\n      {/* Summary Cards */}\n      <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-6\">\n        <MetricCard\n          title={t('usage.metrics.totalRuns', 'Total Runs')}\n          value={isLoading ? undefined : formatNumber(metrics?.totalRuns || 0)}\n          icon={Zap}\n          isLoading={isLoading}\n        />\n        <MetricCard\n          title={t('usage.metrics.totalTokens', 'Total Tokens')}\n          value={isLoading ? undefined : formatNumber(metrics?.totalTokens || 0)}\n          icon={BarChart3}\n          isLoading={isLoading}\n        />\n        <MetricCard\n          title={t('usage.metrics.totalCost', 'Total Cost')}\n          value={isLoading ? undefined : formatCost(metrics?.totalCost || 0)}\n          icon={DollarSign}\n          trend={metrics?.totalCost && metrics.totalCost > 0 ? 'up' : undefined}\n          isLoading={isLoading}\n        />\n        <MetricCard\n          title={t('usage.metrics.successRate', 'Success Rate')}\n          value={isLoading ? undefined : `${(metrics?.successRate || 0).toFixed(1)}%`}\n          icon={TrendingUp}\n          trend={(metrics?.successRate || 0) >= 95 ? 'up' : 'down'}\n          isLoading={isLoading}\n        />\n      </div>\n\n      {/* Tabs */}\n      <Tabs value={activeTab} onValueChange={(v) => setActiveTab(v as typeof activeTab)}>\n        <TabsList className=\"mb-4\">\n          <TabsTrigger value=\"overview\">{t('usage.tabs.overview', 'Overview')}</TabsTrigger>\n          <TabsTrigger value=\"users\">{t('usage.tabs.users', 'Top Users')}</TabsTrigger>\n          <TabsTrigger value=\"breakdown\">{t('usage.tabs.breakdown', 'Breakdown')}</TabsTrigger>\n        </TabsList>\n\n        <TabsContent value=\"overview\">\n          <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n            {/* Usage by Type */}\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"text-lg\">{t('usage.byType', 'Usage by Feature')}</CardTitle>\n              </CardHeader>\n              <CardContent>\n                {isLoading ? (\n                  <div className=\"space-y-3\">\n                    <Skeleton className=\"h-12 w-full\" />\n                    <Skeleton className=\"h-12 w-full\" />\n                    <Skeleton className=\"h-12 w-full\" />\n                  </div>\n                ) : (\n                  <div className=\"space-y-4\">\n                    {Object.entries(metrics?.runsByType || {}).map(([type, count]) => {\n                      const Icon = RUN_TYPE_ICONS[type] || Zap\n                      const total = metrics?.totalRuns || 1\n                      const percentage = (count / total) * 100\n                      return (\n                        <div key={type} className=\"space-y-2\">\n                          <div className=\"flex items-center justify-between\">\n                            <div className=\"flex items-center gap-2\">\n                              <Icon className=\"h-4 w-4 text-muted-foreground\" />\n                              <span className=\"text-sm font-medium capitalize\">\n                                {type.replace(/_/g, ' ')}\n                              </span>\n                            </div>\n                            <span className=\"text-sm text-muted-foreground\">\n                              {formatNumber(count)} ({percentage.toFixed(1)}%)\n                            </span>\n                          </div>\n                          <Progress value={percentage} className=\"h-2\" />\n                        </div>\n                      )\n                    })}\n                    {Object.keys(metrics?.runsByType || {}).length === 0 && (\n                      <p className=\"text-center text-muted-foreground py-4\">\n                        {t('usage.noData', 'No usage data available')}\n                      </p>\n                    )}\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n\n            {/* Cost by Provider */}\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"text-lg\">\n                  {t('usage.byProvider', 'Cost by Provider')}\n                </CardTitle>\n              </CardHeader>\n              <CardContent>\n                {isLoading ? (\n                  <div className=\"space-y-3\">\n                    <Skeleton className=\"h-12 w-full\" />\n                    <Skeleton className=\"h-12 w-full\" />\n                  </div>\n                ) : (\n                  <div className=\"space-y-4\">\n                    {Object.entries(metrics?.costByProvider || {}).map(([provider, cost]) => {\n                      const total = metrics?.totalCost || 1\n                      const percentage = (cost / total) * 100\n                      return (\n                        <div key={provider} className=\"space-y-2\">\n                          <div className=\"flex items-center justify-between\">\n                            <span className=\"text-sm font-medium capitalize\">{provider}</span>\n                            <span className=\"text-sm text-muted-foreground\">\n                              {formatCost(cost)} ({percentage.toFixed(1)}%)\n                            </span>\n                          </div>\n                          <Progress value={percentage} className=\"h-2\" />\n                        </div>\n                      )\n                    })}\n                    {Object.keys(metrics?.costByProvider || {}).length === 0 && (\n                      <p className=\"text-center text-muted-foreground py-4\">\n                        {t('usage.noData', 'No cost data available')}\n                      </p>\n                    )}\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n          </div>\n\n          {/* Daily Usage Chart (Simple bar representation) */}\n          <Card className=\"mt-6\">\n            <CardHeader>\n              <CardTitle className=\"text-lg\">{t('usage.dailyUsage', 'Daily Usage')}</CardTitle>\n              <CardDescription>\n                {t('usage.dailyUsageDesc', 'Number of AI runs per day')}\n              </CardDescription>\n            </CardHeader>\n            <CardContent>\n              {isLoading ? (\n                <Skeleton className=\"h-48 w-full\" />\n              ) : (\n                <div className=\"h-48 flex items-end gap-1\">\n                  {metrics?.dailyUsage.slice(-30).map((day) => {\n                    const maxRuns = Math.max(...(metrics?.dailyUsage.map((d) => d.runs) || [1]))\n                    const height = (day.runs / maxRuns) * 100\n                    return (\n                      <div\n                        key={day.date}\n                        className=\"flex-1 bg-primary/80 hover:bg-primary rounded-t transition-colors cursor-pointer group relative\"\n                        style={{ height: `${Math.max(height, 2)}%` }}\n                        title={`${day.date}: ${day.runs} runs`}\n                      >\n                        <div className=\"absolute bottom-full mb-2 left-1/2 -translate-x-1/2 bg-popover text-popover-foreground text-xs px-2 py-1 rounded shadow-lg opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap z-10\">\n                          {day.date}: {day.runs} runs\n                        </div>\n                      </div>\n                    )\n                  })}\n                  {(metrics?.dailyUsage.length || 0) === 0 && (\n                    <p className=\"w-full text-center text-muted-foreground py-8\">\n                      {t('usage.noData', 'No usage data available')}\n                    </p>\n                  )}\n                </div>\n              )}\n            </CardContent>\n          </Card>\n        </TabsContent>\n\n        <TabsContent value=\"users\">\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"text-lg flex items-center gap-2\">\n                <Users className=\"h-5 w-5\" />\n                {t('usage.topUsers', 'Top Users by Cost')}\n              </CardTitle>\n            </CardHeader>\n            <CardContent>\n              {isLoading ? (\n                <div className=\"space-y-3\">\n                  {[1, 2, 3, 4, 5].map((i) => (\n                    <Skeleton key={i} className=\"h-12 w-full\" />\n                  ))}\n                </div>\n              ) : (\n                <div className=\"space-y-3\">\n                  {metrics?.topUsers.map((user, index) => (\n                    <div\n                      key={user.user_id}\n                      className=\"flex items-center justify-between p-3 rounded-lg bg-muted/50\"\n                    >\n                      <div className=\"flex items-center gap-3\">\n                        <Badge\n                          variant=\"outline\"\n                          className=\"w-8 h-8 rounded-full flex items-center justify-center\"\n                        >\n                          {index + 1}\n                        </Badge>\n                        <div>\n                          <p className=\"font-medium text-sm\">{user.email}</p>\n                          <p className=\"text-xs text-muted-foreground\">\n                            {formatNumber(user.runs)} {t('usage.runs', 'runs')}\n                          </p>\n                        </div>\n                      </div>\n                      <div className=\"text-end\">\n                        <p className=\"font-medium\">{formatCost(user.cost)}</p>\n                      </div>\n                    </div>\n                  ))}\n                  {(metrics?.topUsers.length || 0) === 0 && (\n                    <p className=\"text-center text-muted-foreground py-8\">\n                      {t('usage.noUsers', 'No user data available')}\n                    </p>\n                  )}\n                </div>\n              )}\n            </CardContent>\n          </Card>\n        </TabsContent>\n\n        <TabsContent value=\"breakdown\">\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"text-lg\">{t('usage.performance', 'Performance')}</CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"flex items-center justify-between\">\n                  <span className=\"text-sm\">{t('usage.avgLatency', 'Avg. Latency')}</span>\n                  <Badge variant=\"outline\">\n                    {isLoading ? '...' : `${(metrics?.averageLatency || 0).toFixed(0)}ms`}\n                  </Badge>\n                </div>\n                <div className=\"flex items-center justify-between\">\n                  <span className=\"text-sm\">{t('usage.successRate', 'Success Rate')}</span>\n                  <Badge variant={(metrics?.successRate || 0) >= 95 ? 'default' : 'destructive'}>\n                    {isLoading ? '...' : `${(metrics?.successRate || 0).toFixed(1)}%`}\n                  </Badge>\n                </div>\n                <div className=\"flex items-center justify-between\">\n                  <span className=\"text-sm\">{t('usage.avgTokensPerRun', 'Avg. Tokens/Run')}</span>\n                  <Badge variant=\"outline\">\n                    {isLoading\n                      ? '...'\n                      : formatNumber(\n                          metrics?.totalRuns\n                            ? Math.round((metrics?.totalTokens || 0) / metrics.totalRuns)\n                            : 0,\n                        )}\n                  </Badge>\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"text-lg\">\n                  {t('usage.costBreakdown', 'Cost Summary')}\n                </CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"flex items-center justify-between\">\n                  <span className=\"text-sm\">{t('usage.totalCost', 'Total Cost')}</span>\n                  <span className=\"font-bold text-lg\">\n                    {isLoading ? '...' : formatCost(metrics?.totalCost || 0)}\n                  </span>\n                </div>\n                <div className=\"flex items-center justify-between\">\n                  <span className=\"text-sm\">{t('usage.avgCostPerRun', 'Avg. Cost/Run')}</span>\n                  <Badge variant=\"outline\">\n                    {isLoading\n                      ? '...'\n                      : formatCost(\n                          metrics?.totalRuns ? (metrics?.totalCost || 0) / metrics.totalRuns : 0,\n                        )}\n                  </Badge>\n                </div>\n                <div className=\"flex items-center justify-between\">\n                  <span className=\"text-sm\">\n                    {t('usage.projectedMonthly', 'Projected Monthly')}\n                  </span>\n                  <Badge variant=\"secondary\">\n                    {isLoading\n                      ? '...'\n                      : formatCost(\n                          ((metrics?.totalCost || 0) /\n                            (dateRange === '7d' ? 7 : dateRange === '30d' ? 30 : 90)) *\n                            30,\n                        )}\n                  </Badge>\n                </div>\n              </CardContent>\n            </Card>\n          </div>\n        </TabsContent>\n      </Tabs>\n    </div>\n  )\n}\n\ninterface MetricCardProps {\n  title: string\n  value?: string\n  icon: typeof BarChart3\n  trend?: 'up' | 'down'\n  isLoading?: boolean\n}\n\nfunction MetricCard({ title, value, icon: Icon, trend, isLoading }: MetricCardProps) {\n  return (\n    <Card>\n      <CardContent className=\"pt-6\">\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <p className=\"text-sm text-muted-foreground\">{title}</p>\n            {isLoading ? (\n              <Skeleton className=\"h-8 w-24 mt-1\" />\n            ) : (\n              <p className=\"text-2xl font-bold mt-1\">{value}</p>\n            )}\n          </div>\n          <div className=\"flex items-center gap-2\">\n            {trend &&\n              (trend === 'up' ? (\n                <TrendingUp className=\"h-4 w-4 text-green-500\" />\n              ) : (\n                <TrendingDown className=\"h-4 w-4 text-red-500\" />\n              ))}\n            <div className=\"p-2 rounded-full bg-primary/10\">\n              <Icon className=\"h-5 w-5 text-primary\" />\n            </div>\n          </div>\n        </div>\n      </CardContent>\n    </Card>\n  )\n}\n\nexport default AIUsageDashboard\n","/**\n * Toast Hook\n *\n * Wrapper around react-hot-toast for consistent toast notifications\n * across the application.\n */\n\nimport toast from 'react-hot-toast';\n\ntype ToastVariant = 'default' | 'destructive' | 'success';\n\ninterface ToastOptions {\n  title: string;\n  description?: string;\n  variant?: ToastVariant;\n  duration?: number;\n}\n\nexport function useToast() {\n  const showToast = (options: ToastOptions) => {\n    const { title, description, variant = 'default', duration = 4000 } = options;\n\n    const message = description ? `${title}\\n${description}` : title;\n\n    switch (variant) {\n      case 'destructive':\n        toast.error(message, { duration });\n        break;\n      case 'success':\n        toast.success(message, { duration });\n        break;\n      default:\n        toast(message, { duration });\n    }\n  };\n\n  return {\n    toast: showToast,\n  };\n}\n","/**\n * Route: /admin/ai-settings\n * AI Settings & LLM Policy Configuration\n * Feature: 033-ai-brief-generation\n * Tasks: T053, T054\n */\n\nimport { createFileRoute } from '@tanstack/react-router'\nimport { useState } from 'react'\nimport { useTranslation } from 'react-i18next'\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query'\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Button } from '@/components/ui/button'\nimport { Badge } from '@/components/ui/badge'\nimport { Input } from '@/components/ui/input'\nimport { Label } from '@/components/ui/label'\nimport { Switch } from '@/components/ui/switch'\nimport { Skeleton } from '@/components/ui/skeleton'\nimport { Alert, AlertDescription, AlertTitle } from '@/components/ui/alert'\nimport { Separator } from '@/components/ui/separator'\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from '@/components/ui/select'\n// cn utility available if needed for conditional classes\nimport { supabase } from '@/lib/supabase'\nimport {\n  Settings,\n  Brain,\n  DollarSign,\n  Shield,\n  Zap,\n  AlertTriangle,\n  CheckCircle2,\n  Save,\n  RotateCcw,\n  FileText,\n  MessageSquare,\n  Link2,\n} from 'lucide-react'\nimport { useToast } from '@/hooks/use-toast'\n\nexport const Route = createFileRoute('/_protected/admin/ai-settings')({\n  component: AISettingsPage,\n  beforeLoad: async () => {\n    const {\n      data: { session },\n    } = await supabase.auth.getSession()\n    const user = session?.user\n    const isAdmin = user?.user_metadata?.role === 'admin' || user?.app_metadata?.role === 'admin'\n    if (!isAdmin) {\n      throw new Error('Admin access required')\n    }\n  },\n})\n\ninterface LLMPolicy {\n  id: string\n  organization_id: string\n  default_provider: string\n  default_model: string\n  fallback_provider: string | null\n  fallback_model: string | null\n  max_tokens_per_request: number\n  max_requests_per_minute: number\n  max_requests_per_day: number\n  monthly_spend_cap: number | null\n  features_enabled: {\n    brief_generation: boolean\n    chat: boolean\n    entity_linking: boolean\n  }\n  created_at: string\n  updated_at: string\n}\n\ninterface AIModelPricing {\n  model_id: string\n  provider: string\n  model_name: string\n  input_cost_per_1k: number\n  output_cost_per_1k: number\n  context_window: number\n  is_active: boolean\n}\n\nconst PROVIDERS = [\n  { value: 'anthropic', label: 'Anthropic' },\n  { value: 'openai', label: 'OpenAI' },\n  { value: 'google', label: 'Google' },\n]\n\nconst MODELS: Record<string, Array<{ value: string; label: string }>> = {\n  anthropic: [\n    { value: 'claude-sonnet-4-20250514', label: 'Claude Sonnet 4' },\n    { value: 'claude-3-5-sonnet-20241022', label: 'Claude 3.5 Sonnet' },\n    { value: 'claude-3-haiku-20240307', label: 'Claude 3 Haiku' },\n  ],\n  openai: [\n    { value: 'gpt-4o', label: 'GPT-4o' },\n    { value: 'gpt-4o-mini', label: 'GPT-4o Mini' },\n    { value: 'gpt-4-turbo', label: 'GPT-4 Turbo' },\n  ],\n  google: [\n    { value: 'gemini-1.5-pro', label: 'Gemini 1.5 Pro' },\n    { value: 'gemini-1.5-flash', label: 'Gemini 1.5 Flash' },\n  ],\n}\n\nfunction AISettingsPage() {\n  const { t, i18n } = useTranslation('ai-admin')\n  const isRTL = i18n.language === 'ar'\n  const queryClient = useQueryClient()\n  const { toast } = useToast()\n\n  const [formState, setFormState] = useState<Partial<LLMPolicy> | null>(null)\n  const [hasChanges, setHasChanges] = useState(false)\n\n  // Fetch current organization's LLM policy\n  const { data: policy, isLoading: policyLoading } = useQuery({\n    queryKey: ['llm-policy'],\n    queryFn: async (): Promise<LLMPolicy | null> => {\n      const {\n        data: { session },\n      } = await supabase.auth.getSession()\n      const orgId = session?.user?.user_metadata?.organization_id\n\n      if (!orgId) return null\n\n      const { data, error } = await supabase\n        .from('organization_llm_policies')\n        .select('*')\n        .eq('organization_id', orgId)\n        .single()\n\n      if (error && error.code !== 'PGRST116') throw error\n      return data\n    },\n    staleTime: 60 * 1000,\n  })\n\n  // Fetch model pricing for reference\n  const { data: modelPricing } = useQuery({\n    queryKey: ['ai-model-pricing'],\n    queryFn: async (): Promise<AIModelPricing[]> => {\n      const { data, error } = await supabase\n        .from('ai_model_pricing')\n        .select('*')\n        .eq('is_active', true)\n        .order('provider')\n\n      if (error) throw error\n      return data || []\n    },\n  })\n\n  // Update policy mutation\n  const updatePolicyMutation = useMutation({\n    mutationFn: async (updates: Partial<LLMPolicy>) => {\n      const {\n        data: { session },\n      } = await supabase.auth.getSession()\n      const orgId = session?.user?.user_metadata?.organization_id\n\n      if (!orgId) throw new Error('No organization')\n\n      const { data, error } = await supabase\n        .from('organization_llm_policies')\n        .upsert({\n          organization_id: orgId,\n          ...updates,\n          updated_at: new Date().toISOString(),\n        })\n        .select()\n        .single()\n\n      if (error) throw error\n      return data\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['llm-policy'] })\n      setHasChanges(false)\n      toast({\n        title: t('settings.saved', 'Settings saved'),\n        description: t('settings.savedDesc', 'AI settings have been updated successfully.'),\n      })\n    },\n    onError: (error) => {\n      toast({\n        title: t('settings.error', 'Error'),\n        description: error.message,\n        variant: 'destructive',\n      })\n    },\n  })\n\n  // Initialize form state from policy\n  const currentState = formState ||\n    policy || {\n      default_provider: 'anthropic',\n      default_model: 'claude-sonnet-4-20250514',\n      fallback_provider: null,\n      fallback_model: null,\n      max_tokens_per_request: 8192,\n      max_requests_per_minute: 10,\n      max_requests_per_day: 500,\n      monthly_spend_cap: null,\n      features_enabled: {\n        brief_generation: true,\n        chat: true,\n        entity_linking: true,\n      },\n    }\n\n  const updateField = <K extends keyof LLMPolicy>(field: K, value: LLMPolicy[K]) => {\n    setFormState((prev) => ({\n      ...(prev || policy || {}),\n      [field]: value,\n    }))\n    setHasChanges(true)\n  }\n\n  const updateFeature = (feature: keyof LLMPolicy['features_enabled'], enabled: boolean) => {\n    const defaultFeatures: LLMPolicy['features_enabled'] = {\n      brief_generation: true,\n      chat: true,\n      entity_linking: true,\n    }\n    const features: LLMPolicy['features_enabled'] = {\n      ...defaultFeatures,\n      ...currentState.features_enabled,\n      [feature]: enabled,\n    }\n    updateField('features_enabled', features)\n  }\n\n  const handleSave = () => {\n    if (formState) {\n      updatePolicyMutation.mutate(formState)\n    }\n  }\n\n  const handleReset = () => {\n    setFormState(null)\n    setHasChanges(false)\n  }\n\n  const getModelPricingInfo = (modelId: string) => {\n    return modelPricing?.find((m) => m.model_id === modelId)\n  }\n\n  return (\n    <div className=\"container mx-auto px-4 py-6 sm:py-8\" dir={isRTL ? 'rtl' : 'ltr'}>\n      {/* Header */}\n      <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6\">\n        <div>\n          <h1 className=\"text-2xl sm:text-3xl font-bold flex items-center gap-2\">\n            <Settings className=\"h-7 w-7 text-primary\" />\n            {t('settings.title', 'AI Settings')}\n          </h1>\n          <p className=\"text-muted-foreground mt-1\">\n            {t('settings.description', 'Configure AI features, models, and spending limits')}\n          </p>\n        </div>\n        <div className=\"flex items-center gap-3\">\n          {hasChanges && (\n            <>\n              <Button variant=\"outline\" onClick={handleReset}>\n                <RotateCcw className=\"h-4 w-4 me-2\" />\n                {t('settings.reset', 'Reset')}\n              </Button>\n              <Button onClick={handleSave} disabled={updatePolicyMutation.isPending}>\n                <Save className=\"h-4 w-4 me-2\" />\n                {t('settings.save', 'Save Changes')}\n              </Button>\n            </>\n          )}\n        </div>\n      </div>\n\n      {/* Unsaved Changes Warning */}\n      {hasChanges && (\n        <Alert className=\"mb-6\">\n          <AlertTriangle className=\"h-4 w-4\" />\n          <AlertTitle>{t('settings.unsaved', 'Unsaved Changes')}</AlertTitle>\n          <AlertDescription>\n            {t(\n              'settings.unsavedDesc',\n              'You have unsaved changes. Click \"Save Changes\" to apply them.',\n            )}\n          </AlertDescription>\n        </Alert>\n      )}\n\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n        {/* Feature Toggles */}\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2\">\n              <Zap className=\"h-5 w-5\" />\n              {t('settings.features', 'AI Features')}\n            </CardTitle>\n            <CardDescription>\n              {t('settings.featuresDesc', 'Enable or disable AI features for your organization')}\n            </CardDescription>\n          </CardHeader>\n          <CardContent className=\"space-y-6\">\n            {policyLoading ? (\n              <div className=\"space-y-4\">\n                <Skeleton className=\"h-12 w-full\" />\n                <Skeleton className=\"h-12 w-full\" />\n                <Skeleton className=\"h-12 w-full\" />\n              </div>\n            ) : (\n              <>\n                <div className=\"flex items-center justify-between\">\n                  <div className=\"flex items-center gap-3\">\n                    <FileText className=\"h-5 w-5 text-muted-foreground\" />\n                    <div>\n                      <p className=\"font-medium\">\n                        {t('settings.briefGeneration', 'Brief Generation')}\n                      </p>\n                      <p className=\"text-sm text-muted-foreground\">\n                        {t('settings.briefGenerationDesc', 'AI-generated briefing documents')}\n                      </p>\n                    </div>\n                  </div>\n                  <Switch\n                    checked={currentState.features_enabled?.brief_generation ?? true}\n                    onCheckedChange={(checked) => updateFeature('brief_generation', checked)}\n                  />\n                </div>\n\n                <Separator />\n\n                <div className=\"flex items-center justify-between\">\n                  <div className=\"flex items-center gap-3\">\n                    <MessageSquare className=\"h-5 w-5 text-muted-foreground\" />\n                    <div>\n                      <p className=\"font-medium\">{t('settings.chat', 'AI Chat')}</p>\n                      <p className=\"text-sm text-muted-foreground\">\n                        {t('settings.chatDesc', 'Natural language Q&A interface')}\n                      </p>\n                    </div>\n                  </div>\n                  <Switch\n                    checked={currentState.features_enabled?.chat ?? true}\n                    onCheckedChange={(checked) => updateFeature('chat', checked)}\n                  />\n                </div>\n\n                <Separator />\n\n                <div className=\"flex items-center justify-between\">\n                  <div className=\"flex items-center gap-3\">\n                    <Link2 className=\"h-5 w-5 text-muted-foreground\" />\n                    <div>\n                      <p className=\"font-medium\">{t('settings.entityLinking', 'Entity Linking')}</p>\n                      <p className=\"text-sm text-muted-foreground\">\n                        {t('settings.entityLinkingDesc', 'AI-suggested entity links for intake')}\n                      </p>\n                    </div>\n                  </div>\n                  <Switch\n                    checked={currentState.features_enabled?.entity_linking ?? true}\n                    onCheckedChange={(checked) => updateFeature('entity_linking', checked)}\n                  />\n                </div>\n              </>\n            )}\n          </CardContent>\n        </Card>\n\n        {/* Model Configuration */}\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2\">\n              <Brain className=\"h-5 w-5\" />\n              {t('settings.modelConfig', 'Model Configuration')}\n            </CardTitle>\n            <CardDescription>\n              {t('settings.modelConfigDesc', 'Select default and fallback AI models')}\n            </CardDescription>\n          </CardHeader>\n          <CardContent className=\"space-y-6\">\n            {policyLoading ? (\n              <div className=\"space-y-4\">\n                <Skeleton className=\"h-12 w-full\" />\n                <Skeleton className=\"h-12 w-full\" />\n              </div>\n            ) : (\n              <>\n                <div className=\"space-y-2\">\n                  <Label>{t('settings.defaultProvider', 'Default Provider')}</Label>\n                  <Select\n                    value={currentState.default_provider}\n                    onValueChange={(v) => {\n                      updateField('default_provider', v)\n                      updateField('default_model', MODELS[v]?.[0]?.value || '')\n                    }}\n                  >\n                    <SelectTrigger>\n                      <SelectValue />\n                    </SelectTrigger>\n                    <SelectContent>\n                      {PROVIDERS.map((p) => (\n                        <SelectItem key={p.value} value={p.value}>\n                          {p.label}\n                        </SelectItem>\n                      ))}\n                    </SelectContent>\n                  </Select>\n                </div>\n\n                <div className=\"space-y-2\">\n                  <Label>{t('settings.defaultModel', 'Default Model')}</Label>\n                  <Select\n                    value={currentState.default_model}\n                    onValueChange={(v) => updateField('default_model', v)}\n                  >\n                    <SelectTrigger>\n                      <SelectValue />\n                    </SelectTrigger>\n                    <SelectContent>\n                      {MODELS[currentState.default_provider || 'anthropic']?.map((m) => (\n                        <SelectItem key={m.value} value={m.value}>\n                          {m.label}\n                        </SelectItem>\n                      ))}\n                    </SelectContent>\n                  </Select>\n                  {currentState.default_model && (\n                    <div className=\"text-xs text-muted-foreground mt-1\">\n                      {getModelPricingInfo(currentState.default_model) && (\n                        <>\n                          Input: $\n                          {getModelPricingInfo(currentState.default_model)?.input_cost_per_1k}/1K\n                          tokens, Output: $\n                          {getModelPricingInfo(currentState.default_model)?.output_cost_per_1k}/1K\n                          tokens\n                        </>\n                      )}\n                    </div>\n                  )}\n                </div>\n\n                <Separator />\n\n                <div className=\"space-y-2\">\n                  <Label>{t('settings.fallbackProvider', 'Fallback Provider (Optional)')}</Label>\n                  <Select\n                    value={currentState.fallback_provider || '__none__'}\n                    onValueChange={(v) => {\n                      const provider = v === '__none__' ? null : v\n                      updateField('fallback_provider', provider)\n                      updateField(\n                        'fallback_model',\n                        provider ? MODELS[provider]?.[0]?.value || null : null,\n                      )\n                    }}\n                  >\n                    <SelectTrigger>\n                      <SelectValue placeholder={t('settings.none', 'None')} />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"__none__\">{t('settings.none', 'None')}</SelectItem>\n                      {PROVIDERS.filter((p) => p.value !== currentState.default_provider).map(\n                        (p) => (\n                          <SelectItem key={p.value} value={p.value}>\n                            {p.label}\n                          </SelectItem>\n                        ),\n                      )}\n                    </SelectContent>\n                  </Select>\n                </div>\n\n                {currentState.fallback_provider && (\n                  <div className=\"space-y-2\">\n                    <Label>{t('settings.fallbackModel', 'Fallback Model')}</Label>\n                    <Select\n                      value={currentState.fallback_model || ''}\n                      onValueChange={(v) => updateField('fallback_model', v || null)}\n                    >\n                      <SelectTrigger>\n                        <SelectValue />\n                      </SelectTrigger>\n                      <SelectContent>\n                        {MODELS[currentState.fallback_provider]?.map((m) => (\n                          <SelectItem key={m.value} value={m.value}>\n                            {m.label}\n                          </SelectItem>\n                        ))}\n                      </SelectContent>\n                    </Select>\n                  </div>\n                )}\n              </>\n            )}\n          </CardContent>\n        </Card>\n\n        {/* Rate Limits */}\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2\">\n              <Shield className=\"h-5 w-5\" />\n              {t('settings.rateLimits', 'Rate Limits')}\n            </CardTitle>\n            <CardDescription>\n              {t('settings.rateLimitsDesc', 'Control API usage limits')}\n            </CardDescription>\n          </CardHeader>\n          <CardContent className=\"space-y-6\">\n            {policyLoading ? (\n              <div className=\"space-y-4\">\n                <Skeleton className=\"h-12 w-full\" />\n                <Skeleton className=\"h-12 w-full\" />\n                <Skeleton className=\"h-12 w-full\" />\n              </div>\n            ) : (\n              <>\n                <div className=\"space-y-2\">\n                  <Label>{t('settings.maxTokens', 'Max Tokens per Request')}</Label>\n                  <Input\n                    type=\"number\"\n                    value={currentState.max_tokens_per_request}\n                    onChange={(e) =>\n                      updateField('max_tokens_per_request', parseInt(e.target.value) || 0)\n                    }\n                    min={1000}\n                    max={128000}\n                  />\n                  <p className=\"text-xs text-muted-foreground\">\n                    {t('settings.maxTokensDesc', 'Maximum tokens allowed in a single AI request')}\n                  </p>\n                </div>\n\n                <div className=\"space-y-2\">\n                  <Label>{t('settings.maxPerMinute', 'Max Requests per Minute')}</Label>\n                  <Input\n                    type=\"number\"\n                    value={currentState.max_requests_per_minute}\n                    onChange={(e) =>\n                      updateField('max_requests_per_minute', parseInt(e.target.value) || 0)\n                    }\n                    min={1}\n                    max={100}\n                  />\n                </div>\n\n                <div className=\"space-y-2\">\n                  <Label>{t('settings.maxPerDay', 'Max Requests per Day')}</Label>\n                  <Input\n                    type=\"number\"\n                    value={currentState.max_requests_per_day}\n                    onChange={(e) =>\n                      updateField('max_requests_per_day', parseInt(e.target.value) || 0)\n                    }\n                    min={1}\n                    max={10000}\n                  />\n                </div>\n              </>\n            )}\n          </CardContent>\n        </Card>\n\n        {/* Spending Limits */}\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2\">\n              <DollarSign className=\"h-5 w-5\" />\n              {t('settings.spendingLimits', 'Spending Limits')}\n            </CardTitle>\n            <CardDescription>\n              {t('settings.spendingLimitsDesc', 'Set monthly budget caps for AI usage')}\n            </CardDescription>\n          </CardHeader>\n          <CardContent className=\"space-y-6\">\n            {policyLoading ? (\n              <Skeleton className=\"h-12 w-full\" />\n            ) : (\n              <>\n                <div className=\"space-y-2\">\n                  <Label>{t('settings.monthlyCap', 'Monthly Spend Cap (USD)')}</Label>\n                  <Input\n                    type=\"number\"\n                    value={currentState.monthly_spend_cap || ''}\n                    onChange={(e) =>\n                      updateField(\n                        'monthly_spend_cap',\n                        e.target.value ? parseFloat(e.target.value) : null,\n                      )\n                    }\n                    placeholder={t('settings.noLimit', 'No limit')}\n                    min={0}\n                    step={10}\n                  />\n                  <p className=\"text-xs text-muted-foreground\">\n                    {t(\n                      'settings.monthlyCapDesc',\n                      'Leave empty for no spending limit. AI features will be disabled when cap is reached.',\n                    )}\n                  </p>\n                </div>\n\n                {currentState.monthly_spend_cap && (\n                  <Alert>\n                    <AlertTriangle className=\"h-4 w-4\" />\n                    <AlertDescription>\n                      {t(\n                        'settings.capWarning',\n                        'When the monthly cap is reached, all AI features will be temporarily disabled until the next billing cycle.',\n                      )}\n                    </AlertDescription>\n                  </Alert>\n                )}\n              </>\n            )}\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Status */}\n      <Card className=\"mt-6\">\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <CheckCircle2 className=\"h-5 w-5 text-green-500\" />\n            {t('settings.status', 'Configuration Status')}\n          </CardTitle>\n        </CardHeader>\n        <CardContent>\n          <div className=\"flex flex-wrap gap-3\">\n            <Badge\n              variant={currentState.features_enabled?.brief_generation ? 'default' : 'secondary'}\n            >\n              <FileText className=\"h-3 w-3 me-1\" />\n              {t('settings.briefGeneration', 'Brief Generation')}:{' '}\n              {currentState.features_enabled?.brief_generation\n                ? t('settings.enabled', 'Enabled')\n                : t('settings.disabled', 'Disabled')}\n            </Badge>\n            <Badge variant={currentState.features_enabled?.chat ? 'default' : 'secondary'}>\n              <MessageSquare className=\"h-3 w-3 me-1\" />\n              {t('settings.chat', 'Chat')}:{' '}\n              {currentState.features_enabled?.chat\n                ? t('settings.enabled', 'Enabled')\n                : t('settings.disabled', 'Disabled')}\n            </Badge>\n            <Badge\n              variant={currentState.features_enabled?.entity_linking ? 'default' : 'secondary'}\n            >\n              <Link2 className=\"h-3 w-3 me-1\" />\n              {t('settings.entityLinking', 'Entity Linking')}:{' '}\n              {currentState.features_enabled?.entity_linking\n                ? t('settings.enabled', 'Enabled')\n                : t('settings.disabled', 'Disabled')}\n            </Badge>\n            <Badge variant=\"outline\">\n              <Brain className=\"h-3 w-3 me-1\" />\n              {currentState.default_provider}/\n              {currentState.default_model?.split('-').slice(0, 2).join('-')}\n            </Badge>\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  )\n}\n\nexport default AISettingsPage\n","/**\n * Working Groups List Page (Feature 028 - User Story 2)\n *\n * Displays filterable list of working group dossiers.\n * Mobile-first, RTL-compatible, WCAG AA compliant.\n */\n\nimport { createFileRoute, Link } from '@tanstack/react-router';\nimport { useTranslation } from 'react-i18next';\nimport { Loader2, Plus, Briefcase } from 'lucide-react';\nimport { useDossiersByType } from '@/hooks/useDossier';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from '@/components/ui/table';\nimport { Badge } from '@/components/ui/badge';\nimport { useState } from 'react';\n\nexport const Route = createFileRoute('/_protected/dossiers/working_groups/')({\n  component: WorkingGroupsListPage,\n});\n\nfunction WorkingGroupsListPage() {\n  const { t, i18n } = useTranslation('dossier');\n  const isRTL = i18n.language === 'ar';\n\n  const [searchQuery, setSearchQuery] = useState('');\n  const [page, setPage] = useState(1);\n  const pageSize = 20;\n\n  // Fetch working group dossiers\n  const { data, isLoading, error } = useDossiersByType('working_group', page, pageSize);\n\n  // Filter by search query (client-side for now)\n  const filteredDossiers = data?.data.filter((dossier) => {\n    if (!searchQuery) return true;\n    const searchLower = searchQuery.toLowerCase();\n    return (\n      dossier.name_en.toLowerCase().includes(searchLower) ||\n      dossier.name_ar?.toLowerCase().includes(searchLower) ||\n      dossier.description_en?.toLowerCase().includes(searchLower) ||\n      dossier.description_ar?.toLowerCase().includes(searchLower)\n    );\n  });\n\n  return (\n    <div\n      className=\"container mx-auto px-4 sm:px-6 lg:px-8 py-4 sm:py-6 lg:py-8\"\n      dir={isRTL ? 'rtl' : 'ltr'}\n    >\n      {/* Page Header */}\n      <header className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6 sm:mb-8\">\n        <div className=\"flex items-center gap-3\">\n          <Briefcase className=\"h-6 w-6 sm:h-8 sm:w-8 text-primary\" />\n          <div>\n            <h1 className=\"text-2xl sm:text-3xl md:text-4xl font-bold\">\n              {t('type.working_group')}\n            </h1>\n            <p className=\"text-sm sm:text-base text-muted-foreground mt-1\">\n              {t('typeDescription.working_group')}\n            </p>\n          </div>\n        </div>\n        <Button asChild>\n          <Link to=\"/dossiers/create\">\n            <Plus className=\"h-4 w-4 me-2\" />\n            {t('action.create')}\n          </Link>\n        </Button>\n      </header>\n\n      {/* Search Bar */}\n      <div className=\"mb-6\">\n        <Input\n          type=\"text\"\n          placeholder={t('filter.search')}\n          value={searchQuery}\n          onChange={(e) => setSearchQuery(e.target.value)}\n          className=\"max-w-md\"\n        />\n      </div>\n\n      {/* Loading State */}\n      {isLoading && (\n        <div className=\"flex items-center justify-center py-12 sm:py-16 lg:py-20\">\n          <Loader2 className=\"h-8 w-8 sm:h-10 sm:w-10 animate-spin text-muted-foreground\" />\n          <span className=\"ms-3 text-muted-foreground text-sm sm:text-base\">\n            {t('list.loading')}\n          </span>\n        </div>\n      )}\n\n      {/* Error State */}\n      {error && !isLoading && (\n        <div\n          className=\"bg-destructive/10 border border-destructive/20 rounded-lg p-4 sm:p-6\"\n          role=\"alert\"\n        >\n          <h3 className=\"text-base sm:text-lg font-semibold text-destructive mb-2\">\n            {t('list.error')}\n          </h3>\n          <p className=\"text-sm sm:text-base text-destructive/90\">\n            {error.message}\n          </p>\n        </div>\n      )}\n\n      {/* Empty State */}\n      {!isLoading && !error && filteredDossiers?.length === 0 && (\n        <div className=\"flex flex-col items-center justify-center py-12 sm:py-16 lg:py-20 text-center\">\n          <Briefcase className=\"h-12 w-12 sm:h-16 sm:w-16 text-muted-foreground mb-4\" />\n          <h3 className=\"text-base sm:text-lg font-semibold mb-2\">\n            {searchQuery ? t('list.emptyFiltered') : t('list.empty')}\n          </h3>\n          <p className=\"text-sm sm:text-base text-muted-foreground max-w-md mb-6\">\n            {searchQuery\n              ? t('list.emptyFilteredDescription')\n              : t('list.emptyDescription')}\n          </p>\n          {!searchQuery && (\n            <Button asChild>\n              <Link to=\"/dossiers/create\">\n                {t('action.create')}\n              </Link>\n            </Button>\n          )}\n        </div>\n      )}\n\n      {/* Table - Desktop */}\n      {!isLoading && !error && filteredDossiers && filteredDossiers.length > 0 && (\n        <>\n          <div className=\"hidden md:block rounded-lg border overflow-hidden\">\n            <Table>\n              <TableHeader>\n                <TableRow>\n                  <TableHead>{t('form.nameEn')}</TableHead>\n                  <TableHead>{t('form.nameAr')}</TableHead>\n                  <TableHead>{t('form.status')}</TableHead>\n                  <TableHead>{t('form.sensitivityLevel')}</TableHead>\n                  <TableHead className=\"text-end\">{t('action.more')}</TableHead>\n                </TableRow>\n              </TableHeader>\n              <TableBody>\n                {filteredDossiers.map((dossier) => (\n                  <TableRow key={dossier.id}>\n                    <TableCell className=\"font-medium\">\n                      <Link\n                        to={`/dossiers/${dossier.id}`}\n                        className=\"hover:text-primary hover:underline\"\n                      >\n                        {dossier.name_en}\n                      </Link>\n                    </TableCell>\n                    <TableCell>{dossier.name_ar}</TableCell>\n                    <TableCell>\n                      <Badge variant={dossier.status === 'active' ? 'default' : 'secondary'}>\n                        {t(`status.${dossier.status}`)}\n                      </Badge>\n                    </TableCell>\n                    <TableCell>\n                      <Badge variant=\"outline\">\n                        {t(`sensitivityLevel.${dossier.sensitivity_level}`)}\n                      </Badge>\n                    </TableCell>\n                    <TableCell className=\"text-end\">\n                      <Button variant=\"ghost\" size=\"sm\" asChild>\n                        <Link to={`/dossiers/${dossier.id}`}>\n                          {t('action.view')}\n                        </Link>\n                      </Button>\n                    </TableCell>\n                  </TableRow>\n                ))}\n              </TableBody>\n            </Table>\n          </div>\n\n          {/* Card List - Mobile */}\n          <div className=\"md:hidden space-y-4\">\n            {filteredDossiers.map((dossier) => (\n              <Link\n                key={dossier.id}\n                to={`/dossiers/${dossier.id}`}\n                className=\"block p-4 rounded-lg border bg-card hover:bg-accent transition-colors\"\n              >\n                <div className=\"flex items-start justify-between gap-3 mb-3\">\n                  <h3 className=\"font-semibold text-base\">\n                    {isRTL ? dossier.name_ar : dossier.name_en}\n                  </h3>\n                  <Badge variant={dossier.status === 'active' ? 'default' : 'secondary'}>\n                    {t(`status.${dossier.status}`)}\n                  </Badge>\n                </div>\n                {(isRTL ? dossier.description_ar : dossier.description_en) && (\n                  <p className=\"text-sm text-muted-foreground mb-3 line-clamp-2\">\n                    {isRTL ? dossier.description_ar : dossier.description_en}\n                  </p>\n                )}\n                <div className=\"flex items-center gap-2\">\n                  <Badge variant=\"outline\" className=\"text-xs\">\n                    {t(`sensitivityLevel.${dossier.sensitivity_level}`)}\n                  </Badge>\n                </div>\n              </Link>\n            ))}\n          </div>\n\n          {/* Pagination */}\n          {data && data.total > pageSize && (\n            <div className=\"mt-8 flex items-center justify-between\">\n              <Button\n                variant=\"outline\"\n                disabled={page === 1}\n                onClick={() => setPage((p) => Math.max(1, p - 1))}\n              >\n                {t('action.back')}\n              </Button>\n              <span className=\"text-sm text-muted-foreground\">\n                {t('list.pageInfo', {\n                  current: page,\n                  total: Math.ceil(data.total / pageSize),\n                })}\n              </span>\n              <Button\n                variant=\"outline\"\n                disabled={page * pageSize >= data.total}\n                onClick={() => setPage((p) => p + 1)}\n              >\n                {t('action.next')}\n              </Button>\n            </div>\n          )}\n        </>\n      )}\n    </div>\n  );\n}\n","/**\n * Topics List Page (Feature 028 - Type-Specific Detail Pages)\n *\n * Displays filterable list of topic dossiers (policy areas, strategic priorities).\n * Mobile-first, RTL-compatible, WCAG AA compliant.\n */\n\nimport { createFileRoute, Link } from '@tanstack/react-router';\nimport { useTranslation } from 'react-i18next';\nimport { Loader2, Plus, Target } from 'lucide-react';\nimport { useDossiersByType } from '@/hooks/useDossier';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from '@/components/ui/table';\nimport { Badge } from '@/components/ui/badge';\nimport { useState } from 'react';\n\nexport const Route = createFileRoute('/_protected/dossiers/topics/')({\n  component: TopicsListPage,\n});\n\nfunction TopicsListPage() {\n  const { t, i18n } = useTranslation('dossier');\n  const isRTL = i18n.language === 'ar';\n\n  const [searchQuery, setSearchQuery] = useState('');\n  const [page, setPage] = useState(1);\n  const pageSize = 20;\n\n  // Fetch topic dossiers\n  const { data, isLoading, error } = useDossiersByType('topic', page, pageSize);\n\n  // Filter by search query (client-side for now)\n  const filteredDossiers = data?.data.filter((dossier) => {\n    if (!searchQuery) return true;\n    const searchLower = searchQuery.toLowerCase();\n    return (\n      dossier.name_en.toLowerCase().includes(searchLower) ||\n      dossier.name_ar?.toLowerCase().includes(searchLower) ||\n      dossier.description_en?.toLowerCase().includes(searchLower) ||\n      dossier.description_ar?.toLowerCase().includes(searchLower)\n    );\n  });\n\n  return (\n    <div\n      className=\"container mx-auto px-4 sm:px-6 lg:px-8 py-4 sm:py-6 lg:py-8\"\n      dir={isRTL ? 'rtl' : 'ltr'}\n    >\n      {/* Page Header */}\n      <header className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6 sm:mb-8\">\n        <div className=\"flex items-center gap-3\">\n          <Target className=\"h-6 w-6 sm:h-8 sm:w-8 text-primary\" />\n          <div>\n            <h1 className=\"text-2xl sm:text-3xl md:text-4xl font-bold\">\n              {t('type.topic')}\n            </h1>\n            <p className=\"text-sm sm:text-base text-muted-foreground mt-1\">\n              {t('typeDescription.topic')}\n            </p>\n          </div>\n        </div>\n        <Button asChild>\n          <Link to=\"/dossiers/create\">\n            <Plus className=\"h-4 w-4 me-2\" />\n            {t('action.create')}\n          </Link>\n        </Button>\n      </header>\n\n      {/* Search Bar */}\n      <div className=\"mb-6\">\n        <Input\n          type=\"text\"\n          placeholder={t('filter.search')}\n          value={searchQuery}\n          onChange={(e) => setSearchQuery(e.target.value)}\n          className=\"max-w-md\"\n        />\n      </div>\n\n      {/* Loading State */}\n      {isLoading && (\n        <div className=\"flex items-center justify-center py-12 sm:py-16 lg:py-20\">\n          <Loader2 className=\"h-8 w-8 sm:h-10 sm:w-10 animate-spin text-muted-foreground\" />\n          <span className=\"ms-3 text-muted-foreground text-sm sm:text-base\">\n            {t('list.loading')}\n          </span>\n        </div>\n      )}\n\n      {/* Error State */}\n      {error && !isLoading && (\n        <div\n          className=\"bg-destructive/10 border border-destructive/20 rounded-lg p-4 sm:p-6\"\n          role=\"alert\"\n        >\n          <h3 className=\"text-base sm:text-lg font-semibold text-destructive mb-2\">\n            {t('list.error')}\n          </h3>\n          <p className=\"text-sm sm:text-base text-destructive/90\">\n            {error.message}\n          </p>\n        </div>\n      )}\n\n      {/* Empty State */}\n      {!isLoading && !error && filteredDossiers?.length === 0 && (\n        <div className=\"flex flex-col items-center justify-center py-12 sm:py-16 lg:py-20 text-center\">\n          <Target className=\"h-12 w-12 sm:h-16 sm:w-16 text-muted-foreground mb-4\" />\n          <h3 className=\"text-base sm:text-lg font-semibold mb-2\">\n            {searchQuery ? t('list.emptyFiltered') : t('list.empty')}\n          </h3>\n          <p className=\"text-sm sm:text-base text-muted-foreground max-w-md mb-6\">\n            {searchQuery\n              ? t('list.emptyFilteredDescription')\n              : t('list.emptyDescription')}\n          </p>\n          {!searchQuery && (\n            <Button asChild>\n              <Link to=\"/dossiers/create\">\n                {t('action.create')}\n              </Link>\n            </Button>\n          )}\n        </div>\n      )}\n\n      {/* Table - Desktop */}\n      {!isLoading && !error && filteredDossiers && filteredDossiers.length > 0 && (\n        <>\n          <div className=\"hidden md:block rounded-lg border overflow-hidden\">\n            <Table>\n              <TableHeader>\n                <TableRow>\n                  <TableHead>{t('form.nameEn')}</TableHead>\n                  <TableHead>{t('form.nameAr')}</TableHead>\n                  <TableHead>{t('form.status')}</TableHead>\n                  <TableHead>{t('form.sensitivityLevel')}</TableHead>\n                  <TableHead className=\"text-end\">{t('action.more')}</TableHead>\n                </TableRow>\n              </TableHeader>\n              <TableBody>\n                {filteredDossiers.map((dossier) => (\n                  <TableRow key={dossier.id}>\n                    <TableCell className=\"font-medium\">\n                      <Link\n                        to={`/dossiers/${dossier.id}`}\n                        className=\"hover:text-primary hover:underline\"\n                      >\n                        {dossier.name_en}\n                      </Link>\n                    </TableCell>\n                    <TableCell>{dossier.name_ar}</TableCell>\n                    <TableCell>\n                      <Badge variant={dossier.status === 'active' ? 'default' : 'secondary'}>\n                        {t(`status.${dossier.status}`)}\n                      </Badge>\n                    </TableCell>\n                    <TableCell>\n                      <Badge variant=\"outline\">\n                        {t(`sensitivityLevel.${dossier.sensitivity_level}`)}\n                      </Badge>\n                    </TableCell>\n                    <TableCell className=\"text-end\">\n                      <Button variant=\"ghost\" size=\"sm\" asChild>\n                        <Link to={`/dossiers/${dossier.id}`}>\n                          {t('action.view')}\n                        </Link>\n                      </Button>\n                    </TableCell>\n                  </TableRow>\n                ))}\n              </TableBody>\n            </Table>\n          </div>\n\n          {/* Card List - Mobile */}\n          <div className=\"md:hidden space-y-4\">\n            {filteredDossiers.map((dossier) => (\n              <Link\n                key={dossier.id}\n                to={`/dossiers/${dossier.id}`}\n                className=\"block p-4 rounded-lg border bg-card hover:bg-accent transition-colors\"\n              >\n                <div className=\"flex items-start justify-between gap-3 mb-3\">\n                  <h3 className=\"font-semibold text-base\">\n                    {isRTL ? dossier.name_ar : dossier.name_en}\n                  </h3>\n                  <Badge variant={dossier.status === 'active' ? 'default' : 'secondary'}>\n                    {t(`status.${dossier.status}`)}\n                  </Badge>\n                </div>\n                {(isRTL ? dossier.description_ar : dossier.description_en) && (\n                  <p className=\"text-sm text-muted-foreground mb-3 line-clamp-2\">\n                    {isRTL ? dossier.description_ar : dossier.description_en}\n                  </p>\n                )}\n                <div className=\"flex items-center gap-2\">\n                  <Badge variant=\"outline\" className=\"text-xs\">\n                    {t(`sensitivityLevel.${dossier.sensitivity_level}`)}\n                  </Badge>\n                </div>\n              </Link>\n            ))}\n          </div>\n\n          {/* Pagination */}\n          {data && data.total > pageSize && (\n            <div className=\"mt-8 flex items-center justify-between\">\n              <Button\n                variant=\"outline\"\n                disabled={page === 1}\n                onClick={() => setPage((p) => Math.max(1, p - 1))}\n              >\n                {t('action.back')}\n              </Button>\n              <span className=\"text-sm text-muted-foreground\">\n                {t('list.pageInfo', {\n                  current: page,\n                  total: Math.ceil(data.total / pageSize),\n                })}\n              </span>\n              <Button\n                variant=\"outline\"\n                disabled={page * pageSize >= data.total}\n                onClick={() => setPage((p) => p + 1)}\n              >\n                {t('action.next')}\n              </Button>\n            </div>\n          )}\n        </>\n      )}\n    </div>\n  );\n}\n","/**\n * Persons List Page (Feature 028 - User Story 2)\n *\n * Displays filterable list of person dossiers.\n * Mobile-first, RTL-compatible, WCAG AA compliant.\n */\n\nimport { createFileRoute, Link } from '@tanstack/react-router';\nimport { useTranslation } from 'react-i18next';\nimport { Loader2, Plus, Users } from 'lucide-react';\nimport { useDossiersByType } from '@/hooks/useDossier';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from '@/components/ui/table';\nimport { Badge } from '@/components/ui/badge';\nimport { useState } from 'react';\n\nexport const Route = createFileRoute('/_protected/dossiers/persons/')({\n  component: PersonsListPage,\n});\n\nfunction PersonsListPage() {\n  const { t, i18n } = useTranslation('dossier');\n  const isRTL = i18n.language === 'ar';\n\n  const [searchQuery, setSearchQuery] = useState('');\n  const [page, setPage] = useState(1);\n  const pageSize = 20;\n\n  // Fetch person dossiers\n  const { data, isLoading, error } = useDossiersByType('person', page, pageSize);\n\n  // Filter by search query (client-side for now)\n  const filteredDossiers = data?.data.filter((dossier) => {\n    if (!searchQuery) return true;\n    const searchLower = searchQuery.toLowerCase();\n    return (\n      dossier.name_en.toLowerCase().includes(searchLower) ||\n      dossier.name_ar?.toLowerCase().includes(searchLower) ||\n      dossier.description_en?.toLowerCase().includes(searchLower) ||\n      dossier.description_ar?.toLowerCase().includes(searchLower)\n    );\n  });\n\n  return (\n    <div\n      className=\"container mx-auto px-4 sm:px-6 lg:px-8 py-4 sm:py-6 lg:py-8\"\n      dir={isRTL ? 'rtl' : 'ltr'}\n    >\n      {/* Page Header */}\n      <header className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6 sm:mb-8\">\n        <div className=\"flex items-center gap-3\">\n          <Users className=\"h-6 w-6 sm:h-8 sm:w-8 text-primary\" />\n          <div>\n            <h1 className=\"text-2xl sm:text-3xl md:text-4xl font-bold\">\n              {t('type.person')}\n            </h1>\n            <p className=\"text-sm sm:text-base text-muted-foreground mt-1\">\n              {t('typeDescription.person')}\n            </p>\n          </div>\n        </div>\n        <Button asChild>\n          <Link to=\"/dossiers/create\">\n            <Plus className=\"h-4 w-4 me-2\" />\n            {t('action.create')}\n          </Link>\n        </Button>\n      </header>\n\n      {/* Search Bar */}\n      <div className=\"mb-6\">\n        <Input\n          type=\"text\"\n          placeholder={t('filter.search')}\n          value={searchQuery}\n          onChange={(e) => setSearchQuery(e.target.value)}\n          className=\"max-w-md\"\n        />\n      </div>\n\n      {/* Loading State */}\n      {isLoading && (\n        <div className=\"flex items-center justify-center py-12 sm:py-16 lg:py-20\">\n          <Loader2 className=\"h-8 w-8 sm:h-10 sm:w-10 animate-spin text-muted-foreground\" />\n          <span className=\"ms-3 text-muted-foreground text-sm sm:text-base\">\n            {t('list.loading')}\n          </span>\n        </div>\n      )}\n\n      {/* Error State */}\n      {error && !isLoading && (\n        <div\n          className=\"bg-destructive/10 border border-destructive/20 rounded-lg p-4 sm:p-6\"\n          role=\"alert\"\n        >\n          <h3 className=\"text-base sm:text-lg font-semibold text-destructive mb-2\">\n            {t('list.error')}\n          </h3>\n          <p className=\"text-sm sm:text-base text-destructive/90\">\n            {error.message}\n          </p>\n        </div>\n      )}\n\n      {/* Empty State */}\n      {!isLoading && !error && filteredDossiers?.length === 0 && (\n        <div className=\"flex flex-col items-center justify-center py-12 sm:py-16 lg:py-20 text-center\">\n          <Users className=\"h-12 w-12 sm:h-16 sm:w-16 text-muted-foreground mb-4\" />\n          <h3 className=\"text-base sm:text-lg font-semibold mb-2\">\n            {searchQuery ? t('list.emptyFiltered') : t('list.empty')}\n          </h3>\n          <p className=\"text-sm sm:text-base text-muted-foreground max-w-md mb-6\">\n            {searchQuery\n              ? t('list.emptyFilteredDescription')\n              : t('list.emptyDescription')}\n          </p>\n          {!searchQuery && (\n            <Button asChild>\n              <Link to=\"/dossiers/create\">\n                {t('action.create')}\n              </Link>\n            </Button>\n          )}\n        </div>\n      )}\n\n      {/* Table - Desktop */}\n      {!isLoading && !error && filteredDossiers && filteredDossiers.length > 0 && (\n        <>\n          <div className=\"hidden md:block rounded-lg border overflow-hidden\">\n            <Table>\n              <TableHeader>\n                <TableRow>\n                  <TableHead>{t('form.nameEn')}</TableHead>\n                  <TableHead>{t('form.nameAr')}</TableHead>\n                  <TableHead>{t('form.status')}</TableHead>\n                  <TableHead>{t('form.sensitivityLevel')}</TableHead>\n                  <TableHead className=\"text-end\">{t('action.more')}</TableHead>\n                </TableRow>\n              </TableHeader>\n              <TableBody>\n                {filteredDossiers.map((dossier) => (\n                  <TableRow key={dossier.id}>\n                    <TableCell className=\"font-medium\">\n                      <Link\n                        to={`/dossiers/${dossier.id}`}\n                        className=\"hover:text-primary hover:underline\"\n                      >\n                        {dossier.name_en}\n                      </Link>\n                    </TableCell>\n                    <TableCell>{dossier.name_ar}</TableCell>\n                    <TableCell>\n                      <Badge variant={dossier.status === 'active' ? 'default' : 'secondary'}>\n                        {t(`status.${dossier.status}`)}\n                      </Badge>\n                    </TableCell>\n                    <TableCell>\n                      <Badge variant=\"outline\">\n                        {t(`sensitivityLevel.${dossier.sensitivity_level}`)}\n                      </Badge>\n                    </TableCell>\n                    <TableCell className=\"text-end\">\n                      <Button variant=\"ghost\" size=\"sm\" asChild>\n                        <Link to={`/dossiers/${dossier.id}`}>\n                          {t('action.view')}\n                        </Link>\n                      </Button>\n                    </TableCell>\n                  </TableRow>\n                ))}\n              </TableBody>\n            </Table>\n          </div>\n\n          {/* Card List - Mobile */}\n          <div className=\"md:hidden space-y-4\">\n            {filteredDossiers.map((dossier) => (\n              <Link\n                key={dossier.id}\n                to={`/dossiers/${dossier.id}`}\n                className=\"block p-4 rounded-lg border bg-card hover:bg-accent transition-colors\"\n              >\n                <div className=\"flex items-start justify-between gap-3 mb-3\">\n                  <h3 className=\"font-semibold text-base\">\n                    {isRTL ? dossier.name_ar : dossier.name_en}\n                  </h3>\n                  <Badge variant={dossier.status === 'active' ? 'default' : 'secondary'}>\n                    {t(`status.${dossier.status}`)}\n                  </Badge>\n                </div>\n                {(isRTL ? dossier.description_ar : dossier.description_en) && (\n                  <p className=\"text-sm text-muted-foreground mb-3 line-clamp-2\">\n                    {isRTL ? dossier.description_ar : dossier.description_en}\n                  </p>\n                )}\n                <div className=\"flex items-center gap-2\">\n                  <Badge variant=\"outline\" className=\"text-xs\">\n                    {t(`sensitivityLevel.${dossier.sensitivity_level}`)}\n                  </Badge>\n                </div>\n              </Link>\n            ))}\n          </div>\n\n          {/* Pagination */}\n          {data && data.total > pageSize && (\n            <div className=\"mt-8 flex items-center justify-between\">\n              <Button\n                variant=\"outline\"\n                disabled={page === 1}\n                onClick={() => setPage((p) => Math.max(1, p - 1))}\n              >\n                {t('action.back')}\n              </Button>\n              <span className=\"text-sm text-muted-foreground\">\n                {t('list.pageInfo', {\n                  current: page,\n                  total: Math.ceil(data.total / pageSize),\n                })}\n              </span>\n              <Button\n                variant=\"outline\"\n                disabled={page * pageSize >= data.total}\n                onClick={() => setPage((p) => p + 1)}\n              >\n                {t('action.next')}\n              </Button>\n            </div>\n          )}\n        </>\n      )}\n    </div>\n  );\n}\n","/**\n * Organizations List Page (Feature 028 - User Story 2)\n *\n * Displays filterable list of organization dossiers.\n * Mobile-first, RTL-compatible, WCAG AA compliant.\n */\n\nimport { createFileRoute, Link } from '@tanstack/react-router';\nimport { useTranslation } from 'react-i18next';\nimport { Loader2, Plus, Building2 } from 'lucide-react';\nimport { useDossiersByType } from '@/hooks/useDossier';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from '@/components/ui/table';\nimport { Badge } from '@/components/ui/badge';\nimport { useState } from 'react';\n\nexport const Route = createFileRoute('/_protected/dossiers/organizations/')({\n  component: OrganizationsListPage,\n});\n\nfunction OrganizationsListPage() {\n  const { t, i18n } = useTranslation('dossier');\n  const isRTL = i18n.language === 'ar';\n\n  const [searchQuery, setSearchQuery] = useState('');\n  const [page, setPage] = useState(1);\n  const pageSize = 20;\n\n  // Fetch organization dossiers\n  const { data, isLoading, error } = useDossiersByType('organization', page, pageSize);\n\n  // Filter by search query (client-side for now)\n  const filteredDossiers = data?.data.filter((dossier) => {\n    if (!searchQuery) return true;\n    const searchLower = searchQuery.toLowerCase();\n    return (\n      dossier.name_en.toLowerCase().includes(searchLower) ||\n      dossier.name_ar?.toLowerCase().includes(searchLower) ||\n      dossier.description_en?.toLowerCase().includes(searchLower) ||\n      dossier.description_ar?.toLowerCase().includes(searchLower)\n    );\n  });\n\n  return (\n    <div\n      className=\"container mx-auto px-4 sm:px-6 lg:px-8 py-4 sm:py-6 lg:py-8\"\n      dir={isRTL ? 'rtl' : 'ltr'}\n    >\n      {/* Page Header */}\n      <header className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6 sm:mb-8\">\n        <div className=\"flex items-center gap-3\">\n          <Building2 className=\"h-6 w-6 sm:h-8 sm:w-8 text-primary\" />\n          <div>\n            <h1 className=\"text-2xl sm:text-3xl md:text-4xl font-bold\">\n              {t('type.organization')}\n            </h1>\n            <p className=\"text-sm sm:text-base text-muted-foreground mt-1\">\n              {t('typeDescription.organization')}\n            </p>\n          </div>\n        </div>\n        <Button asChild>\n          <Link to=\"/dossiers/create\">\n            <Plus className=\"h-4 w-4 me-2\" />\n            {t('action.create')}\n          </Link>\n        </Button>\n      </header>\n\n      {/* Search Bar */}\n      <div className=\"mb-6\">\n        <Input\n          type=\"text\"\n          placeholder={t('filter.search')}\n          value={searchQuery}\n          onChange={(e) => setSearchQuery(e.target.value)}\n          className=\"max-w-md\"\n        />\n      </div>\n\n      {/* Loading State */}\n      {isLoading && (\n        <div className=\"flex items-center justify-center py-12 sm:py-16 lg:py-20\">\n          <Loader2 className=\"h-8 w-8 sm:h-10 sm:w-10 animate-spin text-muted-foreground\" />\n          <span className=\"ms-3 text-muted-foreground text-sm sm:text-base\">\n            {t('list.loading')}\n          </span>\n        </div>\n      )}\n\n      {/* Error State */}\n      {error && !isLoading && (\n        <div\n          className=\"bg-destructive/10 border border-destructive/20 rounded-lg p-4 sm:p-6\"\n          role=\"alert\"\n        >\n          <h3 className=\"text-base sm:text-lg font-semibold text-destructive mb-2\">\n            {t('list.error')}\n          </h3>\n          <p className=\"text-sm sm:text-base text-destructive/90\">\n            {error.message}\n          </p>\n        </div>\n      )}\n\n      {/* Empty State */}\n      {!isLoading && !error && filteredDossiers?.length === 0 && (\n        <div className=\"flex flex-col items-center justify-center py-12 sm:py-16 lg:py-20 text-center\">\n          <Building2 className=\"h-12 w-12 sm:h-16 sm:w-16 text-muted-foreground mb-4\" />\n          <h3 className=\"text-base sm:text-lg font-semibold mb-2\">\n            {searchQuery ? t('list.emptyFiltered') : t('list.empty')}\n          </h3>\n          <p className=\"text-sm sm:text-base text-muted-foreground max-w-md mb-6\">\n            {searchQuery\n              ? t('list.emptyFilteredDescription')\n              : t('list.emptyDescription')}\n          </p>\n          {!searchQuery && (\n            <Button asChild>\n              <Link to=\"/dossiers/create\">\n                {t('action.create')}\n              </Link>\n            </Button>\n          )}\n        </div>\n      )}\n\n      {/* Table - Desktop */}\n      {!isLoading && !error && filteredDossiers && filteredDossiers.length > 0 && (\n        <>\n          <div className=\"hidden md:block rounded-lg border overflow-hidden\">\n            <Table>\n              <TableHeader>\n                <TableRow>\n                  <TableHead>{t('form.nameEn')}</TableHead>\n                  <TableHead>{t('form.nameAr')}</TableHead>\n                  <TableHead>{t('form.status')}</TableHead>\n                  <TableHead>{t('form.sensitivityLevel')}</TableHead>\n                  <TableHead className=\"text-end\">{t('action.more')}</TableHead>\n                </TableRow>\n              </TableHeader>\n              <TableBody>\n                {filteredDossiers.map((dossier) => (\n                  <TableRow key={dossier.id}>\n                    <TableCell className=\"font-medium\">\n                      <Link\n                        to={`/dossiers/${dossier.id}`}\n                        className=\"hover:text-primary hover:underline\"\n                      >\n                        {dossier.name_en}\n                      </Link>\n                    </TableCell>\n                    <TableCell>{dossier.name_ar}</TableCell>\n                    <TableCell>\n                      <Badge variant={dossier.status === 'active' ? 'default' : 'secondary'}>\n                        {t(`status.${dossier.status}`)}\n                      </Badge>\n                    </TableCell>\n                    <TableCell>\n                      <Badge variant=\"outline\">\n                        {t(`sensitivityLevel.${dossier.sensitivity_level}`)}\n                      </Badge>\n                    </TableCell>\n                    <TableCell className=\"text-end\">\n                      <Button variant=\"ghost\" size=\"sm\" asChild>\n                        <Link to={`/dossiers/${dossier.id}`}>\n                          {t('action.view')}\n                        </Link>\n                      </Button>\n                    </TableCell>\n                  </TableRow>\n                ))}\n              </TableBody>\n            </Table>\n          </div>\n\n          {/* Card List - Mobile */}\n          <div className=\"md:hidden space-y-4\">\n            {filteredDossiers.map((dossier) => (\n              <Link\n                key={dossier.id}\n                to={`/dossiers/${dossier.id}`}\n                className=\"block p-4 rounded-lg border bg-card hover:bg-accent transition-colors\"\n              >\n                <div className=\"flex items-start justify-between gap-3 mb-3\">\n                  <h3 className=\"font-semibold text-base\">\n                    {isRTL ? dossier.name_ar : dossier.name_en}\n                  </h3>\n                  <Badge variant={dossier.status === 'active' ? 'default' : 'secondary'}>\n                    {t(`status.${dossier.status}`)}\n                  </Badge>\n                </div>\n                {(isRTL ? dossier.description_ar : dossier.description_en) && (\n                  <p className=\"text-sm text-muted-foreground mb-3 line-clamp-2\">\n                    {isRTL ? dossier.description_ar : dossier.description_en}\n                  </p>\n                )}\n                <div className=\"flex items-center gap-2\">\n                  <Badge variant=\"outline\" className=\"text-xs\">\n                    {t(`sensitivityLevel.${dossier.sensitivity_level}`)}\n                  </Badge>\n                </div>\n              </Link>\n            ))}\n          </div>\n\n          {/* Pagination */}\n          {data && data.total > pageSize && (\n            <div className=\"mt-8 flex items-center justify-between\">\n              <Button\n                variant=\"outline\"\n                disabled={page === 1}\n                onClick={() => setPage((p) => Math.max(1, p - 1))}\n              >\n                {t('action.back')}\n              </Button>\n              <span className=\"text-sm text-muted-foreground\">\n                {t('list.pageInfo', {\n                  current: page,\n                  total: Math.ceil(data.total / pageSize),\n                })}\n              </span>\n              <Button\n                variant=\"outline\"\n                disabled={page * pageSize >= data.total}\n                onClick={() => setPage((p) => p + 1)}\n              >\n                {t('action.next')}\n              </Button>\n            </div>\n          )}\n        </>\n      )}\n    </div>\n  );\n}\n","/**\n * Forums List Page (Feature 028 - User Story 2)\n *\n * Displays filterable list of forum dossiers.\n * Mobile-first, RTL-compatible, WCAG AA compliant.\n */\n\nimport { createFileRoute, Link } from '@tanstack/react-router';\nimport { useTranslation } from 'react-i18next';\nimport { Loader2, Plus, MessageSquare } from 'lucide-react';\nimport { useDossiersByType } from '@/hooks/useDossier';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from '@/components/ui/table';\nimport { Badge } from '@/components/ui/badge';\nimport { useState } from 'react';\n\nexport const Route = createFileRoute('/_protected/dossiers/forums/')({\n  component: ForumsListPage,\n});\n\nfunction ForumsListPage() {\n  const { t, i18n } = useTranslation('dossier');\n  const isRTL = i18n.language === 'ar';\n\n  const [searchQuery, setSearchQuery] = useState('');\n  const [page, setPage] = useState(1);\n  const pageSize = 20;\n\n  // Fetch forum dossiers\n  const { data, isLoading, error } = useDossiersByType('forum', page, pageSize);\n\n  // Filter by search query (client-side for now)\n  const filteredDossiers = data?.data.filter((dossier) => {\n    if (!searchQuery) return true;\n    const searchLower = searchQuery.toLowerCase();\n    return (\n      dossier.name_en.toLowerCase().includes(searchLower) ||\n      dossier.name_ar?.toLowerCase().includes(searchLower) ||\n      dossier.description_en?.toLowerCase().includes(searchLower) ||\n      dossier.description_ar?.toLowerCase().includes(searchLower)\n    );\n  });\n\n  return (\n    <div\n      className=\"container mx-auto px-4 sm:px-6 lg:px-8 py-4 sm:py-6 lg:py-8\"\n      dir={isRTL ? 'rtl' : 'ltr'}\n    >\n      {/* Page Header */}\n      <header className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6 sm:mb-8\">\n        <div className=\"flex items-center gap-3\">\n          <MessageSquare className=\"h-6 w-6 sm:h-8 sm:w-8 text-primary\" />\n          <div>\n            <h1 className=\"text-2xl sm:text-3xl md:text-4xl font-bold\">\n              {t('type.forum')}\n            </h1>\n            <p className=\"text-sm sm:text-base text-muted-foreground mt-1\">\n              {t('typeDescription.forum')}\n            </p>\n          </div>\n        </div>\n        <Button asChild>\n          <Link to=\"/dossiers/create\">\n            <Plus className=\"h-4 w-4 me-2\" />\n            {t('action.create')}\n          </Link>\n        </Button>\n      </header>\n\n      {/* Search Bar */}\n      <div className=\"mb-6\">\n        <Input\n          type=\"text\"\n          placeholder={t('filter.search')}\n          value={searchQuery}\n          onChange={(e) => setSearchQuery(e.target.value)}\n          className=\"max-w-md\"\n        />\n      </div>\n\n      {/* Loading State */}\n      {isLoading && (\n        <div className=\"flex items-center justify-center py-12 sm:py-16 lg:py-20\">\n          <Loader2 className=\"h-8 w-8 sm:h-10 sm:w-10 animate-spin text-muted-foreground\" />\n          <span className=\"ms-3 text-muted-foreground text-sm sm:text-base\">\n            {t('list.loading')}\n          </span>\n        </div>\n      )}\n\n      {/* Error State */}\n      {error && !isLoading && (\n        <div\n          className=\"bg-destructive/10 border border-destructive/20 rounded-lg p-4 sm:p-6\"\n          role=\"alert\"\n        >\n          <h3 className=\"text-base sm:text-lg font-semibold text-destructive mb-2\">\n            {t('list.error')}\n          </h3>\n          <p className=\"text-sm sm:text-base text-destructive/90\">\n            {error.message}\n          </p>\n        </div>\n      )}\n\n      {/* Empty State */}\n      {!isLoading && !error && filteredDossiers?.length === 0 && (\n        <div className=\"flex flex-col items-center justify-center py-12 sm:py-16 lg:py-20 text-center\">\n          <MessageSquare className=\"h-12 w-12 sm:h-16 sm:w-16 text-muted-foreground mb-4\" />\n          <h3 className=\"text-base sm:text-lg font-semibold mb-2\">\n            {searchQuery ? t('list.emptyFiltered') : t('list.empty')}\n          </h3>\n          <p className=\"text-sm sm:text-base text-muted-foreground max-w-md mb-6\">\n            {searchQuery\n              ? t('list.emptyFilteredDescription')\n              : t('list.emptyDescription')}\n          </p>\n          {!searchQuery && (\n            <Button asChild>\n              <Link to=\"/dossiers/create\">\n                {t('action.create')}\n              </Link>\n            </Button>\n          )}\n        </div>\n      )}\n\n      {/* Table - Desktop */}\n      {!isLoading && !error && filteredDossiers && filteredDossiers.length > 0 && (\n        <>\n          <div className=\"hidden md:block rounded-lg border overflow-hidden\">\n            <Table>\n              <TableHeader>\n                <TableRow>\n                  <TableHead>{t('form.nameEn')}</TableHead>\n                  <TableHead>{t('form.nameAr')}</TableHead>\n                  <TableHead>{t('form.status')}</TableHead>\n                  <TableHead>{t('form.sensitivityLevel')}</TableHead>\n                  <TableHead className=\"text-end\">{t('action.more')}</TableHead>\n                </TableRow>\n              </TableHeader>\n              <TableBody>\n                {filteredDossiers.map((dossier) => (\n                  <TableRow key={dossier.id}>\n                    <TableCell className=\"font-medium\">\n                      <Link\n                        to={`/dossiers/${dossier.id}`}\n                        className=\"hover:text-primary hover:underline\"\n                      >\n                        {dossier.name_en}\n                      </Link>\n                    </TableCell>\n                    <TableCell>{dossier.name_ar}</TableCell>\n                    <TableCell>\n                      <Badge variant={dossier.status === 'active' ? 'default' : 'secondary'}>\n                        {t(`status.${dossier.status}`)}\n                      </Badge>\n                    </TableCell>\n                    <TableCell>\n                      <Badge variant=\"outline\">\n                        {t(`sensitivityLevel.${dossier.sensitivity_level}`)}\n                      </Badge>\n                    </TableCell>\n                    <TableCell className=\"text-end\">\n                      <Button variant=\"ghost\" size=\"sm\" asChild>\n                        <Link to={`/dossiers/${dossier.id}`}>\n                          {t('action.view')}\n                        </Link>\n                      </Button>\n                    </TableCell>\n                  </TableRow>\n                ))}\n              </TableBody>\n            </Table>\n          </div>\n\n          {/* Card List - Mobile */}\n          <div className=\"md:hidden space-y-4\">\n            {filteredDossiers.map((dossier) => (\n              <Link\n                key={dossier.id}\n                to={`/dossiers/${dossier.id}`}\n                className=\"block p-4 rounded-lg border bg-card hover:bg-accent transition-colors\"\n              >\n                <div className=\"flex items-start justify-between gap-3 mb-3\">\n                  <h3 className=\"font-semibold text-base\">\n                    {isRTL ? dossier.name_ar : dossier.name_en}\n                  </h3>\n                  <Badge variant={dossier.status === 'active' ? 'default' : 'secondary'}>\n                    {t(`status.${dossier.status}`)}\n                  </Badge>\n                </div>\n                {(isRTL ? dossier.description_ar : dossier.description_en) && (\n                  <p className=\"text-sm text-muted-foreground mb-3 line-clamp-2\">\n                    {isRTL ? dossier.description_ar : dossier.description_en}\n                  </p>\n                )}\n                <div className=\"flex items-center gap-2\">\n                  <Badge variant=\"outline\" className=\"text-xs\">\n                    {t(`sensitivityLevel.${dossier.sensitivity_level}`)}\n                  </Badge>\n                </div>\n              </Link>\n            ))}\n          </div>\n\n          {/* Pagination */}\n          {data && data.total > pageSize && (\n            <div className=\"mt-8 flex items-center justify-between\">\n              <Button\n                variant=\"outline\"\n                disabled={page === 1}\n                onClick={() => setPage((p) => Math.max(1, p - 1))}\n              >\n                {t('action.back')}\n              </Button>\n              <span className=\"text-sm text-muted-foreground\">\n                {t('list.pageInfo', {\n                  current: page,\n                  total: Math.ceil(data.total / pageSize),\n                })}\n              </span>\n              <Button\n                variant=\"outline\"\n                disabled={page * pageSize >= data.total}\n                onClick={() => setPage((p) => p + 1)}\n              >\n                {t('action.next')}\n              </Button>\n            </div>\n          )}\n        </>\n      )}\n    </div>\n  );\n}\n","/**\n * Engagements List Page (Feature 028 - User Story 2)\n *\n * Displays filterable list of engagement dossiers.\n * Mobile-first, RTL-compatible, WCAG AA compliant.\n */\n\nimport { createFileRoute, Link } from '@tanstack/react-router';\nimport { useTranslation } from 'react-i18next';\nimport { Loader2, Plus, CalendarDays } from 'lucide-react';\nimport { useDossiersByType } from '@/hooks/useDossier';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from '@/components/ui/table';\nimport { Badge } from '@/components/ui/badge';\nimport { useState } from 'react';\n\nexport const Route = createFileRoute('/_protected/dossiers/engagements/')({\n  component: EngagementsListPage,\n});\n\nfunction EngagementsListPage() {\n  const { t, i18n } = useTranslation('dossier');\n  const isRTL = i18n.language === 'ar';\n\n  const [searchQuery, setSearchQuery] = useState('');\n  const [page, setPage] = useState(1);\n  const pageSize = 20;\n\n  // Fetch engagement dossiers\n  const { data, isLoading, error } = useDossiersByType('engagement', page, pageSize);\n\n  // Filter by search query (client-side for now)\n  const filteredDossiers = data?.data.filter((dossier) => {\n    if (!searchQuery) return true;\n    const searchLower = searchQuery.toLowerCase();\n    return (\n      dossier.name_en.toLowerCase().includes(searchLower) ||\n      dossier.name_ar?.toLowerCase().includes(searchLower) ||\n      dossier.description_en?.toLowerCase().includes(searchLower) ||\n      dossier.description_ar?.toLowerCase().includes(searchLower)\n    );\n  });\n\n  return (\n    <div\n      className=\"container mx-auto px-4 sm:px-6 lg:px-8 py-4 sm:py-6 lg:py-8\"\n      dir={isRTL ? 'rtl' : 'ltr'}\n    >\n      {/* Page Header */}\n      <header className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6 sm:mb-8\">\n        <div className=\"flex items-center gap-3\">\n          <CalendarDays className=\"h-6 w-6 sm:h-8 sm:w-8 text-primary\" />\n          <div>\n            <h1 className=\"text-2xl sm:text-3xl md:text-4xl font-bold\">\n              {t('type.engagement')}\n            </h1>\n            <p className=\"text-sm sm:text-base text-muted-foreground mt-1\">\n              {t('typeDescription.engagement')}\n            </p>\n          </div>\n        </div>\n        <Button asChild>\n          <Link to=\"/dossiers/create\">\n            <Plus className=\"h-4 w-4 me-2\" />\n            {t('action.create')}\n          </Link>\n        </Button>\n      </header>\n\n      {/* Search Bar */}\n      <div className=\"mb-6\">\n        <Input\n          type=\"text\"\n          placeholder={t('filter.search')}\n          value={searchQuery}\n          onChange={(e) => setSearchQuery(e.target.value)}\n          className=\"max-w-md\"\n        />\n      </div>\n\n      {/* Loading State */}\n      {isLoading && (\n        <div className=\"flex items-center justify-center py-12 sm:py-16 lg:py-20\">\n          <Loader2 className=\"h-8 w-8 sm:h-10 sm:w-10 animate-spin text-muted-foreground\" />\n          <span className=\"ms-3 text-muted-foreground text-sm sm:text-base\">\n            {t('list.loading')}\n          </span>\n        </div>\n      )}\n\n      {/* Error State */}\n      {error && !isLoading && (\n        <div\n          className=\"bg-destructive/10 border border-destructive/20 rounded-lg p-4 sm:p-6\"\n          role=\"alert\"\n        >\n          <h3 className=\"text-base sm:text-lg font-semibold text-destructive mb-2\">\n            {t('list.error')}\n          </h3>\n          <p className=\"text-sm sm:text-base text-destructive/90\">\n            {error.message}\n          </p>\n        </div>\n      )}\n\n      {/* Empty State */}\n      {!isLoading && !error && filteredDossiers?.length === 0 && (\n        <div className=\"flex flex-col items-center justify-center py-12 sm:py-16 lg:py-20 text-center\">\n          <CalendarDays className=\"h-12 w-12 sm:h-16 sm:w-16 text-muted-foreground mb-4\" />\n          <h3 className=\"text-base sm:text-lg font-semibold mb-2\">\n            {searchQuery ? t('list.emptyFiltered') : t('list.empty')}\n          </h3>\n          <p className=\"text-sm sm:text-base text-muted-foreground max-w-md mb-6\">\n            {searchQuery\n              ? t('list.emptyFilteredDescription')\n              : t('list.emptyDescription')}\n          </p>\n          {!searchQuery && (\n            <Button asChild>\n              <Link to=\"/dossiers/create\">\n                {t('action.create')}\n              </Link>\n            </Button>\n          )}\n        </div>\n      )}\n\n      {/* Table - Desktop */}\n      {!isLoading && !error && filteredDossiers && filteredDossiers.length > 0 && (\n        <>\n          <div className=\"hidden md:block rounded-lg border overflow-hidden\">\n            <Table>\n              <TableHeader>\n                <TableRow>\n                  <TableHead>{t('form.nameEn')}</TableHead>\n                  <TableHead>{t('form.nameAr')}</TableHead>\n                  <TableHead>{t('form.status')}</TableHead>\n                  <TableHead>{t('form.sensitivityLevel')}</TableHead>\n                  <TableHead className=\"text-end\">{t('action.more')}</TableHead>\n                </TableRow>\n              </TableHeader>\n              <TableBody>\n                {filteredDossiers.map((dossier) => (\n                  <TableRow key={dossier.id}>\n                    <TableCell className=\"font-medium\">\n                      <Link\n                        to={`/dossiers/engagements/${dossier.id}`}\n                        className=\"hover:text-primary hover:underline\"\n                      >\n                        {dossier.name_en}\n                      </Link>\n                    </TableCell>\n                    <TableCell>{dossier.name_ar}</TableCell>\n                    <TableCell>\n                      <Badge variant={dossier.status === 'active' ? 'default' : 'secondary'}>\n                        {t(`status.${dossier.status}`)}\n                      </Badge>\n                    </TableCell>\n                    <TableCell>\n                      <Badge variant=\"outline\">\n                        {t(`sensitivityLevel.${dossier.sensitivity_level}`)}\n                      </Badge>\n                    </TableCell>\n                    <TableCell className=\"text-end\">\n                      <Button variant=\"ghost\" size=\"sm\" asChild>\n                        <Link to={`/dossiers/engagements/${dossier.id}`}>\n                          {t('action.view')}\n                        </Link>\n                      </Button>\n                    </TableCell>\n                  </TableRow>\n                ))}\n              </TableBody>\n            </Table>\n          </div>\n\n          {/* Card List - Mobile */}\n          <div className=\"md:hidden space-y-4\">\n            {filteredDossiers.map((dossier) => (\n              <Link\n                key={dossier.id}\n                to={`/dossiers/engagements/${dossier.id}`}\n                className=\"block p-4 rounded-lg border bg-card hover:bg-accent transition-colors\"\n              >\n                <div className=\"flex items-start justify-between gap-3 mb-3\">\n                  <h3 className=\"font-semibold text-base\">\n                    {isRTL ? dossier.name_ar : dossier.name_en}\n                  </h3>\n                  <Badge variant={dossier.status === 'active' ? 'default' : 'secondary'}>\n                    {t(`status.${dossier.status}`)}\n                  </Badge>\n                </div>\n                {(isRTL ? dossier.description_ar : dossier.description_en) && (\n                  <p className=\"text-sm text-muted-foreground mb-3 line-clamp-2\">\n                    {isRTL ? dossier.description_ar : dossier.description_en}\n                  </p>\n                )}\n                <div className=\"flex items-center gap-2\">\n                  <Badge variant=\"outline\" className=\"text-xs\">\n                    {t(`sensitivityLevel.${dossier.sensitivity_level}`)}\n                  </Badge>\n                </div>\n              </Link>\n            ))}\n          </div>\n\n          {/* Pagination */}\n          {data && data.total > pageSize && (\n            <div className=\"mt-8 flex items-center justify-between\">\n              <Button\n                variant=\"outline\"\n                disabled={page === 1}\n                onClick={() => setPage((p) => Math.max(1, p - 1))}\n              >\n                {t('action.back')}\n              </Button>\n              <span className=\"text-sm text-muted-foreground\">\n                {t('list.pageInfo', {\n                  current: page,\n                  total: Math.ceil(data.total / pageSize),\n                })}\n              </span>\n              <Button\n                variant=\"outline\"\n                disabled={page * pageSize >= data.total}\n                onClick={() => setPage((p) => p + 1)}\n              >\n                {t('action.next')}\n              </Button>\n            </div>\n          )}\n        </>\n      )}\n    </div>\n  );\n}\n","/**\n * Countries List Page (Feature 028 - User Story 2)\n *\n * Displays filterable list of country dossiers.\n * Mobile-first, RTL-compatible, WCAG AA compliant.\n */\n\nimport { createFileRoute, Link } from '@tanstack/react-router';\nimport { useTranslation } from 'react-i18next';\nimport { Loader2, Plus, Globe2 } from 'lucide-react';\nimport { useDossiersByType } from '@/hooks/useDossier';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from '@/components/ui/table';\nimport { Badge } from '@/components/ui/badge';\nimport { useState } from 'react';\n\nexport const Route = createFileRoute('/_protected/dossiers/countries/')({\n  component: CountriesListPage,\n});\n\nfunction CountriesListPage() {\n  const { t, i18n } = useTranslation('dossier');\n  const isRTL = i18n.language === 'ar';\n\n  const [searchQuery, setSearchQuery] = useState('');\n  const [page, setPage] = useState(1);\n  const pageSize = 20;\n\n  // Fetch country dossiers\n  const { data, isLoading, error } = useDossiersByType('country', page, pageSize);\n\n  // Filter by search query (client-side for now)\n  const filteredDossiers = data?.data.filter((dossier) => {\n    if (!searchQuery) return true;\n    const searchLower = searchQuery.toLowerCase();\n    return (\n      dossier.name_en.toLowerCase().includes(searchLower) ||\n      dossier.name_ar?.toLowerCase().includes(searchLower) ||\n      dossier.description_en?.toLowerCase().includes(searchLower) ||\n      dossier.description_ar?.toLowerCase().includes(searchLower)\n    );\n  });\n\n  return (\n    <div\n      className=\"container mx-auto px-4 sm:px-6 lg:px-8 py-4 sm:py-6 lg:py-8\"\n      dir={isRTL ? 'rtl' : 'ltr'}\n    >\n      {/* Page Header */}\n      <header className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6 sm:mb-8\">\n        <div className=\"flex items-center gap-3\">\n          <Globe2 className=\"h-6 w-6 sm:h-8 sm:w-8 text-primary\" />\n          <div>\n            <h1 className=\"text-2xl sm:text-3xl md:text-4xl font-bold\">\n              {t('type.country')}\n            </h1>\n            <p className=\"text-sm sm:text-base text-muted-foreground mt-1\">\n              {t('typeDescription.country')}\n            </p>\n          </div>\n        </div>\n        <Button asChild>\n          <Link to=\"/dossiers/create\">\n            <Plus className=\"h-4 w-4 me-2\" />\n            {t('action.create')}\n          </Link>\n        </Button>\n      </header>\n\n      {/* Search Bar */}\n      <div className=\"mb-6\">\n        <Input\n          type=\"text\"\n          placeholder={t('filter.search')}\n          value={searchQuery}\n          onChange={(e) => setSearchQuery(e.target.value)}\n          className=\"max-w-md\"\n        />\n      </div>\n\n      {/* Loading State */}\n      {isLoading && (\n        <div className=\"flex items-center justify-center py-12 sm:py-16 lg:py-20\">\n          <Loader2 className=\"h-8 w-8 sm:h-10 sm:w-10 animate-spin text-muted-foreground\" />\n          <span className=\"ms-3 text-muted-foreground text-sm sm:text-base\">\n            {t('list.loading')}\n          </span>\n        </div>\n      )}\n\n      {/* Error State */}\n      {error && !isLoading && (\n        <div\n          className=\"bg-destructive/10 border border-destructive/20 rounded-lg p-4 sm:p-6\"\n          role=\"alert\"\n        >\n          <h3 className=\"text-base sm:text-lg font-semibold text-destructive mb-2\">\n            {t('list.error')}\n          </h3>\n          <p className=\"text-sm sm:text-base text-destructive/90\">\n            {error.message}\n          </p>\n        </div>\n      )}\n\n      {/* Empty State */}\n      {!isLoading && !error && filteredDossiers?.length === 0 && (\n        <div className=\"flex flex-col items-center justify-center py-12 sm:py-16 lg:py-20 text-center\">\n          <Globe2 className=\"h-12 w-12 sm:h-16 sm:w-16 text-muted-foreground mb-4\" />\n          <h3 className=\"text-base sm:text-lg font-semibold mb-2\">\n            {searchQuery ? t('list.emptyFiltered') : t('list.empty')}\n          </h3>\n          <p className=\"text-sm sm:text-base text-muted-foreground max-w-md mb-6\">\n            {searchQuery\n              ? t('list.emptyFilteredDescription')\n              : t('list.emptyDescription')}\n          </p>\n          {!searchQuery && (\n            <Button asChild>\n              <Link to=\"/dossiers/create\">\n                {t('action.create')}\n              </Link>\n            </Button>\n          )}\n        </div>\n      )}\n\n      {/* Table - Desktop */}\n      {!isLoading && !error && filteredDossiers && filteredDossiers.length > 0 && (\n        <>\n          <div className=\"hidden md:block rounded-lg border overflow-hidden\">\n            <Table>\n              <TableHeader>\n                <TableRow>\n                  <TableHead>{t('form.nameEn')}</TableHead>\n                  <TableHead>{t('form.nameAr')}</TableHead>\n                  <TableHead>{t('form.status')}</TableHead>\n                  <TableHead>{t('form.sensitivityLevel')}</TableHead>\n                  <TableHead className=\"text-end\">{t('action.more')}</TableHead>\n                </TableRow>\n              </TableHeader>\n              <TableBody>\n                {filteredDossiers.map((dossier) => (\n                  <TableRow key={dossier.id}>\n                    <TableCell className=\"font-medium\">\n                      <Link\n                        to={`/dossiers/countries/${dossier.id}`}\n                        className=\"hover:text-primary hover:underline\"\n                      >\n                        {dossier.name_en}\n                      </Link>\n                    </TableCell>\n                    <TableCell>{dossier.name_ar}</TableCell>\n                    <TableCell>\n                      <Badge variant={dossier.status === 'active' ? 'default' : 'secondary'}>\n                        {t(`status.${dossier.status}`)}\n                      </Badge>\n                    </TableCell>\n                    <TableCell>\n                      <Badge variant=\"outline\">\n                        {t(`sensitivityLevel.${dossier.sensitivity_level}`)}\n                      </Badge>\n                    </TableCell>\n                    <TableCell className=\"text-end\">\n                      <Button variant=\"ghost\" size=\"sm\" asChild>\n                        <Link to={`/dossiers/countries/${dossier.id}`}>\n                          {t('action.view')}\n                        </Link>\n                      </Button>\n                    </TableCell>\n                  </TableRow>\n                ))}\n              </TableBody>\n            </Table>\n          </div>\n\n          {/* Card List - Mobile */}\n          <div className=\"md:hidden space-y-4\">\n            {filteredDossiers.map((dossier) => (\n              <Link\n                key={dossier.id}\n                to={`/dossiers/countries/${dossier.id}`}\n                className=\"block p-4 rounded-lg border bg-card hover:bg-accent transition-colors\"\n              >\n                <div className=\"flex items-start justify-between gap-3 mb-3\">\n                  <h3 className=\"font-semibold text-base\">\n                    {isRTL ? dossier.name_ar : dossier.name_en}\n                  </h3>\n                  <Badge variant={dossier.status === 'active' ? 'default' : 'secondary'}>\n                    {t(`status.${dossier.status}`)}\n                  </Badge>\n                </div>\n                {(isRTL ? dossier.description_ar : dossier.description_en) && (\n                  <p className=\"text-sm text-muted-foreground mb-3 line-clamp-2\">\n                    {isRTL ? dossier.description_ar : dossier.description_en}\n                  </p>\n                )}\n                <div className=\"flex items-center gap-2\">\n                  <Badge variant=\"outline\" className=\"text-xs\">\n                    {t(`sensitivityLevel.${dossier.sensitivity_level}`)}\n                  </Badge>\n                </div>\n              </Link>\n            ))}\n          </div>\n\n          {/* Pagination */}\n          {data && data.total > pageSize && (\n            <div className=\"mt-8 flex items-center justify-between\">\n              <Button\n                variant=\"outline\"\n                disabled={page === 1}\n                onClick={() => setPage((p) => Math.max(1, p - 1))}\n              >\n                {t('action.back')}\n              </Button>\n              <span className=\"text-sm text-muted-foreground\">\n                {t('list.pageInfo', {\n                  current: page,\n                  total: Math.ceil(data.total / pageSize),\n                })}\n              </span>\n              <Button\n                variant=\"outline\"\n                disabled={page * pageSize >= data.total}\n                onClick={() => setPage((p) => p + 1)}\n              >\n                {t('action.next')}\n              </Button>\n            </div>\n          )}\n        </>\n      )}\n    </div>\n  );\n}\n","/**\n * Route: /positions/:id/versions\n * Version history and comparison page\n */\n\nimport { createFileRoute, Link } from '@tanstack/react-router';\nimport { useState } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Card } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { useQuery } from '@tanstack/react-query';\nimport { supabase } from '@/lib/supabase';\nimport { ArrowLeft, GitCompare } from 'lucide-react';\nimport { VersionComparison } from '@/components/VersionComparison';\nimport { Skeleton } from '@/components/ui/skeleton';\n\nexport const Route = createFileRoute('/_protected/positions/$id/versions')({\n component: VersionHistoryPage,\n});\n\nconst API_BASE_URL = import.meta.env.VITE_SUPABASE_URL + '/functions/v1';\n\nasync function fetchVersions(positionId: string) {\n const { data: { session } } = await supabase.auth.getSession();\n const response = await fetch(`${API_BASE_URL}/positions-versions-list?id=${positionId}`, {\n headers: {\n 'Authorization': `Bearer ${session?.access_token}`,\n 'Content-Type': 'application/json',\n },\n });\n\n if (!response.ok) {\n throw new Error('Failed to fetch versions');\n }\n\n const data = await response.json();\n return data.versions || [];\n}\n\nfunction VersionHistoryPage() {\n const { id } = Route.useParams();\n const { t } = useTranslation();\n const [selectedVersions, setSelectedVersions] = useState<[number | null, number | null]>([null, null]);\n\n const { data: versions, isLoading } = useQuery({\n queryKey: ['positions', 'versions', id],\n queryFn: () => fetchVersions(id),\n });\n\n const handleVersionSelect = (versionNumber: number) => {\n if (selectedVersions[0] === null) {\n setSelectedVersions([versionNumber, null]);\n } else if (selectedVersions[1] === null && versionNumber !== selectedVersions[0]) {\n setSelectedVersions([selectedVersions[0], versionNumber]);\n } else {\n setSelectedVersions([versionNumber, null]);\n }\n };\n\n const canCompare = selectedVersions[0] !== null && selectedVersions[1] !== null;\n\n if (isLoading) {\n return (\n <div className=\"container mx-auto py-6 space-y-4\">\n <Skeleton className=\"h-8 w-64\" />\n <Skeleton className=\"h-96\" />\n </div>\n );\n }\n\n return (\n <div className=\"container mx-auto py-6 space-y-6\">\n {/* Header */}\n <div className=\"flex items-center justify-between\">\n <div className=\"flex items-center gap-4\">\n <Link to=\"/positions/$id\" params={{ id }}>\n <Button variant=\"outline\" size=\"sm\">\n <ArrowLeft className=\"me-2 h-4 w-4\" />\n {t('common.back', 'Back')}\n </Button>\n </Link>\n <h1 className=\"text-3xl font-bold\">\n {t('positions.versions.title', 'Version History')}\n </h1>\n </div>\n\n {canCompare && (\n <Button onClick={() => {}}>\n <GitCompare className=\"me-2 h-4 w-4\" />\n {t('positions.versions.compare', 'Compare Versions')}\n </Button>\n )}\n </div>\n\n {/* Version List */}\n {!canCompare && (\n <Card className=\"p-6\">\n <div className=\"space-y-4\">\n <p className=\"text-sm text-muted-foreground\">\n {t('positions.versions.selectTwo', 'Select two versions to compare')}\n </p>\n\n <div className=\"space-y-2\">\n {versions?.map((version: any) => (\n <div\n key={version.id}\n className={`p-4 border rounded-lg cursor-pointer transition-colors ${\n selectedVersions.includes(version.version_number)\n ? 'border-primary bg-primary/5'\n : 'hover:border-primary/50'\n }`}\n onClick={() => handleVersionSelect(version.version_number)}\n >\n <div className=\"flex items-center justify-between\">\n <div className=\"space-y-1\">\n <div className=\"flex items-center gap-2\">\n <span className=\"font-semibold\">\n {t('positions.versions.version', 'Version')} {version.version_number}\n </span>\n {!version.superseded && (\n <Badge variant=\"success\">\n {t('positions.versions.current', 'Current')}\n </Badge>\n )}\n </div>\n <p className=\"text-sm text-muted-foreground\">\n {new Date(version.created_at).toLocaleString()}\n </p>\n </div>\n </div>\n </div>\n ))}\n </div>\n </div>\n </Card>\n )}\n\n {/* Version Comparison */}\n {canCompare && (\n <Card className=\"p-6\">\n <div className=\"mb-4 flex items-center justify-between\">\n <div className=\"flex items-center gap-2\">\n <span className=\"text-sm text-muted-foreground\">\n {t('positions.versions.comparing', 'Comparing versions')}:\n </span>\n <Badge>{selectedVersions[0]}</Badge>\n <span className=\"text-sm text-muted-foreground\">vs</span>\n <Badge>{selectedVersions[1]}</Badge>\n </div>\n <Button variant=\"outline\" onClick={() => setSelectedVersions([null, null])}>\n {t('common.clear', 'Clear Selection')}\n </Button>\n </div>\n\n <VersionComparison\n positionId={id}\n fromVersion={Math.min(selectedVersions[0]!, selectedVersions[1]!)}\n toVersion={Math.max(selectedVersions[0]!, selectedVersions[1]!)}\n />\n </Card>\n )}\n </div>\n );\n}\n","/**\n * Route: /positions/:id/approvals\n * Detailed approval tracking page\n */\n\nimport { createFileRoute } from '@tanstack/react-router';\nimport { useTranslation } from 'react-i18next';\nimport { Card } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from '@/components/ui/table';\nimport { useQuery } from '@tanstack/react-query';\nimport { supabase } from '@/lib/supabase';\nimport { ArrowLeft, CheckCircle, XCircle, UserPlus, Users } from 'lucide-react';\nimport { Link } from '@tanstack/react-router';\nimport ApprovalChain from '@/components/ApprovalChain';\nimport { Skeleton } from '@/components/ui/skeleton';\n\nexport const Route = createFileRoute('/_protected/positions/$id/approvals')({\n component: ApprovalTrackingPage,\n});\n\nconst API_BASE_URL = import.meta.env.VITE_SUPABASE_URL + '/functions/v1';\n\nasync function fetchApprovals(positionId: string) {\n const { data: { session } } = await supabase.auth.getSession();\n const response = await fetch(`${API_BASE_URL}/positions-get?id=${positionId}`, {\n headers: {\n 'Authorization': `Bearer ${session?.access_token}`,\n 'Content-Type': 'application/json',\n },\n });\n\n if (!response.ok) {\n throw new Error('Failed to fetch position');\n }\n\n return response.json();\n}\n\nfunction ApprovalTrackingPage() {\n const { id } = Route.useParams();\n const { t } = useTranslation();\n\n const { data: position, isLoading } = useQuery({\n queryKey: ['positions', 'detail', id],\n queryFn: () => fetchApprovals(id),\n });\n\n if (isLoading) {\n return (\n <div className=\"container mx-auto py-6 space-y-4\">\n <Skeleton className=\"h-8 w-64\" />\n <Skeleton className=\"h-96\" />\n </div>\n );\n }\n\n const getActionIcon = (action: string) => {\n switch (action) {\n case 'approve':\n return <CheckCircle className=\"h-4 w-4 text-green-500\" />;\n case 'request_revisions':\n return <XCircle className=\"h-4 w-4 text-red-500\" />;\n case 'delegate':\n return <UserPlus className=\"h-4 w-4 text-blue-500\" />;\n case 'reassign':\n return <Users className=\"h-4 w-4 text-orange-500\" />;\n default:\n return null;\n }\n };\n\n return (\n <div className=\"container mx-auto py-6 space-y-6\">\n {/* Header */}\n <div className=\"flex items-center gap-4\">\n <Link to=\"/positions/$id\" params={{ id }}>\n <Button variant=\"outline\" size=\"sm\">\n <ArrowLeft className=\"me-2 h-4 w-4\" />\n {t('common.back', 'Back')}\n </Button>\n </Link>\n <h1 className=\"text-3xl font-bold\">\n {t('positions.approvals.title', 'Approval Tracking')}\n </h1>\n </div>\n\n {/* Approval Chain Visualization */}\n <Card className=\"p-6\">\n <h2 className=\"text-xl font-semibold mb-4\">\n {t('positions.approvals.progress', 'Approval Progress')}\n </h2>\n <ApprovalChain\n positionId={id}\n currentStage={position?.current_stage || 0}\n detailed={true}\n />\n </Card>\n\n {/* Approval History Table */}\n <Card className=\"p-6\">\n <h2 className=\"text-xl font-semibold mb-4\">\n {t('positions.approvals.history', 'Approval History')}\n </h2>\n\n <Table>\n <TableHeader>\n <TableRow>\n <TableHead>{t('positions.approvals.stage', 'Stage')}</TableHead>\n <TableHead>{t('positions.approvals.approver', 'Approver')}</TableHead>\n <TableHead>{t('positions.approvals.action', 'Action')}</TableHead>\n <TableHead>{t('positions.approvals.stepUp', 'Step-Up Verified')}</TableHead>\n <TableHead>{t('positions.approvals.comments', 'Comments')}</TableHead>\n <TableHead>{t('positions.approvals.timestamp', 'Timestamp')}</TableHead>\n </TableRow>\n </TableHeader>\n <TableBody>\n {position?.approvals?.map((approval: any) => (\n <TableRow key={approval.id}>\n <TableCell>\n <Badge variant=\"outline\">{approval.stage}</Badge>\n </TableCell>\n <TableCell>\n <div className=\"flex flex-col\">\n <span className=\"font-medium\">{approval.approver_name || approval.approver_id}</span>\n {approval.delegated_from && (\n <span className=\"text-xs text-muted-foreground\">\n {t('positions.approvals.delegatedFrom', 'Delegated from')}: {approval.delegated_from}\n </span>\n )}\n </div>\n </TableCell>\n <TableCell>\n <div className=\"flex items-center gap-2\">\n {getActionIcon(approval.action)}\n <span className=\"capitalize\">{approval.action.replace('_', ' ')}</span>\n </div>\n </TableCell>\n <TableCell>\n {approval.step_up_verified ? (\n <Badge variant=\"success\" className=\"text-xs\">\n {t('common.yes', 'Yes')}\n </Badge>\n ) : (\n <Badge variant=\"secondary\" className=\"text-xs\">\n {t('common.no', 'No')}\n </Badge>\n )}\n </TableCell>\n <TableCell className=\"max-w-xs truncate\">{approval.comments || '-'}</TableCell>\n <TableCell className=\"text-sm text-muted-foreground\">\n {new Date(approval.created_at).toLocaleString()}\n </TableCell>\n </TableRow>\n ))}\n </TableBody>\n </Table>\n </Card>\n </div>\n );\n}\n","import { createFileRoute } from '@tanstack/react-router';\nimport { TicketDetail } from '../../../pages/TicketDetail';\n\nexport const Route = createFileRoute('/_protected/intake/tickets/$id')({\n component: TicketDetailPage,\n});\n\nfunction TicketDetailPage() {\n return <TicketDetail />;\n}","import { createFileRoute, useNavigate, Link } from '@tanstack/react-router';\nimport { useEngagement } from '@/hooks/useEngagement';\nimport { useCreateAfterAction } from '@/hooks/useAfterAction';\nimport { AfterActionForm } from '@/components/AfterActionForm';\nimport { useTranslation } from 'react-i18next';\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Skeleton } from '@/components/ui/skeleton';\nimport { Button } from '@/components/ui/button';\nimport { ArrowLeft } from 'lucide-react';\nimport { toast } from 'sonner';\n\nexport const Route = createFileRoute('/_protected/engagements/$engagementId/after-action')({\n component: AfterActionFormPage,\n});\n\nfunction AfterActionFormPage() {\n const { engagementId } = Route.useParams();\n const { t, i18n } = useTranslation();\n const isRTL = i18n.language === 'ar';\n const navigate = useNavigate();\n\n const { data: engagement, isLoading: loadingEngagement } = useEngagement(engagementId);\n const createAfterAction = useCreateAfterAction();\n\n if (loadingEngagement) {\n return (\n <div className=\"container mx-auto p-6 space-y-6\">\n <Skeleton className=\"h-8 w-64\" />\n <Skeleton className=\"h-screen w-full\" />\n </div>\n );\n }\n\n if (!engagement) {\n return (\n <div className=\"container mx-auto p-6\">\n <Card className=\"border-destructive\">\n <CardHeader>\n <CardTitle className=\"text-destructive\">{t('common.error')}</CardTitle>\n <CardDescription>{t('engagements.notFound')}</CardDescription>\n </CardHeader>\n </Card>\n </div>\n );\n }\n\n const handleSaveDraft = async (data: any) => {\n try {\n const afterAction = await createAfterAction.mutateAsync({\n engagement_id: engagementId,\n dossier_id: engagement.dossier_id,\n publication_status: 'draft',\n ...data,\n });\n\n toast.success(t('afterActions.draftSaved'));\n navigate({\n to: '/after-actions/$afterActionId',\n params: { afterActionId: afterAction.id },\n });\n } catch (error: any) {\n toast.error(error.message || t('afterActions.saveFailed'));\n }\n };\n\n return (\n <div className={`container mx-auto p-6 space-y-6 ${isRTL ? 'rtl' : 'ltr'}`}>\n {/* Header */}\n <div className=\"flex items-center gap-4\">\n <Button variant=\"ghost\" size=\"icon\" asChild>\n <Link\n to=\"/engagements/$engagementId\"\n params={{ engagementId }}\n >\n <ArrowLeft className={`h-4 w-4 ${isRTL ? 'rotate-180' : ''}`} />\n </Link>\n </Button>\n <div>\n <h1 className=\"text-3xl font-bold\">{t('afterActions.logAfterAction')}</h1>\n <p className=\"text-muted-foreground\">{engagement.title}</p>\n </div>\n </div>\n\n {/* Form Card */}\n <Card>\n <CardHeader>\n <CardTitle>{t('afterActions.formTitle')}</CardTitle>\n <CardDescription>{t('afterActions.formDescription')}</CardDescription>\n </CardHeader>\n <CardContent>\n <AfterActionForm\n engagementId={engagementId}\n dossierId={engagement.dossier_id}\n onSaveDraft={handleSaveDraft}\n isLoading={createAfterAction.isPending}\n />\n </CardContent>\n </Card>\n </div>\n );\n}\n","/**\n * Working Group Dossier Detail Route (Feature 028 - User Story 6)\n *\n * Component Library Decision:\n * - Checked: Aceternity UI > Aceternity Pro > Kibo-UI\n * - Selected: CollapsibleSection (already implemented), DossierDetailLayout (shared wrapper)\n * - Reason: Reusing shared components for consistency, type-specific layout via gridClassName\n *\n * Responsive Strategy:\n * - Base: Single column (grid-cols-1)\n * - md: 2-column grid (md:grid-cols-2)\n * - lg: 3-column bento grid (lg:grid-cols-3) for collaboration visualization\n *\n * RTL Support:\n * - Logical properties: Container uses ps-*, pe-*, text-start\n * - Icon flipping: None needed (no directional icons)\n * - Text alignment: text-start for all text content\n *\n * Accessibility:\n * - ARIA: Page title as h1, proper semantic structure\n * - Keyboard: Collapsible sections support keyboard navigation\n * - Focus: Focus management in CollapsibleSection component\n *\n * Performance:\n * - Lazy loading: Component will be code-split via React.lazy in polish phase\n * - Memoization: Type guard validation memoized via TanStack Query\n *\n * @example\n * <Route path=\"/dossiers/working-groups/:id\" />\n */\n\nimport { createFileRoute } from '@tanstack/react-router';\nimport { useTranslation } from 'react-i18next';\nimport { Loader2, AlertCircle } from 'lucide-react';\nimport { useTypedDossier } from '@/hooks/useDossier';\nimport { WorkingGroupDossierPage } from '@/pages/dossiers/WorkingGroupDossierPage';\nimport { Button } from '@/components/ui/button';\nimport { Link } from '@tanstack/react-router';\n\nexport const Route = createFileRoute('/_protected/dossiers/working_groups/$id')({\n  component: WorkingGroupDossierDetailRoute,\n});\n\nfunction WorkingGroupDossierDetailRoute() {\n  const { id } = Route.useParams();\n  const { t, i18n } = useTranslation('dossier');\n  const isRTL = i18n.language === 'ar';\n\n  // Fetch working group dossier with type validation\n  const { data: dossier, isLoading, error } = useTypedDossier(id, 'working_group');\n\n  // Loading State\n  if (isLoading) {\n    return (\n      <div\n        className=\"flex min-h-[50vh] items-center justify-center\"\n        dir={isRTL ? 'rtl' : 'ltr'}\n      >\n        <div className=\"flex flex-col items-center gap-3\">\n          <Loader2 className=\"h-8 w-8 sm:h-10 sm:w-10 animate-spin text-primary\" />\n          <p className=\"text-sm sm:text-base text-muted-foreground\">\n            {t('detail.loading')}\n          </p>\n        </div>\n      </div>\n    );\n  }\n\n  // Error State\n  if (error || !dossier) {\n    return (\n      <div\n        className=\"container mx-auto px-4 sm:px-6 lg:px-8 py-8 sm:py-12\"\n        dir={isRTL ? 'rtl' : 'ltr'}\n      >\n        <div className=\"max-w-2xl mx-auto\">\n          <div className=\"rounded-lg border border-destructive/20 bg-destructive/10 p-6 sm:p-8\">\n            <div className=\"flex items-start gap-4\">\n              <AlertCircle className=\"h-5 w-5 sm:h-6 sm:w-6 text-destructive shrink-0 mt-1\" />\n              <div className=\"flex-1\">\n                <h2 className=\"text-lg sm:text-xl font-semibold text-destructive mb-2\">\n                  {t('detail.error')}\n                </h2>\n                <p className=\"text-sm sm:text-base text-destructive/90 mb-4\">\n                  {error?.message || t('detail.errorGeneric')}\n                </p>\n                <Button asChild variant=\"outline\">\n                  <Link to=\"/dossiers\">\n                    {t('action.backToHub')}\n                  </Link>\n                </Button>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  // Type Mismatch Error\n  if (dossier.type !== 'working_group') {\n    return (\n      <div\n        className=\"container mx-auto px-4 sm:px-6 lg:px-8 py-8 sm:py-12\"\n        dir={isRTL ? 'rtl' : 'ltr'}\n      >\n        <div className=\"max-w-2xl mx-auto\">\n          <div className=\"rounded-lg border border-warning/20 bg-warning/10 p-6 sm:p-8\">\n            <h2 className=\"text-lg sm:text-xl font-semibold mb-2\">\n              {t('detail.wrongType')}\n            </h2>\n            <p className=\"text-sm sm:text-base text-muted-foreground mb-4\">\n              {t('detail.wrongTypeDescription', {\n                actualType: t(`type.${dossier.type}`),\n                expectedType: t('type.working_group'),\n              })}\n            </p>\n            <div className=\"flex gap-3\">\n              <Button asChild>\n                <Link to={`/dossiers/${dossier.type}s/${id}`}>\n                  {t('action.viewCorrectType', { type: t(`type.${dossier.type}`) })}\n                </Link>\n              </Button>\n              <Button asChild variant=\"outline\">\n                <Link to=\"/dossiers\">\n                  {t('action.backToHub')}\n                </Link>\n              </Button>\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  // Success - Render Working Group Dossier Page\n  return <WorkingGroupDossierPage dossier={dossier} />;\n}\n","/**\n * Topic Detail Route (Feature 028 - Type-Specific Detail Pages)\n *\n * Route: /dossiers/topics/$id\n * Validates topic type and renders detail page.\n * Error handling for loading, errors, not found, and wrong types.\n */\n\nimport { createFileRoute, Link } from '@tanstack/react-router';\nimport { useTranslation } from 'react-i18next';\nimport { AlertCircle, ArrowLeft } from 'lucide-react';\nimport { Alert, AlertDescription, AlertTitle } from '@/components/ui/alert';\nimport { Button } from '@/components/ui/button';\nimport { useDossier } from '@/hooks/useDossier';\nimport { isTopicDossier } from '@/lib/dossier-type-guards';\nimport { TopicDossierPage } from '@/pages/dossiers/TopicDossierPage';\n\nexport const Route = createFileRoute('/_protected/dossiers/topics/$id')({\n  component: TopicDossierDetailRoute,\n});\n\nfunction TopicDossierDetailRoute() {\n  const { t, i18n } = useTranslation('dossier');\n  const isRTL = i18n.language === 'ar';\n  const { id } = Route.useParams();\n\n  const { data: dossier, isLoading, error } = useDossier(id, ['stats', 'owners', 'contacts']);\n\n  // Loading state\n  if (isLoading) {\n    return (\n      <div\n        className=\"flex flex-col items-center justify-center min-h-[50vh] space-y-4\"\n        dir={isRTL ? 'rtl' : 'ltr'}\n      >\n        <div className=\"h-12 w-12 animate-spin rounded-full border-4 border-primary border-t-transparent\" />\n        <p className=\"text-sm sm:text-base text-muted-foreground\">\n          {t('detail.loading')}\n        </p>\n      </div>\n    );\n  }\n\n  // Error state\n  if (error) {\n    return (\n      <div\n        className=\"container mx-auto px-4 sm:px-6 lg:px-8 py-6 sm:py-8\"\n        dir={isRTL ? 'rtl' : 'ltr'}\n      >\n        <Alert variant=\"destructive\">\n          <AlertCircle className=\"h-4 w-4\" />\n          <AlertTitle>{t('detail.error')}</AlertTitle>\n          <AlertDescription>\n            {error instanceof Error ? error.message : t('detail.errorGeneric')}\n          </AlertDescription>\n        </Alert>\n        <div className=\"mt-4 sm:mt-6\">\n          <Link to=\"/dossiers\">\n            <Button variant=\"outline\" className=\"gap-2\">\n              <ArrowLeft className={`h-4 w-4 ${isRTL ? 'rotate-180' : ''}`} />\n              {t('action.backToHub')}\n            </Button>\n          </Link>\n        </div>\n      </div>\n    );\n  }\n\n  // Not found state\n  if (!dossier) {\n    return (\n      <div\n        className=\"container mx-auto px-4 sm:px-6 lg:px-8 py-6 sm:py-8\"\n        dir={isRTL ? 'rtl' : 'ltr'}\n      >\n        <Alert>\n          <AlertCircle className=\"h-4 w-4\" />\n          <AlertTitle>{t('detail.notFound')}</AlertTitle>\n          <AlertDescription>\n            {t('detail.errorGeneric')}\n          </AlertDescription>\n        </Alert>\n        <div className=\"mt-4 sm:mt-6\">\n          <Link to=\"/dossiers\">\n            <Button variant=\"outline\" className=\"gap-2\">\n              <ArrowLeft className={`h-4 w-4 ${isRTL ? 'rotate-180' : ''}`} />\n              {t('action.backToHub')}\n            </Button>\n          </Link>\n        </div>\n      </div>\n    );\n  }\n\n  // Wrong type validation\n  if (!isTopicDossier(dossier)) {\n    const actualType = t(`type.${dossier.dossier_type}`);\n    const expectedType = t('type.topic');\n\n    return (\n      <div\n        className=\"container mx-auto px-4 sm:px-6 lg:px-8 py-6 sm:py-8\"\n        dir={isRTL ? 'rtl' : 'ltr'}\n      >\n        <Alert>\n          <AlertCircle className=\"h-4 w-4\" />\n          <AlertTitle>{t('detail.wrongType')}</AlertTitle>\n          <AlertDescription>\n            {t('detail.wrongTypeDescription', { actualType, expectedType })}\n          </AlertDescription>\n        </Alert>\n        <div className=\"mt-4 sm:mt-6 flex flex-col sm:flex-row gap-3\">\n          <Link to={`/dossiers/${dossier.dossier_type}s/$id`} params={{ id: dossier.id }}>\n            <Button className=\"gap-2 w-full sm:w-auto\">\n              {t('action.viewCorrectType', { type: actualType })}\n            </Button>\n          </Link>\n          <Link to=\"/dossiers/topics\">\n            <Button variant=\"outline\" className=\"gap-2 w-full sm:w-auto\">\n              <ArrowLeft className={`h-4 w-4 ${isRTL ? 'rotate-180' : ''}`} />\n              {t('action.backToList')}\n            </Button>\n          </Link>\n        </div>\n      </div>\n    );\n  }\n\n  return <TopicDossierPage dossier={dossier} />;\n}\n","/**\n * Person Detail Route (Feature 028 - User Story 4 - T033)\n *\n * Route: /dossiers/persons/$id\n * Validates person type and renders detail page.\n * Error handling for loading, errors, not found, and wrong types.\n */\n\nimport { createFileRoute, Link } from '@tanstack/react-router';\nimport { useTranslation } from 'react-i18next';\nimport { AlertCircle, ArrowLeft } from 'lucide-react';\nimport { Alert, AlertDescription, AlertTitle } from '@/components/ui/alert';\nimport { Button } from '@/components/ui/button';\nimport { useDossier } from '@/hooks/useDossier';\nimport { isPersonDossier } from '@/lib/dossier-type-guards';\nimport { PersonDossierPage } from '@/pages/dossiers/PersonDossierPage';\n\nexport const Route = createFileRoute('/_protected/dossiers/persons/$id')({\n  component: PersonDossierDetailRoute,\n});\n\nfunction PersonDossierDetailRoute() {\n  const { t, i18n } = useTranslation('dossier');\n  const isRTL = i18n.language === 'ar';\n  const { id } = Route.useParams();\n\n  const { data: dossier, isLoading, error } = useDossier(id, ['stats', 'owners', 'contacts']);\n\n  // Loading state\n  if (isLoading) {\n    return (\n      <div\n        className=\"flex flex-col items-center justify-center min-h-[50vh] space-y-4\"\n        dir={isRTL ? 'rtl' : 'ltr'}\n      >\n        <div className=\"h-12 w-12 animate-spin rounded-full border-4 border-primary border-t-transparent\" />\n        <p className=\"text-sm sm:text-base text-muted-foreground\">\n          {t('detail.loading')}\n        </p>\n      </div>\n    );\n  }\n\n  // Error state\n  if (error) {\n    return (\n      <div\n        className=\"container mx-auto px-4 sm:px-6 lg:px-8 py-6 sm:py-8\"\n        dir={isRTL ? 'rtl' : 'ltr'}\n      >\n        <Alert variant=\"destructive\">\n          <AlertCircle className=\"h-4 w-4\" />\n          <AlertTitle>{t('detail.error')}</AlertTitle>\n          <AlertDescription>\n            {error instanceof Error ? error.message : t('detail.errorGeneric')}\n          </AlertDescription>\n        </Alert>\n        <div className=\"mt-4 sm:mt-6\">\n          <Link to=\"/dossiers\">\n            <Button variant=\"outline\" className=\"gap-2\">\n              <ArrowLeft className={`h-4 w-4 ${isRTL ? 'rotate-180' : ''}`} />\n              {t('action.backToHub')}\n            </Button>\n          </Link>\n        </div>\n      </div>\n    );\n  }\n\n  // Not found state\n  if (!dossier) {\n    return (\n      <div\n        className=\"container mx-auto px-4 sm:px-6 lg:px-8 py-6 sm:py-8\"\n        dir={isRTL ? 'rtl' : 'ltr'}\n      >\n        <Alert>\n          <AlertCircle className=\"h-4 w-4\" />\n          <AlertTitle>{t('detail.notFound')}</AlertTitle>\n          <AlertDescription>\n            {t('detail.errorGeneric')}\n          </AlertDescription>\n        </Alert>\n        <div className=\"mt-4 sm:mt-6\">\n          <Link to=\"/dossiers\">\n            <Button variant=\"outline\" className=\"gap-2\">\n              <ArrowLeft className={`h-4 w-4 ${isRTL ? 'rotate-180' : ''}`} />\n              {t('action.backToHub')}\n            </Button>\n          </Link>\n        </div>\n      </div>\n    );\n  }\n\n  // Wrong type validation\n  if (!isPersonDossier(dossier)) {\n    const actualType = t(`type.${dossier.dossier_type}`);\n    const expectedType = t('type.person');\n\n    return (\n      <div\n        className=\"container mx-auto px-4 sm:px-6 lg:px-8 py-6 sm:py-8\"\n        dir={isRTL ? 'rtl' : 'ltr'}\n      >\n        <Alert>\n          <AlertCircle className=\"h-4 w-4\" />\n          <AlertTitle>{t('detail.wrongType')}</AlertTitle>\n          <AlertDescription>\n            {t('detail.wrongTypeDescription', { actualType, expectedType })}\n          </AlertDescription>\n        </Alert>\n        <div className=\"mt-4 sm:mt-6 flex flex-col sm:flex-row gap-3\">\n          <Link to={`/dossiers/${dossier.dossier_type}s/$id`} params={{ id: dossier.id }}>\n            <Button className=\"gap-2 w-full sm:w-auto\">\n              {t('action.viewCorrectType', { type: actualType })}\n            </Button>\n          </Link>\n          <Link to=\"/dossiers/persons\">\n            <Button variant=\"outline\" className=\"gap-2 w-full sm:w-auto\">\n              <ArrowLeft className={`h-4 w-4 ${isRTL ? 'rotate-180' : ''}`} />\n              {t('action.backToList')}\n            </Button>\n          </Link>\n        </div>\n      </div>\n    );\n  }\n\n  return <PersonDossierPage dossier={dossier} />;\n}\n","/**\n * Organization Dossier Detail Route (Feature 028 - User Story 5)\n *\n * Component Library Decision:\n * - Checked: Aceternity UI > Aceternity Pro > Kibo-UI\n * - Selected: CollapsibleSection (already implemented), DossierDetailLayout (shared wrapper)\n * - Reason: Reusing shared components for consistency, type-specific layout via gridClassName\n *\n * Responsive Strategy:\n * - Base: Single column (grid-cols-1)\n * - lg: 3-column grid (lg:grid-cols-3) for hierarchical visualization\n *\n * RTL Support:\n * - Logical properties: Container uses ps-*, pe-*, text-start\n * - Icon flipping: None needed (no directional icons in organization view)\n * - Text alignment: text-start for all text content\n *\n * Accessibility:\n * - ARIA: Page title as h1, proper semantic structure\n * - Keyboard: Collapsible sections support keyboard navigation\n * - Focus: Focus management in CollapsibleSection component\n *\n * Performance:\n * - Lazy loading: Component will be code-split via React.lazy in polish phase\n * - Memoization: Type guard validation memoized via TanStack Query\n *\n * @example\n * <Route path=\"/dossiers/organizations/:id\" />\n */\n\nimport { createFileRoute } from '@tanstack/react-router';\nimport { useTranslation } from 'react-i18next';\nimport { Loader2, AlertCircle } from 'lucide-react';\nimport { useTypedDossier } from '@/hooks/useDossier';\nimport { OrganizationDossierPage } from '@/pages/dossiers/OrganizationDossierPage';\nimport { Button } from '@/components/ui/button';\nimport { Link } from '@tanstack/react-router';\n\nexport const Route = createFileRoute('/_protected/dossiers/organizations/$id')({\n  component: OrganizationDossierDetailRoute,\n});\n\nfunction OrganizationDossierDetailRoute() {\n  const { id } = Route.useParams();\n  const { t, i18n } = useTranslation('dossier');\n  const isRTL = i18n.language === 'ar';\n\n  // Fetch organization dossier with type validation\n  const { data: dossier, isLoading, error } = useTypedDossier(id, 'organization');\n\n  // Loading State\n  if (isLoading) {\n    return (\n      <div\n        className=\"flex min-h-[50vh] items-center justify-center\"\n        dir={isRTL ? 'rtl' : 'ltr'}\n      >\n        <div className=\"flex flex-col items-center gap-3\">\n          <Loader2 className=\"h-8 w-8 sm:h-10 sm:w-10 animate-spin text-primary\" />\n          <p className=\"text-sm sm:text-base text-muted-foreground\">\n            {t('detail.loading')}\n          </p>\n        </div>\n      </div>\n    );\n  }\n\n  // Error State\n  if (error || !dossier) {\n    return (\n      <div\n        className=\"container mx-auto px-4 sm:px-6 lg:px-8 py-8 sm:py-12\"\n        dir={isRTL ? 'rtl' : 'ltr'}\n      >\n        <div className=\"max-w-2xl mx-auto\">\n          <div className=\"rounded-lg border border-destructive/20 bg-destructive/10 p-6 sm:p-8\">\n            <div className=\"flex items-start gap-4\">\n              <AlertCircle className=\"h-5 w-5 sm:h-6 sm:w-6 text-destructive shrink-0 mt-1\" />\n              <div className=\"flex-1\">\n                <h2 className=\"text-lg sm:text-xl font-semibold text-destructive mb-2\">\n                  {t('detail.error')}\n                </h2>\n                <p className=\"text-sm sm:text-base text-destructive/90 mb-4\">\n                  {error?.message || t('detail.errorGeneric')}\n                </p>\n                <Button asChild variant=\"outline\">\n                  <Link to=\"/dossiers\">\n                    {t('action.backToHub')}\n                  </Link>\n                </Button>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  // Type Mismatch Error (should not happen with type guard, but defensive)\n  if (dossier.type !== 'organization') {\n    return (\n      <div\n        className=\"container mx-auto px-4 sm:px-6 lg:px-8 py-8 sm:py-12\"\n        dir={isRTL ? 'rtl' : 'ltr'}\n      >\n        <div className=\"max-w-2xl mx-auto\">\n          <div className=\"rounded-lg border border-warning/20 bg-warning/10 p-6 sm:p-8\">\n            <h2 className=\"text-lg sm:text-xl font-semibold mb-2\">\n              {t('detail.wrongType')}\n            </h2>\n            <p className=\"text-sm sm:text-base text-muted-foreground mb-4\">\n              {t('detail.wrongTypeDescription', {\n                actualType: t(`type.${dossier.type}`),\n                expectedType: t('type.organization'),\n              })}\n            </p>\n            <div className=\"flex gap-3\">\n              <Button asChild>\n                <Link to={`/dossiers/${dossier.type}s/${id}`}>\n                  {t('action.viewCorrectType', { type: t(`type.${dossier.type}`) })}\n                </Link>\n              </Button>\n              <Button asChild variant=\"outline\">\n                <Link to=\"/dossiers\">\n                  {t('action.backToHub')}\n                </Link>\n              </Button>\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  // Success - Render Organization Dossier Page\n  return <OrganizationDossierPage dossier={dossier} />;\n}\n","/**\n * Forum Dossier Detail Route (Feature 028 - User Story 6)\n *\n * Component Library Decision:\n * - Checked: Aceternity UI > Aceternity Pro > Kibo-UI\n * - Selected: CollapsibleSection (already implemented), DossierDetailLayout (shared wrapper)\n * - Reason: Reusing shared components for consistency, type-specific layout via gridClassName\n *\n * Responsive Strategy:\n * - Base: Single column (grid-cols-1)\n * - md: 2-column grid (md:grid-cols-2)\n * - lg: 3-column bento grid (lg:grid-cols-3) for collaboration visualization\n *\n * RTL Support:\n * - Logical properties: Container uses ps-*, pe-*, text-start\n * - Icon flipping: None needed (no directional icons)\n * - Text alignment: text-start for all text content\n *\n * Accessibility:\n * - ARIA: Page title as h1, proper semantic structure\n * - Keyboard: Collapsible sections support keyboard navigation\n * - Focus: Focus management in CollapsibleSection component\n *\n * Performance:\n * - Lazy loading: Component will be code-split via React.lazy in polish phase\n * - Memoization: Type guard validation memoized via TanStack Query\n *\n * @example\n * <Route path=\"/dossiers/forums/:id\" />\n */\n\nimport { createFileRoute } from '@tanstack/react-router';\nimport { useTranslation } from 'react-i18next';\nimport { Loader2, AlertCircle } from 'lucide-react';\nimport { useTypedDossier } from '@/hooks/useDossier';\nimport { ForumDossierPage } from '@/pages/dossiers/ForumDossierPage';\nimport { Button } from '@/components/ui/button';\nimport { Link } from '@tanstack/react-router';\n\nexport const Route = createFileRoute('/_protected/dossiers/forums/$id')({\n  component: ForumDossierDetailRoute,\n});\n\nfunction ForumDossierDetailRoute() {\n  const { id } = Route.useParams();\n  const { t, i18n } = useTranslation('dossier');\n  const isRTL = i18n.language === 'ar';\n\n  // Fetch forum dossier with type validation\n  const { data: dossier, isLoading, error } = useTypedDossier(id, 'forum');\n\n  // Loading State\n  if (isLoading) {\n    return (\n      <div\n        className=\"flex min-h-[50vh] items-center justify-center\"\n        dir={isRTL ? 'rtl' : 'ltr'}\n      >\n        <div className=\"flex flex-col items-center gap-3\">\n          <Loader2 className=\"h-8 w-8 sm:h-10 sm:w-10 animate-spin text-primary\" />\n          <p className=\"text-sm sm:text-base text-muted-foreground\">\n            {t('detail.loading')}\n          </p>\n        </div>\n      </div>\n    );\n  }\n\n  // Error State\n  if (error || !dossier) {\n    return (\n      <div\n        className=\"container mx-auto px-4 sm:px-6 lg:px-8 py-8 sm:py-12\"\n        dir={isRTL ? 'rtl' : 'ltr'}\n      >\n        <div className=\"max-w-2xl mx-auto\">\n          <div className=\"rounded-lg border border-destructive/20 bg-destructive/10 p-6 sm:p-8\">\n            <div className=\"flex items-start gap-4\">\n              <AlertCircle className=\"h-5 w-5 sm:h-6 sm:w-6 text-destructive shrink-0 mt-1\" />\n              <div className=\"flex-1\">\n                <h2 className=\"text-lg sm:text-xl font-semibold text-destructive mb-2\">\n                  {t('detail.error')}\n                </h2>\n                <p className=\"text-sm sm:text-base text-destructive/90 mb-4\">\n                  {error?.message || t('detail.errorGeneric')}\n                </p>\n                <Button asChild variant=\"outline\">\n                  <Link to=\"/dossiers\">\n                    {t('action.backToHub')}\n                  </Link>\n                </Button>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  // Type Mismatch Error\n  if (dossier.type !== 'forum') {\n    return (\n      <div\n        className=\"container mx-auto px-4 sm:px-6 lg:px-8 py-8 sm:py-12\"\n        dir={isRTL ? 'rtl' : 'ltr'}\n      >\n        <div className=\"max-w-2xl mx-auto\">\n          <div className=\"rounded-lg border border-warning/20 bg-warning/10 p-6 sm:p-8\">\n            <h2 className=\"text-lg sm:text-xl font-semibold mb-2\">\n              {t('detail.wrongType')}\n            </h2>\n            <p className=\"text-sm sm:text-base text-muted-foreground mb-4\">\n              {t('detail.wrongTypeDescription', {\n                actualType: t(`type.${dossier.type}`),\n                expectedType: t('type.forum'),\n              })}\n            </p>\n            <div className=\"flex gap-3\">\n              <Button asChild>\n                <Link to={`/dossiers/${dossier.type}s/${id}`}>\n                  {t('action.viewCorrectType', { type: t(`type.${dossier.type}`) })}\n                </Link>\n              </Button>\n              <Button asChild variant=\"outline\">\n                <Link to=\"/dossiers\">\n                  {t('action.backToHub')}\n                </Link>\n              </Button>\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  // Success - Render Forum Dossier Page\n  return <ForumDossierPage dossier={dossier} />;\n}\n","/**\n * Engagement Detail Route (Feature 028 - User Story 3 - T026)\n *\n * Route: /dossiers/engagements/$id\n * Validates engagement type and renders detail page.\n * Error handling for loading, errors, not found, and wrong types.\n */\n\nimport { createFileRoute, Link } from '@tanstack/react-router';\nimport { useTranslation } from 'react-i18next';\nimport { AlertCircle, ArrowLeft } from 'lucide-react';\nimport { Alert, AlertDescription, AlertTitle } from '@/components/ui/alert';\nimport { Button } from '@/components/ui/button';\nimport { useDossier } from '@/hooks/useDossier';\nimport { isEngagementDossier } from '@/lib/dossier-type-guards';\nimport { EngagementDossierPage } from '@/pages/dossiers/EngagementDossierPage';\n\nexport const Route = createFileRoute('/_protected/dossiers/engagements/$id')({\n  component: EngagementDossierDetailRoute,\n});\n\nfunction EngagementDossierDetailRoute() {\n  const { t, i18n } = useTranslation('dossier');\n  const isRTL = i18n.language === 'ar';\n  const { id } = Route.useParams();\n\n  const { data: dossier, isLoading, error } = useDossier(id, ['stats', 'owners', 'contacts']);\n\n  // Loading state\n  if (isLoading) {\n    return (\n      <div\n        className=\"flex flex-col items-center justify-center min-h-[50vh] space-y-4\"\n        dir={isRTL ? 'rtl' : 'ltr'}\n      >\n        <div className=\"h-12 w-12 animate-spin rounded-full border-4 border-primary border-t-transparent\" />\n        <p className=\"text-sm sm:text-base text-muted-foreground\">\n          {t('detail.loading')}\n        </p>\n      </div>\n    );\n  }\n\n  // Error state\n  if (error) {\n    return (\n      <div\n        className=\"container mx-auto px-4 sm:px-6 lg:px-8 py-6 sm:py-8\"\n        dir={isRTL ? 'rtl' : 'ltr'}\n      >\n        <Alert variant=\"destructive\">\n          <AlertCircle className=\"h-4 w-4\" />\n          <AlertTitle>{t('detail.error')}</AlertTitle>\n          <AlertDescription>\n            {error instanceof Error ? error.message : t('detail.errorGeneric')}\n          </AlertDescription>\n        </Alert>\n        <div className=\"mt-4 sm:mt-6\">\n          <Link to=\"/dossiers\">\n            <Button variant=\"outline\" className=\"gap-2\">\n              <ArrowLeft className={`h-4 w-4 ${isRTL ? 'rotate-180' : ''}`} />\n              {t('action.backToHub')}\n            </Button>\n          </Link>\n        </div>\n      </div>\n    );\n  }\n\n  // Not found state\n  if (!dossier) {\n    return (\n      <div\n        className=\"container mx-auto px-4 sm:px-6 lg:px-8 py-6 sm:py-8\"\n        dir={isRTL ? 'rtl' : 'ltr'}\n      >\n        <Alert>\n          <AlertCircle className=\"h-4 w-4\" />\n          <AlertTitle>{t('detail.notFound')}</AlertTitle>\n          <AlertDescription>\n            {t('detail.errorGeneric')}\n          </AlertDescription>\n        </Alert>\n        <div className=\"mt-4 sm:mt-6\">\n          <Link to=\"/dossiers\">\n            <Button variant=\"outline\" className=\"gap-2\">\n              <ArrowLeft className={`h-4 w-4 ${isRTL ? 'rotate-180' : ''}`} />\n              {t('action.backToHub')}\n            </Button>\n          </Link>\n        </div>\n      </div>\n    );\n  }\n\n  // Wrong type validation\n  if (!isEngagementDossier(dossier)) {\n    const actualType = t(`type.${dossier.type}`);\n    const expectedType = t('type.engagement');\n\n    return (\n      <div\n        className=\"container mx-auto px-4 sm:px-6 lg:px-8 py-6 sm:py-8\"\n        dir={isRTL ? 'rtl' : 'ltr'}\n      >\n        <Alert>\n          <AlertCircle className=\"h-4 w-4\" />\n          <AlertTitle>{t('detail.wrongType')}</AlertTitle>\n          <AlertDescription>\n            {t('detail.wrongTypeDescription', { actualType, expectedType })}\n          </AlertDescription>\n        </Alert>\n        <div className=\"mt-4 sm:mt-6 flex flex-col sm:flex-row gap-3\">\n          <Link to={`/dossiers/${dossier.type}s/$id`} params={{ id: dossier.id }}>\n            <Button className=\"gap-2 w-full sm:w-auto\">\n              {t('action.viewCorrectType', { type: actualType })}\n            </Button>\n          </Link>\n          <Link to=\"/dossiers/engagements\">\n            <Button variant=\"outline\" className=\"gap-2 w-full sm:w-auto\">\n              <ArrowLeft className={`h-4 w-4 ${isRTL ? 'rotate-180' : ''}`} />\n              {t('action.backToList')}\n            </Button>\n          </Link>\n        </div>\n      </div>\n    );\n  }\n\n  return <EngagementDossierPage dossier={dossier} />;\n}\n","/**\n * Country Dossier Detail Route (Feature 028 - User Story 1 - T018)\n *\n * Type-specific detail page for country dossiers.\n * Validates dossier is actually a country type using type guard.\n * Mobile-first, RTL-compatible, WCAG AA compliant.\n *\n * Performance Optimization (T064): Uses React.lazy() for code splitting\n */\n\nimport { createFileRoute } from '@tanstack/react-router';\nimport { lazy, Suspense } from 'react';\nimport { useDossier } from '@/hooks/useDossier';\nimport { isCountryDossier } from '@/lib/dossier-type-guards';\nimport { CountryDossierSkeleton } from '@/components/Dossier/DossierLoadingSkeletons';\nimport { AlertCircle } from 'lucide-react';\nimport { useTranslation } from 'react-i18next';\nimport { Link } from '@tanstack/react-router';\nimport { Button } from '@/components/ui/button';\n\n// Lazy load the CountryDossierPage component (T064)\nconst CountryDossierPage = lazy(() =>\n  import('@/pages/dossiers/CountryDossierPage').then((module) => ({\n    default: module.CountryDossierPage,\n  }))\n);\n\n// Search params for tab navigation\ninterface CountryDossierSearchParams {\n  tab?: string;\n}\n\nexport const Route = createFileRoute('/_protected/dossiers/countries/$id')({\n  component: CountryDossierDetailRoute,\n  validateSearch: (search: Record<string, unknown>): CountryDossierSearchParams => {\n    return {\n      tab: search.tab as string | undefined,\n    };\n  },\n});\n\nfunction CountryDossierDetailRoute() {\n  const { t, i18n } = useTranslation('dossier');\n  const isRTL = i18n.language === 'ar';\n  const { id } = Route.useParams();\n  const searchParams = Route.useSearch();\n\n  // Fetch dossier with country-specific includes\n  const { data: dossier, isLoading, error } = useDossier(id, ['stats', 'owners', 'contacts']);\n\n  // Loading state - use country-specific skeleton\n  if (isLoading) {\n    return <CountryDossierSkeleton />;\n  }\n\n  // Error state\n  if (error) {\n    return (\n      <div\n        className=\"container mx-auto px-4 sm:px-6 lg:px-8 py-8 sm:py-12 lg:py-16\"\n        dir={isRTL ? 'rtl' : 'ltr'}\n      >\n        <div\n          className=\"bg-destructive/10 border border-destructive/20 rounded-lg p-4 sm:p-6\"\n          role=\"alert\"\n        >\n          <div className=\"flex items-start gap-3\">\n            <AlertCircle className=\"h-5 w-5 sm:h-6 sm:w-6 text-destructive flex-shrink-0 mt-0.5\" />\n            <div className=\"flex-1 min-w-0\">\n              <h3 className=\"text-base sm:text-lg font-semibold text-destructive mb-2\">\n                {t('detail.error')}\n              </h3>\n              <p className=\"text-sm sm:text-base text-destructive/90\">\n                {error.message || t('detail.errorGeneric')}\n              </p>\n              <div className=\"mt-4 flex flex-col sm:flex-row gap-2\">\n                <Button variant=\"outline\" asChild>\n                  <Link to=\"/dossiers\">{t('action.backToHub')}</Link>\n                </Button>\n                <Button variant=\"outline\" asChild>\n                  <Link to=\"/dossiers/countries\">{t('action.backToList')}</Link>\n                </Button>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  // Type validation - ensure this is actually a country dossier\n  if (!dossier || !isCountryDossier(dossier)) {\n    return (\n      <div\n        className=\"container mx-auto px-4 sm:px-6 lg:px-8 py-8 sm:py-12 lg:py-16\"\n        dir={isRTL ? 'rtl' : 'ltr'}\n      >\n        <div\n          className=\"bg-destructive/10 border border-destructive/20 rounded-lg p-4 sm:p-6\"\n          role=\"alert\"\n        >\n          <div className=\"flex items-start gap-3\">\n            <AlertCircle className=\"h-5 w-5 sm:h-6 sm:w-6 text-destructive flex-shrink-0 mt-0.5\" />\n            <div className=\"flex-1 min-w-0\">\n              <h3 className=\"text-base sm:text-lg font-semibold text-destructive mb-2\">\n                {t('detail.wrongType')}\n              </h3>\n              <p className=\"text-sm sm:text-base text-destructive/90\">\n                {t('detail.wrongTypeDescription', {\n                  expectedType: t('type.country'),\n                  actualType: dossier ? t(`type.${dossier.dossier_type}`) : 'unknown',\n                })}\n              </p>\n              <div className=\"mt-4 flex flex-col sm:flex-row gap-2\">\n                <Button variant=\"outline\" asChild>\n                  <Link to=\"/dossiers\">{t('action.backToHub')}</Link>\n                </Button>\n                {dossier && (\n                  <Button variant=\"outline\" asChild>\n                    <Link to={`/dossiers/${dossier.dossier_type}s/${dossier.id}`}>\n                      {t('action.viewCorrectType', { type: t(`type.${dossier.dossier_type}`) })}\n                    </Link>\n                  </Button>\n                )}\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  // Render country-specific detail page with Suspense for lazy loading (T064)\n  return (\n    <Suspense fallback={<CountryDossierSkeleton />}>\n      <CountryDossierPage dossier={dossier} initialTab={searchParams.tab} />\n    </Suspense>\n  );\n}\n","import { createFileRoute, Link } from '@tanstack/react-router';\nimport { useAfterActionVersions } from '@/hooks/useAfterAction';\nimport { useTranslation } from 'react-i18next';\nimport { Button } from '@/components/ui/button';\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Skeleton } from '@/components/ui/skeleton';\nimport { VersionHistoryViewer } from '@/components/VersionHistoryViewer';\nimport { ArrowLeft } from 'lucide-react';\n\nexport const Route = createFileRoute('/_protected/after-actions/$afterActionId/versions')({\n component: VersionHistoryPage,\n});\n\nfunction VersionHistoryPage() {\n const { afterActionId } = Route.useParams();\n const { t, i18n } = useTranslation();\n const isRTL = i18n.language === 'ar';\n\n const { data: versions, isLoading, error } = useAfterActionVersions(afterActionId);\n\n if (isLoading) {\n return (\n <div className=\"container mx-auto p-6 space-y-6\">\n <Skeleton className=\"h-8 w-64\" />\n <Skeleton className=\"h-96 w-full\" />\n </div>\n );\n }\n\n if (error) {\n return (\n <div className=\"container mx-auto p-6\">\n <Card className=\"border-destructive\">\n <CardHeader>\n <CardTitle className=\"text-destructive\">{t('common.error')}</CardTitle>\n <CardDescription>{t('afterActions.versions.loadError')}</CardDescription>\n </CardHeader>\n </Card>\n </div>\n );\n }\n\n return (\n <div className={`container mx-auto p-6 space-y-6 ${isRTL ? 'rtl' : 'ltr'}`}>\n {/* Header */}\n <div className=\"flex items-center gap-4\">\n <Button variant=\"ghost\" size=\"icon\" asChild>\n <Link\n to=\"/after-actions/$afterActionId\"\n params={{ afterActionId }}\n >\n <ArrowLeft className={`h-4 w-4 ${isRTL ? 'rotate-180' : ''}`} />\n </Link>\n </Button>\n <div>\n <h1 className=\"text-3xl font-bold\">{t('afterActions.versions.title')}</h1>\n <p className=\"text-muted-foreground\">\n {t('afterActions.versions.description')}\n </p>\n </div>\n </div>\n\n {/* Version History Card */}\n <Card>\n <CardHeader>\n <CardTitle>{t('afterActions.versions.history')}</CardTitle>\n <CardDescription>\n {versions && versions.length > 0\n ? t('afterActions.versions.count', { count: versions.length })\n : t('afterActions.versions.noVersions')\n }\n </CardDescription>\n </CardHeader>\n <CardContent>\n {versions && versions.length > 0 ? (\n <VersionHistoryViewer\n afterActionId={afterActionId}\n versions={versions}\n />\n ) : (\n <p className=\"text-center text-muted-foreground py-8\">\n {t('afterActions.versions.noVersionsDescription')}\n </p>\n )}\n </CardContent>\n </Card>\n </div>\n );\n}\n","/* eslint-disable */\n\n// @ts-nocheck\n\n// noinspection JSUnusedGlobalSymbols\n\n// This file was automatically generated by TanStack Router.\n// You should NOT make any changes in this file as it will be overwritten.\n// Additionally, you should also exclude this file from your linter and/or formatter to prevent it from being checked or modified.\n\nimport { Route as rootRouteImport } from './routes/__root'\nimport { Route as RegisterRouteImport } from './routes/register'\nimport { Route as ModernNavStandaloneRouteImport } from './routes/modern-nav-standalone'\nimport { Route as LoginRouteImport } from './routes/login'\nimport { Route as ProtectedRouteImport } from './routes/_protected'\nimport { Route as IndexRouteImport } from './routes/index'\nimport { Route as ProtectedWorkingGroupsRouteImport } from './routes/_protected/working-groups'\nimport { Route as ProtectedWordAssistantRouteImport } from './routes/_protected/word-assistant'\nimport { Route as ProtectedUsersRouteImport } from './routes/_protected/users'\nimport { Route as ProtectedThemesRouteImport } from './routes/_protected/themes'\nimport { Route as ProtectedSettingsRouteImport } from './routes/_protected/settings'\nimport { Route as ProtectedSearchRouteImport } from './routes/_protected/search'\nimport { Route as ProtectedResponsiveDemoRouteImport } from './routes/_protected/responsive-demo'\nimport { Route as ProtectedReportsRouteImport } from './routes/_protected/reports'\nimport { Route as ProtectedPrototypeDossierRouteImport } from './routes/_protected/prototype-dossier'\nimport { Route as ProtectedPositionsRouteImport } from './routes/_protected/positions'\nimport { Route as ProtectedPersonsRouteImport } from './routes/_protected/persons'\nimport { Route as ProtectedOrganizationsRouteImport } from './routes/_protected/organizations'\nimport { Route as ProtectedMyWorkRouteImport } from './routes/_protected/my-work'\nimport { Route as ProtectedMousRouteImport } from './routes/_protected/mous'\nimport { Route as ProtectedMonitoringRouteImport } from './routes/_protected/monitoring'\nimport { Route as ProtectedModernNavDemoRouteImport } from './routes/_protected/modern-nav-demo'\nimport { Route as ProtectedKanbanRouteImport } from './routes/_protected/kanban'\nimport { Route as ProtectedIntelligenceRouteImport } from './routes/_protected/intelligence'\nimport { Route as ProtectedIntakeRouteImport } from './routes/_protected/intake'\nimport { Route as ProtectedForumsRouteImport } from './routes/_protected/forums'\nimport { Route as ProtectedExportImportRouteImport } from './routes/_protected/export-import'\nimport { Route as ProtectedExportRouteImport } from './routes/_protected/export'\nimport { Route as ProtectedEventsRouteImport } from './routes/_protected/events'\nimport { Route as ProtectedEngagementsRouteImport } from './routes/_protected/engagements'\nimport { Route as ProtectedDelegationsRouteImport } from './routes/_protected/delegations'\nimport { Route as ProtectedDataLibraryRouteImport } from './routes/_protected/data-library'\nimport { Route as ProtectedDashboardRouteImport } from './routes/_protected/dashboard'\nimport { Route as ProtectedCustomDashboardRouteImport } from './routes/_protected/custom-dashboard'\nimport { Route as ProtectedCountriesRouteImport } from './routes/_protected/countries'\nimport { Route as ProtectedContactsRouteImport } from './routes/_protected/contacts'\nimport { Route as ProtectedCommitmentsRouteImport } from './routes/_protected/commitments'\nimport { Route as ProtectedCalendarRouteImport } from './routes/_protected/calendar'\nimport { Route as ProtectedBulkActionsDemoRouteImport } from './routes/_protected/bulk-actions-demo'\nimport { Route as ProtectedBriefsRouteImport } from './routes/_protected/briefs'\nimport { Route as ProtectedAuditLogsRouteImport } from './routes/_protected/audit-logs'\nimport { Route as ProtectedAnalyticsRouteImport } from './routes/_protected/analytics'\nimport { Route as ProtectedAdvancedSearchRouteImport } from './routes/_protected/advanced-search'\nimport { Route as ProtectedAccessibilityRouteImport } from './routes/_protected/accessibility'\nimport { Route as ProtectedTasksIndexRouteImport } from './routes/_protected/tasks/index'\nimport { Route as ProtectedPositionsIndexRouteImport } from './routes/_protected/positions/index'\nimport { Route as ProtectedPersonsIndexRouteImport } from './routes/_protected/persons/index'\nimport { Route as ProtectedMyWorkIndexRouteImport } from './routes/_protected/my-work/index'\nimport { Route as ProtectedIntakeIndexRouteImport } from './routes/_protected/intake/index'\nimport { Route as ProtectedHelpIndexRouteImport } from './routes/_protected/help/index'\nimport { Route as ProtectedEngagementsIndexRouteImport } from './routes/_protected/engagements/index'\nimport { Route as ProtectedDossiersIndexRouteImport } from './routes/_protected/dossiers/index'\nimport { Route as ProtectedApprovalsIndexRouteImport } from './routes/_protected/approvals/index'\nimport { Route as ProtectedAfterActionsIndexRouteImport } from './routes/_protected/after-actions/index'\nimport { Route as ProtectedTasksQueueRouteImport } from './routes/_protected/tasks/queue'\nimport { Route as ProtectedTasksEscalationsRouteImport } from './routes/_protected/tasks/escalations'\nimport { Route as ProtectedTasksIdRouteImport } from './routes/_protected/tasks/$id'\nimport { Route as ProtectedRelationshipsGraphRouteImport } from './routes/_protected/relationships/graph'\nimport { Route as ProtectedPositionsPositionIdRouteImport } from './routes/_protected/positions/$positionId'\nimport { Route as ProtectedPositionsIdRouteImport } from './routes/_protected/positions/$id'\nimport { Route as ProtectedPersonsCreateRouteImport } from './routes/_protected/persons/create'\nimport { Route as ProtectedPersonsPersonIdRouteImport } from './routes/_protected/persons/$personId'\nimport { Route as ProtectedMyWorkWaitingRouteImport } from './routes/_protected/my-work/waiting'\nimport { Route as ProtectedMyWorkIntakeRouteImport } from './routes/_protected/my-work/intake'\nimport { Route as ProtectedMyWorkBoardRouteImport } from './routes/_protected/my-work/board'\nimport { Route as ProtectedMyWorkAssignmentsRouteImport } from './routes/_protected/my-work/assignments'\nimport { Route as ProtectedIntakeQueueRouteImport } from './routes/_protected/intake/queue'\nimport { Route as ProtectedIntakeNewRouteImport } from './routes/_protected/intake/new'\nimport { Route as ProtectedHelpCommitmentsRouteImport } from './routes/_protected/help/commitments'\nimport { Route as ProtectedEngagementsEngagementIdRouteImport } from './routes/_protected/engagements/$engagementId'\nimport { Route as ProtectedDossiersCreateRouteImport } from './routes/_protected/dossiers/create'\nimport { Route as ProtectedDossiersIdRouteImport } from './routes/_protected/dossiers/$id'\nimport { Route as ProtectedContactsNotesSearchRouteImport } from './routes/_protected/contacts/notes-search'\nimport { Route as ProtectedContactsCreateRouteImport } from './routes/_protected/contacts/create'\nimport { Route as ProtectedContactsContactIdRouteImport } from './routes/_protected/contacts/$contactId'\nimport { Route as ProtectedCalendarNewRouteImport } from './routes/_protected/calendar/new'\nimport { Route as ProtectedAfterActionsAfterActionIdRouteImport } from './routes/_protected/after-actions/$afterActionId'\nimport { Route as ProtectedAdminSystemRouteImport } from './routes/_protected/admin/system'\nimport { Route as ProtectedAdminDataRetentionRouteImport } from './routes/_protected/admin/data-retention'\nimport { Route as ProtectedAdminApprovalsRouteImport } from './routes/_protected/admin/approvals'\nimport { Route as ProtectedAdminAiUsageRouteImport } from './routes/_protected/admin/ai-usage'\nimport { Route as ProtectedAdminAiSettingsRouteImport } from './routes/_protected/admin/ai-settings'\nimport { Route as ProtectedDossiersWorking_groupsIndexRouteImport } from './routes/_protected/dossiers/working_groups/index'\nimport { Route as ProtectedDossiersTopicsIndexRouteImport } from './routes/_protected/dossiers/topics/index'\nimport { Route as ProtectedDossiersPersonsIndexRouteImport } from './routes/_protected/dossiers/persons/index'\nimport { Route as ProtectedDossiersOrganizationsIndexRouteImport } from './routes/_protected/dossiers/organizations/index'\nimport { Route as ProtectedDossiersForumsIndexRouteImport } from './routes/_protected/dossiers/forums/index'\nimport { Route as ProtectedDossiersEngagementsIndexRouteImport } from './routes/_protected/dossiers/engagements/index'\nimport { Route as ProtectedDossiersCountriesIndexRouteImport } from './routes/_protected/dossiers/countries/index'\nimport { Route as ProtectedPositionsIdVersionsRouteImport } from './routes/_protected/positions/$id/versions'\nimport { Route as ProtectedPositionsIdApprovalsRouteImport } from './routes/_protected/positions/$id/approvals'\nimport { Route as ProtectedIntakeTicketsIdRouteImport } from './routes/_protected/intake/tickets.$id'\nimport { Route as ProtectedEngagementsEngagementIdAfterActionRouteImport } from './routes/_protected/engagements/$engagementId/after-action'\nimport { Route as ProtectedDossiersWorking_groupsIdRouteImport } from './routes/_protected/dossiers/working_groups/$id'\nimport { Route as ProtectedDossiersTopicsIdRouteImport } from './routes/_protected/dossiers/topics/$id'\nimport { Route as ProtectedDossiersPersonsIdRouteImport } from './routes/_protected/dossiers/persons/$id'\nimport { Route as ProtectedDossiersOrganizationsIdRouteImport } from './routes/_protected/dossiers/organizations/$id'\nimport { Route as ProtectedDossiersForumsIdRouteImport } from './routes/_protected/dossiers/forums/$id'\nimport { Route as ProtectedDossiersEngagementsIdRouteImport } from './routes/_protected/dossiers/engagements/$id'\nimport { Route as ProtectedDossiersCountriesIdRouteImport } from './routes/_protected/dossiers/countries/$id'\nimport { Route as ProtectedAfterActionsAfterActionIdVersionsRouteImport } from './routes/_protected/after-actions/$afterActionId/versions'\n\nconst RegisterRoute = RegisterRouteImport.update({\n  id: '/register',\n  path: '/register',\n  getParentRoute: () => rootRouteImport,\n} as any)\nconst ModernNavStandaloneRoute = ModernNavStandaloneRouteImport.update({\n  id: '/modern-nav-standalone',\n  path: '/modern-nav-standalone',\n  getParentRoute: () => rootRouteImport,\n} as any)\nconst LoginRoute = LoginRouteImport.update({\n  id: '/login',\n  path: '/login',\n  getParentRoute: () => rootRouteImport,\n} as any)\nconst ProtectedRoute = ProtectedRouteImport.update({\n  id: '/_protected',\n  getParentRoute: () => rootRouteImport,\n} as any)\nconst IndexRoute = IndexRouteImport.update({\n  id: '/',\n  path: '/',\n  getParentRoute: () => rootRouteImport,\n} as any)\nconst ProtectedWorkingGroupsRoute = ProtectedWorkingGroupsRouteImport.update({\n  id: '/working-groups',\n  path: '/working-groups',\n  getParentRoute: () => ProtectedRoute,\n} as any)\nconst ProtectedWordAssistantRoute = ProtectedWordAssistantRouteImport.update({\n  id: '/word-assistant',\n  path: '/word-assistant',\n  getParentRoute: () => ProtectedRoute,\n} as any)\nconst ProtectedUsersRoute = ProtectedUsersRouteImport.update({\n  id: '/users',\n  path: '/users',\n  getParentRoute: () => ProtectedRoute,\n} as any)\nconst ProtectedThemesRoute = ProtectedThemesRouteImport.update({\n  id: '/themes',\n  path: '/themes',\n  getParentRoute: () => ProtectedRoute,\n} as any)\nconst ProtectedSettingsRoute = ProtectedSettingsRouteImport.update({\n  id: '/settings',\n  path: '/settings',\n  getParentRoute: () => ProtectedRoute,\n} as any)\nconst ProtectedSearchRoute = ProtectedSearchRouteImport.update({\n  id: '/search',\n  path: '/search',\n  getParentRoute: () => ProtectedRoute,\n} as any)\nconst ProtectedResponsiveDemoRoute = ProtectedResponsiveDemoRouteImport.update({\n  id: '/responsive-demo',\n  path: '/responsive-demo',\n  getParentRoute: () => ProtectedRoute,\n} as any)\nconst ProtectedReportsRoute = ProtectedReportsRouteImport.update({\n  id: '/reports',\n  path: '/reports',\n  getParentRoute: () => ProtectedRoute,\n} as any)\nconst ProtectedPrototypeDossierRoute =\n  ProtectedPrototypeDossierRouteImport.update({\n    id: '/prototype-dossier',\n    path: '/prototype-dossier',\n    getParentRoute: () => ProtectedRoute,\n  } as any)\nconst ProtectedPositionsRoute = ProtectedPositionsRouteImport.update({\n  id: '/positions',\n  path: '/positions',\n  getParentRoute: () => ProtectedRoute,\n} as any)\nconst ProtectedPersonsRoute = ProtectedPersonsRouteImport.update({\n  id: '/persons',\n  path: '/persons',\n  getParentRoute: () => ProtectedRoute,\n} as any)\nconst ProtectedOrganizationsRoute = ProtectedOrganizationsRouteImport.update({\n  id: '/organizations',\n  path: '/organizations',\n  getParentRoute: () => ProtectedRoute,\n} as any)\nconst ProtectedMyWorkRoute = ProtectedMyWorkRouteImport.update({\n  id: '/my-work',\n  path: '/my-work',\n  getParentRoute: () => ProtectedRoute,\n} as any)\nconst ProtectedMousRoute = ProtectedMousRouteImport.update({\n  id: '/mous',\n  path: '/mous',\n  getParentRoute: () => ProtectedRoute,\n} as any)\nconst ProtectedMonitoringRoute = ProtectedMonitoringRouteImport.update({\n  id: '/monitoring',\n  path: '/monitoring',\n  getParentRoute: () => ProtectedRoute,\n} as any)\nconst ProtectedModernNavDemoRoute = ProtectedModernNavDemoRouteImport.update({\n  id: '/modern-nav-demo',\n  path: '/modern-nav-demo',\n  getParentRoute: () => ProtectedRoute,\n} as any)\nconst ProtectedKanbanRoute = ProtectedKanbanRouteImport.update({\n  id: '/kanban',\n  path: '/kanban',\n  getParentRoute: () => ProtectedRoute,\n} as any)\nconst ProtectedIntelligenceRoute = ProtectedIntelligenceRouteImport.update({\n  id: '/intelligence',\n  path: '/intelligence',\n  getParentRoute: () => ProtectedRoute,\n} as any)\nconst ProtectedIntakeRoute = ProtectedIntakeRouteImport.update({\n  id: '/intake',\n  path: '/intake',\n  getParentRoute: () => ProtectedRoute,\n} as any)\nconst ProtectedForumsRoute = ProtectedForumsRouteImport.update({\n  id: '/forums',\n  path: '/forums',\n  getParentRoute: () => ProtectedRoute,\n} as any)\nconst ProtectedExportImportRoute = ProtectedExportImportRouteImport.update({\n  id: '/export-import',\n  path: '/export-import',\n  getParentRoute: () => ProtectedRoute,\n} as any)\nconst ProtectedExportRoute = ProtectedExportRouteImport.update({\n  id: '/export',\n  path: '/export',\n  getParentRoute: () => ProtectedRoute,\n} as any)\nconst ProtectedEventsRoute = ProtectedEventsRouteImport.update({\n  id: '/events',\n  path: '/events',\n  getParentRoute: () => ProtectedRoute,\n} as any)\nconst ProtectedEngagementsRoute = ProtectedEngagementsRouteImport.update({\n  id: '/engagements',\n  path: '/engagements',\n  getParentRoute: () => ProtectedRoute,\n} as any)\nconst ProtectedDelegationsRoute = ProtectedDelegationsRouteImport.update({\n  id: '/delegations',\n  path: '/delegations',\n  getParentRoute: () => ProtectedRoute,\n} as any)\nconst ProtectedDataLibraryRoute = ProtectedDataLibraryRouteImport.update({\n  id: '/data-library',\n  path: '/data-library',\n  getParentRoute: () => ProtectedRoute,\n} as any)\nconst ProtectedDashboardRoute = ProtectedDashboardRouteImport.update({\n  id: '/dashboard',\n  path: '/dashboard',\n  getParentRoute: () => ProtectedRoute,\n} as any)\nconst ProtectedCustomDashboardRoute =\n  ProtectedCustomDashboardRouteImport.update({\n    id: '/custom-dashboard',\n    path: '/custom-dashboard',\n    getParentRoute: () => ProtectedRoute,\n  } as any)\nconst ProtectedCountriesRoute = ProtectedCountriesRouteImport.update({\n  id: '/countries',\n  path: '/countries',\n  getParentRoute: () => ProtectedRoute,\n} as any)\nconst ProtectedContactsRoute = ProtectedContactsRouteImport.update({\n  id: '/contacts',\n  path: '/contacts',\n  getParentRoute: () => ProtectedRoute,\n} as any)\nconst ProtectedCommitmentsRoute = ProtectedCommitmentsRouteImport.update({\n  id: '/commitments',\n  path: '/commitments',\n  getParentRoute: () => ProtectedRoute,\n} as any)\nconst ProtectedCalendarRoute = ProtectedCalendarRouteImport.update({\n  id: '/calendar',\n  path: '/calendar',\n  getParentRoute: () => ProtectedRoute,\n} as any)\nconst ProtectedBulkActionsDemoRoute =\n  ProtectedBulkActionsDemoRouteImport.update({\n    id: '/bulk-actions-demo',\n    path: '/bulk-actions-demo',\n    getParentRoute: () => ProtectedRoute,\n  } as any)\nconst ProtectedBriefsRoute = ProtectedBriefsRouteImport.update({\n  id: '/briefs',\n  path: '/briefs',\n  getParentRoute: () => ProtectedRoute,\n} as any)\nconst ProtectedAuditLogsRoute = ProtectedAuditLogsRouteImport.update({\n  id: '/audit-logs',\n  path: '/audit-logs',\n  getParentRoute: () => ProtectedRoute,\n} as any)\nconst ProtectedAnalyticsRoute = ProtectedAnalyticsRouteImport.update({\n  id: '/analytics',\n  path: '/analytics',\n  getParentRoute: () => ProtectedRoute,\n} as any)\nconst ProtectedAdvancedSearchRoute = ProtectedAdvancedSearchRouteImport.update({\n  id: '/advanced-search',\n  path: '/advanced-search',\n  getParentRoute: () => ProtectedRoute,\n} as any)\nconst ProtectedAccessibilityRoute = ProtectedAccessibilityRouteImport.update({\n  id: '/accessibility',\n  path: '/accessibility',\n  getParentRoute: () => ProtectedRoute,\n} as any)\nconst ProtectedTasksIndexRoute = ProtectedTasksIndexRouteImport.update({\n  id: '/tasks/',\n  path: '/tasks/',\n  getParentRoute: () => ProtectedRoute,\n} as any)\nconst ProtectedPositionsIndexRoute = ProtectedPositionsIndexRouteImport.update({\n  id: '/',\n  path: '/',\n  getParentRoute: () => ProtectedPositionsRoute,\n} as any)\nconst ProtectedPersonsIndexRoute = ProtectedPersonsIndexRouteImport.update({\n  id: '/',\n  path: '/',\n  getParentRoute: () => ProtectedPersonsRoute,\n} as any)\nconst ProtectedMyWorkIndexRoute = ProtectedMyWorkIndexRouteImport.update({\n  id: '/',\n  path: '/',\n  getParentRoute: () => ProtectedMyWorkRoute,\n} as any)\nconst ProtectedIntakeIndexRoute = ProtectedIntakeIndexRouteImport.update({\n  id: '/',\n  path: '/',\n  getParentRoute: () => ProtectedIntakeRoute,\n} as any)\nconst ProtectedHelpIndexRoute = ProtectedHelpIndexRouteImport.update({\n  id: '/help/',\n  path: '/help/',\n  getParentRoute: () => ProtectedRoute,\n} as any)\nconst ProtectedEngagementsIndexRoute =\n  ProtectedEngagementsIndexRouteImport.update({\n    id: '/',\n    path: '/',\n    getParentRoute: () => ProtectedEngagementsRoute,\n  } as any)\nconst ProtectedDossiersIndexRoute = ProtectedDossiersIndexRouteImport.update({\n  id: '/dossiers/',\n  path: '/dossiers/',\n  getParentRoute: () => ProtectedRoute,\n} as any)\nconst ProtectedApprovalsIndexRoute = ProtectedApprovalsIndexRouteImport.update({\n  id: '/approvals/',\n  path: '/approvals/',\n  getParentRoute: () => ProtectedRoute,\n} as any)\nconst ProtectedAfterActionsIndexRoute =\n  ProtectedAfterActionsIndexRouteImport.update({\n    id: '/after-actions/',\n    path: '/after-actions/',\n    getParentRoute: () => ProtectedRoute,\n  } as any)\nconst ProtectedTasksQueueRoute = ProtectedTasksQueueRouteImport.update({\n  id: '/tasks/queue',\n  path: '/tasks/queue',\n  getParentRoute: () => ProtectedRoute,\n} as any)\nconst ProtectedTasksEscalationsRoute =\n  ProtectedTasksEscalationsRouteImport.update({\n    id: '/tasks/escalations',\n    path: '/tasks/escalations',\n    getParentRoute: () => ProtectedRoute,\n  } as any)\nconst ProtectedTasksIdRoute = ProtectedTasksIdRouteImport.update({\n  id: '/tasks/$id',\n  path: '/tasks/$id',\n  getParentRoute: () => ProtectedRoute,\n} as any)\nconst ProtectedRelationshipsGraphRoute =\n  ProtectedRelationshipsGraphRouteImport.update({\n    id: '/relationships/graph',\n    path: '/relationships/graph',\n    getParentRoute: () => ProtectedRoute,\n  } as any)\nconst ProtectedPositionsPositionIdRoute =\n  ProtectedPositionsPositionIdRouteImport.update({\n    id: '/$positionId',\n    path: '/$positionId',\n    getParentRoute: () => ProtectedPositionsRoute,\n  } as any)\nconst ProtectedPositionsIdRoute = ProtectedPositionsIdRouteImport.update({\n  id: '/$id',\n  path: '/$id',\n  getParentRoute: () => ProtectedPositionsRoute,\n} as any)\nconst ProtectedPersonsCreateRoute = ProtectedPersonsCreateRouteImport.update({\n  id: '/create',\n  path: '/create',\n  getParentRoute: () => ProtectedPersonsRoute,\n} as any)\nconst ProtectedPersonsPersonIdRoute =\n  ProtectedPersonsPersonIdRouteImport.update({\n    id: '/$personId',\n    path: '/$personId',\n    getParentRoute: () => ProtectedPersonsRoute,\n  } as any)\nconst ProtectedMyWorkWaitingRoute = ProtectedMyWorkWaitingRouteImport.update({\n  id: '/waiting',\n  path: '/waiting',\n  getParentRoute: () => ProtectedMyWorkRoute,\n} as any)\nconst ProtectedMyWorkIntakeRoute = ProtectedMyWorkIntakeRouteImport.update({\n  id: '/intake',\n  path: '/intake',\n  getParentRoute: () => ProtectedMyWorkRoute,\n} as any)\nconst ProtectedMyWorkBoardRoute = ProtectedMyWorkBoardRouteImport.update({\n  id: '/board',\n  path: '/board',\n  getParentRoute: () => ProtectedMyWorkRoute,\n} as any)\nconst ProtectedMyWorkAssignmentsRoute =\n  ProtectedMyWorkAssignmentsRouteImport.update({\n    id: '/assignments',\n    path: '/assignments',\n    getParentRoute: () => ProtectedMyWorkRoute,\n  } as any)\nconst ProtectedIntakeQueueRoute = ProtectedIntakeQueueRouteImport.update({\n  id: '/queue',\n  path: '/queue',\n  getParentRoute: () => ProtectedIntakeRoute,\n} as any)\nconst ProtectedIntakeNewRoute = ProtectedIntakeNewRouteImport.update({\n  id: '/new',\n  path: '/new',\n  getParentRoute: () => ProtectedIntakeRoute,\n} as any)\nconst ProtectedHelpCommitmentsRoute =\n  ProtectedHelpCommitmentsRouteImport.update({\n    id: '/help/commitments',\n    path: '/help/commitments',\n    getParentRoute: () => ProtectedRoute,\n  } as any)\nconst ProtectedEngagementsEngagementIdRoute =\n  ProtectedEngagementsEngagementIdRouteImport.update({\n    id: '/$engagementId',\n    path: '/$engagementId',\n    getParentRoute: () => ProtectedEngagementsRoute,\n  } as any)\nconst ProtectedDossiersCreateRoute = ProtectedDossiersCreateRouteImport.update({\n  id: '/dossiers/create',\n  path: '/dossiers/create',\n  getParentRoute: () => ProtectedRoute,\n} as any)\nconst ProtectedDossiersIdRoute = ProtectedDossiersIdRouteImport.update({\n  id: '/dossiers/$id',\n  path: '/dossiers/$id',\n  getParentRoute: () => ProtectedRoute,\n} as any)\nconst ProtectedContactsNotesSearchRoute =\n  ProtectedContactsNotesSearchRouteImport.update({\n    id: '/notes-search',\n    path: '/notes-search',\n    getParentRoute: () => ProtectedContactsRoute,\n  } as any)\nconst ProtectedContactsCreateRoute = ProtectedContactsCreateRouteImport.update({\n  id: '/create',\n  path: '/create',\n  getParentRoute: () => ProtectedContactsRoute,\n} as any)\nconst ProtectedContactsContactIdRoute =\n  ProtectedContactsContactIdRouteImport.update({\n    id: '/$contactId',\n    path: '/$contactId',\n    getParentRoute: () => ProtectedContactsRoute,\n  } as any)\nconst ProtectedCalendarNewRoute = ProtectedCalendarNewRouteImport.update({\n  id: '/new',\n  path: '/new',\n  getParentRoute: () => ProtectedCalendarRoute,\n} as any)\nconst ProtectedAfterActionsAfterActionIdRoute =\n  ProtectedAfterActionsAfterActionIdRouteImport.update({\n    id: '/after-actions/$afterActionId',\n    path: '/after-actions/$afterActionId',\n    getParentRoute: () => ProtectedRoute,\n  } as any)\nconst ProtectedAdminSystemRoute = ProtectedAdminSystemRouteImport.update({\n  id: '/admin/system',\n  path: '/admin/system',\n  getParentRoute: () => ProtectedRoute,\n} as any)\nconst ProtectedAdminDataRetentionRoute =\n  ProtectedAdminDataRetentionRouteImport.update({\n    id: '/admin/data-retention',\n    path: '/admin/data-retention',\n    getParentRoute: () => ProtectedRoute,\n  } as any)\nconst ProtectedAdminApprovalsRoute = ProtectedAdminApprovalsRouteImport.update({\n  id: '/admin/approvals',\n  path: '/admin/approvals',\n  getParentRoute: () => ProtectedRoute,\n} as any)\nconst ProtectedAdminAiUsageRoute = ProtectedAdminAiUsageRouteImport.update({\n  id: '/admin/ai-usage',\n  path: '/admin/ai-usage',\n  getParentRoute: () => ProtectedRoute,\n} as any)\nconst ProtectedAdminAiSettingsRoute =\n  ProtectedAdminAiSettingsRouteImport.update({\n    id: '/admin/ai-settings',\n    path: '/admin/ai-settings',\n    getParentRoute: () => ProtectedRoute,\n  } as any)\nconst ProtectedDossiersWorking_groupsIndexRoute =\n  ProtectedDossiersWorking_groupsIndexRouteImport.update({\n    id: '/dossiers/working_groups/',\n    path: '/dossiers/working_groups/',\n    getParentRoute: () => ProtectedRoute,\n  } as any)\nconst ProtectedDossiersTopicsIndexRoute =\n  ProtectedDossiersTopicsIndexRouteImport.update({\n    id: '/dossiers/topics/',\n    path: '/dossiers/topics/',\n    getParentRoute: () => ProtectedRoute,\n  } as any)\nconst ProtectedDossiersPersonsIndexRoute =\n  ProtectedDossiersPersonsIndexRouteImport.update({\n    id: '/dossiers/persons/',\n    path: '/dossiers/persons/',\n    getParentRoute: () => ProtectedRoute,\n  } as any)\nconst ProtectedDossiersOrganizationsIndexRoute =\n  ProtectedDossiersOrganizationsIndexRouteImport.update({\n    id: '/dossiers/organizations/',\n    path: '/dossiers/organizations/',\n    getParentRoute: () => ProtectedRoute,\n  } as any)\nconst ProtectedDossiersForumsIndexRoute =\n  ProtectedDossiersForumsIndexRouteImport.update({\n    id: '/dossiers/forums/',\n    path: '/dossiers/forums/',\n    getParentRoute: () => ProtectedRoute,\n  } as any)\nconst ProtectedDossiersEngagementsIndexRoute =\n  ProtectedDossiersEngagementsIndexRouteImport.update({\n    id: '/dossiers/engagements/',\n    path: '/dossiers/engagements/',\n    getParentRoute: () => ProtectedRoute,\n  } as any)\nconst ProtectedDossiersCountriesIndexRoute =\n  ProtectedDossiersCountriesIndexRouteImport.update({\n    id: '/dossiers/countries/',\n    path: '/dossiers/countries/',\n    getParentRoute: () => ProtectedRoute,\n  } as any)\nconst ProtectedPositionsIdVersionsRoute =\n  ProtectedPositionsIdVersionsRouteImport.update({\n    id: '/versions',\n    path: '/versions',\n    getParentRoute: () => ProtectedPositionsIdRoute,\n  } as any)\nconst ProtectedPositionsIdApprovalsRoute =\n  ProtectedPositionsIdApprovalsRouteImport.update({\n    id: '/approvals',\n    path: '/approvals',\n    getParentRoute: () => ProtectedPositionsIdRoute,\n  } as any)\nconst ProtectedIntakeTicketsIdRoute =\n  ProtectedIntakeTicketsIdRouteImport.update({\n    id: '/tickets/$id',\n    path: '/tickets/$id',\n    getParentRoute: () => ProtectedIntakeRoute,\n  } as any)\nconst ProtectedEngagementsEngagementIdAfterActionRoute =\n  ProtectedEngagementsEngagementIdAfterActionRouteImport.update({\n    id: '/after-action',\n    path: '/after-action',\n    getParentRoute: () => ProtectedEngagementsEngagementIdRoute,\n  } as any)\nconst ProtectedDossiersWorking_groupsIdRoute =\n  ProtectedDossiersWorking_groupsIdRouteImport.update({\n    id: '/dossiers/working_groups/$id',\n    path: '/dossiers/working_groups/$id',\n    getParentRoute: () => ProtectedRoute,\n  } as any)\nconst ProtectedDossiersTopicsIdRoute =\n  ProtectedDossiersTopicsIdRouteImport.update({\n    id: '/dossiers/topics/$id',\n    path: '/dossiers/topics/$id',\n    getParentRoute: () => ProtectedRoute,\n  } as any)\nconst ProtectedDossiersPersonsIdRoute =\n  ProtectedDossiersPersonsIdRouteImport.update({\n    id: '/dossiers/persons/$id',\n    path: '/dossiers/persons/$id',\n    getParentRoute: () => ProtectedRoute,\n  } as any)\nconst ProtectedDossiersOrganizationsIdRoute =\n  ProtectedDossiersOrganizationsIdRouteImport.update({\n    id: '/dossiers/organizations/$id',\n    path: '/dossiers/organizations/$id',\n    getParentRoute: () => ProtectedRoute,\n  } as any)\nconst ProtectedDossiersForumsIdRoute =\n  ProtectedDossiersForumsIdRouteImport.update({\n    id: '/dossiers/forums/$id',\n    path: '/dossiers/forums/$id',\n    getParentRoute: () => ProtectedRoute,\n  } as any)\nconst ProtectedDossiersEngagementsIdRoute =\n  ProtectedDossiersEngagementsIdRouteImport.update({\n    id: '/dossiers/engagements/$id',\n    path: '/dossiers/engagements/$id',\n    getParentRoute: () => ProtectedRoute,\n  } as any)\nconst ProtectedDossiersCountriesIdRoute =\n  ProtectedDossiersCountriesIdRouteImport.update({\n    id: '/dossiers/countries/$id',\n    path: '/dossiers/countries/$id',\n    getParentRoute: () => ProtectedRoute,\n  } as any)\nconst ProtectedAfterActionsAfterActionIdVersionsRoute =\n  ProtectedAfterActionsAfterActionIdVersionsRouteImport.update({\n    id: '/versions',\n    path: '/versions',\n    getParentRoute: () => ProtectedAfterActionsAfterActionIdRoute,\n  } as any)\n\nexport interface FileRoutesByFullPath {\n  '/': typeof IndexRoute\n  '/login': typeof LoginRoute\n  '/modern-nav-standalone': typeof ModernNavStandaloneRoute\n  '/register': typeof RegisterRoute\n  '/accessibility': typeof ProtectedAccessibilityRoute\n  '/advanced-search': typeof ProtectedAdvancedSearchRoute\n  '/analytics': typeof ProtectedAnalyticsRoute\n  '/audit-logs': typeof ProtectedAuditLogsRoute\n  '/briefs': typeof ProtectedBriefsRoute\n  '/bulk-actions-demo': typeof ProtectedBulkActionsDemoRoute\n  '/calendar': typeof ProtectedCalendarRouteWithChildren\n  '/commitments': typeof ProtectedCommitmentsRoute\n  '/contacts': typeof ProtectedContactsRouteWithChildren\n  '/countries': typeof ProtectedCountriesRoute\n  '/custom-dashboard': typeof ProtectedCustomDashboardRoute\n  '/dashboard': typeof ProtectedDashboardRoute\n  '/data-library': typeof ProtectedDataLibraryRoute\n  '/delegations': typeof ProtectedDelegationsRoute\n  '/engagements': typeof ProtectedEngagementsRouteWithChildren\n  '/events': typeof ProtectedEventsRoute\n  '/export': typeof ProtectedExportRoute\n  '/export-import': typeof ProtectedExportImportRoute\n  '/forums': typeof ProtectedForumsRoute\n  '/intake': typeof ProtectedIntakeRouteWithChildren\n  '/intelligence': typeof ProtectedIntelligenceRoute\n  '/kanban': typeof ProtectedKanbanRoute\n  '/modern-nav-demo': typeof ProtectedModernNavDemoRoute\n  '/monitoring': typeof ProtectedMonitoringRoute\n  '/mous': typeof ProtectedMousRoute\n  '/my-work': typeof ProtectedMyWorkRouteWithChildren\n  '/organizations': typeof ProtectedOrganizationsRoute\n  '/persons': typeof ProtectedPersonsRouteWithChildren\n  '/positions': typeof ProtectedPositionsRouteWithChildren\n  '/prototype-dossier': typeof ProtectedPrototypeDossierRoute\n  '/reports': typeof ProtectedReportsRoute\n  '/responsive-demo': typeof ProtectedResponsiveDemoRoute\n  '/search': typeof ProtectedSearchRoute\n  '/settings': typeof ProtectedSettingsRoute\n  '/themes': typeof ProtectedThemesRoute\n  '/users': typeof ProtectedUsersRoute\n  '/word-assistant': typeof ProtectedWordAssistantRoute\n  '/working-groups': typeof ProtectedWorkingGroupsRoute\n  '/admin/ai-settings': typeof ProtectedAdminAiSettingsRoute\n  '/admin/ai-usage': typeof ProtectedAdminAiUsageRoute\n  '/admin/approvals': typeof ProtectedAdminApprovalsRoute\n  '/admin/data-retention': typeof ProtectedAdminDataRetentionRoute\n  '/admin/system': typeof ProtectedAdminSystemRoute\n  '/after-actions/$afterActionId': typeof ProtectedAfterActionsAfterActionIdRouteWithChildren\n  '/calendar/new': typeof ProtectedCalendarNewRoute\n  '/contacts/$contactId': typeof ProtectedContactsContactIdRoute\n  '/contacts/create': typeof ProtectedContactsCreateRoute\n  '/contacts/notes-search': typeof ProtectedContactsNotesSearchRoute\n  '/dossiers/$id': typeof ProtectedDossiersIdRoute\n  '/dossiers/create': typeof ProtectedDossiersCreateRoute\n  '/engagements/$engagementId': typeof ProtectedEngagementsEngagementIdRouteWithChildren\n  '/help/commitments': typeof ProtectedHelpCommitmentsRoute\n  '/intake/new': typeof ProtectedIntakeNewRoute\n  '/intake/queue': typeof ProtectedIntakeQueueRoute\n  '/my-work/assignments': typeof ProtectedMyWorkAssignmentsRoute\n  '/my-work/board': typeof ProtectedMyWorkBoardRoute\n  '/my-work/intake': typeof ProtectedMyWorkIntakeRoute\n  '/my-work/waiting': typeof ProtectedMyWorkWaitingRoute\n  '/persons/$personId': typeof ProtectedPersonsPersonIdRoute\n  '/persons/create': typeof ProtectedPersonsCreateRoute\n  '/positions/$id': typeof ProtectedPositionsIdRouteWithChildren\n  '/positions/$positionId': typeof ProtectedPositionsPositionIdRoute\n  '/relationships/graph': typeof ProtectedRelationshipsGraphRoute\n  '/tasks/$id': typeof ProtectedTasksIdRoute\n  '/tasks/escalations': typeof ProtectedTasksEscalationsRoute\n  '/tasks/queue': typeof ProtectedTasksQueueRoute\n  '/after-actions': typeof ProtectedAfterActionsIndexRoute\n  '/approvals': typeof ProtectedApprovalsIndexRoute\n  '/dossiers': typeof ProtectedDossiersIndexRoute\n  '/engagements/': typeof ProtectedEngagementsIndexRoute\n  '/help': typeof ProtectedHelpIndexRoute\n  '/intake/': typeof ProtectedIntakeIndexRoute\n  '/my-work/': typeof ProtectedMyWorkIndexRoute\n  '/persons/': typeof ProtectedPersonsIndexRoute\n  '/positions/': typeof ProtectedPositionsIndexRoute\n  '/tasks': typeof ProtectedTasksIndexRoute\n  '/after-actions/$afterActionId/versions': typeof ProtectedAfterActionsAfterActionIdVersionsRoute\n  '/dossiers/countries/$id': typeof ProtectedDossiersCountriesIdRoute\n  '/dossiers/engagements/$id': typeof ProtectedDossiersEngagementsIdRoute\n  '/dossiers/forums/$id': typeof ProtectedDossiersForumsIdRoute\n  '/dossiers/organizations/$id': typeof ProtectedDossiersOrganizationsIdRoute\n  '/dossiers/persons/$id': typeof ProtectedDossiersPersonsIdRoute\n  '/dossiers/topics/$id': typeof ProtectedDossiersTopicsIdRoute\n  '/dossiers/working_groups/$id': typeof ProtectedDossiersWorking_groupsIdRoute\n  '/engagements/$engagementId/after-action': typeof ProtectedEngagementsEngagementIdAfterActionRoute\n  '/intake/tickets/$id': typeof ProtectedIntakeTicketsIdRoute\n  '/positions/$id/approvals': typeof ProtectedPositionsIdApprovalsRoute\n  '/positions/$id/versions': typeof ProtectedPositionsIdVersionsRoute\n  '/dossiers/countries': typeof ProtectedDossiersCountriesIndexRoute\n  '/dossiers/engagements': typeof ProtectedDossiersEngagementsIndexRoute\n  '/dossiers/forums': typeof ProtectedDossiersForumsIndexRoute\n  '/dossiers/organizations': typeof ProtectedDossiersOrganizationsIndexRoute\n  '/dossiers/persons': typeof ProtectedDossiersPersonsIndexRoute\n  '/dossiers/topics': typeof ProtectedDossiersTopicsIndexRoute\n  '/dossiers/working_groups': typeof ProtectedDossiersWorking_groupsIndexRoute\n}\nexport interface FileRoutesByTo {\n  '/': typeof IndexRoute\n  '/login': typeof LoginRoute\n  '/modern-nav-standalone': typeof ModernNavStandaloneRoute\n  '/register': typeof RegisterRoute\n  '/accessibility': typeof ProtectedAccessibilityRoute\n  '/advanced-search': typeof ProtectedAdvancedSearchRoute\n  '/analytics': typeof ProtectedAnalyticsRoute\n  '/audit-logs': typeof ProtectedAuditLogsRoute\n  '/briefs': typeof ProtectedBriefsRoute\n  '/bulk-actions-demo': typeof ProtectedBulkActionsDemoRoute\n  '/calendar': typeof ProtectedCalendarRouteWithChildren\n  '/commitments': typeof ProtectedCommitmentsRoute\n  '/contacts': typeof ProtectedContactsRouteWithChildren\n  '/countries': typeof ProtectedCountriesRoute\n  '/custom-dashboard': typeof ProtectedCustomDashboardRoute\n  '/dashboard': typeof ProtectedDashboardRoute\n  '/data-library': typeof ProtectedDataLibraryRoute\n  '/delegations': typeof ProtectedDelegationsRoute\n  '/events': typeof ProtectedEventsRoute\n  '/export': typeof ProtectedExportRoute\n  '/export-import': typeof ProtectedExportImportRoute\n  '/forums': typeof ProtectedForumsRoute\n  '/intelligence': typeof ProtectedIntelligenceRoute\n  '/kanban': typeof ProtectedKanbanRoute\n  '/modern-nav-demo': typeof ProtectedModernNavDemoRoute\n  '/monitoring': typeof ProtectedMonitoringRoute\n  '/mous': typeof ProtectedMousRoute\n  '/organizations': typeof ProtectedOrganizationsRoute\n  '/prototype-dossier': typeof ProtectedPrototypeDossierRoute\n  '/reports': typeof ProtectedReportsRoute\n  '/responsive-demo': typeof ProtectedResponsiveDemoRoute\n  '/search': typeof ProtectedSearchRoute\n  '/settings': typeof ProtectedSettingsRoute\n  '/themes': typeof ProtectedThemesRoute\n  '/users': typeof ProtectedUsersRoute\n  '/word-assistant': typeof ProtectedWordAssistantRoute\n  '/working-groups': typeof ProtectedWorkingGroupsRoute\n  '/admin/ai-settings': typeof ProtectedAdminAiSettingsRoute\n  '/admin/ai-usage': typeof ProtectedAdminAiUsageRoute\n  '/admin/approvals': typeof ProtectedAdminApprovalsRoute\n  '/admin/data-retention': typeof ProtectedAdminDataRetentionRoute\n  '/admin/system': typeof ProtectedAdminSystemRoute\n  '/after-actions/$afterActionId': typeof ProtectedAfterActionsAfterActionIdRouteWithChildren\n  '/calendar/new': typeof ProtectedCalendarNewRoute\n  '/contacts/$contactId': typeof ProtectedContactsContactIdRoute\n  '/contacts/create': typeof ProtectedContactsCreateRoute\n  '/contacts/notes-search': typeof ProtectedContactsNotesSearchRoute\n  '/dossiers/$id': typeof ProtectedDossiersIdRoute\n  '/dossiers/create': typeof ProtectedDossiersCreateRoute\n  '/engagements/$engagementId': typeof ProtectedEngagementsEngagementIdRouteWithChildren\n  '/help/commitments': typeof ProtectedHelpCommitmentsRoute\n  '/intake/new': typeof ProtectedIntakeNewRoute\n  '/intake/queue': typeof ProtectedIntakeQueueRoute\n  '/my-work/assignments': typeof ProtectedMyWorkAssignmentsRoute\n  '/my-work/board': typeof ProtectedMyWorkBoardRoute\n  '/my-work/intake': typeof ProtectedMyWorkIntakeRoute\n  '/my-work/waiting': typeof ProtectedMyWorkWaitingRoute\n  '/persons/$personId': typeof ProtectedPersonsPersonIdRoute\n  '/persons/create': typeof ProtectedPersonsCreateRoute\n  '/positions/$id': typeof ProtectedPositionsIdRouteWithChildren\n  '/positions/$positionId': typeof ProtectedPositionsPositionIdRoute\n  '/relationships/graph': typeof ProtectedRelationshipsGraphRoute\n  '/tasks/$id': typeof ProtectedTasksIdRoute\n  '/tasks/escalations': typeof ProtectedTasksEscalationsRoute\n  '/tasks/queue': typeof ProtectedTasksQueueRoute\n  '/after-actions': typeof ProtectedAfterActionsIndexRoute\n  '/approvals': typeof ProtectedApprovalsIndexRoute\n  '/dossiers': typeof ProtectedDossiersIndexRoute\n  '/engagements': typeof ProtectedEngagementsIndexRoute\n  '/help': typeof ProtectedHelpIndexRoute\n  '/intake': typeof ProtectedIntakeIndexRoute\n  '/my-work': typeof ProtectedMyWorkIndexRoute\n  '/persons': typeof ProtectedPersonsIndexRoute\n  '/positions': typeof ProtectedPositionsIndexRoute\n  '/tasks': typeof ProtectedTasksIndexRoute\n  '/after-actions/$afterActionId/versions': typeof ProtectedAfterActionsAfterActionIdVersionsRoute\n  '/dossiers/countries/$id': typeof ProtectedDossiersCountriesIdRoute\n  '/dossiers/engagements/$id': typeof ProtectedDossiersEngagementsIdRoute\n  '/dossiers/forums/$id': typeof ProtectedDossiersForumsIdRoute\n  '/dossiers/organizations/$id': typeof ProtectedDossiersOrganizationsIdRoute\n  '/dossiers/persons/$id': typeof ProtectedDossiersPersonsIdRoute\n  '/dossiers/topics/$id': typeof ProtectedDossiersTopicsIdRoute\n  '/dossiers/working_groups/$id': typeof ProtectedDossiersWorking_groupsIdRoute\n  '/engagements/$engagementId/after-action': typeof ProtectedEngagementsEngagementIdAfterActionRoute\n  '/intake/tickets/$id': typeof ProtectedIntakeTicketsIdRoute\n  '/positions/$id/approvals': typeof ProtectedPositionsIdApprovalsRoute\n  '/positions/$id/versions': typeof ProtectedPositionsIdVersionsRoute\n  '/dossiers/countries': typeof ProtectedDossiersCountriesIndexRoute\n  '/dossiers/engagements': typeof ProtectedDossiersEngagementsIndexRoute\n  '/dossiers/forums': typeof ProtectedDossiersForumsIndexRoute\n  '/dossiers/organizations': typeof ProtectedDossiersOrganizationsIndexRoute\n  '/dossiers/persons': typeof ProtectedDossiersPersonsIndexRoute\n  '/dossiers/topics': typeof ProtectedDossiersTopicsIndexRoute\n  '/dossiers/working_groups': typeof ProtectedDossiersWorking_groupsIndexRoute\n}\nexport interface FileRoutesById {\n  __root__: typeof rootRouteImport\n  '/': typeof IndexRoute\n  '/_protected': typeof ProtectedRouteWithChildren\n  '/login': typeof LoginRoute\n  '/modern-nav-standalone': typeof ModernNavStandaloneRoute\n  '/register': typeof RegisterRoute\n  '/_protected/accessibility': typeof ProtectedAccessibilityRoute\n  '/_protected/advanced-search': typeof ProtectedAdvancedSearchRoute\n  '/_protected/analytics': typeof ProtectedAnalyticsRoute\n  '/_protected/audit-logs': typeof ProtectedAuditLogsRoute\n  '/_protected/briefs': typeof ProtectedBriefsRoute\n  '/_protected/bulk-actions-demo': typeof ProtectedBulkActionsDemoRoute\n  '/_protected/calendar': typeof ProtectedCalendarRouteWithChildren\n  '/_protected/commitments': typeof ProtectedCommitmentsRoute\n  '/_protected/contacts': typeof ProtectedContactsRouteWithChildren\n  '/_protected/countries': typeof ProtectedCountriesRoute\n  '/_protected/custom-dashboard': typeof ProtectedCustomDashboardRoute\n  '/_protected/dashboard': typeof ProtectedDashboardRoute\n  '/_protected/data-library': typeof ProtectedDataLibraryRoute\n  '/_protected/delegations': typeof ProtectedDelegationsRoute\n  '/_protected/engagements': typeof ProtectedEngagementsRouteWithChildren\n  '/_protected/events': typeof ProtectedEventsRoute\n  '/_protected/export': typeof ProtectedExportRoute\n  '/_protected/export-import': typeof ProtectedExportImportRoute\n  '/_protected/forums': typeof ProtectedForumsRoute\n  '/_protected/intake': typeof ProtectedIntakeRouteWithChildren\n  '/_protected/intelligence': typeof ProtectedIntelligenceRoute\n  '/_protected/kanban': typeof ProtectedKanbanRoute\n  '/_protected/modern-nav-demo': typeof ProtectedModernNavDemoRoute\n  '/_protected/monitoring': typeof ProtectedMonitoringRoute\n  '/_protected/mous': typeof ProtectedMousRoute\n  '/_protected/my-work': typeof ProtectedMyWorkRouteWithChildren\n  '/_protected/organizations': typeof ProtectedOrganizationsRoute\n  '/_protected/persons': typeof ProtectedPersonsRouteWithChildren\n  '/_protected/positions': typeof ProtectedPositionsRouteWithChildren\n  '/_protected/prototype-dossier': typeof ProtectedPrototypeDossierRoute\n  '/_protected/reports': typeof ProtectedReportsRoute\n  '/_protected/responsive-demo': typeof ProtectedResponsiveDemoRoute\n  '/_protected/search': typeof ProtectedSearchRoute\n  '/_protected/settings': typeof ProtectedSettingsRoute\n  '/_protected/themes': typeof ProtectedThemesRoute\n  '/_protected/users': typeof ProtectedUsersRoute\n  '/_protected/word-assistant': typeof ProtectedWordAssistantRoute\n  '/_protected/working-groups': typeof ProtectedWorkingGroupsRoute\n  '/_protected/admin/ai-settings': typeof ProtectedAdminAiSettingsRoute\n  '/_protected/admin/ai-usage': typeof ProtectedAdminAiUsageRoute\n  '/_protected/admin/approvals': typeof ProtectedAdminApprovalsRoute\n  '/_protected/admin/data-retention': typeof ProtectedAdminDataRetentionRoute\n  '/_protected/admin/system': typeof ProtectedAdminSystemRoute\n  '/_protected/after-actions/$afterActionId': typeof ProtectedAfterActionsAfterActionIdRouteWithChildren\n  '/_protected/calendar/new': typeof ProtectedCalendarNewRoute\n  '/_protected/contacts/$contactId': typeof ProtectedContactsContactIdRoute\n  '/_protected/contacts/create': typeof ProtectedContactsCreateRoute\n  '/_protected/contacts/notes-search': typeof ProtectedContactsNotesSearchRoute\n  '/_protected/dossiers/$id': typeof ProtectedDossiersIdRoute\n  '/_protected/dossiers/create': typeof ProtectedDossiersCreateRoute\n  '/_protected/engagements/$engagementId': typeof ProtectedEngagementsEngagementIdRouteWithChildren\n  '/_protected/help/commitments': typeof ProtectedHelpCommitmentsRoute\n  '/_protected/intake/new': typeof ProtectedIntakeNewRoute\n  '/_protected/intake/queue': typeof ProtectedIntakeQueueRoute\n  '/_protected/my-work/assignments': typeof ProtectedMyWorkAssignmentsRoute\n  '/_protected/my-work/board': typeof ProtectedMyWorkBoardRoute\n  '/_protected/my-work/intake': typeof ProtectedMyWorkIntakeRoute\n  '/_protected/my-work/waiting': typeof ProtectedMyWorkWaitingRoute\n  '/_protected/persons/$personId': typeof ProtectedPersonsPersonIdRoute\n  '/_protected/persons/create': typeof ProtectedPersonsCreateRoute\n  '/_protected/positions/$id': typeof ProtectedPositionsIdRouteWithChildren\n  '/_protected/positions/$positionId': typeof ProtectedPositionsPositionIdRoute\n  '/_protected/relationships/graph': typeof ProtectedRelationshipsGraphRoute\n  '/_protected/tasks/$id': typeof ProtectedTasksIdRoute\n  '/_protected/tasks/escalations': typeof ProtectedTasksEscalationsRoute\n  '/_protected/tasks/queue': typeof ProtectedTasksQueueRoute\n  '/_protected/after-actions/': typeof ProtectedAfterActionsIndexRoute\n  '/_protected/approvals/': typeof ProtectedApprovalsIndexRoute\n  '/_protected/dossiers/': typeof ProtectedDossiersIndexRoute\n  '/_protected/engagements/': typeof ProtectedEngagementsIndexRoute\n  '/_protected/help/': typeof ProtectedHelpIndexRoute\n  '/_protected/intake/': typeof ProtectedIntakeIndexRoute\n  '/_protected/my-work/': typeof ProtectedMyWorkIndexRoute\n  '/_protected/persons/': typeof ProtectedPersonsIndexRoute\n  '/_protected/positions/': typeof ProtectedPositionsIndexRoute\n  '/_protected/tasks/': typeof ProtectedTasksIndexRoute\n  '/_protected/after-actions/$afterActionId/versions': typeof ProtectedAfterActionsAfterActionIdVersionsRoute\n  '/_protected/dossiers/countries/$id': typeof ProtectedDossiersCountriesIdRoute\n  '/_protected/dossiers/engagements/$id': typeof ProtectedDossiersEngagementsIdRoute\n  '/_protected/dossiers/forums/$id': typeof ProtectedDossiersForumsIdRoute\n  '/_protected/dossiers/organizations/$id': typeof ProtectedDossiersOrganizationsIdRoute\n  '/_protected/dossiers/persons/$id': typeof ProtectedDossiersPersonsIdRoute\n  '/_protected/dossiers/topics/$id': typeof ProtectedDossiersTopicsIdRoute\n  '/_protected/dossiers/working_groups/$id': typeof ProtectedDossiersWorking_groupsIdRoute\n  '/_protected/engagements/$engagementId/after-action': typeof ProtectedEngagementsEngagementIdAfterActionRoute\n  '/_protected/intake/tickets/$id': typeof ProtectedIntakeTicketsIdRoute\n  '/_protected/positions/$id/approvals': typeof ProtectedPositionsIdApprovalsRoute\n  '/_protected/positions/$id/versions': typeof ProtectedPositionsIdVersionsRoute\n  '/_protected/dossiers/countries/': typeof ProtectedDossiersCountriesIndexRoute\n  '/_protected/dossiers/engagements/': typeof ProtectedDossiersEngagementsIndexRoute\n  '/_protected/dossiers/forums/': typeof ProtectedDossiersForumsIndexRoute\n  '/_protected/dossiers/organizations/': typeof ProtectedDossiersOrganizationsIndexRoute\n  '/_protected/dossiers/persons/': typeof ProtectedDossiersPersonsIndexRoute\n  '/_protected/dossiers/topics/': typeof ProtectedDossiersTopicsIndexRoute\n  '/_protected/dossiers/working_groups/': typeof ProtectedDossiersWorking_groupsIndexRoute\n}\nexport interface FileRouteTypes {\n  fileRoutesByFullPath: FileRoutesByFullPath\n  fullPaths:\n    | '/'\n    | '/login'\n    | '/modern-nav-standalone'\n    | '/register'\n    | '/accessibility'\n    | '/advanced-search'\n    | '/analytics'\n    | '/audit-logs'\n    | '/briefs'\n    | '/bulk-actions-demo'\n    | '/calendar'\n    | '/commitments'\n    | '/contacts'\n    | '/countries'\n    | '/custom-dashboard'\n    | '/dashboard'\n    | '/data-library'\n    | '/delegations'\n    | '/engagements'\n    | '/events'\n    | '/export'\n    | '/export-import'\n    | '/forums'\n    | '/intake'\n    | '/intelligence'\n    | '/kanban'\n    | '/modern-nav-demo'\n    | '/monitoring'\n    | '/mous'\n    | '/my-work'\n    | '/organizations'\n    | '/persons'\n    | '/positions'\n    | '/prototype-dossier'\n    | '/reports'\n    | '/responsive-demo'\n    | '/search'\n    | '/settings'\n    | '/themes'\n    | '/users'\n    | '/word-assistant'\n    | '/working-groups'\n    | '/admin/ai-settings'\n    | '/admin/ai-usage'\n    | '/admin/approvals'\n    | '/admin/data-retention'\n    | '/admin/system'\n    | '/after-actions/$afterActionId'\n    | '/calendar/new'\n    | '/contacts/$contactId'\n    | '/contacts/create'\n    | '/contacts/notes-search'\n    | '/dossiers/$id'\n    | '/dossiers/create'\n    | '/engagements/$engagementId'\n    | '/help/commitments'\n    | '/intake/new'\n    | '/intake/queue'\n    | '/my-work/assignments'\n    | '/my-work/board'\n    | '/my-work/intake'\n    | '/my-work/waiting'\n    | '/persons/$personId'\n    | '/persons/create'\n    | '/positions/$id'\n    | '/positions/$positionId'\n    | '/relationships/graph'\n    | '/tasks/$id'\n    | '/tasks/escalations'\n    | '/tasks/queue'\n    | '/after-actions'\n    | '/approvals'\n    | '/dossiers'\n    | '/engagements/'\n    | '/help'\n    | '/intake/'\n    | '/my-work/'\n    | '/persons/'\n    | '/positions/'\n    | '/tasks'\n    | '/after-actions/$afterActionId/versions'\n    | '/dossiers/countries/$id'\n    | '/dossiers/engagements/$id'\n    | '/dossiers/forums/$id'\n    | '/dossiers/organizations/$id'\n    | '/dossiers/persons/$id'\n    | '/dossiers/topics/$id'\n    | '/dossiers/working_groups/$id'\n    | '/engagements/$engagementId/after-action'\n    | '/intake/tickets/$id'\n    | '/positions/$id/approvals'\n    | '/positions/$id/versions'\n    | '/dossiers/countries'\n    | '/dossiers/engagements'\n    | '/dossiers/forums'\n    | '/dossiers/organizations'\n    | '/dossiers/persons'\n    | '/dossiers/topics'\n    | '/dossiers/working_groups'\n  fileRoutesByTo: FileRoutesByTo\n  to:\n    | '/'\n    | '/login'\n    | '/modern-nav-standalone'\n    | '/register'\n    | '/accessibility'\n    | '/advanced-search'\n    | '/analytics'\n    | '/audit-logs'\n    | '/briefs'\n    | '/bulk-actions-demo'\n    | '/calendar'\n    | '/commitments'\n    | '/contacts'\n    | '/countries'\n    | '/custom-dashboard'\n    | '/dashboard'\n    | '/data-library'\n    | '/delegations'\n    | '/events'\n    | '/export'\n    | '/export-import'\n    | '/forums'\n    | '/intelligence'\n    | '/kanban'\n    | '/modern-nav-demo'\n    | '/monitoring'\n    | '/mous'\n    | '/organizations'\n    | '/prototype-dossier'\n    | '/reports'\n    | '/responsive-demo'\n    | '/search'\n    | '/settings'\n    | '/themes'\n    | '/users'\n    | '/word-assistant'\n    | '/working-groups'\n    | '/admin/ai-settings'\n    | '/admin/ai-usage'\n    | '/admin/approvals'\n    | '/admin/data-retention'\n    | '/admin/system'\n    | '/after-actions/$afterActionId'\n    | '/calendar/new'\n    | '/contacts/$contactId'\n    | '/contacts/create'\n    | '/contacts/notes-search'\n    | '/dossiers/$id'\n    | '/dossiers/create'\n    | '/engagements/$engagementId'\n    | '/help/commitments'\n    | '/intake/new'\n    | '/intake/queue'\n    | '/my-work/assignments'\n    | '/my-work/board'\n    | '/my-work/intake'\n    | '/my-work/waiting'\n    | '/persons/$personId'\n    | '/persons/create'\n    | '/positions/$id'\n    | '/positions/$positionId'\n    | '/relationships/graph'\n    | '/tasks/$id'\n    | '/tasks/escalations'\n    | '/tasks/queue'\n    | '/after-actions'\n    | '/approvals'\n    | '/dossiers'\n    | '/engagements'\n    | '/help'\n    | '/intake'\n    | '/my-work'\n    | '/persons'\n    | '/positions'\n    | '/tasks'\n    | '/after-actions/$afterActionId/versions'\n    | '/dossiers/countries/$id'\n    | '/dossiers/engagements/$id'\n    | '/dossiers/forums/$id'\n    | '/dossiers/organizations/$id'\n    | '/dossiers/persons/$id'\n    | '/dossiers/topics/$id'\n    | '/dossiers/working_groups/$id'\n    | '/engagements/$engagementId/after-action'\n    | '/intake/tickets/$id'\n    | '/positions/$id/approvals'\n    | '/positions/$id/versions'\n    | '/dossiers/countries'\n    | '/dossiers/engagements'\n    | '/dossiers/forums'\n    | '/dossiers/organizations'\n    | '/dossiers/persons'\n    | '/dossiers/topics'\n    | '/dossiers/working_groups'\n  id:\n    | '__root__'\n    | '/'\n    | '/_protected'\n    | '/login'\n    | '/modern-nav-standalone'\n    | '/register'\n    | '/_protected/accessibility'\n    | '/_protected/advanced-search'\n    | '/_protected/analytics'\n    | '/_protected/audit-logs'\n    | '/_protected/briefs'\n    | '/_protected/bulk-actions-demo'\n    | '/_protected/calendar'\n    | '/_protected/commitments'\n    | '/_protected/contacts'\n    | '/_protected/countries'\n    | '/_protected/custom-dashboard'\n    | '/_protected/dashboard'\n    | '/_protected/data-library'\n    | '/_protected/delegations'\n    | '/_protected/engagements'\n    | '/_protected/events'\n    | '/_protected/export'\n    | '/_protected/export-import'\n    | '/_protected/forums'\n    | '/_protected/intake'\n    | '/_protected/intelligence'\n    | '/_protected/kanban'\n    | '/_protected/modern-nav-demo'\n    | '/_protected/monitoring'\n    | '/_protected/mous'\n    | '/_protected/my-work'\n    | '/_protected/organizations'\n    | '/_protected/persons'\n    | '/_protected/positions'\n    | '/_protected/prototype-dossier'\n    | '/_protected/reports'\n    | '/_protected/responsive-demo'\n    | '/_protected/search'\n    | '/_protected/settings'\n    | '/_protected/themes'\n    | '/_protected/users'\n    | '/_protected/word-assistant'\n    | '/_protected/working-groups'\n    | '/_protected/admin/ai-settings'\n    | '/_protected/admin/ai-usage'\n    | '/_protected/admin/approvals'\n    | '/_protected/admin/data-retention'\n    | '/_protected/admin/system'\n    | '/_protected/after-actions/$afterActionId'\n    | '/_protected/calendar/new'\n    | '/_protected/contacts/$contactId'\n    | '/_protected/contacts/create'\n    | '/_protected/contacts/notes-search'\n    | '/_protected/dossiers/$id'\n    | '/_protected/dossiers/create'\n    | '/_protected/engagements/$engagementId'\n    | '/_protected/help/commitments'\n    | '/_protected/intake/new'\n    | '/_protected/intake/queue'\n    | '/_protected/my-work/assignments'\n    | '/_protected/my-work/board'\n    | '/_protected/my-work/intake'\n    | '/_protected/my-work/waiting'\n    | '/_protected/persons/$personId'\n    | '/_protected/persons/create'\n    | '/_protected/positions/$id'\n    | '/_protected/positions/$positionId'\n    | '/_protected/relationships/graph'\n    | '/_protected/tasks/$id'\n    | '/_protected/tasks/escalations'\n    | '/_protected/tasks/queue'\n    | '/_protected/after-actions/'\n    | '/_protected/approvals/'\n    | '/_protected/dossiers/'\n    | '/_protected/engagements/'\n    | '/_protected/help/'\n    | '/_protected/intake/'\n    | '/_protected/my-work/'\n    | '/_protected/persons/'\n    | '/_protected/positions/'\n    | '/_protected/tasks/'\n    | '/_protected/after-actions/$afterActionId/versions'\n    | '/_protected/dossiers/countries/$id'\n    | '/_protected/dossiers/engagements/$id'\n    | '/_protected/dossiers/forums/$id'\n    | '/_protected/dossiers/organizations/$id'\n    | '/_protected/dossiers/persons/$id'\n    | '/_protected/dossiers/topics/$id'\n    | '/_protected/dossiers/working_groups/$id'\n    | '/_protected/engagements/$engagementId/after-action'\n    | '/_protected/intake/tickets/$id'\n    | '/_protected/positions/$id/approvals'\n    | '/_protected/positions/$id/versions'\n    | '/_protected/dossiers/countries/'\n    | '/_protected/dossiers/engagements/'\n    | '/_protected/dossiers/forums/'\n    | '/_protected/dossiers/organizations/'\n    | '/_protected/dossiers/persons/'\n    | '/_protected/dossiers/topics/'\n    | '/_protected/dossiers/working_groups/'\n  fileRoutesById: FileRoutesById\n}\nexport interface RootRouteChildren {\n  IndexRoute: typeof IndexRoute\n  ProtectedRoute: typeof ProtectedRouteWithChildren\n  LoginRoute: typeof LoginRoute\n  ModernNavStandaloneRoute: typeof ModernNavStandaloneRoute\n  RegisterRoute: typeof RegisterRoute\n}\n\ndeclare module '@tanstack/react-router' {\n  interface FileRoutesByPath {\n    '/register': {\n      id: '/register'\n      path: '/register'\n      fullPath: '/register'\n      preLoaderRoute: typeof RegisterRouteImport\n      parentRoute: typeof rootRouteImport\n    }\n    '/modern-nav-standalone': {\n      id: '/modern-nav-standalone'\n      path: '/modern-nav-standalone'\n      fullPath: '/modern-nav-standalone'\n      preLoaderRoute: typeof ModernNavStandaloneRouteImport\n      parentRoute: typeof rootRouteImport\n    }\n    '/login': {\n      id: '/login'\n      path: '/login'\n      fullPath: '/login'\n      preLoaderRoute: typeof LoginRouteImport\n      parentRoute: typeof rootRouteImport\n    }\n    '/_protected': {\n      id: '/_protected'\n      path: ''\n      fullPath: ''\n      preLoaderRoute: typeof ProtectedRouteImport\n      parentRoute: typeof rootRouteImport\n    }\n    '/': {\n      id: '/'\n      path: '/'\n      fullPath: '/'\n      preLoaderRoute: typeof IndexRouteImport\n      parentRoute: typeof rootRouteImport\n    }\n    '/_protected/working-groups': {\n      id: '/_protected/working-groups'\n      path: '/working-groups'\n      fullPath: '/working-groups'\n      preLoaderRoute: typeof ProtectedWorkingGroupsRouteImport\n      parentRoute: typeof ProtectedRoute\n    }\n    '/_protected/word-assistant': {\n      id: '/_protected/word-assistant'\n      path: '/word-assistant'\n      fullPath: '/word-assistant'\n      preLoaderRoute: typeof ProtectedWordAssistantRouteImport\n      parentRoute: typeof ProtectedRoute\n    }\n    '/_protected/users': {\n      id: '/_protected/users'\n      path: '/users'\n      fullPath: '/users'\n      preLoaderRoute: typeof ProtectedUsersRouteImport\n      parentRoute: typeof ProtectedRoute\n    }\n    '/_protected/themes': {\n      id: '/_protected/themes'\n      path: '/themes'\n      fullPath: '/themes'\n      preLoaderRoute: typeof ProtectedThemesRouteImport\n      parentRoute: typeof ProtectedRoute\n    }\n    '/_protected/settings': {\n      id: '/_protected/settings'\n      path: '/settings'\n      fullPath: '/settings'\n      preLoaderRoute: typeof ProtectedSettingsRouteImport\n      parentRoute: typeof ProtectedRoute\n    }\n    '/_protected/search': {\n      id: '/_protected/search'\n      path: '/search'\n      fullPath: '/search'\n      preLoaderRoute: typeof ProtectedSearchRouteImport\n      parentRoute: typeof ProtectedRoute\n    }\n    '/_protected/responsive-demo': {\n      id: '/_protected/responsive-demo'\n      path: '/responsive-demo'\n      fullPath: '/responsive-demo'\n      preLoaderRoute: typeof ProtectedResponsiveDemoRouteImport\n      parentRoute: typeof ProtectedRoute\n    }\n    '/_protected/reports': {\n      id: '/_protected/reports'\n      path: '/reports'\n      fullPath: '/reports'\n      preLoaderRoute: typeof ProtectedReportsRouteImport\n      parentRoute: typeof ProtectedRoute\n    }\n    '/_protected/prototype-dossier': {\n      id: '/_protected/prototype-dossier'\n      path: '/prototype-dossier'\n      fullPath: '/prototype-dossier'\n      preLoaderRoute: typeof ProtectedPrototypeDossierRouteImport\n      parentRoute: typeof ProtectedRoute\n    }\n    '/_protected/positions': {\n      id: '/_protected/positions'\n      path: '/positions'\n      fullPath: '/positions'\n      preLoaderRoute: typeof ProtectedPositionsRouteImport\n      parentRoute: typeof ProtectedRoute\n    }\n    '/_protected/persons': {\n      id: '/_protected/persons'\n      path: '/persons'\n      fullPath: '/persons'\n      preLoaderRoute: typeof ProtectedPersonsRouteImport\n      parentRoute: typeof ProtectedRoute\n    }\n    '/_protected/organizations': {\n      id: '/_protected/organizations'\n      path: '/organizations'\n      fullPath: '/organizations'\n      preLoaderRoute: typeof ProtectedOrganizationsRouteImport\n      parentRoute: typeof ProtectedRoute\n    }\n    '/_protected/my-work': {\n      id: '/_protected/my-work'\n      path: '/my-work'\n      fullPath: '/my-work'\n      preLoaderRoute: typeof ProtectedMyWorkRouteImport\n      parentRoute: typeof ProtectedRoute\n    }\n    '/_protected/mous': {\n      id: '/_protected/mous'\n      path: '/mous'\n      fullPath: '/mous'\n      preLoaderRoute: typeof ProtectedMousRouteImport\n      parentRoute: typeof ProtectedRoute\n    }\n    '/_protected/monitoring': {\n      id: '/_protected/monitoring'\n      path: '/monitoring'\n      fullPath: '/monitoring'\n      preLoaderRoute: typeof ProtectedMonitoringRouteImport\n      parentRoute: typeof ProtectedRoute\n    }\n    '/_protected/modern-nav-demo': {\n      id: '/_protected/modern-nav-demo'\n      path: '/modern-nav-demo'\n      fullPath: '/modern-nav-demo'\n      preLoaderRoute: typeof ProtectedModernNavDemoRouteImport\n      parentRoute: typeof ProtectedRoute\n    }\n    '/_protected/kanban': {\n      id: '/_protected/kanban'\n      path: '/kanban'\n      fullPath: '/kanban'\n      preLoaderRoute: typeof ProtectedKanbanRouteImport\n      parentRoute: typeof ProtectedRoute\n    }\n    '/_protected/intelligence': {\n      id: '/_protected/intelligence'\n      path: '/intelligence'\n      fullPath: '/intelligence'\n      preLoaderRoute: typeof ProtectedIntelligenceRouteImport\n      parentRoute: typeof ProtectedRoute\n    }\n    '/_protected/intake': {\n      id: '/_protected/intake'\n      path: '/intake'\n      fullPath: '/intake'\n      preLoaderRoute: typeof ProtectedIntakeRouteImport\n      parentRoute: typeof ProtectedRoute\n    }\n    '/_protected/forums': {\n      id: '/_protected/forums'\n      path: '/forums'\n      fullPath: '/forums'\n      preLoaderRoute: typeof ProtectedForumsRouteImport\n      parentRoute: typeof ProtectedRoute\n    }\n    '/_protected/export-import': {\n      id: '/_protected/export-import'\n      path: '/export-import'\n      fullPath: '/export-import'\n      preLoaderRoute: typeof ProtectedExportImportRouteImport\n      parentRoute: typeof ProtectedRoute\n    }\n    '/_protected/export': {\n      id: '/_protected/export'\n      path: '/export'\n      fullPath: '/export'\n      preLoaderRoute: typeof ProtectedExportRouteImport\n      parentRoute: typeof ProtectedRoute\n    }\n    '/_protected/events': {\n      id: '/_protected/events'\n      path: '/events'\n      fullPath: '/events'\n      preLoaderRoute: typeof ProtectedEventsRouteImport\n      parentRoute: typeof ProtectedRoute\n    }\n    '/_protected/engagements': {\n      id: '/_protected/engagements'\n      path: '/engagements'\n      fullPath: '/engagements'\n      preLoaderRoute: typeof ProtectedEngagementsRouteImport\n      parentRoute: typeof ProtectedRoute\n    }\n    '/_protected/delegations': {\n      id: '/_protected/delegations'\n      path: '/delegations'\n      fullPath: '/delegations'\n      preLoaderRoute: typeof ProtectedDelegationsRouteImport\n      parentRoute: typeof ProtectedRoute\n    }\n    '/_protected/data-library': {\n      id: '/_protected/data-library'\n      path: '/data-library'\n      fullPath: '/data-library'\n      preLoaderRoute: typeof ProtectedDataLibraryRouteImport\n      parentRoute: typeof ProtectedRoute\n    }\n    '/_protected/dashboard': {\n      id: '/_protected/dashboard'\n      path: '/dashboard'\n      fullPath: '/dashboard'\n      preLoaderRoute: typeof ProtectedDashboardRouteImport\n      parentRoute: typeof ProtectedRoute\n    }\n    '/_protected/custom-dashboard': {\n      id: '/_protected/custom-dashboard'\n      path: '/custom-dashboard'\n      fullPath: '/custom-dashboard'\n      preLoaderRoute: typeof ProtectedCustomDashboardRouteImport\n      parentRoute: typeof ProtectedRoute\n    }\n    '/_protected/countries': {\n      id: '/_protected/countries'\n      path: '/countries'\n      fullPath: '/countries'\n      preLoaderRoute: typeof ProtectedCountriesRouteImport\n      parentRoute: typeof ProtectedRoute\n    }\n    '/_protected/contacts': {\n      id: '/_protected/contacts'\n      path: '/contacts'\n      fullPath: '/contacts'\n      preLoaderRoute: typeof ProtectedContactsRouteImport\n      parentRoute: typeof ProtectedRoute\n    }\n    '/_protected/commitments': {\n      id: '/_protected/commitments'\n      path: '/commitments'\n      fullPath: '/commitments'\n      preLoaderRoute: typeof ProtectedCommitmentsRouteImport\n      parentRoute: typeof ProtectedRoute\n    }\n    '/_protected/calendar': {\n      id: '/_protected/calendar'\n      path: '/calendar'\n      fullPath: '/calendar'\n      preLoaderRoute: typeof ProtectedCalendarRouteImport\n      parentRoute: typeof ProtectedRoute\n    }\n    '/_protected/bulk-actions-demo': {\n      id: '/_protected/bulk-actions-demo'\n      path: '/bulk-actions-demo'\n      fullPath: '/bulk-actions-demo'\n      preLoaderRoute: typeof ProtectedBulkActionsDemoRouteImport\n      parentRoute: typeof ProtectedRoute\n    }\n    '/_protected/briefs': {\n      id: '/_protected/briefs'\n      path: '/briefs'\n      fullPath: '/briefs'\n      preLoaderRoute: typeof ProtectedBriefsRouteImport\n      parentRoute: typeof ProtectedRoute\n    }\n    '/_protected/audit-logs': {\n      id: '/_protected/audit-logs'\n      path: '/audit-logs'\n      fullPath: '/audit-logs'\n      preLoaderRoute: typeof ProtectedAuditLogsRouteImport\n      parentRoute: typeof ProtectedRoute\n    }\n    '/_protected/analytics': {\n      id: '/_protected/analytics'\n      path: '/analytics'\n      fullPath: '/analytics'\n      preLoaderRoute: typeof ProtectedAnalyticsRouteImport\n      parentRoute: typeof ProtectedRoute\n    }\n    '/_protected/advanced-search': {\n      id: '/_protected/advanced-search'\n      path: '/advanced-search'\n      fullPath: '/advanced-search'\n      preLoaderRoute: typeof ProtectedAdvancedSearchRouteImport\n      parentRoute: typeof ProtectedRoute\n    }\n    '/_protected/accessibility': {\n      id: '/_protected/accessibility'\n      path: '/accessibility'\n      fullPath: '/accessibility'\n      preLoaderRoute: typeof ProtectedAccessibilityRouteImport\n      parentRoute: typeof ProtectedRoute\n    }\n    '/_protected/tasks/': {\n      id: '/_protected/tasks/'\n      path: '/tasks'\n      fullPath: '/tasks'\n      preLoaderRoute: typeof ProtectedTasksIndexRouteImport\n      parentRoute: typeof ProtectedRoute\n    }\n    '/_protected/positions/': {\n      id: '/_protected/positions/'\n      path: '/'\n      fullPath: '/positions/'\n      preLoaderRoute: typeof ProtectedPositionsIndexRouteImport\n      parentRoute: typeof ProtectedPositionsRoute\n    }\n    '/_protected/persons/': {\n      id: '/_protected/persons/'\n      path: '/'\n      fullPath: '/persons/'\n      preLoaderRoute: typeof ProtectedPersonsIndexRouteImport\n      parentRoute: typeof ProtectedPersonsRoute\n    }\n    '/_protected/my-work/': {\n      id: '/_protected/my-work/'\n      path: '/'\n      fullPath: '/my-work/'\n      preLoaderRoute: typeof ProtectedMyWorkIndexRouteImport\n      parentRoute: typeof ProtectedMyWorkRoute\n    }\n    '/_protected/intake/': {\n      id: '/_protected/intake/'\n      path: '/'\n      fullPath: '/intake/'\n      preLoaderRoute: typeof ProtectedIntakeIndexRouteImport\n      parentRoute: typeof ProtectedIntakeRoute\n    }\n    '/_protected/help/': {\n      id: '/_protected/help/'\n      path: '/help'\n      fullPath: '/help'\n      preLoaderRoute: typeof ProtectedHelpIndexRouteImport\n      parentRoute: typeof ProtectedRoute\n    }\n    '/_protected/engagements/': {\n      id: '/_protected/engagements/'\n      path: '/'\n      fullPath: '/engagements/'\n      preLoaderRoute: typeof ProtectedEngagementsIndexRouteImport\n      parentRoute: typeof ProtectedEngagementsRoute\n    }\n    '/_protected/dossiers/': {\n      id: '/_protected/dossiers/'\n      path: '/dossiers'\n      fullPath: '/dossiers'\n      preLoaderRoute: typeof ProtectedDossiersIndexRouteImport\n      parentRoute: typeof ProtectedRoute\n    }\n    '/_protected/approvals/': {\n      id: '/_protected/approvals/'\n      path: '/approvals'\n      fullPath: '/approvals'\n      preLoaderRoute: typeof ProtectedApprovalsIndexRouteImport\n      parentRoute: typeof ProtectedRoute\n    }\n    '/_protected/after-actions/': {\n      id: '/_protected/after-actions/'\n      path: '/after-actions'\n      fullPath: '/after-actions'\n      preLoaderRoute: typeof ProtectedAfterActionsIndexRouteImport\n      parentRoute: typeof ProtectedRoute\n    }\n    '/_protected/tasks/queue': {\n      id: '/_protected/tasks/queue'\n      path: '/tasks/queue'\n      fullPath: '/tasks/queue'\n      preLoaderRoute: typeof ProtectedTasksQueueRouteImport\n      parentRoute: typeof ProtectedRoute\n    }\n    '/_protected/tasks/escalations': {\n      id: '/_protected/tasks/escalations'\n      path: '/tasks/escalations'\n      fullPath: '/tasks/escalations'\n      preLoaderRoute: typeof ProtectedTasksEscalationsRouteImport\n      parentRoute: typeof ProtectedRoute\n    }\n    '/_protected/tasks/$id': {\n      id: '/_protected/tasks/$id'\n      path: '/tasks/$id'\n      fullPath: '/tasks/$id'\n      preLoaderRoute: typeof ProtectedTasksIdRouteImport\n      parentRoute: typeof ProtectedRoute\n    }\n    '/_protected/relationships/graph': {\n      id: '/_protected/relationships/graph'\n      path: '/relationships/graph'\n      fullPath: '/relationships/graph'\n      preLoaderRoute: typeof ProtectedRelationshipsGraphRouteImport\n      parentRoute: typeof ProtectedRoute\n    }\n    '/_protected/positions/$positionId': {\n      id: '/_protected/positions/$positionId'\n      path: '/$positionId'\n      fullPath: '/positions/$positionId'\n      preLoaderRoute: typeof ProtectedPositionsPositionIdRouteImport\n      parentRoute: typeof ProtectedPositionsRoute\n    }\n    '/_protected/positions/$id': {\n      id: '/_protected/positions/$id'\n      path: '/$id'\n      fullPath: '/positions/$id'\n      preLoaderRoute: typeof ProtectedPositionsIdRouteImport\n      parentRoute: typeof ProtectedPositionsRoute\n    }\n    '/_protected/persons/create': {\n      id: '/_protected/persons/create'\n      path: '/create'\n      fullPath: '/persons/create'\n      preLoaderRoute: typeof ProtectedPersonsCreateRouteImport\n      parentRoute: typeof ProtectedPersonsRoute\n    }\n    '/_protected/persons/$personId': {\n      id: '/_protected/persons/$personId'\n      path: '/$personId'\n      fullPath: '/persons/$personId'\n      preLoaderRoute: typeof ProtectedPersonsPersonIdRouteImport\n      parentRoute: typeof ProtectedPersonsRoute\n    }\n    '/_protected/my-work/waiting': {\n      id: '/_protected/my-work/waiting'\n      path: '/waiting'\n      fullPath: '/my-work/waiting'\n      preLoaderRoute: typeof ProtectedMyWorkWaitingRouteImport\n      parentRoute: typeof ProtectedMyWorkRoute\n    }\n    '/_protected/my-work/intake': {\n      id: '/_protected/my-work/intake'\n      path: '/intake'\n      fullPath: '/my-work/intake'\n      preLoaderRoute: typeof ProtectedMyWorkIntakeRouteImport\n      parentRoute: typeof ProtectedMyWorkRoute\n    }\n    '/_protected/my-work/board': {\n      id: '/_protected/my-work/board'\n      path: '/board'\n      fullPath: '/my-work/board'\n      preLoaderRoute: typeof ProtectedMyWorkBoardRouteImport\n      parentRoute: typeof ProtectedMyWorkRoute\n    }\n    '/_protected/my-work/assignments': {\n      id: '/_protected/my-work/assignments'\n      path: '/assignments'\n      fullPath: '/my-work/assignments'\n      preLoaderRoute: typeof ProtectedMyWorkAssignmentsRouteImport\n      parentRoute: typeof ProtectedMyWorkRoute\n    }\n    '/_protected/intake/queue': {\n      id: '/_protected/intake/queue'\n      path: '/queue'\n      fullPath: '/intake/queue'\n      preLoaderRoute: typeof ProtectedIntakeQueueRouteImport\n      parentRoute: typeof ProtectedIntakeRoute\n    }\n    '/_protected/intake/new': {\n      id: '/_protected/intake/new'\n      path: '/new'\n      fullPath: '/intake/new'\n      preLoaderRoute: typeof ProtectedIntakeNewRouteImport\n      parentRoute: typeof ProtectedIntakeRoute\n    }\n    '/_protected/help/commitments': {\n      id: '/_protected/help/commitments'\n      path: '/help/commitments'\n      fullPath: '/help/commitments'\n      preLoaderRoute: typeof ProtectedHelpCommitmentsRouteImport\n      parentRoute: typeof ProtectedRoute\n    }\n    '/_protected/engagements/$engagementId': {\n      id: '/_protected/engagements/$engagementId'\n      path: '/$engagementId'\n      fullPath: '/engagements/$engagementId'\n      preLoaderRoute: typeof ProtectedEngagementsEngagementIdRouteImport\n      parentRoute: typeof ProtectedEngagementsRoute\n    }\n    '/_protected/dossiers/create': {\n      id: '/_protected/dossiers/create'\n      path: '/dossiers/create'\n      fullPath: '/dossiers/create'\n      preLoaderRoute: typeof ProtectedDossiersCreateRouteImport\n      parentRoute: typeof ProtectedRoute\n    }\n    '/_protected/dossiers/$id': {\n      id: '/_protected/dossiers/$id'\n      path: '/dossiers/$id'\n      fullPath: '/dossiers/$id'\n      preLoaderRoute: typeof ProtectedDossiersIdRouteImport\n      parentRoute: typeof ProtectedRoute\n    }\n    '/_protected/contacts/notes-search': {\n      id: '/_protected/contacts/notes-search'\n      path: '/notes-search'\n      fullPath: '/contacts/notes-search'\n      preLoaderRoute: typeof ProtectedContactsNotesSearchRouteImport\n      parentRoute: typeof ProtectedContactsRoute\n    }\n    '/_protected/contacts/create': {\n      id: '/_protected/contacts/create'\n      path: '/create'\n      fullPath: '/contacts/create'\n      preLoaderRoute: typeof ProtectedContactsCreateRouteImport\n      parentRoute: typeof ProtectedContactsRoute\n    }\n    '/_protected/contacts/$contactId': {\n      id: '/_protected/contacts/$contactId'\n      path: '/$contactId'\n      fullPath: '/contacts/$contactId'\n      preLoaderRoute: typeof ProtectedContactsContactIdRouteImport\n      parentRoute: typeof ProtectedContactsRoute\n    }\n    '/_protected/calendar/new': {\n      id: '/_protected/calendar/new'\n      path: '/new'\n      fullPath: '/calendar/new'\n      preLoaderRoute: typeof ProtectedCalendarNewRouteImport\n      parentRoute: typeof ProtectedCalendarRoute\n    }\n    '/_protected/after-actions/$afterActionId': {\n      id: '/_protected/after-actions/$afterActionId'\n      path: '/after-actions/$afterActionId'\n      fullPath: '/after-actions/$afterActionId'\n      preLoaderRoute: typeof ProtectedAfterActionsAfterActionIdRouteImport\n      parentRoute: typeof ProtectedRoute\n    }\n    '/_protected/admin/system': {\n      id: '/_protected/admin/system'\n      path: '/admin/system'\n      fullPath: '/admin/system'\n      preLoaderRoute: typeof ProtectedAdminSystemRouteImport\n      parentRoute: typeof ProtectedRoute\n    }\n    '/_protected/admin/data-retention': {\n      id: '/_protected/admin/data-retention'\n      path: '/admin/data-retention'\n      fullPath: '/admin/data-retention'\n      preLoaderRoute: typeof ProtectedAdminDataRetentionRouteImport\n      parentRoute: typeof ProtectedRoute\n    }\n    '/_protected/admin/approvals': {\n      id: '/_protected/admin/approvals'\n      path: '/admin/approvals'\n      fullPath: '/admin/approvals'\n      preLoaderRoute: typeof ProtectedAdminApprovalsRouteImport\n      parentRoute: typeof ProtectedRoute\n    }\n    '/_protected/admin/ai-usage': {\n      id: '/_protected/admin/ai-usage'\n      path: '/admin/ai-usage'\n      fullPath: '/admin/ai-usage'\n      preLoaderRoute: typeof ProtectedAdminAiUsageRouteImport\n      parentRoute: typeof ProtectedRoute\n    }\n    '/_protected/admin/ai-settings': {\n      id: '/_protected/admin/ai-settings'\n      path: '/admin/ai-settings'\n      fullPath: '/admin/ai-settings'\n      preLoaderRoute: typeof ProtectedAdminAiSettingsRouteImport\n      parentRoute: typeof ProtectedRoute\n    }\n    '/_protected/dossiers/working_groups/': {\n      id: '/_protected/dossiers/working_groups/'\n      path: '/dossiers/working_groups'\n      fullPath: '/dossiers/working_groups'\n      preLoaderRoute: typeof ProtectedDossiersWorking_groupsIndexRouteImport\n      parentRoute: typeof ProtectedRoute\n    }\n    '/_protected/dossiers/topics/': {\n      id: '/_protected/dossiers/topics/'\n      path: '/dossiers/topics'\n      fullPath: '/dossiers/topics'\n      preLoaderRoute: typeof ProtectedDossiersTopicsIndexRouteImport\n      parentRoute: typeof ProtectedRoute\n    }\n    '/_protected/dossiers/persons/': {\n      id: '/_protected/dossiers/persons/'\n      path: '/dossiers/persons'\n      fullPath: '/dossiers/persons'\n      preLoaderRoute: typeof ProtectedDossiersPersonsIndexRouteImport\n      parentRoute: typeof ProtectedRoute\n    }\n    '/_protected/dossiers/organizations/': {\n      id: '/_protected/dossiers/organizations/'\n      path: '/dossiers/organizations'\n      fullPath: '/dossiers/organizations'\n      preLoaderRoute: typeof ProtectedDossiersOrganizationsIndexRouteImport\n      parentRoute: typeof ProtectedRoute\n    }\n    '/_protected/dossiers/forums/': {\n      id: '/_protected/dossiers/forums/'\n      path: '/dossiers/forums'\n      fullPath: '/dossiers/forums'\n      preLoaderRoute: typeof ProtectedDossiersForumsIndexRouteImport\n      parentRoute: typeof ProtectedRoute\n    }\n    '/_protected/dossiers/engagements/': {\n      id: '/_protected/dossiers/engagements/'\n      path: '/dossiers/engagements'\n      fullPath: '/dossiers/engagements'\n      preLoaderRoute: typeof ProtectedDossiersEngagementsIndexRouteImport\n      parentRoute: typeof ProtectedRoute\n    }\n    '/_protected/dossiers/countries/': {\n      id: '/_protected/dossiers/countries/'\n      path: '/dossiers/countries'\n      fullPath: '/dossiers/countries'\n      preLoaderRoute: typeof ProtectedDossiersCountriesIndexRouteImport\n      parentRoute: typeof ProtectedRoute\n    }\n    '/_protected/positions/$id/versions': {\n      id: '/_protected/positions/$id/versions'\n      path: '/versions'\n      fullPath: '/positions/$id/versions'\n      preLoaderRoute: typeof ProtectedPositionsIdVersionsRouteImport\n      parentRoute: typeof ProtectedPositionsIdRoute\n    }\n    '/_protected/positions/$id/approvals': {\n      id: '/_protected/positions/$id/approvals'\n      path: '/approvals'\n      fullPath: '/positions/$id/approvals'\n      preLoaderRoute: typeof ProtectedPositionsIdApprovalsRouteImport\n      parentRoute: typeof ProtectedPositionsIdRoute\n    }\n    '/_protected/intake/tickets/$id': {\n      id: '/_protected/intake/tickets/$id'\n      path: '/tickets/$id'\n      fullPath: '/intake/tickets/$id'\n      preLoaderRoute: typeof ProtectedIntakeTicketsIdRouteImport\n      parentRoute: typeof ProtectedIntakeRoute\n    }\n    '/_protected/engagements/$engagementId/after-action': {\n      id: '/_protected/engagements/$engagementId/after-action'\n      path: '/after-action'\n      fullPath: '/engagements/$engagementId/after-action'\n      preLoaderRoute: typeof ProtectedEngagementsEngagementIdAfterActionRouteImport\n      parentRoute: typeof ProtectedEngagementsEngagementIdRoute\n    }\n    '/_protected/dossiers/working_groups/$id': {\n      id: '/_protected/dossiers/working_groups/$id'\n      path: '/dossiers/working_groups/$id'\n      fullPath: '/dossiers/working_groups/$id'\n      preLoaderRoute: typeof ProtectedDossiersWorking_groupsIdRouteImport\n      parentRoute: typeof ProtectedRoute\n    }\n    '/_protected/dossiers/topics/$id': {\n      id: '/_protected/dossiers/topics/$id'\n      path: '/dossiers/topics/$id'\n      fullPath: '/dossiers/topics/$id'\n      preLoaderRoute: typeof ProtectedDossiersTopicsIdRouteImport\n      parentRoute: typeof ProtectedRoute\n    }\n    '/_protected/dossiers/persons/$id': {\n      id: '/_protected/dossiers/persons/$id'\n      path: '/dossiers/persons/$id'\n      fullPath: '/dossiers/persons/$id'\n      preLoaderRoute: typeof ProtectedDossiersPersonsIdRouteImport\n      parentRoute: typeof ProtectedRoute\n    }\n    '/_protected/dossiers/organizations/$id': {\n      id: '/_protected/dossiers/organizations/$id'\n      path: '/dossiers/organizations/$id'\n      fullPath: '/dossiers/organizations/$id'\n      preLoaderRoute: typeof ProtectedDossiersOrganizationsIdRouteImport\n      parentRoute: typeof ProtectedRoute\n    }\n    '/_protected/dossiers/forums/$id': {\n      id: '/_protected/dossiers/forums/$id'\n      path: '/dossiers/forums/$id'\n      fullPath: '/dossiers/forums/$id'\n      preLoaderRoute: typeof ProtectedDossiersForumsIdRouteImport\n      parentRoute: typeof ProtectedRoute\n    }\n    '/_protected/dossiers/engagements/$id': {\n      id: '/_protected/dossiers/engagements/$id'\n      path: '/dossiers/engagements/$id'\n      fullPath: '/dossiers/engagements/$id'\n      preLoaderRoute: typeof ProtectedDossiersEngagementsIdRouteImport\n      parentRoute: typeof ProtectedRoute\n    }\n    '/_protected/dossiers/countries/$id': {\n      id: '/_protected/dossiers/countries/$id'\n      path: '/dossiers/countries/$id'\n      fullPath: '/dossiers/countries/$id'\n      preLoaderRoute: typeof ProtectedDossiersCountriesIdRouteImport\n      parentRoute: typeof ProtectedRoute\n    }\n    '/_protected/after-actions/$afterActionId/versions': {\n      id: '/_protected/after-actions/$afterActionId/versions'\n      path: '/versions'\n      fullPath: '/after-actions/$afterActionId/versions'\n      preLoaderRoute: typeof ProtectedAfterActionsAfterActionIdVersionsRouteImport\n      parentRoute: typeof ProtectedAfterActionsAfterActionIdRoute\n    }\n  }\n}\n\ninterface ProtectedCalendarRouteChildren {\n  ProtectedCalendarNewRoute: typeof ProtectedCalendarNewRoute\n}\n\nconst ProtectedCalendarRouteChildren: ProtectedCalendarRouteChildren = {\n  ProtectedCalendarNewRoute: ProtectedCalendarNewRoute,\n}\n\nconst ProtectedCalendarRouteWithChildren =\n  ProtectedCalendarRoute._addFileChildren(ProtectedCalendarRouteChildren)\n\ninterface ProtectedContactsRouteChildren {\n  ProtectedContactsContactIdRoute: typeof ProtectedContactsContactIdRoute\n  ProtectedContactsCreateRoute: typeof ProtectedContactsCreateRoute\n  ProtectedContactsNotesSearchRoute: typeof ProtectedContactsNotesSearchRoute\n}\n\nconst ProtectedContactsRouteChildren: ProtectedContactsRouteChildren = {\n  ProtectedContactsContactIdRoute: ProtectedContactsContactIdRoute,\n  ProtectedContactsCreateRoute: ProtectedContactsCreateRoute,\n  ProtectedContactsNotesSearchRoute: ProtectedContactsNotesSearchRoute,\n}\n\nconst ProtectedContactsRouteWithChildren =\n  ProtectedContactsRoute._addFileChildren(ProtectedContactsRouteChildren)\n\ninterface ProtectedEngagementsEngagementIdRouteChildren {\n  ProtectedEngagementsEngagementIdAfterActionRoute: typeof ProtectedEngagementsEngagementIdAfterActionRoute\n}\n\nconst ProtectedEngagementsEngagementIdRouteChildren: ProtectedEngagementsEngagementIdRouteChildren =\n  {\n    ProtectedEngagementsEngagementIdAfterActionRoute:\n      ProtectedEngagementsEngagementIdAfterActionRoute,\n  }\n\nconst ProtectedEngagementsEngagementIdRouteWithChildren =\n  ProtectedEngagementsEngagementIdRoute._addFileChildren(\n    ProtectedEngagementsEngagementIdRouteChildren,\n  )\n\ninterface ProtectedEngagementsRouteChildren {\n  ProtectedEngagementsEngagementIdRoute: typeof ProtectedEngagementsEngagementIdRouteWithChildren\n  ProtectedEngagementsIndexRoute: typeof ProtectedEngagementsIndexRoute\n}\n\nconst ProtectedEngagementsRouteChildren: ProtectedEngagementsRouteChildren = {\n  ProtectedEngagementsEngagementIdRoute:\n    ProtectedEngagementsEngagementIdRouteWithChildren,\n  ProtectedEngagementsIndexRoute: ProtectedEngagementsIndexRoute,\n}\n\nconst ProtectedEngagementsRouteWithChildren =\n  ProtectedEngagementsRoute._addFileChildren(ProtectedEngagementsRouteChildren)\n\ninterface ProtectedIntakeRouteChildren {\n  ProtectedIntakeNewRoute: typeof ProtectedIntakeNewRoute\n  ProtectedIntakeQueueRoute: typeof ProtectedIntakeQueueRoute\n  ProtectedIntakeIndexRoute: typeof ProtectedIntakeIndexRoute\n  ProtectedIntakeTicketsIdRoute: typeof ProtectedIntakeTicketsIdRoute\n}\n\nconst ProtectedIntakeRouteChildren: ProtectedIntakeRouteChildren = {\n  ProtectedIntakeNewRoute: ProtectedIntakeNewRoute,\n  ProtectedIntakeQueueRoute: ProtectedIntakeQueueRoute,\n  ProtectedIntakeIndexRoute: ProtectedIntakeIndexRoute,\n  ProtectedIntakeTicketsIdRoute: ProtectedIntakeTicketsIdRoute,\n}\n\nconst ProtectedIntakeRouteWithChildren = ProtectedIntakeRoute._addFileChildren(\n  ProtectedIntakeRouteChildren,\n)\n\ninterface ProtectedMyWorkRouteChildren {\n  ProtectedMyWorkAssignmentsRoute: typeof ProtectedMyWorkAssignmentsRoute\n  ProtectedMyWorkBoardRoute: typeof ProtectedMyWorkBoardRoute\n  ProtectedMyWorkIntakeRoute: typeof ProtectedMyWorkIntakeRoute\n  ProtectedMyWorkWaitingRoute: typeof ProtectedMyWorkWaitingRoute\n  ProtectedMyWorkIndexRoute: typeof ProtectedMyWorkIndexRoute\n}\n\nconst ProtectedMyWorkRouteChildren: ProtectedMyWorkRouteChildren = {\n  ProtectedMyWorkAssignmentsRoute: ProtectedMyWorkAssignmentsRoute,\n  ProtectedMyWorkBoardRoute: ProtectedMyWorkBoardRoute,\n  ProtectedMyWorkIntakeRoute: ProtectedMyWorkIntakeRoute,\n  ProtectedMyWorkWaitingRoute: ProtectedMyWorkWaitingRoute,\n  ProtectedMyWorkIndexRoute: ProtectedMyWorkIndexRoute,\n}\n\nconst ProtectedMyWorkRouteWithChildren = ProtectedMyWorkRoute._addFileChildren(\n  ProtectedMyWorkRouteChildren,\n)\n\ninterface ProtectedPersonsRouteChildren {\n  ProtectedPersonsPersonIdRoute: typeof ProtectedPersonsPersonIdRoute\n  ProtectedPersonsCreateRoute: typeof ProtectedPersonsCreateRoute\n  ProtectedPersonsIndexRoute: typeof ProtectedPersonsIndexRoute\n}\n\nconst ProtectedPersonsRouteChildren: ProtectedPersonsRouteChildren = {\n  ProtectedPersonsPersonIdRoute: ProtectedPersonsPersonIdRoute,\n  ProtectedPersonsCreateRoute: ProtectedPersonsCreateRoute,\n  ProtectedPersonsIndexRoute: ProtectedPersonsIndexRoute,\n}\n\nconst ProtectedPersonsRouteWithChildren =\n  ProtectedPersonsRoute._addFileChildren(ProtectedPersonsRouteChildren)\n\ninterface ProtectedPositionsIdRouteChildren {\n  ProtectedPositionsIdApprovalsRoute: typeof ProtectedPositionsIdApprovalsRoute\n  ProtectedPositionsIdVersionsRoute: typeof ProtectedPositionsIdVersionsRoute\n}\n\nconst ProtectedPositionsIdRouteChildren: ProtectedPositionsIdRouteChildren = {\n  ProtectedPositionsIdApprovalsRoute: ProtectedPositionsIdApprovalsRoute,\n  ProtectedPositionsIdVersionsRoute: ProtectedPositionsIdVersionsRoute,\n}\n\nconst ProtectedPositionsIdRouteWithChildren =\n  ProtectedPositionsIdRoute._addFileChildren(ProtectedPositionsIdRouteChildren)\n\ninterface ProtectedPositionsRouteChildren {\n  ProtectedPositionsIdRoute: typeof ProtectedPositionsIdRouteWithChildren\n  ProtectedPositionsPositionIdRoute: typeof ProtectedPositionsPositionIdRoute\n  ProtectedPositionsIndexRoute: typeof ProtectedPositionsIndexRoute\n}\n\nconst ProtectedPositionsRouteChildren: ProtectedPositionsRouteChildren = {\n  ProtectedPositionsIdRoute: ProtectedPositionsIdRouteWithChildren,\n  ProtectedPositionsPositionIdRoute: ProtectedPositionsPositionIdRoute,\n  ProtectedPositionsIndexRoute: ProtectedPositionsIndexRoute,\n}\n\nconst ProtectedPositionsRouteWithChildren =\n  ProtectedPositionsRoute._addFileChildren(ProtectedPositionsRouteChildren)\n\ninterface ProtectedAfterActionsAfterActionIdRouteChildren {\n  ProtectedAfterActionsAfterActionIdVersionsRoute: typeof ProtectedAfterActionsAfterActionIdVersionsRoute\n}\n\nconst ProtectedAfterActionsAfterActionIdRouteChildren: ProtectedAfterActionsAfterActionIdRouteChildren =\n  {\n    ProtectedAfterActionsAfterActionIdVersionsRoute:\n      ProtectedAfterActionsAfterActionIdVersionsRoute,\n  }\n\nconst ProtectedAfterActionsAfterActionIdRouteWithChildren =\n  ProtectedAfterActionsAfterActionIdRoute._addFileChildren(\n    ProtectedAfterActionsAfterActionIdRouteChildren,\n  )\n\ninterface ProtectedRouteChildren {\n  ProtectedAccessibilityRoute: typeof ProtectedAccessibilityRoute\n  ProtectedAdvancedSearchRoute: typeof ProtectedAdvancedSearchRoute\n  ProtectedAnalyticsRoute: typeof ProtectedAnalyticsRoute\n  ProtectedAuditLogsRoute: typeof ProtectedAuditLogsRoute\n  ProtectedBriefsRoute: typeof ProtectedBriefsRoute\n  ProtectedBulkActionsDemoRoute: typeof ProtectedBulkActionsDemoRoute\n  ProtectedCalendarRoute: typeof ProtectedCalendarRouteWithChildren\n  ProtectedCommitmentsRoute: typeof ProtectedCommitmentsRoute\n  ProtectedContactsRoute: typeof ProtectedContactsRouteWithChildren\n  ProtectedCountriesRoute: typeof ProtectedCountriesRoute\n  ProtectedCustomDashboardRoute: typeof ProtectedCustomDashboardRoute\n  ProtectedDashboardRoute: typeof ProtectedDashboardRoute\n  ProtectedDataLibraryRoute: typeof ProtectedDataLibraryRoute\n  ProtectedDelegationsRoute: typeof ProtectedDelegationsRoute\n  ProtectedEngagementsRoute: typeof ProtectedEngagementsRouteWithChildren\n  ProtectedEventsRoute: typeof ProtectedEventsRoute\n  ProtectedExportRoute: typeof ProtectedExportRoute\n  ProtectedExportImportRoute: typeof ProtectedExportImportRoute\n  ProtectedForumsRoute: typeof ProtectedForumsRoute\n  ProtectedIntakeRoute: typeof ProtectedIntakeRouteWithChildren\n  ProtectedIntelligenceRoute: typeof ProtectedIntelligenceRoute\n  ProtectedKanbanRoute: typeof ProtectedKanbanRoute\n  ProtectedModernNavDemoRoute: typeof ProtectedModernNavDemoRoute\n  ProtectedMonitoringRoute: typeof ProtectedMonitoringRoute\n  ProtectedMousRoute: typeof ProtectedMousRoute\n  ProtectedMyWorkRoute: typeof ProtectedMyWorkRouteWithChildren\n  ProtectedOrganizationsRoute: typeof ProtectedOrganizationsRoute\n  ProtectedPersonsRoute: typeof ProtectedPersonsRouteWithChildren\n  ProtectedPositionsRoute: typeof ProtectedPositionsRouteWithChildren\n  ProtectedPrototypeDossierRoute: typeof ProtectedPrototypeDossierRoute\n  ProtectedReportsRoute: typeof ProtectedReportsRoute\n  ProtectedResponsiveDemoRoute: typeof ProtectedResponsiveDemoRoute\n  ProtectedSearchRoute: typeof ProtectedSearchRoute\n  ProtectedSettingsRoute: typeof ProtectedSettingsRoute\n  ProtectedThemesRoute: typeof ProtectedThemesRoute\n  ProtectedUsersRoute: typeof ProtectedUsersRoute\n  ProtectedWordAssistantRoute: typeof ProtectedWordAssistantRoute\n  ProtectedWorkingGroupsRoute: typeof ProtectedWorkingGroupsRoute\n  ProtectedAdminAiSettingsRoute: typeof ProtectedAdminAiSettingsRoute\n  ProtectedAdminAiUsageRoute: typeof ProtectedAdminAiUsageRoute\n  ProtectedAdminApprovalsRoute: typeof ProtectedAdminApprovalsRoute\n  ProtectedAdminDataRetentionRoute: typeof ProtectedAdminDataRetentionRoute\n  ProtectedAdminSystemRoute: typeof ProtectedAdminSystemRoute\n  ProtectedAfterActionsAfterActionIdRoute: typeof ProtectedAfterActionsAfterActionIdRouteWithChildren\n  ProtectedDossiersIdRoute: typeof ProtectedDossiersIdRoute\n  ProtectedDossiersCreateRoute: typeof ProtectedDossiersCreateRoute\n  ProtectedHelpCommitmentsRoute: typeof ProtectedHelpCommitmentsRoute\n  ProtectedRelationshipsGraphRoute: typeof ProtectedRelationshipsGraphRoute\n  ProtectedTasksIdRoute: typeof ProtectedTasksIdRoute\n  ProtectedTasksEscalationsRoute: typeof ProtectedTasksEscalationsRoute\n  ProtectedTasksQueueRoute: typeof ProtectedTasksQueueRoute\n  ProtectedAfterActionsIndexRoute: typeof ProtectedAfterActionsIndexRoute\n  ProtectedApprovalsIndexRoute: typeof ProtectedApprovalsIndexRoute\n  ProtectedDossiersIndexRoute: typeof ProtectedDossiersIndexRoute\n  ProtectedHelpIndexRoute: typeof ProtectedHelpIndexRoute\n  ProtectedTasksIndexRoute: typeof ProtectedTasksIndexRoute\n  ProtectedDossiersCountriesIdRoute: typeof ProtectedDossiersCountriesIdRoute\n  ProtectedDossiersEngagementsIdRoute: typeof ProtectedDossiersEngagementsIdRoute\n  ProtectedDossiersForumsIdRoute: typeof ProtectedDossiersForumsIdRoute\n  ProtectedDossiersOrganizationsIdRoute: typeof ProtectedDossiersOrganizationsIdRoute\n  ProtectedDossiersPersonsIdRoute: typeof ProtectedDossiersPersonsIdRoute\n  ProtectedDossiersTopicsIdRoute: typeof ProtectedDossiersTopicsIdRoute\n  ProtectedDossiersWorking_groupsIdRoute: typeof ProtectedDossiersWorking_groupsIdRoute\n  ProtectedDossiersCountriesIndexRoute: typeof ProtectedDossiersCountriesIndexRoute\n  ProtectedDossiersEngagementsIndexRoute: typeof ProtectedDossiersEngagementsIndexRoute\n  ProtectedDossiersForumsIndexRoute: typeof ProtectedDossiersForumsIndexRoute\n  ProtectedDossiersOrganizationsIndexRoute: typeof ProtectedDossiersOrganizationsIndexRoute\n  ProtectedDossiersPersonsIndexRoute: typeof ProtectedDossiersPersonsIndexRoute\n  ProtectedDossiersTopicsIndexRoute: typeof ProtectedDossiersTopicsIndexRoute\n  ProtectedDossiersWorking_groupsIndexRoute: typeof ProtectedDossiersWorking_groupsIndexRoute\n}\n\nconst ProtectedRouteChildren: ProtectedRouteChildren = {\n  ProtectedAccessibilityRoute: ProtectedAccessibilityRoute,\n  ProtectedAdvancedSearchRoute: ProtectedAdvancedSearchRoute,\n  ProtectedAnalyticsRoute: ProtectedAnalyticsRoute,\n  ProtectedAuditLogsRoute: ProtectedAuditLogsRoute,\n  ProtectedBriefsRoute: ProtectedBriefsRoute,\n  ProtectedBulkActionsDemoRoute: ProtectedBulkActionsDemoRoute,\n  ProtectedCalendarRoute: ProtectedCalendarRouteWithChildren,\n  ProtectedCommitmentsRoute: ProtectedCommitmentsRoute,\n  ProtectedContactsRoute: ProtectedContactsRouteWithChildren,\n  ProtectedCountriesRoute: ProtectedCountriesRoute,\n  ProtectedCustomDashboardRoute: ProtectedCustomDashboardRoute,\n  ProtectedDashboardRoute: ProtectedDashboardRoute,\n  ProtectedDataLibraryRoute: ProtectedDataLibraryRoute,\n  ProtectedDelegationsRoute: ProtectedDelegationsRoute,\n  ProtectedEngagementsRoute: ProtectedEngagementsRouteWithChildren,\n  ProtectedEventsRoute: ProtectedEventsRoute,\n  ProtectedExportRoute: ProtectedExportRoute,\n  ProtectedExportImportRoute: ProtectedExportImportRoute,\n  ProtectedForumsRoute: ProtectedForumsRoute,\n  ProtectedIntakeRoute: ProtectedIntakeRouteWithChildren,\n  ProtectedIntelligenceRoute: ProtectedIntelligenceRoute,\n  ProtectedKanbanRoute: ProtectedKanbanRoute,\n  ProtectedModernNavDemoRoute: ProtectedModernNavDemoRoute,\n  ProtectedMonitoringRoute: ProtectedMonitoringRoute,\n  ProtectedMousRoute: ProtectedMousRoute,\n  ProtectedMyWorkRoute: ProtectedMyWorkRouteWithChildren,\n  ProtectedOrganizationsRoute: ProtectedOrganizationsRoute,\n  ProtectedPersonsRoute: ProtectedPersonsRouteWithChildren,\n  ProtectedPositionsRoute: ProtectedPositionsRouteWithChildren,\n  ProtectedPrototypeDossierRoute: ProtectedPrototypeDossierRoute,\n  ProtectedReportsRoute: ProtectedReportsRoute,\n  ProtectedResponsiveDemoRoute: ProtectedResponsiveDemoRoute,\n  ProtectedSearchRoute: ProtectedSearchRoute,\n  ProtectedSettingsRoute: ProtectedSettingsRoute,\n  ProtectedThemesRoute: ProtectedThemesRoute,\n  ProtectedUsersRoute: ProtectedUsersRoute,\n  ProtectedWordAssistantRoute: ProtectedWordAssistantRoute,\n  ProtectedWorkingGroupsRoute: ProtectedWorkingGroupsRoute,\n  ProtectedAdminAiSettingsRoute: ProtectedAdminAiSettingsRoute,\n  ProtectedAdminAiUsageRoute: ProtectedAdminAiUsageRoute,\n  ProtectedAdminApprovalsRoute: ProtectedAdminApprovalsRoute,\n  ProtectedAdminDataRetentionRoute: ProtectedAdminDataRetentionRoute,\n  ProtectedAdminSystemRoute: ProtectedAdminSystemRoute,\n  ProtectedAfterActionsAfterActionIdRoute:\n    ProtectedAfterActionsAfterActionIdRouteWithChildren,\n  ProtectedDossiersIdRoute: ProtectedDossiersIdRoute,\n  ProtectedDossiersCreateRoute: ProtectedDossiersCreateRoute,\n  ProtectedHelpCommitmentsRoute: ProtectedHelpCommitmentsRoute,\n  ProtectedRelationshipsGraphRoute: ProtectedRelationshipsGraphRoute,\n  ProtectedTasksIdRoute: ProtectedTasksIdRoute,\n  ProtectedTasksEscalationsRoute: ProtectedTasksEscalationsRoute,\n  ProtectedTasksQueueRoute: ProtectedTasksQueueRoute,\n  ProtectedAfterActionsIndexRoute: ProtectedAfterActionsIndexRoute,\n  ProtectedApprovalsIndexRoute: ProtectedApprovalsIndexRoute,\n  ProtectedDossiersIndexRoute: ProtectedDossiersIndexRoute,\n  ProtectedHelpIndexRoute: ProtectedHelpIndexRoute,\n  ProtectedTasksIndexRoute: ProtectedTasksIndexRoute,\n  ProtectedDossiersCountriesIdRoute: ProtectedDossiersCountriesIdRoute,\n  ProtectedDossiersEngagementsIdRoute: ProtectedDossiersEngagementsIdRoute,\n  ProtectedDossiersForumsIdRoute: ProtectedDossiersForumsIdRoute,\n  ProtectedDossiersOrganizationsIdRoute: ProtectedDossiersOrganizationsIdRoute,\n  ProtectedDossiersPersonsIdRoute: ProtectedDossiersPersonsIdRoute,\n  ProtectedDossiersTopicsIdRoute: ProtectedDossiersTopicsIdRoute,\n  ProtectedDossiersWorking_groupsIdRoute:\n    ProtectedDossiersWorking_groupsIdRoute,\n  ProtectedDossiersCountriesIndexRoute: ProtectedDossiersCountriesIndexRoute,\n  ProtectedDossiersEngagementsIndexRoute:\n    ProtectedDossiersEngagementsIndexRoute,\n  ProtectedDossiersForumsIndexRoute: ProtectedDossiersForumsIndexRoute,\n  ProtectedDossiersOrganizationsIndexRoute:\n    ProtectedDossiersOrganizationsIndexRoute,\n  ProtectedDossiersPersonsIndexRoute: ProtectedDossiersPersonsIndexRoute,\n  ProtectedDossiersTopicsIndexRoute: ProtectedDossiersTopicsIndexRoute,\n  ProtectedDossiersWorking_groupsIndexRoute:\n    ProtectedDossiersWorking_groupsIndexRoute,\n}\n\nconst ProtectedRouteWithChildren = ProtectedRoute._addFileChildren(\n  ProtectedRouteChildren,\n)\n\nconst rootRouteChildren: RootRouteChildren = {\n  IndexRoute: IndexRoute,\n  ProtectedRoute: ProtectedRouteWithChildren,\n  LoginRoute: LoginRoute,\n  ModernNavStandaloneRoute: ModernNavStandaloneRoute,\n  RegisterRoute: RegisterRoute,\n}\nexport const routeTree = rootRouteImport\n  ._addFileChildren(rootRouteChildren)\n  ._addFileTypes<FileRouteTypes>()\n","import { createRouter, Link } from '@tanstack/react-router'\nimport { routeTree } from '../routeTree.gen'\nimport type { AuthContextValue } from '../contexts/auth.context'\nimport { useTranslation } from 'react-i18next'\nimport { Home, ArrowLeft } from 'lucide-react'\n\ndeclare module '@tanstack/react-router' {\n interface Register {\n router: typeof router\n }\n\n interface RouterContext {\n auth: AuthContextValue\n }\n}\n\nexport const router = createRouter({\n routeTree,\n defaultPreload: 'intent',\n defaultPreloadStaleTime: 0,\n context: {\n auth: undefined!,\n },\n defaultErrorComponent: ({ error, reset }) => (\n <div className=\"from-base-50 to-base-100 flex min-h-screen items-center justify-center bg-gradient-to-br p-4 sm:p-8\">\n <div className=\"border-base-200 w-full max-w-lg rounded-2xl border bg-white p-6 text-center shadow-xl sm:p-8\">\n <h2 className=\"font-display text-xl font-semibold text-red-600 sm:text-2xl\">\n {error?.name ?? 'Application error'}\n </h2>\n <p className=\"text-base-600 mt-4 text-sm sm:text-base\">\n {error?.message ?? 'Something went wrong while loading this page.'}\n </p>\n <button\n type=\"button\"\n onClick={reset}\n className=\"mt-6 rounded-lg bg-primary-600 px-6 py-2 text-sm font-medium text-primary-50 shadow hover:bg-primary-700\"\n >\n Retry\n </button>\n </div>\n </div>\n ),\n defaultNotFoundComponent: () => {\n const { t, i18n } = useTranslation()\n const isRTL = i18n.language === 'ar'\n\n return (\n <div\n className=\"from-base-50 to-base-100 flex min-h-screen items-center justify-center bg-gradient-to-br p-4 sm:p-8\"\n dir={isRTL ? 'rtl' : 'ltr'}\n >\n <div className=\"border-base-200 w-full max-w-lg rounded-2xl border bg-white p-6 text-center shadow-xl sm:p-8\">\n <div className=\"mb-4 inline-flex size-16 items-center justify-center rounded-full bg-amber-100 sm:mb-6 sm:size-20\">\n <span className=\"text-3xl font-bold text-amber-600 sm:text-4xl\">404</span>\n </div>\n\n <h1 className=\"font-display text-base-900 text-xl font-semibold sm:text-2xl md:text-3xl\">\n {t('common.notFound.title', 'Page Not Found')}\n </h1>\n\n <p className=\"text-base-600 mt-3 text-sm sm:mt-4 sm:text-base\">\n {t('common.notFound.message', 'The page you are looking for does not exist or has been moved.')}\n </p>\n\n <div className=\"mt-6 flex flex-col justify-center gap-3 sm:mt-8 sm:flex-row\">\n <Link\n to=\"/\"\n className=\"inline-flex items-center justify-center gap-2 rounded-lg bg-primary-600 px-4 py-2.5 text-sm font-medium text-white shadow transition-colors hover:bg-primary-700 sm:px-6 sm:py-3\"\n >\n <Home className={`size-4 ${isRTL ? 'rotate-0' : ''}`} />\n {t('common.notFound.goHome', 'Go to Home')}\n </Link>\n\n <button\n type=\"button\"\n onClick={() => window.history.back()}\n className=\"border-base-300 text-base-700 hover:bg-base-50 inline-flex items-center justify-center gap-2 rounded-lg border bg-white px-4 py-2.5 text-sm font-medium shadow-sm transition-colors sm:px-6 sm:py-3\"\n >\n <ArrowLeft className={`size-4 ${isRTL ? 'rotate-180' : ''}`} />\n {t('common.notFound.goBack', 'Go Back')}\n </button>\n </div>\n </div>\n </div>\n )\n },\n})\n","import React, { Component, ErrorInfo, ReactNode } from 'react'\nimport { useTranslation } from 'react-i18next'\nimport { Button } from '../ui/button'\nimport { AlertTriangle, RefreshCw, Home, Bug } from 'lucide-react'\n\ninterface Props {\n  children: ReactNode\n  fallback?: ReactNode\n  onError?: (error: Error, errorInfo: ErrorInfo) => void\n  resetOnPropsChange?: boolean\n  resetKeys?: Array<string | number>\n}\n\ninterface State {\n  hasError: boolean\n  error: Error | null\n  errorInfo: ErrorInfo | null\n}\n\nexport class ErrorBoundary extends Component<Props, State> {\n  constructor(props: Props) {\n    super(props)\n    this.state = {\n      hasError: false,\n      error: null,\n      errorInfo: null,\n    }\n  }\n\n  static getDerivedStateFromError(error: Error): State {\n    return {\n      hasError: true,\n      error,\n      errorInfo: null,\n    }\n  }\n\n  componentDidCatch(error: Error, errorInfo: ErrorInfo) {\n    this.setState({\n      error,\n      errorInfo,\n    })\n\n    // Log error to console in development\n    if (process.env.NODE_ENV === 'development') {\n      console.error('ErrorBoundary caught an error:', error, errorInfo)\n    }\n\n    // Call custom error handler\n    this.props.onError?.(error, errorInfo)\n\n    // Log error to external service in production\n    if (process.env.NODE_ENV === 'production') {\n      this.logErrorToService(error, errorInfo)\n    }\n  }\n\n  componentDidUpdate(prevProps: Props) {\n    const { resetKeys, resetOnPropsChange } = this.props\n    const { hasError } = this.state\n\n    if (hasError && resetOnPropsChange) {\n      if (resetKeys && prevProps.resetKeys) {\n        const hasResetKeyChanged = resetKeys.some(\n          (key, index) => key !== prevProps.resetKeys?.[index],\n        )\n        if (hasResetKeyChanged) {\n          this.resetErrorBoundary()\n        }\n      }\n    }\n  }\n\n  resetErrorBoundary = () => {\n    this.setState({\n      hasError: false,\n      error: null,\n      errorInfo: null,\n    })\n  }\n\n  logErrorToService = (error: Error, errorInfo: ErrorInfo) => {\n    // In a real app, you would send this to an error reporting service\n    // like Sentry, LogRocket, or Bugsnag\n    console.error('Error logged to service:', {\n      error: error.message,\n      stack: error.stack,\n      componentStack: errorInfo.componentStack,\n      timestamp: new Date().toISOString(),\n      userAgent: navigator.userAgent,\n      url: window.location.href,\n    })\n  }\n\n  render() {\n    if (this.state.hasError) {\n      if (this.props.fallback) {\n        return this.props.fallback\n      }\n\n      return (\n        <ErrorFallback\n          error={this.state.error}\n          errorInfo={this.state.errorInfo}\n          resetError={this.resetErrorBoundary}\n        />\n      )\n    }\n\n    return this.props.children\n  }\n}\n\ninterface ErrorFallbackProps {\n  error: Error | null\n  errorInfo: ErrorInfo | null\n  resetError: () => void\n}\n\nfunction ErrorFallback({ error, errorInfo, resetError }: ErrorFallbackProps) {\n  const { t } = useTranslation()\n  const [showDetails, setShowDetails] = React.useState(false)\n\n  const handleGoHome = () => {\n    window.location.href = '/'\n  }\n\n  const handleReportError = () => {\n    // In a real app, you would open a bug report form or send to error service\n    const errorReport = {\n      message: error?.message,\n      stack: error?.stack,\n      componentStack: errorInfo?.componentStack,\n      timestamp: new Date().toISOString(),\n      url: window.location.href,\n      userAgent: navigator.userAgent,\n    }\n\n    // In production, send to error tracking service\n    alert('Error report generated. Report ID: ' + Date.now())\n  }\n\n  return (\n    <div className=\"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900 p-4\">\n      <div className=\"max-w-md w-full bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 text-center\">\n        <div className=\"flex justify-center mb-4\">\n          <AlertTriangle className=\"h-16 w-16 text-red-500\" />\n        </div>\n\n        <h1 className=\"text-2xl font-bold text-gray-900 dark:text-white mb-2\">\n          {t('errorBoundary.title')}\n        </h1>\n\n        <p className=\"text-gray-600 dark:text-gray-400 mb-6\">{t('errorBoundary.description')}</p>\n\n        <div className=\"space-y-3\">\n          <Button onClick={resetError} className=\"w-full\">\n            <RefreshCw className=\"h-4 w-4 me-2\" />\n            {t('errorBoundary.refreshPage')}\n          </Button>\n\n          <Button onClick={handleGoHome} variant=\"outline\" className=\"w-full\">\n            <Home className=\"h-4 w-4 me-2\" />\n            {t('errorBoundary.goHome')}\n          </Button>\n\n          <Button onClick={handleReportError} variant=\"ghost\" className=\"w-full\">\n            <Bug className=\"h-4 w-4 me-2\" />\n            {t('errorBoundary.reportError')}\n          </Button>\n        </div>\n\n        {process.env.NODE_ENV === 'development' && (\n          <div className=\"mt-6\">\n            <Button onClick={() => setShowDetails(!showDetails)} variant=\"outline\" size=\"sm\">\n              {showDetails ? 'Hide' : 'Show'} {t('errorBoundary.errorDetails')}\n            </Button>\n\n            {showDetails && (\n              <div className=\"mt-4 p-4 bg-gray-100 dark:bg-gray-700 rounded text-start text-xs overflow-auto max-h-64\">\n                <div className=\"font-mono\">\n                  <div className=\"font-bold text-red-600 mb-2\">Error:</div>\n                  <div className=\"mb-4 text-red-500\">{error?.message}</div>\n\n                  <div className=\"font-bold text-red-600 mb-2\">Stack Trace:</div>\n                  <pre className=\"whitespace-pre-wrap text-red-500 mb-4\">{error?.stack}</pre>\n\n                  <div className=\"font-bold text-red-600 mb-2\">Component Stack:</div>\n                  <pre className=\"whitespace-pre-wrap text-red-500\">\n                    {errorInfo?.componentStack}\n                  </pre>\n                </div>\n              </div>\n            )}\n          </div>\n        )}\n      </div>\n    </div>\n  )\n}\n\n// Hook for functional components to trigger error boundary\nexport function useErrorHandler() {\n  return (error: Error, errorInfo?: ErrorInfo) => {\n    // This will be caught by the nearest ErrorBoundary\n    throw error\n  }\n}\n\n// Higher-order component for easier error boundary wrapping\nexport function withErrorBoundary<P extends object>(\n  Component: React.ComponentType<P>,\n  errorBoundaryProps?: Omit<Props, 'children'>,\n) {\n  const WrappedComponent = (props: P) => (\n    <ErrorBoundary {...errorBoundaryProps}>\n      <Component {...props} />\n    </ErrorBoundary>\n  )\n\n  WrappedComponent.displayName = `withErrorBoundary(${Component.displayName || Component.name})`\n\n  return WrappedComponent\n}\n\nexport default ErrorBoundary\n","import { create } from 'zustand'\nimport { subscribeWithSelector } from 'zustand/middleware'\n\n// Types for offline queue\nexport interface QueuedAction {\n  id: string\n  type: 'api' | 'upload' | 'sync'\n  method: 'GET' | 'POST' | 'PUT' | 'DELETE' | 'PATCH'\n  url: string\n  data?: any\n  headers?: Record<string, string>\n  timestamp: number\n  retryCount: number\n  maxRetries: number\n  priority: 'low' | 'normal' | 'high'\n  status: 'pending' | 'processing' | 'completed' | 'failed'\n  error?: string\n}\n\nexport interface OfflineQueueState {\n  actions: QueuedAction[]\n  isOnline: boolean\n  isProcessing: boolean\n  lastSyncTime: number | null\n}\n\nexport interface OfflineQueueActions {\n  addAction: (action: Omit<QueuedAction, 'id' | 'timestamp' | 'retryCount' | 'status'>) => void\n  removeAction: (id: string) => void\n  updateActionStatus: (id: string, status: QueuedAction['status'], error?: string) => void\n  setOnlineStatus: (isOnline: boolean) => void\n  processQueue: () => Promise<void>\n  clearCompleted: () => void\n  retryFailed: () => void\n  getPendingActions: () => QueuedAction[]\n  getFailedActions: () => QueuedAction[]\n}\n\n// IndexedDB setup\nconst DB_NAME = 'OfflineQueueDB'\nconst DB_VERSION = 1\nconst STORE_NAME = 'queuedActions'\n\nclass IndexedDBManager {\n  private db: IDBDatabase | null = null\n\n  async init(): Promise<void> {\n    return new Promise((resolve, reject) => {\n      const request = indexedDB.open(DB_NAME, DB_VERSION)\n\n      request.onerror = () => reject(request.error)\n      request.onsuccess = () => {\n        this.db = request.result\n        resolve()\n      }\n\n      request.onupgradeneeded = (event) => {\n        const db = (event.target as IDBOpenDBRequest).result\n        if (!db.objectStoreNames.contains(STORE_NAME)) {\n          const store = db.createObjectStore(STORE_NAME, { keyPath: 'id' })\n          store.createIndex('status', 'status', { unique: false })\n          store.createIndex('timestamp', 'timestamp', { unique: false })\n          store.createIndex('priority', 'priority', { unique: false })\n        }\n      }\n    })\n  }\n\n  async saveAction(action: QueuedAction): Promise<void> {\n    if (!this.db) await this.init()\n\n    return new Promise((resolve, reject) => {\n      const transaction = this.db!.transaction([STORE_NAME], 'readwrite')\n      const store = transaction.objectStore(STORE_NAME)\n      const request = store.put(action)\n\n      request.onerror = () => reject(request.error)\n      request.onsuccess = () => resolve()\n    })\n  }\n\n  async getActions(): Promise<QueuedAction[]> {\n    if (!this.db) await this.init()\n\n    return new Promise((resolve, reject) => {\n      const transaction = this.db!.transaction([STORE_NAME], 'readonly')\n      const store = transaction.objectStore(STORE_NAME)\n      const request = store.getAll()\n\n      request.onerror = () => reject(request.error)\n      request.onsuccess = () => resolve(request.result)\n    })\n  }\n\n  async deleteAction(id: string): Promise<void> {\n    if (!this.db) await this.init()\n\n    return new Promise((resolve, reject) => {\n      const transaction = this.db!.transaction([STORE_NAME], 'readwrite')\n      const store = transaction.objectStore(STORE_NAME)\n      const request = store.delete(id)\n\n      request.onerror = () => reject(request.error)\n      request.onsuccess = () => resolve()\n    })\n  }\n\n  async clearCompleted(): Promise<void> {\n    if (!this.db) await this.init()\n\n    return new Promise((resolve, reject) => {\n      const transaction = this.db!.transaction([STORE_NAME], 'readwrite')\n      const store = transaction.objectStore(STORE_NAME)\n      const index = store.index('status')\n      const request = index.openCursor()\n\n      request.onerror = () => reject(request.error)\n      request.onsuccess = (event) => {\n        const cursor = (event.target as IDBRequest).result\n        if (cursor) {\n          if (cursor.value.status === 'completed') {\n            cursor.delete()\n          }\n          cursor.continue()\n        } else {\n          resolve()\n        }\n      }\n    })\n  }\n}\n\nconst dbManager = new IndexedDBManager()\n\n// Zustand store for offline queue\nexport const useOfflineQueue = create<OfflineQueueState & OfflineQueueActions>()(\n  subscribeWithSelector((set, get) => ({\n    actions: [],\n    isOnline: navigator.onLine,\n    isProcessing: false,\n    lastSyncTime: null,\n\n    addAction: async (actionData) => {\n      const action: QueuedAction = {\n        ...actionData,\n        id: crypto.randomUUID(),\n        timestamp: Date.now(),\n        retryCount: 0,\n        status: 'pending'\n      }\n\n      try {\n        await dbManager.saveAction(action)\n        set((state) => ({\n          actions: [...state.actions, action]\n        }))\n      } catch (error) {\n        console.error('Failed to save action to IndexedDB:', error)\n      }\n    },\n\n    removeAction: async (id) => {\n      try {\n        await dbManager.deleteAction(id)\n        set((state) => ({\n          actions: state.actions.filter(action => action.id !== id)\n        }))\n      } catch (error) {\n        console.error('Failed to delete action from IndexedDB:', error)\n      }\n    },\n\n    updateActionStatus: async (id, status, error) => {\n      const action = get().actions.find(a => a.id === id)\n      if (!action) return\n\n      const updatedAction = { ...action, status, error }\n      \n      try {\n        await dbManager.saveAction(updatedAction)\n        set((state) => ({\n          actions: state.actions.map(a => a.id === id ? updatedAction : a)\n        }))\n      } catch (error) {\n        console.error('Failed to update action in IndexedDB:', error)\n      }\n    },\n\n    setOnlineStatus: (isOnline) => {\n      set({ isOnline })\n      if (isOnline) {\n        get().processQueue()\n      }\n    },\n\n    processQueue: async () => {\n      const { actions, isOnline, isProcessing } = get()\n      \n      if (!isOnline || isProcessing) return\n\n      const pendingActions = actions\n        .filter(action => action.status === 'pending')\n        .sort((a, b) => {\n          // Sort by priority first, then by timestamp\n          const priorityOrder = { high: 3, normal: 2, low: 1 }\n          const aPriority = priorityOrder[a.priority]\n          const bPriority = priorityOrder[b.priority]\n          \n          if (aPriority !== bPriority) {\n            return bPriority - aPriority\n          }\n          \n          return a.timestamp - b.timestamp\n        })\n\n      if (pendingActions.length === 0) return\n\n      set({ isProcessing: true })\n\n      for (const action of pendingActions) {\n        try {\n          await get().executeAction(action)\n        } catch (error) {\n          console.error(`Failed to execute action ${action.id}:`, error)\n          await get().updateActionStatus(\n            action.id, \n            'failed', \n            error instanceof Error ? error.message : 'Unknown error'\n          )\n        }\n      }\n\n      set({ isProcessing: false, lastSyncTime: Date.now() })\n    },\n\n    clearCompleted: async () => {\n      try {\n        await dbManager.clearCompleted()\n        set((state) => ({\n          actions: state.actions.filter(action => action.status !== 'completed')\n        }))\n      } catch (error) {\n        console.error('Failed to clear completed actions:', error)\n      }\n    },\n\n    retryFailed: async () => {\n      const failedActions = get().getFailedActions()\n      \n      for (const action of failedActions) {\n        if (action.retryCount < action.maxRetries) {\n          const updatedAction = {\n            ...action,\n            status: 'pending' as const,\n            retryCount: action.retryCount + 1,\n            error: undefined\n          }\n          \n          try {\n            await dbManager.saveAction(updatedAction)\n            set((state) => ({\n              actions: state.actions.map(a => a.id === action.id ? updatedAction : a)\n            }))\n          } catch (error) {\n            console.error('Failed to retry action:', error)\n          }\n        }\n      }\n    },\n\n    getPendingActions: () => {\n      return get().actions.filter(action => action.status === 'pending')\n    },\n\n    getFailedActions: () => {\n      return get().actions.filter(action => action.status === 'failed')\n    }\n  }))\n)\n\n// Action executor\nconst executeAction = async (action: QueuedAction): Promise<void> => {\n  const { updateActionStatus } = useOfflineQueue.getState()\n  \n  try {\n    await updateActionStatus(action.id, 'processing')\n\n    const response = await fetch(action.url, {\n      method: action.method,\n      headers: {\n        'Content-Type': 'application/json',\n        ...action.headers\n      },\n      body: action.data ? JSON.stringify(action.data) : undefined\n    })\n\n    if (!response.ok) {\n      throw new Error(`HTTP ${response.status}: ${response.statusText}`)\n    }\n\n    await updateActionStatus(action.id, 'completed')\n  } catch (error) {\n    const errorMessage = error instanceof Error ? error.message : 'Unknown error'\n    await updateActionStatus(action.id, 'failed', errorMessage)\n    throw error\n  }\n}\n\n// Initialize the store with data from IndexedDB\nconst initializeStore = async () => {\n  try {\n    const actions = await dbManager.getActions()\n    useOfflineQueue.setState({ actions })\n  } catch (error) {\n    console.error('Failed to initialize offline queue from IndexedDB:', error)\n  }\n}\n\n// Set up online/offline listeners\nconst setupNetworkListeners = () => {\n  const { setOnlineStatus } = useOfflineQueue.getState()\n\n  window.addEventListener('online', () => {\n    setOnlineStatus(true)\n  })\n\n  window.addEventListener('offline', () => {\n    setOnlineStatus(false)\n  })\n}\n\n// Initialize when module loads\ninitializeStore()\nsetupNetworkListeners()\n\n// Export utility functions\nexport const addToQueue = (action: Omit<QueuedAction, 'id' | 'timestamp' | 'retryCount' | 'status'>) => {\n  useOfflineQueue.getState().addAction(action)\n}\n\nexport const processQueue = () => {\n  useOfflineQueue.getState().processQueue()\n}\n\nexport const clearCompleted = () => {\n  useOfflineQueue.getState().clearCompleted()\n}\n\nexport const retryFailed = () => {\n  useOfflineQueue.getState().retryFailed()\n}\n\n// Export the store\nexport default useOfflineQueue\n\n","import { useTranslation } from 'react-i18next'\nimport { useOfflineQueue } from '../services/offline-queue'\nimport { Button } from './ui/button'\nimport { Badge } from './ui/badge'\nimport { Wifi, WifiOff, RefreshCw, Clock } from 'lucide-react'\nimport { useState } from 'react'\n\nexport function OfflineIndicator() {\n const { t } = useTranslation()\n const { isOnline, actions, processQueue, retryFailed, clearCompleted } = useOfflineQueue()\n const [showDetails, setShowDetails] = useState(false)\n\n const pendingActions = actions.filter(action => action.status === 'pending')\n const failedActions = actions.filter(action => action.status === 'failed')\n const completedActions = actions.filter(action => action.status === 'completed')\n\n if (isOnline && actions.length === 0) {\n return null\n }\n\n return (\n <div className=\"fixed bottom-4 end-4 z-50\">\n <div className=\"max-w-sm rounded-lg border border-gray-200 bg-white p-4 shadow-lg dark:border-gray-700 dark:bg-gray-800\">\n <div className=\"mb-2 flex items-center justify-between\">\n <div className=\"flex items-center gap-2\">\n {isOnline ? (\n <Wifi className=\"size-4 text-green-500\" />\n ) : (\n <WifiOff className=\"size-4 text-red-500\" />\n )}\n <span className=\"text-sm font-medium\">\n {isOnline ? t('realtime.connected') : t('offline.title')}\n </span>\n </div>\n <Button\n variant=\"ghost\"\n size=\"sm\"\n onClick={() => setShowDetails(!showDetails)}\n >\n {showDetails ? 'Hide' : 'Details'}\n </Button>\n </div>\n\n {!isOnline && (\n <p className=\"mb-3 text-xs text-gray-600 dark:text-gray-400\">\n {t('offline.description')}\n </p>\n )}\n\n {actions.length > 0 && (\n <div className=\"space-y-2\">\n <div className=\"flex items-center gap-2 text-xs\">\n <Badge variant=\"outline\" className=\"text-xs\">\n <Clock className=\"me-1 size-3\" />\n {pendingActions.length} {t('offline.queuedActions')}\n </Badge>\n {failedActions.length > 0 && (\n <Badge variant=\"destructive\" className=\"text-xs\">\n {failedActions.length} Failed\n </Badge>\n )}\n </div>\n\n {showDetails && (\n <div className=\"space-y-2 text-xs\">\n {pendingActions.length > 0 && (\n <div>\n <div className=\"mb-1 font-medium text-gray-700 dark:text-gray-300\">\n Pending Actions:\n </div>\n <div className=\"space-y-1\">\n {pendingActions.slice(0, 3).map((action) => (\n <div key={action.id} className=\"flex items-center justify-between\">\n <span className=\"truncate\">{action.method} {action.url}</span>\n <Badge variant=\"outline\" className=\"text-xs\">\n {action.priority}\n </Badge>\n </div>\n ))}\n {pendingActions.length > 3 && (\n <div className=\"text-gray-500\">\n +{pendingActions.length - 3} more\n </div>\n )}\n </div>\n </div>\n )}\n\n {failedActions.length > 0 && (\n <div>\n <div className=\"mb-1 font-medium text-red-600 dark:text-red-400\">\n Failed Actions:\n </div>\n <div className=\"space-y-1\">\n {failedActions.slice(0, 2).map((action) => (\n <div key={action.id} className=\"text-red-600 dark:text-red-400\">\n {action.method} {action.url}\n {action.error && (\n <div className=\"truncate text-xs text-gray-500\">\n {action.error}\n </div>\n )}\n </div>\n ))}\n {failedActions.length > 2 && (\n <div className=\"text-gray-500\">\n +{failedActions.length - 2} more\n </div>\n )}\n </div>\n </div>\n )}\n\n {completedActions.length > 0 && (\n <div className=\"text-xs text-green-600 dark:text-green-400\">\n {completedActions.length} actions completed\n </div>\n )}\n </div>\n )}\n\n <div className=\"flex gap-2\">\n {isOnline && pendingActions.length > 0 && (\n <Button\n size=\"sm\"\n onClick={processQueue}\n className=\"text-xs\"\n >\n <RefreshCw className=\"me-1 size-3\" />\n {t('offline.retrySync')}\n </Button>\n )}\n \n {failedActions.length > 0 && (\n <Button\n size=\"sm\"\n variant=\"outline\"\n onClick={retryFailed}\n className=\"text-xs\"\n >\n Retry Failed\n </Button>\n )}\n \n {completedActions.length > 0 && (\n <Button\n size=\"sm\"\n variant=\"ghost\"\n onClick={clearCompleted}\n className=\"text-xs\"\n >\n Clear\n </Button>\n )}\n </div>\n </div>\n )}\n </div>\n </div>\n )\n}\n\n","import React from 'react'\nimport type { RealtimeChannel, RealtimePostgresChangesPayload } from '@supabase/supabase-js'\nimport { create } from 'zustand'\nimport { subscribeWithSelector } from 'zustand/middleware'\nimport { supabase } from '../lib/supabase'\n\n// Types for realtime subscriptions\nexport interface RealtimeSubscription {\n  id: string\n  channel: RealtimeChannel\n  table: string\n  event: 'INSERT' | 'UPDATE' | 'DELETE' | '*'\n  callback: (payload: RealtimePostgresChangesPayload<any>) => void\n  status: 'subscribed' | 'unsubscribed' | 'error'\n}\n\nexport interface RealtimeState {\n  isConnected: boolean\n  isConnecting: boolean\n  subscriptions: Map<string, RealtimeSubscription>\n  connectionStatus: 'connected' | 'disconnected' | 'reconnecting' | 'error'\n  lastError: string | null\n}\n\nexport interface RealtimeActions {\n  subscribe: (config: {\n    table: string\n    event: 'INSERT' | 'UPDATE' | 'DELETE' | '*'\n    callback: (payload: RealtimePostgresChangesPayload<any>) => void\n    filter?: string\n  }) => string\n  unsubscribe: (subscriptionId: string) => void\n  unsubscribeAll: () => void\n  reconnect: () => Promise<void>\n  setConnectionStatus: (status: RealtimeState['connectionStatus']) => void\n  setError: (error: string | null) => void\n}\n\ntype RealtimeConnectionState = 'connecting' | 'open' | 'closing' | 'closed'\n\n// Zustand store for realtime state\nexport const useRealtimeStore = create<RealtimeState & RealtimeActions>()(\n  subscribeWithSelector((set, get) => ({\n    isConnected: false,\n    isConnecting: false,\n    subscriptions: new Map(),\n    connectionStatus: 'disconnected',\n    lastError: null,\n\n    subscribe: ({ table, event, callback, filter }) => {\n      const subscriptionId = crypto.randomUUID()\n      const { subscriptions } = get()\n\n      try {\n        const channel = supabase.channel(`${table}-${event}-${subscriptionId}`).on(\n          'postgres_changes' as any,\n          {\n            event,\n            schema: 'public',\n            table,\n            filter,\n          } as any,\n          (payload: any) => {\n            callback(payload)\n          },\n        )\n\n        // Subscribe to the channel\n        channel.subscribe((status) => {\n          const subscription = subscriptions.get(subscriptionId)\n          if (subscription) {\n            subscription.status = status === 'SUBSCRIBED' ? 'subscribed' : 'error'\n            set({ subscriptions: new Map(subscriptions) })\n          }\n        })\n\n        const subscription: RealtimeSubscription = {\n          id: subscriptionId,\n          channel,\n          table,\n          event,\n          callback,\n          status: 'subscribed',\n        }\n\n        subscriptions.set(subscriptionId, subscription)\n        set({ subscriptions: new Map(subscriptions) })\n\n        return subscriptionId\n      } catch (error) {\n        console.error('Failed to create subscription:', error)\n        set({ lastError: error instanceof Error ? error.message : 'Unknown error' })\n        throw error\n      }\n    },\n\n    unsubscribe: (subscriptionId) => {\n      const { subscriptions } = get()\n      const subscription = subscriptions.get(subscriptionId)\n\n      if (subscription) {\n        subscription.channel.unsubscribe()\n        subscriptions.delete(subscriptionId)\n        set({ subscriptions: new Map(subscriptions) })\n      }\n    },\n\n    unsubscribeAll: () => {\n      const { subscriptions } = get()\n\n      subscriptions.forEach((subscription) => {\n        subscription.channel.unsubscribe()\n      })\n\n      subscriptions.clear()\n      set({ subscriptions: new Map(subscriptions) })\n    },\n\n    reconnect: async () => {\n      const { isConnecting } = get()\n      if (isConnecting) return\n\n      set({ isConnecting: true, connectionStatus: 'reconnecting' })\n\n      try {\n        // Reconnect to Supabase\n        await supabase.realtime.connect()\n\n        // Resubscribe to all existing subscriptions\n        const { subscriptions } = get()\n        const newSubscriptions = new Map()\n\n        for (const [id, subscription] of subscriptions) {\n          try {\n            const newChannel = supabase\n              .channel(`${subscription.table}-${subscription.event}-${id}`)\n              .on(\n                'postgres_changes' as any,\n                {\n                  event: subscription.event,\n                  schema: 'public',\n                  table: subscription.table,\n                },\n                subscription.callback,\n              )\n\n            newChannel.subscribe((status) => {\n              subscription.status = status === 'SUBSCRIBED' ? 'subscribed' : 'error'\n              newSubscriptions.set(id, subscription)\n              set({ subscriptions: new Map(newSubscriptions) })\n            })\n\n            subscription.channel = newChannel\n            newSubscriptions.set(id, subscription)\n          } catch (error) {\n            console.error(`Failed to resubscribe to ${subscription.table}:`, error)\n            subscription.status = 'error'\n            newSubscriptions.set(id, subscription)\n          }\n        }\n\n        set({\n          isConnected: true,\n          isConnecting: false,\n          connectionStatus: 'connected',\n          lastError: null,\n          subscriptions: newSubscriptions,\n        })\n      } catch (error) {\n        console.error('Failed to reconnect:', error)\n        set({\n          isConnected: false,\n          isConnecting: false,\n          connectionStatus: 'error',\n          lastError: error instanceof Error ? error.message : 'Unknown error',\n        })\n      }\n    },\n\n    setConnectionStatus: (status) => {\n      set({\n        connectionStatus: status,\n        isConnected: status === 'connected',\n        isConnecting: status === 'reconnecting',\n      })\n    },\n\n    setError: (error) => {\n      set({ lastError: error })\n    },\n  })),\n)\n\n// Connection status monitoring\nconst connectionStateToStatus = (\n  state: RealtimeConnectionState,\n): RealtimeState['connectionStatus'] => {\n  switch (state) {\n    case 'open':\n      return 'connected'\n    case 'connecting':\n      return 'reconnecting'\n    case 'closing':\n    case 'closed':\n    default:\n      return 'disconnected'\n  }\n}\n\nlet teardownConnectionMonitoring: (() => void) | null = null\n\nconst setupConnectionMonitoring = () => {\n  const { setConnectionStatus, setError, reconnect } = useRealtimeStore.getState()\n\n  teardownConnectionMonitoring?.()\n\n  const updateFromRealtime = (state?: RealtimeConnectionState) => {\n    const realtimeState = state ?? (supabase.realtime.connectionState() as RealtimeConnectionState)\n\n    const status = connectionStateToStatus(realtimeState)\n    setConnectionStatus(status)\n    if (status === 'connected') {\n      setError(null)\n    }\n  }\n\n  updateFromRealtime()\n\n  if (typeof supabase.realtime.onHeartbeat === 'function') {\n    supabase.realtime.onHeartbeat((heartbeatStatus) => {\n      if (heartbeatStatus === 'ok') {\n        updateFromRealtime('open')\n      } else if (heartbeatStatus === 'sent') {\n        updateFromRealtime('connecting')\n      } else if (\n        heartbeatStatus === 'timeout' ||\n        heartbeatStatus === 'error' ||\n        heartbeatStatus === 'disconnected'\n      ) {\n        console.error('Realtime heartbeat issue:', heartbeatStatus)\n        setConnectionStatus('error')\n        setError(`Realtime heartbeat ${heartbeatStatus}`)\n        setTimeout(() => {\n          reconnect().catch((error) => {\n            console.error('Failed to reconnect after heartbeat issue:', error)\n            setError(error instanceof Error ? error.message : 'Unknown realtime error')\n          })\n        }, 5000)\n      }\n    })\n  }\n\n  const intervalId = setInterval(() => {\n    updateFromRealtime()\n  }, 3000)\n\n  const handleBeforeUnload = () => {\n    clearInterval(intervalId)\n  }\n\n  if (typeof window !== 'undefined') {\n    window.addEventListener('beforeunload', handleBeforeUnload)\n  }\n\n  teardownConnectionMonitoring = () => {\n    clearInterval(intervalId)\n    if (typeof window !== 'undefined') {\n      window.removeEventListener('beforeunload', handleBeforeUnload)\n    }\n  }\n}\n\n// Initialize connection monitoring\nsetupConnectionMonitoring()\n\n// Hook for easy subscription management\nexport function useRealtimeSubscription() {\n  const { subscribe, unsubscribe, unsubscribeAll, isConnected, connectionStatus } =\n    useRealtimeStore()\n\n  return {\n    subscribe,\n    unsubscribe,\n    unsubscribeAll,\n    isConnected,\n    connectionStatus,\n  }\n}\n\n// Specific hooks for common subscriptions\nexport function useTableSubscription<T extends { [key: string]: any } = any>(\n  table: string,\n  event: 'INSERT' | 'UPDATE' | 'DELETE' | '*',\n  callback: (payload: RealtimePostgresChangesPayload<T>) => void,\n  filter?: string,\n) {\n  const { subscribe, unsubscribe } = useRealtimeStore()\n\n  React.useEffect(() => {\n    const subscriptionId = subscribe({\n      table,\n      event,\n      callback,\n      filter,\n    })\n\n    return () => {\n      unsubscribe(subscriptionId)\n    }\n  }, [table, event, filter, subscribe, unsubscribe])\n}\n\n// Presence management for collaborative features\nexport function usePresence(channelName: string) {\n  const [presence, setPresence] = React.useState<Map<string, any>>(new Map())\n  const [isOnline, setIsOnline] = React.useState(false)\n\n  React.useEffect(() => {\n    const channel = supabase.channel(channelName, {\n      config: {\n        presence: {\n          key: crypto.randomUUID(),\n        },\n      },\n    })\n\n    channel\n      .on('presence', { event: 'sync' }, () => {\n        const newPresence = channel.presenceState()\n        setPresence(new Map(Object.entries(newPresence)))\n      })\n      .on('presence', { event: 'join' }, ({ key: _key, newPresences: _newPresences }) => {\n        // User joined\n      })\n      .on('presence', { event: 'leave' }, ({ key: _key, leftPresences: _leftPresences }) => {\n        // User left\n      })\n      .subscribe(async (status) => {\n        if (status === 'SUBSCRIBED') {\n          await channel.track({\n            user_id: crypto.randomUUID(),\n            online_at: new Date().toISOString(),\n          })\n          setIsOnline(true)\n        } else {\n          setIsOnline(false)\n        }\n      })\n\n    return () => {\n      channel.unsubscribe()\n    }\n  }, [channelName])\n\n  return {\n    presence,\n    isOnline,\n    track: (data: any) => {\n      const channel = supabase.channel(channelName)\n      return channel.track(data)\n    },\n  }\n}\n\n// Export the Supabase client for direct use\nexport { supabase }\n\n// Export utility functions\nexport const getConnectionStatus = () => useRealtimeStore.getState().connectionStatus\nexport const getSubscriptions = () => useRealtimeStore.getState().subscriptions\nexport const isRealtimeConnected = () => useRealtimeStore.getState().isConnected\n\nexport default useRealtimeStore\n","import { createContext, useContext, useEffect, useMemo, type ReactNode } from 'react'\nimport { useAuthStore, type AuthState } from '../store/authStore'\n\nexport type AuthContextValue = Pick<\n AuthState,\n 'user' | 'isAuthenticated' | 'isLoading' | 'error' | 'login' | 'logout' | 'checkAuth' | 'clearError'\n>\n\nconst AuthContext = createContext<AuthContextValue | undefined>(undefined)\n\nexport function AuthProvider({ children }: { children: ReactNode }) {\n const {\n user,\n isAuthenticated,\n isLoading,\n error,\n login,\n logout,\n checkAuth,\n clearError,\n } = useAuthStore()\n\n useEffect(() => {\n void checkAuth()\n }, [checkAuth])\n\n const value = useMemo(\n () => ({ user, isAuthenticated, isLoading, error, login, logout, checkAuth, clearError }),\n [user, isAuthenticated, isLoading, error, login, logout, checkAuth, clearError]\n )\n\n return <AuthContext.Provider value={value}>{children}</AuthContext.Provider>\n}\n\nexport function useAuth() {\n const context = useContext(AuthContext)\n if (!context) {\n throw new Error('useAuth must be used within an AuthProvider')\n }\n return context\n}\n","import { useTranslation } from 'react-i18next'\nimport { useRealtimeStore } from '../services/realtime'\nimport { useAuth } from '../contexts/auth.context'\nimport { Badge } from './ui/badge'\nimport { Button } from './ui/button'\nimport { Wifi, WifiOff, RefreshCw, AlertCircle } from 'lucide-react'\n\nexport function RealtimeStatus() {\n const { t } = useTranslation()\n const auth = useAuth()\n const { connectionStatus, isConnected, reconnect, lastError } = useRealtimeStore()\n\n // Don't show on login page or when not authenticated\n if (!auth?.session) {\n return null\n }\n\n const getStatusIcon = () => {\n switch (connectionStatus) {\n case 'connected':\n return <Wifi className=\"size-4 text-green-500\" />\n case 'disconnected':\n return <WifiOff className=\"size-4 text-gray-500\" />\n case 'reconnecting':\n return <RefreshCw className=\"size-4 animate-spin text-yellow-500\" />\n case 'error':\n return <AlertCircle className=\"size-4 text-red-500\" />\n default:\n return <WifiOff className=\"size-4 text-gray-500\" />\n }\n }\n\n const getStatusText = () => {\n switch (connectionStatus) {\n case 'connected':\n return t('realtime.connected', 'Connected')\n case 'disconnected':\n return t('realtime.disconnected', 'Disconnected')\n case 'reconnecting':\n return t('realtime.reconnecting', 'Reconnecting...')\n case 'error':\n return t('realtime.connectionLost', 'Connection Lost')\n default:\n return t('realtime.disconnected', 'Disconnected')\n }\n }\n\n const getStatusVariant = () => {\n switch (connectionStatus) {\n case 'connected':\n return 'default'\n case 'disconnected':\n return 'secondary'\n case 'reconnecting':\n return 'outline'\n case 'error':\n return 'destructive'\n default:\n return 'secondary'\n }\n }\n\n // Only show if not connected or there's an error\n if (connectionStatus === 'connected') {\n return null\n }\n\n return (\n <div className=\"fixed bottom-4 left-4 z-50 flex items-center gap-2 rounded-lg border border-gray-200 bg-white p-3 shadow-lg dark:border-gray-700 dark:bg-gray-800\">\n <Badge variant={getStatusVariant()} className=\"gap-1\">\n {getStatusIcon()}\n <span>{getStatusText()}</span>\n </Badge>\n\n {connectionStatus === 'error' && (\n <Button\n size=\"sm\"\n variant=\"outline\"\n onClick={reconnect}\n className=\"h-6 px-2 text-xs\"\n >\n <RefreshCw className=\"me-1 size-3\" />\n Retry\n </Button>\n )}\n </div>\n )\n}\n\nexport default RealtimeStatus\n\n","import { useEffect, useMemo, type ReactNode } from 'react'\nimport { getDirection } from '../i18n'\nimport { useUIStore } from '../store/uiStore'\n\ninterface RTLWrapperProps {\n children: ReactNode\n}\n\nexport function RTLWrapper({ children }: RTLWrapperProps) {\n const { language } = useUIStore()\n const direction = useMemo(() => getDirection(language), [language])\n\n useEffect(() => {\n document.documentElement.dir = direction\n document.documentElement.lang = language\n document.body.setAttribute('dir', direction)\n document.body.dataset.language = language\n }, [direction, language])\n\n return (\n <div dir={direction} data-dir={direction} className={direction === 'rtl' ? 'rtl' : 'ltr'}>\n {children}\n </div>\n )\n}\n","import React, { Component, ReactNode, ErrorInfo } from 'react'\n\ninterface Props {\n  children: ReactNode\n  fallbackTheme?: 'canvas' | 'gastat' | 'blueSky'\n  fallbackColorMode?: 'light' | 'dark'\n  fallbackLanguage?: 'en' | 'ar'\n}\n\ninterface State {\n  hasError: boolean\n  error: Error | null\n}\n\nexport class ThemeErrorBoundary extends Component<Props, State> {\n  constructor(props: Props) {\n    super(props)\n    this.state = {\n      hasError: false,\n      error: null,\n    }\n  }\n\n  static getDerivedStateFromError(error: Error): State {\n    return {\n      hasError: true,\n      error,\n    }\n  }\n\n  componentDidCatch(error: Error, errorInfo: ErrorInfo): void {\n    console.error('Theme Provider Error:', error, errorInfo)\n\n    // Apply fallback theme directly to DOM\n    this.applyFallbackTheme()\n  }\n\n  applyFallbackTheme(): void {\n    const {\n      fallbackTheme = 'canvas',\n      fallbackColorMode = 'light',\n      fallbackLanguage = 'en',\n    } = this.props\n\n    const root = document.documentElement\n\n    // Apply theme classes\n    root.classList.remove('theme-canvas', 'theme-gastat', 'theme-blueSky')\n    root.classList.add(`theme-${fallbackTheme}`)\n\n    // Apply color mode\n    root.classList.remove('light', 'dark')\n    root.classList.add(fallbackColorMode)\n\n    // Apply language and direction\n    root.setAttribute('lang', fallbackLanguage)\n    root.setAttribute('dir', fallbackLanguage === 'ar' ? 'rtl' : 'ltr')\n\n    // Clear corrupted localStorage\n    try {\n      localStorage.removeItem('theme-preference')\n    } catch {}\n  }\n\n  handleReset = (): void => {\n    // Clear corrupted state\n    try {\n      localStorage.removeItem('theme-preference')\n    } catch {}\n\n    // Reset error state\n    this.setState({ hasError: false, error: null })\n\n    // Reload the page to reinitialize\n    window.location.reload()\n  }\n\n  render(): ReactNode {\n    if (this.state.hasError) {\n      const isRTL = document.documentElement.getAttribute('dir') === 'rtl'\n\n      return (\n        <div className=\"flex min-h-screen items-center justify-center p-4\">\n          <div className=\"w-full max-w-md rounded-lg border bg-background p-6 shadow-lg\">\n            <h1 className=\"mb-4 text-2xl font-bold text-destructive\">\n              {isRTL ? '   ' : 'Theme System Error'}\n            </h1>\n            <p className=\"mb-4 text-muted-foreground\">\n              {isRTL\n                ? '     .    .'\n                : 'An error occurred loading theme settings. Default theme has been applied.'}\n            </p>\n            {this.state.error && (\n              <details className=\"mb-4\">\n                <summary className=\"cursor-pointer text-sm text-muted-foreground hover:text-foreground\">\n                  {isRTL ? ' ' : 'Error details'}\n                </summary>\n                <pre className=\"mt-2 overflow-auto rounded bg-muted p-2 text-xs\">\n                  {this.state.error.message}\n                </pre>\n              </details>\n            )}\n            <button\n              onClick={this.handleReset}\n              className=\"w-full rounded bg-primary px-4 py-2 text-primary-foreground transition-colors hover:bg-primary/90\"\n            >\n              {isRTL ? '  ' : 'Reload Page'}\n            </button>\n          </div>\n        </div>\n      )\n    }\n\n    return this.props.children\n  }\n}\n","import { RouterProvider } from '@tanstack/react-router'\nimport { QueryClientProvider } from '@tanstack/react-query'\nimport { ReactQueryDevtools } from '@tanstack/react-query-devtools'\nimport { Toaster } from 'react-hot-toast'\nimport { queryClient } from './lib/queryClient'\nimport { router } from './router'\nimport { ErrorBoundary } from './components/error-boundary'\nimport { OfflineIndicator } from './components/OfflineIndicator'\nimport { RealtimeStatus } from './components/RealtimeStatus'\nimport { AuthProvider, useAuth } from './contexts/auth.context'\nimport { RTLWrapper } from './components/RTLWrapper'\nimport { ThemeProvider } from './components/theme-provider/theme-provider'\nimport { LanguageProvider } from './components/language-provider/language-provider'\nimport { ThemeErrorBoundary } from './components/theme-error-boundary'\nimport './i18n'\n\nfunction AppRouter() {\n  const auth = useAuth()\n  return <RouterProvider router={router} context={{ auth }} />\n}\n\nfunction App() {\n  return (\n    <ErrorBoundary>\n      <QueryClientProvider client={queryClient}>\n        <AuthProvider>\n          <ThemeErrorBoundary\n            fallbackTheme=\"canvas\"\n            fallbackColorMode=\"light\"\n            fallbackLanguage=\"en\"\n          >\n            <ThemeProvider initialTheme=\"canvas\" initialColorMode=\"light\">\n              <LanguageProvider initialLanguage=\"en\">\n                <RTLWrapper>\n                  <AppRouter />\n                  <ReactQueryDevtools initialIsOpen={false} />\n                  <OfflineIndicator />\n                  <RealtimeStatus />\n                  <Toaster position=\"top-right\" />\n                </RTLWrapper>\n              </LanguageProvider>\n            </ThemeProvider>\n          </ThemeErrorBoundary>\n        </AuthProvider>\n      </QueryClientProvider>\n    </ErrorBoundary>\n  )\n}\n\nexport default App\n","import { StrictMode } from 'react'\nimport { createRoot } from 'react-dom/client'\nimport { ThemeProvider } from './components/theme-provider/theme-provider'\nimport { LanguageProvider } from './components/language-provider/language-provider'\nimport './index.css'\nimport App from './App.tsx'\n\ncreateRoot(document.getElementById('root')!).render(\n <StrictMode>\n <LanguageProvider>\n <ThemeProvider>\n <App />\n </ThemeProvider>\n </LanguageProvider>\n </StrictMode>,\n)\n"],"file":"assets/index-qYY0KoZ1.js"}