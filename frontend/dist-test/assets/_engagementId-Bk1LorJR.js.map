{"version":3,"file":"_engagementId-Bk1LorJR.js","sources":["../../src/hooks/useEngagementBriefs.ts","../../src/components/engagements/EngagementBriefsSection.tsx","../../src/pages/engagements/EngagementDetailPage.tsx","../../src/routes/_protected/engagements/$engagementId.tsx?tsr-split=component"],"sourcesContent":["/**\n * Engagement Briefs Hooks\n * Feature: engagement-brief-linking\n *\n * TanStack Query hooks for managing briefs linked to engagement dossiers:\n * - List briefs for an engagement\n * - Generate AI briefs with context gathering\n * - Link/unlink existing briefs\n * - Get brief generation context\n */\n\nimport {\n  useMutation,\n  useQuery,\n  useQueryClient,\n  type UseQueryOptions,\n} from '@tanstack/react-query'\nimport { useTranslation } from 'react-i18next'\nimport { toast } from 'sonner'\nimport { supabase } from '@/lib/supabase'\n\n// ============================================================================\n// Types\n// ============================================================================\n\nexport type BriefType = 'legacy' | 'ai'\nexport type BriefStatus = 'completed' | 'generating' | 'failed'\n\nexport interface EngagementBrief {\n  id: string\n  brief_type: BriefType\n  title: string\n  summary: string\n  status: BriefStatus\n  source: 'ai' | 'manual'\n  created_at: string\n  completed_at?: string\n  created_by: string\n  has_citations: boolean\n}\n\nexport interface EngagementBriefsListResponse {\n  data: EngagementBrief[]\n  pagination: {\n    total: number\n    limit: number\n    offset: number\n    has_more: boolean\n  }\n}\n\nexport interface BriefGenerationContext {\n  engagement: {\n    id: string\n    name_en: string\n    name_ar: string\n    engagement_type: string\n    engagement_category: string\n    start_date: string\n    end_date: string\n    objectives_en?: string\n    objectives_ar?: string\n  }\n  participants: Array<{\n    id: string\n    role: string\n    participant_type: string\n    name_en?: string\n    name_ar?: string\n    dossier_id?: string\n    dossier_type?: string\n  }>\n  agenda: Array<{\n    id: string\n    order_number: number\n    title_en: string\n    title_ar?: string\n    description_en?: string\n    item_status: string\n  }>\n  host_country?: {\n    id: string\n    name_en: string\n    name_ar: string\n  }\n  host_organization?: {\n    id: string\n    name_en: string\n    name_ar: string\n  }\n  positions: Array<{\n    id: string\n    title_en: string\n    title_ar?: string\n    stance: string\n    dossier_id: string\n    dossier_name_en: string\n  }>\n  commitments: Array<{\n    id: string\n    title_en: string\n    title_ar?: string\n    status: string\n    deadline?: string\n    source_dossier_id: string\n    source_name_en: string\n  }>\n  recent_interactions: Array<{\n    id: string\n    event_type: string\n    event_title_en: string\n    event_date: string\n    dossier_id: string\n    dossier_name_en: string\n  }>\n  previous_briefs_count: number\n}\n\nexport interface GenerateBriefParams {\n  engagementId: string\n  custom_prompt?: string\n  language?: 'en' | 'ar'\n  date_range_start?: string\n  date_range_end?: string\n}\n\nexport interface LinkBriefParams {\n  engagementId: string\n  briefId: string\n  brief_type: BriefType\n}\n\nexport interface BriefsSearchParams {\n  type?: 'all' | 'legacy' | 'ai'\n  status?: BriefStatus\n  limit?: number\n  offset?: number\n}\n\n// ============================================================================\n// API Base URL\n// ============================================================================\n\nconst API_BASE_URL = import.meta.env.VITE_SUPABASE_URL + '/functions/v1'\n\n// ============================================================================\n// Auth Helper\n// ============================================================================\n\nconst getAuthHeaders = async () => {\n  const {\n    data: { session },\n  } = await supabase.auth.getSession()\n  return {\n    'Content-Type': 'application/json',\n    Authorization: `Bearer ${session?.access_token}`,\n  }\n}\n\n// ============================================================================\n// Query Keys\n// ============================================================================\n\nexport const engagementBriefKeys = {\n  all: ['engagement-briefs'] as const,\n  lists: () => [...engagementBriefKeys.all, 'list'] as const,\n  list: (engagementId: string, params?: BriefsSearchParams) =>\n    [...engagementBriefKeys.lists(), engagementId, params] as const,\n  contexts: () => [...engagementBriefKeys.all, 'context'] as const,\n  context: (engagementId: string) =>\n    [...engagementBriefKeys.contexts(), engagementId] as const,\n}\n\n// ============================================================================\n// Hooks\n// ============================================================================\n\n/**\n * Hook to list briefs for an engagement dossier\n */\nexport function useEngagementBriefs(\n  engagementId: string,\n  params?: BriefsSearchParams,\n  options?: Omit<\n    UseQueryOptions<EngagementBriefsListResponse, Error>,\n    'queryKey' | 'queryFn'\n  >\n) {\n  return useQuery({\n    queryKey: engagementBriefKeys.list(engagementId, params),\n    queryFn: async (): Promise<EngagementBriefsListResponse> => {\n      const headers = await getAuthHeaders()\n      const searchParams = new URLSearchParams()\n\n      if (params?.type) searchParams.set('type', params.type)\n      if (params?.status) searchParams.set('status', params.status)\n      if (params?.limit) searchParams.set('limit', String(params.limit))\n      if (params?.offset) searchParams.set('offset', String(params.offset))\n\n      const response = await fetch(\n        `${API_BASE_URL}/engagement-briefs/${engagementId}?${searchParams}`,\n        { headers }\n      )\n\n      if (!response.ok) {\n        const error = await response.json()\n        throw new Error(error.error?.message_en || 'Failed to fetch briefs')\n      }\n\n      return response.json()\n    },\n    enabled: !!engagementId,\n    staleTime: 30_000,\n    gcTime: 5 * 60_000,\n    ...options,\n  })\n}\n\n/**\n * Hook to get brief generation context for an engagement\n */\nexport function useEngagementBriefContext(\n  engagementId: string,\n  options?: Omit<\n    UseQueryOptions<BriefGenerationContext, Error>,\n    'queryKey' | 'queryFn'\n  >\n) {\n  return useQuery({\n    queryKey: engagementBriefKeys.context(engagementId),\n    queryFn: async (): Promise<BriefGenerationContext> => {\n      const headers = await getAuthHeaders()\n      const response = await fetch(\n        `${API_BASE_URL}/engagement-briefs/${engagementId}/context`,\n        { headers }\n      )\n\n      if (!response.ok) {\n        const error = await response.json()\n        throw new Error(error.error?.message_en || 'Failed to fetch brief context')\n      }\n\n      return response.json()\n    },\n    enabled: !!engagementId,\n    staleTime: 60_000,\n    gcTime: 10 * 60_000,\n    ...options,\n  })\n}\n\n/**\n * Hook to generate a new AI brief for an engagement\n */\nexport function useGenerateEngagementBrief() {\n  const queryClient = useQueryClient()\n  const { t } = useTranslation('engagement-briefs')\n\n  return useMutation({\n    mutationFn: async (params: GenerateBriefParams) => {\n      const headers = await getAuthHeaders()\n      const response = await fetch(\n        `${API_BASE_URL}/engagement-briefs/${params.engagementId}/generate`,\n        {\n          method: 'POST',\n          headers,\n          body: JSON.stringify({\n            custom_prompt: params.custom_prompt,\n            language: params.language,\n            date_range_start: params.date_range_start,\n            date_range_end: params.date_range_end,\n          }),\n        }\n      )\n\n      const data = await response.json()\n\n      if (!response.ok) {\n        // Check if it's a fallback response (AI unavailable)\n        if (data.fallback) {\n          return {\n            success: false,\n            fallback: data.fallback,\n            error: data.error,\n          }\n        }\n        throw new Error(data.error?.message_en || 'Failed to generate brief')\n      }\n\n      return { success: true, brief: data }\n    },\n    onSuccess: (data, params) => {\n      if (data.success) {\n        queryClient.invalidateQueries({\n          queryKey: engagementBriefKeys.list(params.engagementId),\n        })\n        toast.success(t('messages.generated', 'Brief generated successfully'))\n      } else {\n        toast.warning(\n          t('messages.aiUnavailable', 'AI unavailable. Use the template to create a manual brief.')\n        )\n      }\n    },\n    onError: (error: Error) => {\n      toast.error(t('messages.generateError', { error: error.message }))\n    },\n  })\n}\n\n/**\n * Hook to link an existing brief to an engagement\n */\nexport function useLinkBriefToEngagement() {\n  const queryClient = useQueryClient()\n  const { t } = useTranslation('engagement-briefs')\n\n  return useMutation({\n    mutationFn: async (params: LinkBriefParams) => {\n      const headers = await getAuthHeaders()\n      const response = await fetch(\n        `${API_BASE_URL}/engagement-briefs/${params.engagementId}/link/${params.briefId}`,\n        {\n          method: 'POST',\n          headers,\n          body: JSON.stringify({ brief_type: params.brief_type }),\n        }\n      )\n\n      if (!response.ok) {\n        const error = await response.json()\n        throw new Error(error.error?.message_en || 'Failed to link brief')\n      }\n\n      return response.json()\n    },\n    onSuccess: (_, params) => {\n      queryClient.invalidateQueries({\n        queryKey: engagementBriefKeys.list(params.engagementId),\n      })\n      toast.success(t('messages.linked', 'Brief linked successfully'))\n    },\n    onError: (error: Error) => {\n      toast.error(t('messages.linkError', { error: error.message }))\n    },\n  })\n}\n\n/**\n * Hook to unlink a brief from an engagement\n */\nexport function useUnlinkBriefFromEngagement() {\n  const queryClient = useQueryClient()\n  const { t } = useTranslation('engagement-briefs')\n\n  return useMutation({\n    mutationFn: async (params: LinkBriefParams) => {\n      const headers = await getAuthHeaders()\n      const response = await fetch(\n        `${API_BASE_URL}/engagement-briefs/${params.engagementId}/link/${params.briefId}?brief_type=${params.brief_type}`,\n        {\n          method: 'DELETE',\n          headers,\n        }\n      )\n\n      if (!response.ok) {\n        const error = await response.json()\n        throw new Error(error.error?.message_en || 'Failed to unlink brief')\n      }\n\n      return response.json()\n    },\n    onSuccess: (_, params) => {\n      queryClient.invalidateQueries({\n        queryKey: engagementBriefKeys.list(params.engagementId),\n      })\n      toast.success(t('messages.unlinked', 'Brief unlinked successfully'))\n    },\n    onError: (error: Error) => {\n      toast.error(t('messages.unlinkError', { error: error.message }))\n    },\n  })\n}\n\n/**\n * Hook to invalidate all engagement brief queries\n */\nexport function useInvalidateEngagementBriefs() {\n  const queryClient = useQueryClient()\n\n  return (engagementId?: string) => {\n    if (engagementId) {\n      queryClient.invalidateQueries({\n        queryKey: engagementBriefKeys.list(engagementId),\n      })\n      queryClient.invalidateQueries({\n        queryKey: engagementBriefKeys.context(engagementId),\n      })\n    } else {\n      queryClient.invalidateQueries({\n        queryKey: engagementBriefKeys.all,\n      })\n    }\n  }\n}\n","/**\n * Engagement Briefs Section Component\n * Feature: engagement-brief-linking\n *\n * Displays briefs linked to an engagement dossier with:\n * - List of linked briefs (AI and legacy)\n * - Generate new brief with AI\n * - Link existing briefs\n * - Brief context preview\n *\n * Mobile-first, RTL-compatible.\n */\n\nimport { useState } from 'react'\nimport { useTranslation } from 'react-i18next'\nimport { motion, AnimatePresence } from 'framer-motion'\nimport {\n  FileText,\n  Sparkles,\n  Plus,\n  Link,\n  Unlink,\n  RefreshCw,\n  Clock,\n  CheckCircle2,\n  AlertCircle,\n  Loader2,\n  ChevronRight,\n  Quote,\n  Users,\n  Target,\n  Calendar,\n  MessageSquare,\n  Download,\n} from 'lucide-react'\nimport { Button } from '@/components/ui/button'\nimport { Badge } from '@/components/ui/badge'\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from '@/components/ui/card'\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from '@/components/ui/dialog'\nimport { Label } from '@/components/ui/label'\nimport { Textarea } from '@/components/ui/textarea'\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from '@/components/ui/select'\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs'\nimport { Skeleton } from '@/components/ui/skeleton'\nimport {\n  useEngagementBriefs,\n  useEngagementBriefContext,\n  useGenerateEngagementBrief,\n  useUnlinkBriefFromEngagement,\n  type EngagementBrief,\n  type BriefType,\n} from '@/hooks/useEngagementBriefs'\n\ninterface EngagementBriefsSectionProps {\n  engagementId: string\n  engagementName: string\n}\n\nexport function EngagementBriefsSection({\n  engagementId,\n  engagementName,\n}: EngagementBriefsSectionProps) {\n  const { t, i18n } = useTranslation('engagement-briefs')\n  const isRTL = i18n.language === 'ar'\n\n  const [activeTab, setActiveTab] = useState('briefs')\n  const [isGenerateDialogOpen, setIsGenerateDialogOpen] = useState(false)\n  const [generateLanguage, setGenerateLanguage] = useState<'en' | 'ar'>('en')\n  const [customPrompt, setCustomPrompt] = useState('')\n\n  // Fetch briefs and context\n  const { data: briefsData, isLoading: briefsLoading } = useEngagementBriefs(engagementId)\n  const { data: contextData, isLoading: contextLoading, refetch: refetchContext } =\n    useEngagementBriefContext(engagementId)\n\n  // Mutations\n  const generateBrief = useGenerateEngagementBrief()\n  const unlinkBrief = useUnlinkBriefFromEngagement()\n\n  const briefs = briefsData?.data || []\n\n  // Handle generate brief\n  const handleGenerateBrief = async () => {\n    await generateBrief.mutateAsync({\n      engagementId,\n      language: generateLanguage,\n      custom_prompt: customPrompt || undefined,\n    })\n    setIsGenerateDialogOpen(false)\n    setCustomPrompt('')\n  }\n\n  // Handle unlink brief\n  const handleUnlinkBrief = async (briefId: string, briefType: BriefType) => {\n    await unlinkBrief.mutateAsync({\n      engagementId,\n      briefId,\n      brief_type: briefType,\n    })\n  }\n\n  // Get status badge color\n  const getStatusColor = (status: string) => {\n    switch (status) {\n      case 'completed':\n        return 'bg-green-500/10 text-green-600 border-green-200'\n      case 'generating':\n        return 'bg-blue-500/10 text-blue-600 border-blue-200'\n      case 'failed':\n        return 'bg-red-500/10 text-red-600 border-red-200'\n      default:\n        return 'bg-gray-500/10 text-gray-600 border-gray-200'\n    }\n  }\n\n  // Get status icon\n  const getStatusIcon = (status: string) => {\n    switch (status) {\n      case 'completed':\n        return <CheckCircle2 className=\"size-3\" />\n      case 'generating':\n        return <Loader2 className=\"size-3 animate-spin\" />\n      case 'failed':\n        return <AlertCircle className=\"size-3\" />\n      default:\n        return <Clock className=\"size-3\" />\n    }\n  }\n\n  // Format date\n  const formatDate = (dateStr: string) => {\n    return new Date(dateStr).toLocaleDateString(isRTL ? 'ar-SA' : 'en-US', {\n      month: 'short',\n      day: 'numeric',\n      year: 'numeric',\n      hour: '2-digit',\n      minute: '2-digit',\n    })\n  }\n\n  return (\n    <Card dir={isRTL ? 'rtl' : 'ltr'}>\n      <CardHeader>\n        <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4\">\n          <div>\n            <CardTitle className=\"flex items-center gap-2 text-lg\">\n              <FileText className=\"size-5 text-primary\" />\n              {t('title')}\n              {briefs.length > 0 && (\n                <Badge variant=\"secondary\" className=\"ms-2\">\n                  {briefs.length}\n                </Badge>\n              )}\n            </CardTitle>\n            <CardDescription className=\"mt-1\">{t('description')}</CardDescription>\n          </div>\n          <div className=\"flex gap-2\">\n            <Dialog open={isGenerateDialogOpen} onOpenChange={setIsGenerateDialogOpen}>\n              <DialogTrigger asChild>\n                <Button size=\"sm\" className=\"gap-2\">\n                  <Sparkles className=\"size-4\" />\n                  <span className=\"hidden sm:inline\">{t('actions.generateWithAI')}</span>\n                </Button>\n              </DialogTrigger>\n              <DialogContent className=\"max-w-lg\" dir={isRTL ? 'rtl' : 'ltr'}>\n                <DialogHeader>\n                  <DialogTitle className=\"flex items-center gap-2\">\n                    <Sparkles className=\"size-5 text-primary\" />\n                    {t('generateDialog.title')}\n                  </DialogTitle>\n                  <DialogDescription>{t('generateDialog.description')}</DialogDescription>\n                </DialogHeader>\n\n                <div className=\"space-y-4 py-4\">\n                  {/* Context Info */}\n                  {contextData && (\n                    <div className=\"p-3 bg-muted/50 rounded-lg text-sm text-muted-foreground\">\n                      {t('generateDialog.contextInfo', {\n                        participantCount: contextData.participants?.length || 0,\n                        positionCount: contextData.positions?.length || 0,\n                        commitmentCount: contextData.commitments?.length || 0,\n                      })}\n                    </div>\n                  )}\n\n                  {/* Language Selection */}\n                  <div className=\"space-y-2\">\n                    <Label>{t('labels.language')}</Label>\n                    <Select\n                      value={generateLanguage}\n                      onValueChange={(v) => setGenerateLanguage(v as 'en' | 'ar')}\n                    >\n                      <SelectTrigger>\n                        <SelectValue />\n                      </SelectTrigger>\n                      <SelectContent>\n                        <SelectItem value=\"en\">{t('generateDialog.languageEn')}</SelectItem>\n                        <SelectItem value=\"ar\">{t('generateDialog.languageAr')}</SelectItem>\n                      </SelectContent>\n                    </Select>\n                  </div>\n\n                  {/* Custom Prompt */}\n                  <div className=\"space-y-2\">\n                    <Label>{t('labels.customPrompt')}</Label>\n                    <Textarea\n                      placeholder={t('generateDialog.customPromptPlaceholder')}\n                      value={customPrompt}\n                      onChange={(e) => setCustomPrompt(e.target.value)}\n                      rows={3}\n                    />\n                  </div>\n                </div>\n\n                <DialogFooter>\n                  <Button variant=\"outline\" onClick={() => setIsGenerateDialogOpen(false)}>\n                    {t('actions.cancel')}\n                  </Button>\n                  <Button\n                    onClick={handleGenerateBrief}\n                    disabled={generateBrief.isPending}\n                    className=\"gap-2\"\n                  >\n                    {generateBrief.isPending ? (\n                      <>\n                        <Loader2 className=\"size-4 animate-spin\" />\n                        {t('generateDialog.generating')}\n                      </>\n                    ) : (\n                      <>\n                        <Sparkles className=\"size-4\" />\n                        {t('actions.generate')}\n                      </>\n                    )}\n                  </Button>\n                </DialogFooter>\n              </DialogContent>\n            </Dialog>\n          </div>\n        </div>\n      </CardHeader>\n\n      <CardContent>\n        <Tabs value={activeTab} onValueChange={setActiveTab}>\n          <TabsList className=\"w-full sm:w-auto mb-4\">\n            <TabsTrigger value=\"briefs\" className=\"flex-1 sm:flex-none gap-2\">\n              <FileText className=\"size-4\" />\n              {t('tabs.briefs')}\n            </TabsTrigger>\n            <TabsTrigger value=\"context\" className=\"flex-1 sm:flex-none gap-2\">\n              <MessageSquare className=\"size-4\" />\n              {t('tabs.context')}\n            </TabsTrigger>\n          </TabsList>\n\n          {/* Briefs Tab */}\n          <TabsContent value=\"briefs\" className=\"space-y-4\">\n            {briefsLoading ? (\n              <div className=\"space-y-3\">\n                {[1, 2].map((i) => (\n                  <Skeleton key={i} className=\"h-24 w-full\" />\n                ))}\n              </div>\n            ) : briefs.length === 0 ? (\n              <div className=\"text-center py-12\">\n                <FileText className=\"size-12 text-muted-foreground mx-auto mb-4\" />\n                <h3 className=\"text-lg font-medium\">{t('empty.title')}</h3>\n                <p className=\"text-sm text-muted-foreground mt-1\">{t('empty.description')}</p>\n              </div>\n            ) : (\n              <AnimatePresence mode=\"popLayout\">\n                {briefs.map((brief) => (\n                  <BriefCard\n                    key={brief.id}\n                    brief={brief}\n                    onUnlink={(briefType) => handleUnlinkBrief(brief.id, briefType)}\n                    isUnlinking={unlinkBrief.isPending}\n                    isRTL={isRTL}\n                    t={t}\n                    formatDate={formatDate}\n                    getStatusColor={getStatusColor}\n                    getStatusIcon={getStatusIcon}\n                  />\n                ))}\n              </AnimatePresence>\n            )}\n          </TabsContent>\n\n          {/* Context Tab */}\n          <TabsContent value=\"context\" className=\"space-y-4\">\n            <div className=\"flex items-center justify-between mb-4\">\n              <h4 className=\"font-medium\">{t('sections.context')}</h4>\n              <Button\n                variant=\"outline\"\n                size=\"sm\"\n                onClick={() => refetchContext()}\n                disabled={contextLoading}\n                className=\"gap-2\"\n              >\n                <RefreshCw className={`size-4 ${contextLoading ? 'animate-spin' : ''}`} />\n                {t('actions.refresh')}\n              </Button>\n            </div>\n\n            {contextLoading ? (\n              <div className=\"space-y-3\">\n                {[1, 2, 3, 4].map((i) => (\n                  <Skeleton key={i} className=\"h-20 w-full\" />\n                ))}\n              </div>\n            ) : contextData ? (\n              <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\n                {/* Participants */}\n                <ContextCard\n                  icon={Users}\n                  title={t('sections.participants')}\n                  count={contextData.participants?.length || 0}\n                  items={contextData.participants?.slice(0, 3).map((p) => ({\n                    label: p.name_en || p.name_ar || 'Unknown',\n                    sublabel: p.role,\n                  }))}\n                  isRTL={isRTL}\n                />\n\n                {/* Positions */}\n                <ContextCard\n                  icon={Target}\n                  title={t('sections.positions')}\n                  count={contextData.positions?.length || 0}\n                  items={contextData.positions?.slice(0, 3).map((p) => ({\n                    label: p.title_en || p.title_ar || 'Position',\n                    sublabel: p.stance,\n                  }))}\n                  isRTL={isRTL}\n                />\n\n                {/* Commitments */}\n                <ContextCard\n                  icon={CheckCircle2}\n                  title={t('sections.commitments')}\n                  count={contextData.commitments?.length || 0}\n                  items={contextData.commitments?.slice(0, 3).map((c) => ({\n                    label: c.title_en || c.title_ar || 'Commitment',\n                    sublabel: c.status,\n                  }))}\n                  isRTL={isRTL}\n                />\n\n                {/* Recent Interactions */}\n                <ContextCard\n                  icon={Calendar}\n                  title={t('sections.recentInteractions')}\n                  count={contextData.recent_interactions?.length || 0}\n                  items={contextData.recent_interactions?.slice(0, 3).map((r) => ({\n                    label: r.event_title_en || 'Event',\n                    sublabel: new Date(r.event_date).toLocaleDateString(),\n                  }))}\n                  isRTL={isRTL}\n                />\n              </div>\n            ) : (\n              <div className=\"text-center py-8\">\n                <MessageSquare className=\"size-12 text-muted-foreground mx-auto mb-4\" />\n                <h3 className=\"text-lg font-medium\">{t('empty.contextTitle')}</h3>\n                <p className=\"text-sm text-muted-foreground mt-1\">\n                  {t('empty.contextDescription')}\n                </p>\n              </div>\n            )}\n          </TabsContent>\n        </Tabs>\n      </CardContent>\n    </Card>\n  )\n}\n\n// Brief Card Component\ninterface BriefCardProps {\n  brief: EngagementBrief\n  onUnlink: (briefType: BriefType) => void\n  isUnlinking: boolean\n  isRTL: boolean\n  t: (key: string, options?: Record<string, unknown>) => string\n  formatDate: (date: string) => string\n  getStatusColor: (status: string) => string\n  getStatusIcon: (status: string) => React.ReactNode\n}\n\nfunction BriefCard({\n  brief,\n  onUnlink,\n  isUnlinking,\n  isRTL,\n  t,\n  formatDate,\n  getStatusColor,\n  getStatusIcon,\n}: BriefCardProps) {\n  return (\n    <motion.div\n      initial={{ opacity: 0, y: 10 }}\n      animate={{ opacity: 1, y: 0 }}\n      exit={{ opacity: 0, y: -10 }}\n      className=\"border rounded-lg p-4 hover:shadow-md transition-shadow\"\n    >\n      <div className=\"flex flex-col sm:flex-row sm:items-start gap-4\">\n        <div className=\"flex-1 min-w-0\">\n          <div className=\"flex items-center gap-2 flex-wrap mb-2\">\n            <h4 className=\"font-medium truncate\">{brief.title || t('card.viewDetails')}</h4>\n            <Badge variant=\"outline\" className={getStatusColor(brief.status)}>\n              <span className=\"me-1\">{getStatusIcon(brief.status)}</span>\n              {t(`statuses.${brief.status}`)}\n            </Badge>\n            {brief.brief_type === 'ai' && (\n              <Badge variant=\"secondary\" className=\"gap-1\">\n                <Sparkles className=\"size-3\" />\n                {t('briefTypes.ai')}\n              </Badge>\n            )}\n            {brief.has_citations && (\n              <Badge variant=\"outline\" className=\"gap-1\">\n                <Quote className=\"size-3\" />\n              </Badge>\n            )}\n          </div>\n\n          {brief.summary && (\n            <p className=\"text-sm text-muted-foreground line-clamp-2\">{brief.summary}</p>\n          )}\n\n          <div className=\"flex items-center gap-4 mt-2 text-xs text-muted-foreground\">\n            <span className=\"flex items-center gap-1\">\n              <Clock className=\"size-3\" />\n              {formatDate(brief.created_at)}\n            </span>\n            <span>{t(`sources.${brief.source}`)}</span>\n          </div>\n        </div>\n\n        <div className=\"flex gap-2 sm:flex-col\">\n          <Button variant=\"outline\" size=\"sm\" className=\"gap-1 flex-1 sm:flex-none\">\n            <ChevronRight className={`size-4 ${isRTL ? 'rotate-180' : ''}`} />\n            {t('actions.view')}\n          </Button>\n          <Button\n            variant=\"ghost\"\n            size=\"sm\"\n            onClick={() => onUnlink(brief.brief_type)}\n            disabled={isUnlinking}\n            className=\"gap-1 text-destructive hover:text-destructive\"\n          >\n            {isUnlinking ? (\n              <Loader2 className=\"size-4 animate-spin\" />\n            ) : (\n              <Unlink className=\"size-4\" />\n            )}\n            <span className=\"sr-only sm:not-sr-only\">{t('actions.unlink')}</span>\n          </Button>\n        </div>\n      </div>\n    </motion.div>\n  )\n}\n\n// Context Card Component\ninterface ContextCardProps {\n  icon: React.ComponentType<{ className?: string }>\n  title: string\n  count: number\n  items?: Array<{ label: string; sublabel?: string }>\n  isRTL: boolean\n}\n\nfunction ContextCard({ icon: Icon, title, count, items, isRTL }: ContextCardProps) {\n  return (\n    <div className=\"border rounded-lg p-4\">\n      <div className=\"flex items-center justify-between mb-3\">\n        <div className=\"flex items-center gap-2\">\n          <Icon className=\"size-4 text-primary\" />\n          <span className=\"font-medium text-sm\">{title}</span>\n        </div>\n        <Badge variant=\"secondary\">{count}</Badge>\n      </div>\n      {items && items.length > 0 ? (\n        <ul className=\"space-y-2\">\n          {items.map((item, idx) => (\n            <li key={idx} className=\"text-sm\">\n              <span className=\"font-medium\">{item.label}</span>\n              {item.sublabel && (\n                <span className=\"text-muted-foreground text-xs ms-2\">({item.sublabel})</span>\n              )}\n            </li>\n          ))}\n        </ul>\n      ) : (\n        <p className=\"text-sm text-muted-foreground\">No items</p>\n      )}\n    </div>\n  )\n}\n\nexport default EngagementBriefsSection\n","/**\n * Engagement Detail Page\n * Feature: engagements-entity-management\n *\n * Detailed view of an engagement dossier with:\n * - Engagement information (dates, location, type)\n * - Participants list\n * - Agenda items\n * - Outcomes\n *\n * Mobile-first design with RTL support.\n */\n\nimport { useState } from 'react'\nimport { useParams, useNavigate } from '@tanstack/react-router'\nimport { useTranslation } from 'react-i18next'\nimport { motion, AnimatePresence } from 'framer-motion'\nimport {\n  ArrowLeft,\n  Edit,\n  Trash2,\n  Calendar,\n  MapPin,\n  Users,\n  Clock,\n  Video,\n  Globe,\n  Building2,\n  Target,\n  FileText,\n  ChevronDown,\n  ChevronUp,\n  Plus,\n  Loader2,\n  ShieldAlert,\n  Check,\n  X as CloseIcon,\n  User,\n  CheckCircle2,\n} from 'lucide-react'\nimport { Button } from '@/components/ui/button'\nimport { Badge } from '@/components/ui/badge'\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs'\nimport { Avatar, AvatarFallback } from '@/components/ui/avatar'\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n  AlertDialogTrigger,\n} from '@/components/ui/alert-dialog'\nimport { useEngagement, useArchiveEngagement } from '@/hooks/useEngagements'\nimport { EngagementBriefsSection } from '@/components/engagements/EngagementBriefsSection'\nimport type {\n  EngagementStatus,\n  EngagementType,\n  EngagementCategory,\n  DelegationLevel,\n  ParticipantRole,\n  AttendanceStatus,\n  AgendaItemStatus,\n} from '@/types/engagement.types'\nimport {\n  ENGAGEMENT_TYPE_LABELS,\n  ENGAGEMENT_CATEGORY_LABELS,\n  ENGAGEMENT_STATUS_LABELS,\n  DELEGATION_LEVEL_LABELS,\n  PARTICIPANT_ROLE_LABELS,\n  ATTENDANCE_STATUS_LABELS,\n  AGENDA_ITEM_STATUS_LABELS,\n} from '@/types/engagement.types'\n\nexport function EngagementDetailPage() {\n  const { engagementId } = useParams({ from: '/_protected/engagements/$engagementId' })\n  const { t, i18n } = useTranslation('engagements')\n  const isRTL = i18n.language === 'ar'\n  const navigate = useNavigate()\n\n  const [activeTab, setActiveTab] = useState('overview')\n  const [expandedSections, setExpandedSections] = useState<Record<string, boolean>>({\n    participants: true,\n    agenda: true,\n    outcomes: true,\n  })\n\n  // Fetch engagement data\n  const { data: engagementData, isLoading, isError, error } = useEngagement(engagementId)\n  const archiveEngagement = useArchiveEngagement()\n\n  // Toggle section expansion\n  const toggleSection = (section: string) => {\n    setExpandedSections(prev => ({ ...prev, [section]: !prev[section] }))\n  }\n\n  // Navigation handlers\n  const handleBack = () => {\n    navigate({ to: '/engagements' })\n  }\n\n  const handleEdit = () => {\n    navigate({ to: '/engagements/$engagementId/edit', params: { engagementId } })\n  }\n\n  const handleArchive = async () => {\n    await archiveEngagement.mutateAsync(engagementId)\n    navigate({ to: '/engagements' })\n  }\n\n  // Get status badge color\n  const getStatusColor = (status: EngagementStatus) => {\n    switch (status) {\n      case 'completed': return 'bg-green-500/10 text-green-600 border-green-200'\n      case 'in_progress': return 'bg-blue-500/10 text-blue-600 border-blue-200'\n      case 'confirmed': return 'bg-emerald-500/10 text-emerald-600 border-emerald-200'\n      case 'planned': return 'bg-yellow-500/10 text-yellow-600 border-yellow-200'\n      case 'postponed': return 'bg-orange-500/10 text-orange-600 border-orange-200'\n      case 'cancelled': return 'bg-red-500/10 text-red-600 border-red-200'\n      default: return 'bg-gray-500/10 text-gray-600 border-gray-200'\n    }\n  }\n\n  // Get agenda item status color\n  const getAgendaStatusColor = (status: AgendaItemStatus) => {\n    switch (status) {\n      case 'completed': return 'bg-green-500/10 text-green-600 border-green-200'\n      case 'in_progress': return 'bg-blue-500/10 text-blue-600 border-blue-200'\n      case 'planned': return 'bg-gray-500/10 text-gray-600 border-gray-200'\n      case 'skipped': return 'bg-orange-500/10 text-orange-600 border-orange-200'\n      case 'postponed': return 'bg-yellow-500/10 text-yellow-600 border-yellow-200'\n      default: return 'bg-gray-500/10 text-gray-600 border-gray-200'\n    }\n  }\n\n  // Get attendance status color\n  const getAttendanceColor = (status: AttendanceStatus) => {\n    switch (status) {\n      case 'attended': return 'bg-green-500/10 text-green-600'\n      case 'confirmed': return 'bg-emerald-500/10 text-emerald-600'\n      case 'expected': return 'bg-blue-500/10 text-blue-600'\n      case 'tentative': return 'bg-yellow-500/10 text-yellow-600'\n      case 'no_show': return 'bg-red-500/10 text-red-600'\n      case 'cancelled': return 'bg-gray-500/10 text-gray-600'\n      default: return 'bg-gray-500/10 text-gray-600'\n    }\n  }\n\n  // Format date\n  const formatDate = (dateStr: string) => {\n    return new Date(dateStr).toLocaleDateString(isRTL ? 'ar-SA' : 'en-US', {\n      weekday: 'long',\n      year: 'numeric',\n      month: 'long',\n      day: 'numeric',\n    })\n  }\n\n  // Format time\n  const formatTime = (dateStr: string) => {\n    return new Date(dateStr).toLocaleTimeString(isRTL ? 'ar-SA' : 'en-US', {\n      hour: '2-digit',\n      minute: '2-digit',\n    })\n  }\n\n  // Format date range\n  const formatDateRange = (startDate: string, endDate: string) => {\n    const start = new Date(startDate)\n    const end = new Date(endDate)\n\n    if (start.toDateString() === end.toDateString()) {\n      return formatDate(startDate)\n    }\n    return `${formatDate(startDate)} - ${formatDate(endDate)}`\n  }\n\n  // Get initials for avatar\n  const getInitials = (name: string) => {\n    return name\n      .split(' ')\n      .map(n => n[0])\n      .join('')\n      .substring(0, 2)\n      .toUpperCase()\n  }\n\n  // Loading state\n  if (isLoading) {\n    return (\n      <div className=\"flex min-h-96 items-center justify-center\">\n        <Loader2 className=\"size-8 animate-spin text-primary\" />\n      </div>\n    )\n  }\n\n  // Error state\n  if (isError || !engagementData) {\n    return (\n      <div className=\"flex min-h-96 flex-col items-center justify-center gap-4\">\n        <ShieldAlert className=\"size-12 text-destructive\" />\n        <div className=\"text-center\">\n          <h2 className=\"text-xl font-semibold text-foreground\">\n            {t('error.notFound', 'Engagement not found')}\n          </h2>\n          <p className=\"text-sm text-muted-foreground\">\n            {error?.message || t('error.notFoundDescription', 'The engagement you are looking for does not exist')}\n          </p>\n        </div>\n        <Button onClick={handleBack}>\n          <ArrowLeft className=\"h-4 w-4 me-2\" />\n          {t('actions.backToList', 'Back to List')}\n        </Button>\n      </div>\n    )\n  }\n\n  const engagement = engagementData.engagement\n  const name = isRTL ? engagement.name_ar : engagement.name_en\n  const description = isRTL ? engagement.description_ar : engagement.description_en\n  const location = isRTL ? engagement.location_ar : engagement.location_en\n  const venue = isRTL ? engagement.venue_ar : engagement.venue_en\n  const objectives = isRTL ? engagement.objectives_ar : engagement.objectives_en\n  const outcomes = isRTL ? engagement.outcomes_ar : engagement.outcomes_en\n  const notes = isRTL ? engagement.notes_ar : engagement.notes_en\n\n  return (\n    <div className=\"min-h-screen bg-background\" dir={isRTL ? 'rtl' : 'ltr'}>\n      {/* Header */}\n      <header className=\"border-b bg-background sticky top-0 z-10\">\n        <div className=\"container mx-auto px-4 sm:px-6 lg:px-8 py-4\">\n          <div className=\"flex items-center justify-between gap-4\">\n            <div className=\"flex items-center gap-4\">\n              <Button variant=\"ghost\" size=\"icon\" onClick={handleBack} className=\"h-10 w-10\">\n                <ArrowLeft className={`h-5 w-5 ${isRTL ? 'rotate-180' : ''}`} />\n              </Button>\n              <div>\n                <div className=\"flex items-center gap-2 flex-wrap\">\n                  <h1 className=\"text-xl sm:text-2xl font-bold\">{name}</h1>\n                  <Badge\n                    variant=\"outline\"\n                    className={getStatusColor(engagement.engagement_status)}\n                  >\n                    {isRTL\n                      ? ENGAGEMENT_STATUS_LABELS[engagement.engagement_status].ar\n                      : ENGAGEMENT_STATUS_LABELS[engagement.engagement_status].en}\n                  </Badge>\n                </div>\n                <p className=\"text-sm text-muted-foreground\">\n                  {isRTL\n                    ? ENGAGEMENT_TYPE_LABELS[engagement.engagement_type].ar\n                    : ENGAGEMENT_TYPE_LABELS[engagement.engagement_type].en}\n                </p>\n              </div>\n            </div>\n\n            <div className=\"flex gap-2\">\n              <Button variant=\"outline\" size=\"sm\" onClick={handleEdit}>\n                <Edit className=\"h-4 w-4 sm:me-2\" />\n                <span className=\"hidden sm:inline\">{t('actions.edit', 'Edit')}</span>\n              </Button>\n              <AlertDialog>\n                <AlertDialogTrigger asChild>\n                  <Button variant=\"outline\" size=\"sm\" className=\"text-destructive hover:text-destructive\">\n                    <Trash2 className=\"h-4 w-4\" />\n                  </Button>\n                </AlertDialogTrigger>\n                <AlertDialogContent>\n                  <AlertDialogHeader>\n                    <AlertDialogTitle>{t('archive.title', 'Archive Engagement?')}</AlertDialogTitle>\n                    <AlertDialogDescription>\n                      {t('archive.description', 'This will archive the engagement and hide it from the list. This action can be undone.')}\n                    </AlertDialogDescription>\n                  </AlertDialogHeader>\n                  <AlertDialogFooter>\n                    <AlertDialogCancel>{t('actions.cancel', 'Cancel')}</AlertDialogCancel>\n                    <AlertDialogAction\n                      onClick={handleArchive}\n                      className=\"bg-destructive text-destructive-foreground hover:bg-destructive/90\"\n                    >\n                      {archiveEngagement.isPending && <Loader2 className=\"h-4 w-4 animate-spin me-2\" />}\n                      {t('actions.archive', 'Archive')}\n                    </AlertDialogAction>\n                  </AlertDialogFooter>\n                </AlertDialogContent>\n              </AlertDialog>\n            </div>\n          </div>\n        </div>\n      </header>\n\n      {/* Content */}\n      <main className=\"container mx-auto px-4 sm:px-6 lg:px-8 py-6\">\n        <Tabs value={activeTab} onValueChange={setActiveTab} className=\"space-y-6\">\n          <TabsList className=\"w-full sm:w-auto\">\n            <TabsTrigger value=\"overview\" className=\"flex-1 sm:flex-none\">\n              {t('tabs.overview', 'Overview')}\n            </TabsTrigger>\n            <TabsTrigger value=\"participants\" className=\"flex-1 sm:flex-none\">\n              {t('tabs.participants', 'Participants')}\n            </TabsTrigger>\n            <TabsTrigger value=\"agenda\" className=\"flex-1 sm:flex-none\">\n              {t('tabs.agenda', 'Agenda')}\n            </TabsTrigger>\n            <TabsTrigger value=\"outcomes\" className=\"flex-1 sm:flex-none\">\n              {t('tabs.outcomes', 'Outcomes')}\n            </TabsTrigger>\n            <TabsTrigger value=\"briefs\" className=\"flex-1 sm:flex-none\">\n              {t('tabs.briefs', 'Briefs')}\n            </TabsTrigger>\n          </TabsList>\n\n          {/* Overview Tab */}\n          <TabsContent value=\"overview\" className=\"space-y-6\">\n            <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n              {/* Details Card */}\n              <Card className=\"lg:col-span-1\">\n                <CardHeader>\n                  <CardTitle className=\"text-lg\">{t('sections.details', 'Details')}</CardTitle>\n                </CardHeader>\n                <CardContent className=\"space-y-4\">\n                  {/* Type & Category */}\n                  <div className=\"space-y-2\">\n                    <div className=\"flex items-center gap-2\">\n                      <Calendar className=\"h-4 w-4 text-muted-foreground\" />\n                      <span className=\"text-sm\">\n                        {isRTL\n                          ? ENGAGEMENT_TYPE_LABELS[engagement.engagement_type].ar\n                          : ENGAGEMENT_TYPE_LABELS[engagement.engagement_type].en}\n                      </span>\n                    </div>\n                    <Badge variant=\"secondary\">\n                      {isRTL\n                        ? ENGAGEMENT_CATEGORY_LABELS[engagement.engagement_category].ar\n                        : ENGAGEMENT_CATEGORY_LABELS[engagement.engagement_category].en}\n                    </Badge>\n                  </div>\n\n                  {/* Dates */}\n                  <div className=\"pt-4 border-t\">\n                    <h4 className=\"text-sm font-medium mb-2 flex items-center gap-2\">\n                      <Clock className=\"h-4 w-4 text-muted-foreground\" />\n                      {t('sections.schedule', 'Schedule')}\n                    </h4>\n                    <p className=\"text-sm text-muted-foreground\">\n                      {formatDateRange(engagement.start_date, engagement.end_date)}\n                    </p>\n                    <p className=\"text-xs text-muted-foreground mt-1\">\n                      {formatTime(engagement.start_date)} - {formatTime(engagement.end_date)}\n                    </p>\n                  </div>\n\n                  {/* Location */}\n                  <div className=\"pt-4 border-t\">\n                    <h4 className=\"text-sm font-medium mb-2 flex items-center gap-2\">\n                      {engagement.is_virtual ? (\n                        <Video className=\"h-4 w-4 text-muted-foreground\" />\n                      ) : (\n                        <MapPin className=\"h-4 w-4 text-muted-foreground\" />\n                      )}\n                      {t('sections.location', 'Location')}\n                    </h4>\n                    {engagement.is_virtual ? (\n                      <div>\n                        <Badge variant=\"outline\" className=\"mb-2\">\n                          <Video className=\"h-3 w-3 me-1\" />\n                          {t('card.virtual', 'Virtual')}\n                        </Badge>\n                        {engagement.virtual_link && (\n                          <a\n                            href={engagement.virtual_link}\n                            target=\"_blank\"\n                            rel=\"noopener noreferrer\"\n                            className=\"text-sm text-primary hover:underline block truncate\"\n                          >\n                            {engagement.virtual_link}\n                          </a>\n                        )}\n                      </div>\n                    ) : (\n                      <div className=\"space-y-1\">\n                        {location && <p className=\"text-sm\">{location}</p>}\n                        {venue && <p className=\"text-xs text-muted-foreground\">{venue}</p>}\n                      </div>\n                    )}\n                  </div>\n\n                  {/* Host Info */}\n                  {(engagementData.host_country || engagementData.host_organization) && (\n                    <div className=\"pt-4 border-t\">\n                      <h4 className=\"text-sm font-medium mb-2 flex items-center gap-2\">\n                        <Building2 className=\"h-4 w-4 text-muted-foreground\" />\n                        {t('form.hostOrganization', 'Host')}\n                      </h4>\n                      {engagementData.host_country && (\n                        <div className=\"flex items-center gap-2 text-sm\">\n                          <Globe className=\"h-3 w-3 text-muted-foreground\" />\n                          {isRTL\n                            ? engagementData.host_country.name_ar\n                            : engagementData.host_country.name_en}\n                        </div>\n                      )}\n                      {engagementData.host_organization && (\n                        <div className=\"flex items-center gap-2 text-sm mt-1\">\n                          <Building2 className=\"h-3 w-3 text-muted-foreground\" />\n                          {isRTL\n                            ? engagementData.host_organization.name_ar\n                            : engagementData.host_organization.name_en}\n                        </div>\n                      )}\n                    </div>\n                  )}\n\n                  {/* Delegation Info */}\n                  {(engagement.delegation_level || engagement.delegation_size) && (\n                    <div className=\"pt-4 border-t\">\n                      <h4 className=\"text-sm font-medium mb-2 flex items-center gap-2\">\n                        <Users className=\"h-4 w-4 text-muted-foreground\" />\n                        {t('sections.delegation', 'Delegation')}\n                      </h4>\n                      {engagement.delegation_level && (\n                        <p className=\"text-sm\">\n                          {isRTL\n                            ? DELEGATION_LEVEL_LABELS[engagement.delegation_level].ar\n                            : DELEGATION_LEVEL_LABELS[engagement.delegation_level].en}\n                        </p>\n                      )}\n                      {engagement.delegation_size && (\n                        <p className=\"text-xs text-muted-foreground\">\n                          {t('form.delegationSize', 'Delegation Size')}: {engagement.delegation_size}\n                        </p>\n                      )}\n                    </div>\n                  )}\n                </CardContent>\n              </Card>\n\n              {/* Main Content */}\n              <div className=\"lg:col-span-2 space-y-6\">\n                {/* Description */}\n                {description && (\n                  <Card>\n                    <CardHeader>\n                      <CardTitle className=\"text-lg\">{t('form.descriptionEn', 'Description')}</CardTitle>\n                    </CardHeader>\n                    <CardContent>\n                      <p className=\"text-sm text-muted-foreground whitespace-pre-wrap\">{description}</p>\n                    </CardContent>\n                  </Card>\n                )}\n\n                {/* Objectives */}\n                {objectives && (\n                  <Card>\n                    <CardHeader>\n                      <CardTitle className=\"flex items-center gap-2 text-lg\">\n                        <Target className=\"h-5 w-5 text-primary\" />\n                        {t('sections.objectives', 'Objectives')}\n                      </CardTitle>\n                    </CardHeader>\n                    <CardContent>\n                      <p className=\"text-sm text-muted-foreground whitespace-pre-wrap\">{objectives}</p>\n                    </CardContent>\n                  </Card>\n                )}\n\n                {/* Quick Stats */}\n                <div className=\"grid grid-cols-3 gap-4\">\n                  <Card>\n                    <CardContent className=\"pt-6 text-center\">\n                      <Users className=\"h-6 w-6 text-primary mx-auto mb-2\" />\n                      <p className=\"text-2xl font-bold\">{engagementData.participants?.length || 0}</p>\n                      <p className=\"text-xs text-muted-foreground\">{t('stats.participants', 'Participants')}</p>\n                    </CardContent>\n                  </Card>\n                  <Card>\n                    <CardContent className=\"pt-6 text-center\">\n                      <FileText className=\"h-6 w-6 text-primary mx-auto mb-2\" />\n                      <p className=\"text-2xl font-bold\">{engagementData.agenda?.length || 0}</p>\n                      <p className=\"text-xs text-muted-foreground\">{t('stats.agendaItems', 'Agenda Items')}</p>\n                    </CardContent>\n                  </Card>\n                  <Card>\n                    <CardContent className=\"pt-6 text-center\">\n                      <CheckCircle2 className=\"h-6 w-6 text-primary mx-auto mb-2\" />\n                      <p className=\"text-2xl font-bold\">\n                        {engagementData.agenda?.filter(a => a.item_status === 'completed').length || 0}\n                      </p>\n                      <p className=\"text-xs text-muted-foreground\">{t('stats.completed', 'Completed')}</p>\n                    </CardContent>\n                  </Card>\n                </div>\n              </div>\n            </div>\n          </TabsContent>\n\n          {/* Participants Tab */}\n          <TabsContent value=\"participants\" className=\"space-y-6\">\n            <Card>\n              <CardHeader>\n                <div className=\"flex items-center justify-between\">\n                  <CardTitle className=\"flex items-center gap-2 text-lg\">\n                    <Users className=\"h-5 w-5 text-primary\" />\n                    {t('sections.participants', 'Participants')}\n                    <Badge variant=\"secondary\" className=\"ms-2\">\n                      {engagementData.participants?.length || 0}\n                    </Badge>\n                  </CardTitle>\n                  <Button variant=\"outline\" size=\"sm\">\n                    <Plus className=\"h-4 w-4 me-2\" />\n                    {t('actions.addParticipant', 'Add Participant')}\n                  </Button>\n                </div>\n              </CardHeader>\n              <CardContent>\n                {engagementData.participants && engagementData.participants.length > 0 ? (\n                  <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\n                    {engagementData.participants.map((item) => {\n                      const participant = item.participant\n                      const participantName = participant.participant_dossier_id && item.dossier_info\n                        ? (isRTL ? item.dossier_info.name_ar : item.dossier_info.name_en)\n                        : (isRTL ? participant.external_name_ar : participant.external_name_en) || ''\n\n                      return (\n                        <Card key={participant.id} className=\"hover:shadow-md transition-shadow\">\n                          <CardContent className=\"p-4\">\n                            <div className=\"flex items-center gap-3\">\n                              <Avatar className=\"h-10 w-10\">\n                                <AvatarFallback className=\"bg-primary/10 text-primary text-sm\">\n                                  {participantName ? getInitials(participantName) : <User className=\"h-4 w-4\" />}\n                                </AvatarFallback>\n                              </Avatar>\n                              <div className=\"flex-1 min-w-0\">\n                                <p className=\"font-medium text-sm truncate\">{participantName}</p>\n                                <div className=\"flex items-center gap-2 mt-1\">\n                                  <Badge variant=\"outline\" className=\"text-xs\">\n                                    {isRTL\n                                      ? PARTICIPANT_ROLE_LABELS[participant.role].ar\n                                      : PARTICIPANT_ROLE_LABELS[participant.role].en}\n                                  </Badge>\n                                  <Badge className={`text-xs ${getAttendanceColor(participant.attendance_status)}`}>\n                                    {isRTL\n                                      ? ATTENDANCE_STATUS_LABELS[participant.attendance_status].ar\n                                      : ATTENDANCE_STATUS_LABELS[participant.attendance_status].en}\n                                  </Badge>\n                                </div>\n                                {participant.external_title_en && (\n                                  <p className=\"text-xs text-muted-foreground mt-1\">\n                                    {isRTL ? participant.external_title_ar : participant.external_title_en}\n                                  </p>\n                                )}\n                              </div>\n                            </div>\n                          </CardContent>\n                        </Card>\n                      )\n                    })}\n                  </div>\n                ) : (\n                  <div className=\"text-center py-8\">\n                    <Users className=\"h-12 w-12 text-muted-foreground mx-auto mb-4\" />\n                    <p className=\"text-sm text-muted-foreground\">\n                      {t('empty.participants', 'No participants added')}\n                    </p>\n                    <p className=\"text-xs text-muted-foreground mt-1\">\n                      {t('empty.participantsDescription', 'Add participants to this engagement')}\n                    </p>\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          {/* Agenda Tab */}\n          <TabsContent value=\"agenda\" className=\"space-y-6\">\n            <Card>\n              <CardHeader>\n                <div className=\"flex items-center justify-between\">\n                  <CardTitle className=\"flex items-center gap-2 text-lg\">\n                    <FileText className=\"h-5 w-5 text-primary\" />\n                    {t('sections.agenda', 'Agenda')}\n                    <Badge variant=\"secondary\" className=\"ms-2\">\n                      {engagementData.agenda?.length || 0}\n                    </Badge>\n                  </CardTitle>\n                  <Button variant=\"outline\" size=\"sm\">\n                    <Plus className=\"h-4 w-4 me-2\" />\n                    {t('actions.addAgendaItem', 'Add Agenda Item')}\n                  </Button>\n                </div>\n              </CardHeader>\n              <CardContent>\n                {engagementData.agenda && engagementData.agenda.length > 0 ? (\n                  <div className=\"space-y-4\">\n                    {engagementData.agenda\n                      .sort((a, b) => a.order_number - b.order_number)\n                      .map((item, idx) => (\n                        <div\n                          key={item.id}\n                          className={`flex gap-4 ${idx < engagementData.agenda.length - 1 ? 'pb-4 border-b' : ''}`}\n                        >\n                          <div className=\"flex flex-col items-center\">\n                            <div className=\"h-8 w-8 rounded-full bg-primary/10 flex items-center justify-center text-sm font-medium text-primary\">\n                              {item.order_number}\n                            </div>\n                            {idx < engagementData.agenda.length - 1 && (\n                              <div className=\"w-0.5 flex-1 bg-border mt-2\" />\n                            )}\n                          </div>\n                          <div className=\"flex-1 pb-2\">\n                            <div className=\"flex items-start justify-between gap-2\">\n                              <div>\n                                <h4 className=\"font-medium\">\n                                  {isRTL ? item.title_ar || item.title_en : item.title_en}\n                                </h4>\n                                {(item.description_en || item.description_ar) && (\n                                  <p className=\"text-sm text-muted-foreground mt-1\">\n                                    {isRTL ? item.description_ar : item.description_en}\n                                  </p>\n                                )}\n                              </div>\n                              <Badge\n                                variant=\"outline\"\n                                className={getAgendaStatusColor(item.item_status)}\n                              >\n                                {isRTL\n                                  ? AGENDA_ITEM_STATUS_LABELS[item.item_status].ar\n                                  : AGENDA_ITEM_STATUS_LABELS[item.item_status].en}\n                              </Badge>\n                            </div>\n                            {(item.start_time || item.duration_minutes) && (\n                              <div className=\"flex items-center gap-2 mt-2 text-xs text-muted-foreground\">\n                                <Clock className=\"h-3 w-3\" />\n                                {item.start_time && (\n                                  <span>{formatTime(item.start_time)}</span>\n                                )}\n                                {item.duration_minutes && (\n                                  <span>({item.duration_minutes} {t('form.agenda.duration', 'min')})</span>\n                                )}\n                              </div>\n                            )}\n                            {(item.outcome_en || item.outcome_ar) && (\n                              <div className=\"mt-2 p-2 bg-muted/50 rounded-lg\">\n                                <p className=\"text-xs font-medium text-muted-foreground mb-1\">\n                                  {t('form.agenda.outcomeEn', 'Outcome')}:\n                                </p>\n                                <p className=\"text-sm\">\n                                  {isRTL ? item.outcome_ar : item.outcome_en}\n                                </p>\n                              </div>\n                            )}\n                          </div>\n                        </div>\n                      ))}\n                  </div>\n                ) : (\n                  <div className=\"text-center py-8\">\n                    <FileText className=\"h-12 w-12 text-muted-foreground mx-auto mb-4\" />\n                    <p className=\"text-sm text-muted-foreground\">\n                      {t('empty.agenda', 'No agenda items')}\n                    </p>\n                    <p className=\"text-xs text-muted-foreground mt-1\">\n                      {t('empty.agendaDescription', 'Add agenda items to organize this engagement')}\n                    </p>\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          {/* Outcomes Tab */}\n          <TabsContent value=\"outcomes\" className=\"space-y-6\">\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2 text-lg\">\n                  <CheckCircle2 className=\"h-5 w-5 text-primary\" />\n                  {t('sections.outcomes', 'Outcomes')}\n                </CardTitle>\n              </CardHeader>\n              <CardContent>\n                {outcomes ? (\n                  <p className=\"text-sm text-muted-foreground whitespace-pre-wrap\">{outcomes}</p>\n                ) : (\n                  <div className=\"text-center py-8\">\n                    <CheckCircle2 className=\"h-12 w-12 text-muted-foreground mx-auto mb-4\" />\n                    <p className=\"text-sm text-muted-foreground\">\n                      {t('empty.outcomes', 'No outcomes recorded yet')}\n                    </p>\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n\n            {/* Notes */}\n            {notes && (\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2 text-lg\">\n                    <FileText className=\"h-5 w-5 text-primary\" />\n                    {t('sections.notes', 'Notes')}\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <p className=\"text-sm text-muted-foreground whitespace-pre-wrap\">{notes}</p>\n                </CardContent>\n              </Card>\n            )}\n          </TabsContent>\n\n          {/* Briefs Tab */}\n          <TabsContent value=\"briefs\" className=\"space-y-6\">\n            <EngagementBriefsSection\n              engagementId={engagementId}\n              engagementName={name}\n            />\n          </TabsContent>\n        </Tabs>\n      </main>\n    </div>\n  )\n}\n\nexport default EngagementDetailPage\n","/**\n * Engagement Detail Route\n * Feature: engagements-entity-management\n *\n * Route for viewing an engagement dossier's details.\n * Mobile-first, RTL-compatible.\n */\n\nimport { createFileRoute } from '@tanstack/react-router'\nimport EngagementDetailPage from '@/pages/engagements/EngagementDetailPage'\n\nexport const Route = createFileRoute('/_protected/engagements/$engagementId')({\n  component: EngagementDetailPage,\n})\n"],"names":["API_BASE_URL","getAuthHeaders","session","supabase","engagementBriefKeys","engagementId","params","useEngagementBriefs","options","useQuery","headers","searchParams","response","error","useEngagementBriefContext","useGenerateEngagementBrief","queryClient","useQueryClient","t","useTranslation","useMutation","data","toast","useUnlinkBriefFromEngagement","_","EngagementBriefsSection","engagementName","i18n","isRTL","activeTab","setActiveTab","useState","isGenerateDialogOpen","setIsGenerateDialogOpen","generateLanguage","setGenerateLanguage","customPrompt","setCustomPrompt","briefsData","briefsLoading","contextData","contextLoading","refetchContext","generateBrief","unlinkBrief","briefs","handleGenerateBrief","handleUnlinkBrief","briefId","briefType","getStatusColor","status","getStatusIcon","jsx","CheckCircle2","Loader2","AlertCircle","Clock","formatDate","dateStr","jsxs","Card","CardHeader","CardTitle","FileText","Badge","CardDescription","Dialog","DialogTrigger","Button","Sparkles","DialogContent","DialogHeader","DialogTitle","DialogDescription","Label","Select","v","SelectTrigger","SelectValue","SelectContent","SelectItem","Textarea","e","DialogFooter","Fragment","CardContent","Tabs","TabsList","TabsTrigger","MessageSquare","TabsContent","i","Skeleton","AnimatePresence","brief","BriefCard","RefreshCw","ContextCard","Users","p","Target","c","Calendar","r","onUnlink","isUnlinking","motion","Quote","ChevronRight","Unlink","Icon","title","count","items","item","idx","EngagementDetailPage","useParams","navigate","useNavigate","expandedSections","setExpandedSections","engagementData","isLoading","isError","useEngagement","archiveEngagement","useArchiveEngagement","handleBack","handleEdit","handleArchive","getAgendaStatusColor","getAttendanceColor","formatTime","formatDateRange","startDate","endDate","start","end","getInitials","name","n","ShieldAlert","ArrowLeft","engagement","description","location","venue","objectives","outcomes","notes","ENGAGEMENT_STATUS_LABELS","ENGAGEMENT_TYPE_LABELS","Edit","AlertDialog","AlertDialogTrigger","Trash2","AlertDialogContent","AlertDialogHeader","AlertDialogTitle","AlertDialogDescription","AlertDialogFooter","AlertDialogCancel","AlertDialogAction","ENGAGEMENT_CATEGORY_LABELS","Video","MapPin","Building2","Globe","DELEGATION_LEVEL_LABELS","a","Plus","participant","participantName","Avatar","AvatarFallback","User","PARTICIPANT_ROLE_LABELS","ATTENDANCE_STATUS_LABELS","b","AGENDA_ITEM_STATUS_LABELS","SplitComponent"],"mappings":"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"}