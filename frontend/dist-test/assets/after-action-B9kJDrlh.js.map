{"version":3,"file":"after-action-B9kJDrlh.js","sources":["../../src/hooks/useEngagement.ts","../../src/components/DecisionList.tsx","../../src/components/CommitmentEditor.tsx","../../src/components/RiskList.tsx","../../src/components/FollowUpList.tsx","../../src/components/AIExtractionButton.tsx","../../src/components/AfterActionForm.tsx","../../src/routes/_protected/engagements/$engagementId/after-action.tsx?tsr-split=component"],"sourcesContent":["/**\n * useEngagement Hook\n *\n * Fetches a single engagement by ID with real-time updates\n * Uses unified dossier architecture with JOIN\n */\n\nimport { useQuery } from '@tanstack/react-query';\nimport { supabase } from '@/lib/supabase';\n\nexport interface Engagement {\n  id: string;\n  name_en: string;\n  name_ar: string;\n  description_en?: string;\n  description_ar?: string;\n  engagement_type: 'meeting' | 'consultation' | 'coordination' | 'workshop' | 'conference' | 'site_visit' | 'ceremony';\n  engagement_category: 'bilateral' | 'multilateral' | 'regional' | 'internal';\n  location_en?: string;\n  location_ar?: string;\n  status: string;\n  created_at: string;\n  updated_at: string;\n  created_by?: string;\n  updated_by?: string;\n}\n\nexport function useEngagement(engagementId: string) {\n  return useQuery({\n    queryKey: ['engagement', engagementId],\n    queryFn: async () => {\n      // Query with JOIN to get dossier data\n      const { data, error } = await supabase\n        .from('dossiers')\n        .select(`\n          id,\n          name_en,\n          name_ar,\n          description_en,\n          description_ar,\n          status,\n          created_at,\n          updated_at,\n          created_by,\n          updated_by,\n          engagements!inner (\n            engagement_type,\n            engagement_category,\n            location_en,\n            location_ar\n          )\n        `)\n        .eq('id', engagementId)\n        .eq('type', 'engagement')\n        .single();\n\n      if (error) throw error;\n\n      // Flatten the joined data structure\n      const flattenedData: Engagement = {\n        id: data.id,\n        name_en: data.name_en,\n        name_ar: data.name_ar,\n        description_en: data.description_en,\n        description_ar: data.description_ar,\n        engagement_type: (data.engagements as any).engagement_type,\n        engagement_category: (data.engagements as any).engagement_category,\n        location_en: (data.engagements as any).location_en,\n        location_ar: (data.engagements as any).location_ar,\n        status: data.status,\n        created_at: data.created_at,\n        updated_at: data.updated_at,\n        created_by: data.created_by,\n        updated_by: data.updated_by,\n      };\n\n      return flattenedData;\n    },\n    enabled: !!engagementId,\n  });\n}\n","import { useState } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Textarea } from '@/components/ui/textarea';\nimport { Label } from '@/components/ui/label';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { Calendar } from '@/components/ui/calendar';\nimport {\n Popover,\n PopoverContent,\n PopoverTrigger,\n} from '@/components/ui/popover';\nimport { Trash2, Plus, CalendarIcon } from 'lucide-react';\nimport { format } from 'date-fns';\nimport { cn } from '@/lib/utils';\n\nexport interface Decision {\n id?: string;\n description: string;\n rationale?: string;\n decision_maker: string;\n decision_date: Date;\n ai_confidence?: number;\n}\n\ninterface DecisionListProps {\n decisions: Decision[];\n onChange: (decisions: Decision[]) => void;\n readOnly?: boolean;\n}\n\nexport function DecisionList({ decisions, onChange, readOnly = false }: DecisionListProps) {\n const { t, i18n } = useTranslation();\n const isRTL = i18n.language === 'ar';\n\n const addDecision = () => {\n onChange([\n ...decisions,\n {\n description: '',\n decision_maker: '',\n decision_date: new Date(),\n },\n ]);\n };\n\n const removeDecision = (index: number) => {\n onChange(decisions.filter((_, i) => i !== index));\n };\n\n const updateDecision = (index: number, field: keyof Decision, value: any) => {\n const updated = [...decisions];\n updated[index] = { ...updated[index], [field]: value };\n onChange(updated);\n };\n\n return (\n <div className=\"space-y-4\">\n <div className={cn('flex items-center justify-between', isRTL && 'flex-row-reverse')}>\n <h3 className=\"text-lg font-semibold\">{t('afterActions.decisions.title')}</h3>\n {!readOnly && (\n <Button type=\"button\" variant=\"outline\" size=\"sm\" onClick={addDecision}>\n <Plus className=\"me-2 size-4\" />\n {t('afterActions.decisions.add')}\n </Button>\n )}\n </div>\n\n {decisions.length === 0 && (\n <p className=\"text-sm text-muted-foreground\">{t('afterActions.decisions.empty')}</p>\n )}\n\n {decisions.map((decision, index) => (\n <Card key={index}>\n <CardHeader>\n <div className={cn('flex items-center justify-between', isRTL && 'flex-row-reverse')}>\n <CardTitle className=\"text-base\">\n {t('afterActions.decisions.item', { number: index + 1 })}\n </CardTitle>\n <div className={cn('flex items-center gap-2', isRTL && 'flex-row-reverse')}>\n {decision.ai_confidence !== undefined && (\n <Badge\n variant={decision.ai_confidence >= 0.8 ? 'default' : decision.ai_confidence >= 0.5 ? 'secondary' : 'destructive'}\n >\n {t('afterActions.confidence', { value: Math.round(decision.ai_confidence * 100) })}\n </Badge>\n )}\n {!readOnly && (\n <Button\n type=\"button\"\n variant=\"ghost\"\n size=\"sm\"\n onClick={() => removeDecision(index)}\n >\n <Trash2 className=\"size-4 text-destructive\" />\n </Button>\n )}\n </div>\n </div>\n </CardHeader>\n <CardContent className=\"space-y-4\">\n <div>\n <Label htmlFor={`decision-description-${index}`}>\n {t('afterActions.decisions.description')} *\n </Label>\n <Textarea\n id={`decision-description-${index}`}\n value={decision.description}\n onChange={(e) => updateDecision(index, 'description', e.target.value)}\n placeholder={t('afterActions.decisions.descriptionPlaceholder')}\n rows={3}\n maxLength={2000}\n disabled={readOnly}\n dir={isRTL ? 'rtl' : 'ltr'}\n required\n />\n <p className=\"mt-1 text-xs text-muted-foreground\">\n {decision.description.length}/2000\n </p>\n </div>\n\n <div>\n <Label htmlFor={`decision-rationale-${index}`}>\n {t('afterActions.decisions.rationale')}\n </Label>\n <Textarea\n id={`decision-rationale-${index}`}\n value={decision.rationale || ''}\n onChange={(e) => updateDecision(index, 'rationale', e.target.value)}\n placeholder={t('afterActions.decisions.rationalePlaceholder')}\n rows={2}\n disabled={readOnly}\n dir={isRTL ? 'rtl' : 'ltr'}\n />\n </div>\n\n <div className=\"grid grid-cols-1 gap-4 md:grid-cols-2\">\n <div>\n <Label htmlFor={`decision-maker-${index}`}>\n {t('afterActions.decisions.decisionMaker')} *\n </Label>\n <Input\n id={`decision-maker-${index}`}\n value={decision.decision_maker}\n onChange={(e) => updateDecision(index, 'decision_maker', e.target.value)}\n placeholder={t('afterActions.decisions.decisionMakerPlaceholder')}\n maxLength={200}\n disabled={readOnly}\n dir={isRTL ? 'rtl' : 'ltr'}\n required\n />\n </div>\n\n <div>\n <Label>{t('afterActions.decisions.decisionDate')} *</Label>\n <Popover>\n <PopoverTrigger asChild>\n <Button\n variant=\"outline\"\n className={cn(\n 'w-full justify-start text-start font-normal',\n !decision.decision_date && 'text-muted-foreground'\n )}\n disabled={readOnly}\n >\n <CalendarIcon className=\"me-2 size-4 opacity-50\" />\n {decision.decision_date\n ? format(decision.decision_date, 'PPP')\n : t('common.selectDate')}\n </Button>\n </PopoverTrigger>\n <PopoverContent className=\"w-auto p-0\" align=\"start\">\n <Calendar\n mode=\"single\"\n selected={decision.decision_date}\n onSelect={(date) => date && updateDecision(index, 'decision_date', date)}\n disabled={(date) => date > new Date()}\n initialFocus\n />\n </PopoverContent>\n </Popover>\n </div>\n </div>\n </CardContent>\n </Card>\n ))}\n </div>\n );\n}\n","import { useTranslation } from 'react-i18next';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Textarea } from '@/components/ui/textarea';\nimport { Label } from '@/components/ui/label';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { RadioGroup, RadioGroupItem } from '@/components/ui/radio-group';\nimport {\n Select,\n SelectContent,\n SelectItem,\n SelectTrigger,\n SelectValue,\n} from '@/components/ui/select';\nimport { Calendar } from '@/components/ui/calendar';\nimport {\n Popover,\n PopoverContent,\n PopoverTrigger,\n} from '@/components/ui/popover';\nimport { Trash2, Plus, CalendarIcon, User, Mail } from 'lucide-react';\nimport { format } from 'date-fns';\nimport { cn } from '@/lib/utils';\n\nexport interface Commitment {\n id?: string;\n description: string;\n priority: 'low' | 'medium' | 'high' | 'critical';\n status?: 'pending' | 'in_progress' | 'completed' | 'cancelled' | 'overdue';\n owner_type: 'internal' | 'external';\n owner_user_id?: string;\n owner_contact_email?: string;\n owner_contact_name?: string;\n owner_contact_organization?: string;\n tracking_mode?: 'automatic' | 'manual';\n due_date: Date;\n ai_confidence?: number;\n}\n\ninterface CommitmentEditorProps {\n commitments: Commitment[];\n onChange: (commitments: Commitment[]) => void;\n readOnly?: boolean;\n availableUsers?: Array<{ id: string; name: string }>;\n}\n\nconst priorities: Commitment['priority'][] = ['low', 'medium', 'high', 'critical'];\nconst statuses: NonNullable<Commitment['status']>[] = ['pending', 'in_progress', 'completed', 'cancelled', 'overdue'];\n\nexport function CommitmentEditor({\n commitments,\n onChange,\n readOnly = false,\n availableUsers = [],\n}: CommitmentEditorProps) {\n const { t, i18n } = useTranslation();\n const isRTL = i18n.language === 'ar';\n\n const addCommitment = () => {\n onChange([\n ...commitments,\n {\n description: '',\n priority: 'medium',\n status: 'pending',\n owner_type: 'internal',\n due_date: new Date(Date.now() + 7 * 24 * 60 * 60 * 1000), // 7 days from now\n },\n ]);\n };\n\n const removeCommitment = (index: number) => {\n onChange(commitments.filter((_, i) => i !== index));\n };\n\n const updateCommitment = (index: number, field: keyof Commitment, value: any) => {\n const updated = [...commitments];\n updated[index] = { ...updated[index], [field]: value };\n\n // Set tracking mode based on owner type\n if (field === 'owner_type') {\n updated[index].tracking_mode = value === 'internal' ? 'automatic' : 'manual';\n }\n\n onChange(updated);\n };\n\n return (\n <div className=\"space-y-4\">\n <div className={cn('flex items-center justify-between', isRTL && 'flex-row-reverse')}>\n <h3 className=\"text-lg font-semibold\">{t('afterActions.commitments.title')}</h3>\n {!readOnly && (\n <Button type=\"button\" variant=\"outline\" size=\"sm\" onClick={addCommitment}>\n <Plus className={cn('h-4 w-4', isRTL ? 'ms-2' : 'me-2')} />\n {t('afterActions.commitments.add')}\n </Button>\n )}\n </div>\n\n {commitments.length === 0 && (\n <p className=\"text-sm text-muted-foreground\">{t('afterActions.commitments.empty')}</p>\n )}\n\n {commitments.map((commitment, index) => (\n <Card key={index}>\n <CardHeader>\n <div className={cn('flex items-center justify-between', isRTL && 'flex-row-reverse')}>\n <CardTitle className=\"text-base\">\n {t('afterActions.commitments.item', { number: index + 1 })}\n </CardTitle>\n <div className={cn('flex items-center gap-2', isRTL && 'flex-row-reverse')}>\n {commitment.tracking_mode && (\n <Badge variant=\"outline\">\n {t(`afterActions.commitments.tracking.${commitment.tracking_mode}`)}\n </Badge>\n )}\n {commitment.ai_confidence !== undefined && (\n <Badge\n variant={commitment.ai_confidence >= 0.8 ? 'default' : commitment.ai_confidence >= 0.5 ? 'secondary' : 'destructive'}\n >\n {t('afterActions.confidence', { value: Math.round(commitment.ai_confidence * 100) })}\n </Badge>\n )}\n {!readOnly && (\n <Button\n type=\"button\"\n variant=\"ghost\"\n size=\"sm\"\n onClick={() => removeCommitment(index)}\n >\n <Trash2 className=\"size-4 text-destructive\" />\n </Button>\n )}\n </div>\n </div>\n </CardHeader>\n <CardContent className=\"space-y-4\">\n <div>\n <Label htmlFor={`commitment-description-${index}`}>\n {t('afterActions.commitments.description')} *\n </Label>\n <Textarea\n id={`commitment-description-${index}`}\n value={commitment.description}\n onChange={(e) => updateCommitment(index, 'description', e.target.value)}\n placeholder={t('afterActions.commitments.descriptionPlaceholder')}\n rows={2}\n maxLength={2000}\n disabled={readOnly}\n dir={isRTL ? 'rtl' : 'ltr'}\n required\n />\n </div>\n\n <div>\n <Label>{t('afterActions.commitments.ownerType')} *</Label>\n <RadioGroup\n value={commitment.owner_type}\n onValueChange={(value) => updateCommitment(index, 'owner_type', value as 'internal' | 'external')}\n disabled={readOnly}\n className=\"flex gap-4\"\n >\n <div className=\"flex items-center space-x-2\">\n <RadioGroupItem value=\"internal\" id={`internal-${index}`} />\n <Label htmlFor={`internal-${index}`} className=\"flex items-center gap-2\">\n <User className=\"size-4\" />\n {t('afterActions.commitments.internal')}\n </Label>\n </div>\n <div className=\"flex items-center space-x-2\">\n <RadioGroupItem value=\"external\" id={`external-${index}`} />\n <Label htmlFor={`external-${index}`} className=\"flex items-center gap-2\">\n <Mail className=\"size-4\" />\n {t('afterActions.commitments.external')}\n </Label>\n </div>\n </RadioGroup>\n </div>\n\n {commitment.owner_type === 'internal' ? (\n <div>\n <Label htmlFor={`owner-user-${index}`}>\n {t('afterActions.commitments.assignedTo')} *\n </Label>\n <Select\n value={commitment.owner_user_id}\n onValueChange={(value) => updateCommitment(index, 'owner_user_id', value)}\n disabled={readOnly}\n >\n <SelectTrigger id={`owner-user-${index}`} dir={isRTL ? 'rtl' : 'ltr'}>\n <SelectValue placeholder={t('afterActions.commitments.selectUser')} />\n </SelectTrigger>\n <SelectContent>\n {availableUsers.map((user) => (\n <SelectItem key={user.id} value={user.id}>\n {user.name}\n </SelectItem>\n ))}\n </SelectContent>\n </Select>\n </div>\n ) : (\n <div className=\"space-y-4\">\n <div>\n <Label htmlFor={`contact-email-${index}`}>\n {t('afterActions.commitments.contactEmail')} *\n </Label>\n <Input\n id={`contact-email-${index}`}\n type=\"email\"\n value={commitment.owner_contact_email || ''}\n onChange={(e) => updateCommitment(index, 'owner_contact_email', e.target.value)}\n placeholder={t('afterActions.commitments.emailPlaceholder')}\n disabled={readOnly}\n dir={isRTL ? 'rtl' : 'ltr'}\n required\n />\n </div>\n <div>\n <Label htmlFor={`contact-name-${index}`}>\n {t('afterActions.commitments.contactName')} *\n </Label>\n <Input\n id={`contact-name-${index}`}\n value={commitment.owner_contact_name || ''}\n onChange={(e) => updateCommitment(index, 'owner_contact_name', e.target.value)}\n placeholder={t('afterActions.commitments.namePlaceholder')}\n maxLength={200}\n disabled={readOnly}\n dir={isRTL ? 'rtl' : 'ltr'}\n required\n />\n </div>\n <div>\n <Label htmlFor={`contact-org-${index}`}>\n {t('afterActions.commitments.organization')}\n </Label>\n <Input\n id={`contact-org-${index}`}\n value={commitment.owner_contact_organization || ''}\n onChange={(e) => updateCommitment(index, 'owner_contact_organization', e.target.value)}\n placeholder={t('afterActions.commitments.orgPlaceholder')}\n maxLength={200}\n disabled={readOnly}\n dir={isRTL ? 'rtl' : 'ltr'}\n />\n </div>\n </div>\n )}\n\n <div className=\"grid grid-cols-1 gap-4 md:grid-cols-3\">\n <div>\n <Label htmlFor={`priority-${index}`}>{t('afterActions.commitments.priority')} *</Label>\n <Select\n value={commitment.priority}\n onValueChange={(value) => updateCommitment(index, 'priority', value)}\n disabled={readOnly}\n >\n <SelectTrigger id={`priority-${index}`} dir={isRTL ? 'rtl' : 'ltr'}>\n <SelectValue />\n </SelectTrigger>\n <SelectContent>\n {priorities.map((priority) => (\n <SelectItem key={priority} value={priority}>\n {t(`afterActions.commitments.priorities.${priority}`)}\n </SelectItem>\n ))}\n </SelectContent>\n </Select>\n </div>\n\n {commitment.status && (\n <div>\n <Label htmlFor={`status-${index}`}>{t('afterActions.commitments.status')}</Label>\n <Select\n value={commitment.status}\n onValueChange={(value) => updateCommitment(index, 'status', value)}\n disabled={readOnly || (commitment.owner_type === 'internal' && commitment.tracking_mode === 'automatic')}\n >\n <SelectTrigger id={`status-${index}`} dir={isRTL ? 'rtl' : 'ltr'}>\n <SelectValue />\n </SelectTrigger>\n <SelectContent>\n {statuses.map((status) => (\n <SelectItem key={status} value={status}>\n {t(`afterActions.commitments.statuses.${status}`)}\n </SelectItem>\n ))}\n </SelectContent>\n </Select>\n </div>\n )}\n\n <div>\n <Label>{t('afterActions.commitments.dueDate')} *</Label>\n <Popover>\n <PopoverTrigger asChild>\n <Button\n variant=\"outline\"\n className={cn(\n 'w-full justify-start text-start font-normal',\n !commitment.due_date && 'text-muted-foreground',\n isRTL && 'justify-end text-end'\n )}\n disabled={readOnly}\n >\n <CalendarIcon className={cn('h-4 w-4 opacity-50', isRTL ? 'ms-2' : 'me-2')} />\n {commitment.due_date\n ? format(commitment.due_date, 'PPP')\n : t('common.selectDate')}\n </Button>\n </PopoverTrigger>\n <PopoverContent className=\"w-auto p-0\" align=\"start\">\n <Calendar\n mode=\"single\"\n selected={commitment.due_date}\n onSelect={(date) => date && updateCommitment(index, 'due_date', date)}\n disabled={(date) => date < new Date()}\n initialFocus\n />\n </PopoverContent>\n </Popover>\n </div>\n </div>\n </CardContent>\n </Card>\n ))}\n </div>\n );\n}\n","import { useTranslation } from 'react-i18next';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Textarea } from '@/components/ui/textarea';\nimport { Label } from '@/components/ui/label';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport {\n Select,\n SelectContent,\n SelectItem,\n SelectTrigger,\n SelectValue,\n} from '@/components/ui/select';\nimport { Trash2, Plus, AlertTriangle } from 'lucide-react';\nimport { cn } from '@/lib/utils';\n\nexport interface Risk {\n id?: string;\n description: string;\n severity: 'low' | 'medium' | 'high' | 'critical';\n likelihood: 'unlikely' | 'possible' | 'likely' | 'certain';\n mitigation_strategy?: string;\n owner?: string;\n ai_confidence?: number;\n}\n\ninterface RiskListProps {\n risks: Risk[];\n onChange: (risks: Risk[]) => void;\n readOnly?: boolean;\n}\n\nconst severities: Risk['severity'][] = ['low', 'medium', 'high', 'critical'];\nconst likelihoods: Risk['likelihood'][] = ['unlikely', 'possible', 'likely', 'certain'];\n\nconst severityColors = {\n low: 'bg-green-500 hover:bg-green-500/80 text-white',\n medium: 'bg-amber-500 hover:bg-amber-500/80 text-white',\n high: 'bg-orange-600 hover:bg-orange-600/80 text-white',\n critical: 'bg-red-600 hover:bg-red-600/80 text-white',\n};\n\nexport function RiskList({ risks, onChange, readOnly = false }: RiskListProps) {\n const { t, i18n } = useTranslation();\n const isRTL = i18n.language === 'ar';\n\n const addRisk = () => {\n onChange([\n ...risks,\n {\n description: '',\n severity: 'medium',\n likelihood: 'possible',\n },\n ]);\n };\n\n const removeRisk = (index: number) => {\n onChange(risks.filter((_, i) => i !== index));\n };\n\n const updateRisk = (index: number, field: keyof Risk, value: any) => {\n const updated = [...risks];\n updated[index] = { ...updated[index], [field]: value };\n onChange(updated);\n };\n\n return (\n <div className=\"space-y-4\">\n <div className={cn('flex items-center justify-between', isRTL && 'flex-row-reverse')}>\n <h3 className=\"flex items-center gap-2 text-lg font-semibold\">\n <AlertTriangle className=\"size-5\" />\n {t('afterActions.risks.title')}\n </h3>\n {!readOnly && (\n <Button type=\"button\" variant=\"outline\" size=\"sm\" onClick={addRisk}>\n <Plus className={cn('h-4 w-4', isRTL ? 'ms-2' : 'me-2')} />\n {t('afterActions.risks.add')}\n </Button>\n )}\n </div>\n\n {risks.length === 0 && (\n <p className=\"text-sm text-muted-foreground\">{t('afterActions.risks.empty')}</p>\n )}\n\n {risks.map((risk, index) => (\n <Card key={index} className={cn(\n 'border-l-4',\n risk.severity === 'low' && 'border-l-green-500',\n risk.severity === 'medium' && 'border-l-amber-500',\n risk.severity === 'high' && 'border-l-orange-600',\n risk.severity === 'critical' && 'border-l-red-600'\n )}>\n <CardHeader>\n <div className={cn('flex items-center justify-between', isRTL && 'flex-row-reverse')}>\n <CardTitle className=\"text-base\">\n {t('afterActions.risks.item', { number: index + 1 })}\n </CardTitle>\n <div className={cn('flex items-center gap-2', isRTL && 'flex-row-reverse')}>\n <Badge className={severityColors[risk.severity]}>\n {t(`afterActions.risks.severities.${risk.severity}`)}\n </Badge>\n {risk.ai_confidence !== undefined && (\n <Badge\n variant={risk.ai_confidence >= 0.8 ? 'default' : risk.ai_confidence >= 0.5 ? 'secondary' : 'destructive'}\n >\n {t('afterActions.confidence', { value: Math.round(risk.ai_confidence * 100) })}\n </Badge>\n )}\n {!readOnly && (\n <Button\n type=\"button\"\n variant=\"ghost\"\n size=\"sm\"\n onClick={() => removeRisk(index)}\n >\n <Trash2 className=\"size-4 text-destructive\" />\n </Button>\n )}\n </div>\n </div>\n </CardHeader>\n <CardContent className=\"space-y-4\">\n <div>\n <Label htmlFor={`risk-description-${index}`}>\n {t('afterActions.risks.description')} *\n </Label>\n <Textarea\n id={`risk-description-${index}`}\n value={risk.description}\n onChange={(e) => updateRisk(index, 'description', e.target.value)}\n placeholder={t('afterActions.risks.descriptionPlaceholder')}\n rows={2}\n maxLength={2000}\n disabled={readOnly}\n dir={isRTL ? 'rtl' : 'ltr'}\n required\n />\n </div>\n\n <div className=\"grid grid-cols-1 gap-4 md:grid-cols-2\">\n <div>\n <Label htmlFor={`severity-${index}`}>{t('afterActions.risks.severity')} *</Label>\n <Select\n value={risk.severity}\n onValueChange={(value) => updateRisk(index, 'severity', value)}\n disabled={readOnly}\n >\n <SelectTrigger id={`severity-${index}`} dir={isRTL ? 'rtl' : 'ltr'}>\n <SelectValue />\n </SelectTrigger>\n <SelectContent>\n {severities.map((severity) => (\n <SelectItem key={severity} value={severity}>\n {t(`afterActions.risks.severities.${severity}`)}\n </SelectItem>\n ))}\n </SelectContent>\n </Select>\n </div>\n\n <div>\n <Label htmlFor={`likelihood-${index}`}>{t('afterActions.risks.likelihood')} *</Label>\n <Select\n value={risk.likelihood}\n onValueChange={(value) => updateRisk(index, 'likelihood', value)}\n disabled={readOnly}\n >\n <SelectTrigger id={`likelihood-${index}`} dir={isRTL ? 'rtl' : 'ltr'}>\n <SelectValue />\n </SelectTrigger>\n <SelectContent>\n {likelihoods.map((likelihood) => (\n <SelectItem key={likelihood} value={likelihood}>\n {t(`afterActions.risks.likelihoods.${likelihood}`)}\n </SelectItem>\n ))}\n </SelectContent>\n </Select>\n </div>\n </div>\n\n <div>\n <Label htmlFor={`mitigation-${index}`}>\n {t('afterActions.risks.mitigationStrategy')}\n </Label>\n <Textarea\n id={`mitigation-${index}`}\n value={risk.mitigation_strategy || ''}\n onChange={(e) => updateRisk(index, 'mitigation_strategy', e.target.value)}\n placeholder={t('afterActions.risks.mitigationPlaceholder')}\n rows={2}\n disabled={readOnly}\n dir={isRTL ? 'rtl' : 'ltr'}\n />\n </div>\n\n <div>\n <Label htmlFor={`risk-owner-${index}`}>{t('afterActions.risks.owner')}</Label>\n <Input\n id={`risk-owner-${index}`}\n value={risk.owner || ''}\n onChange={(e) => updateRisk(index, 'owner', e.target.value)}\n placeholder={t('afterActions.risks.ownerPlaceholder')}\n maxLength={200}\n disabled={readOnly}\n dir={isRTL ? 'rtl' : 'ltr'}\n />\n </div>\n </CardContent>\n </Card>\n ))}\n </div>\n );\n}\n","import { useTranslation } from 'react-i18next';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Textarea } from '@/components/ui/textarea';\nimport { Label } from '@/components/ui/label';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Checkbox } from '@/components/ui/checkbox';\nimport { Calendar } from '@/components/ui/calendar';\nimport {\n Popover,\n PopoverContent,\n PopoverTrigger,\n} from '@/components/ui/popover';\nimport { Trash2, Plus, CalendarIcon, ListTodo } from 'lucide-react';\nimport { format } from 'date-fns';\nimport { cn } from '@/lib/utils';\n\nexport interface FollowUpAction {\n id?: string;\n description: string;\n assigned_to?: string;\n target_date?: Date;\n completed: boolean;\n}\n\ninterface FollowUpListProps {\n followUpActions: FollowUpAction[];\n onChange: (followUpActions: FollowUpAction[]) => void;\n readOnly?: boolean;\n}\n\nexport function FollowUpList({ followUpActions, onChange, readOnly = false }: FollowUpListProps) {\n const { t, i18n } = useTranslation();\n const isRTL = i18n.language === 'ar';\n\n const addFollowUp = () => {\n onChange([\n ...followUpActions,\n {\n description: '',\n completed: false,\n },\n ]);\n };\n\n const removeFollowUp = (index: number) => {\n onChange(followUpActions.filter((_, i) => i !== index));\n };\n\n const updateFollowUp = (index: number, field: keyof FollowUpAction, value: any) => {\n const updated = [...followUpActions];\n updated[index] = { ...updated[index], [field]: value };\n onChange(updated);\n };\n\n return (\n <div className=\"space-y-4\">\n <div className={cn('flex items-center justify-between', isRTL && 'flex-row-reverse')}>\n <h3 className=\"flex items-center gap-2 text-lg font-semibold\">\n <ListTodo className=\"size-5\" />\n {t('afterActions.followUps.title')}\n </h3>\n {!readOnly && (\n <Button type=\"button\" variant=\"outline\" size=\"sm\" onClick={addFollowUp}>\n <Plus className={cn('h-4 w-4', isRTL ? 'ms-2' : 'me-2')} />\n {t('afterActions.followUps.add')}\n </Button>\n )}\n </div>\n\n {followUpActions.length === 0 && (\n <p className=\"text-sm text-muted-foreground\">{t('afterActions.followUps.empty')}</p>\n )}\n\n {followUpActions.map((action, index) => (\n <Card key={index} className={cn(action.completed && 'opacity-60')}>\n <CardHeader>\n <div className={cn('flex items-center justify-between', isRTL && 'flex-row-reverse')}>\n <CardTitle className=\"flex items-center gap-2 text-base\">\n <Checkbox\n checked={action.completed}\n onCheckedChange={(checked) => updateFollowUp(index, 'completed', checked)}\n disabled={readOnly}\n />\n {t('afterActions.followUps.item', { number: index + 1 })}\n </CardTitle>\n {!readOnly && (\n <Button\n type=\"button\"\n variant=\"ghost\"\n size=\"sm\"\n onClick={() => removeFollowUp(index)}\n >\n <Trash2 className=\"size-4 text-destructive\" />\n </Button>\n )}\n </div>\n </CardHeader>\n <CardContent className=\"space-y-4\">\n <div>\n <Label htmlFor={`followup-description-${index}`}>\n {t('afterActions.followUps.description')} *\n </Label>\n <Textarea\n id={`followup-description-${index}`}\n value={action.description}\n onChange={(e) => updateFollowUp(index, 'description', e.target.value)}\n placeholder={t('afterActions.followUps.descriptionPlaceholder')}\n rows={2}\n maxLength={2000}\n disabled={readOnly}\n dir={isRTL ? 'rtl' : 'ltr'}\n required\n className={cn(action.completed && 'line-through')}\n />\n </div>\n\n <div className=\"grid grid-cols-1 gap-4 md:grid-cols-2\">\n <div>\n <Label htmlFor={`followup-assigned-${index}`}>\n {t('afterActions.followUps.assignedTo')}\n <span className=\"ms-1 text-xs text-muted-foreground\">\n {t('common.optional')}\n </span>\n </Label>\n <Input\n id={`followup-assigned-${index}`}\n value={action.assigned_to || ''}\n onChange={(e) => updateFollowUp(index, 'assigned_to', e.target.value)}\n placeholder={t('afterActions.followUps.assignedPlaceholder')}\n maxLength={200}\n disabled={readOnly}\n dir={isRTL ? 'rtl' : 'ltr'}\n />\n </div>\n\n <div>\n <Label>\n {t('afterActions.followUps.targetDate')}\n <span className=\"ms-1 text-xs text-muted-foreground\">\n {t('common.optional')}\n </span>\n </Label>\n <Popover>\n <PopoverTrigger asChild>\n <Button\n variant=\"outline\"\n className={cn(\n 'w-full justify-start text-start font-normal',\n !action.target_date && 'text-muted-foreground',\n isRTL && 'justify-end text-end'\n )}\n disabled={readOnly}\n >\n <CalendarIcon className={cn('h-4 w-4 opacity-50', isRTL ? 'ms-2' : 'me-2')} />\n {action.target_date\n ? format(action.target_date, 'PPP')\n : t('afterActions.followUps.selectDate')}\n </Button>\n </PopoverTrigger>\n <PopoverContent className=\"w-auto p-0\" align=\"start\">\n <Calendar\n mode=\"single\"\n selected={action.target_date}\n onSelect={(date) => updateFollowUp(index, 'target_date', date || undefined)}\n initialFocus\n />\n </PopoverContent>\n </Popover>\n </div>\n </div>\n </CardContent>\n </Card>\n ))}\n </div>\n );\n}\n","import { useState, useCallback } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport {\n Dialog,\n DialogContent,\n DialogDescription,\n DialogHeader,\n DialogTitle,\n DialogTrigger,\n} from '@/components/ui/dialog';\nimport {\n Select,\n SelectContent,\n SelectItem,\n SelectTrigger,\n SelectValue,\n} from '@/components/ui/select';\nimport { Badge } from '@/components/ui/badge';\nimport { Sparkles, Upload, AlertCircle, CheckCircle, Loader2 } from 'lucide-react';\nimport { cn } from '@/lib/utils';\nimport type { Decision } from './DecisionList';\nimport type { Commitment } from './CommitmentEditor';\nimport type { Risk } from './RiskList';\n\ninterface ExtractionResult {\n decisions?: Decision[];\n commitments?: Commitment[];\n risks?: Risk[];\n follow_ups?: Array<{\n description: string;\n assigned_to?: string;\n target_date?: Date;\n }>;\n}\n\ninterface AIExtractionButtonProps {\n onExtract: (result: ExtractionResult) => void;\n disabled?: boolean;\n className?: string;\n}\n\ntype ExtractionMode = 'sync' | 'async' | 'auto';\ntype ExtractionStatus = 'idle' | 'uploading' | 'processing' | 'completed' | 'failed';\n\nexport function AIExtractionButton({\n onExtract,\n disabled = false,\n className,\n}: AIExtractionButtonProps) {\n const { t, i18n } = useTranslation();\n const isRTL = i18n.language === 'ar';\n\n const [open, setOpen] = useState(false);\n const [file, setFile] = useState<File | null>(null);\n const [language, setLanguage] = useState<'en' | 'ar'>(i18n.language as 'en' | 'ar');\n const [mode, setMode] = useState<ExtractionMode>('auto');\n const [status, setStatus] = useState<ExtractionStatus>('idle');\n const [progress, setProgress] = useState(0);\n const [error, setError] = useState<string | null>(null);\n const [jobId, setJobId] = useState<string | null>(null);\n const [estimatedTime, setEstimatedTime] = useState<number | null>(null);\n\n const estimateProcessingTime = useCallback((fileSize: number, lang: string): number => {\n // Estimation: 100KB/sec baseline\n const baseTime = fileSize / (1024 * 100);\n // Arabic is ~30% slower to process\n const langMultiplier = lang === 'ar' ? 1.3 : 1.0;\n return Math.ceil(baseTime * langMultiplier);\n }, []);\n\n const handleFileChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n const selectedFile = e.target.files?.[0];\n if (!selectedFile) return;\n\n // Validate file type\n const allowedTypes = [\n 'text/plain',\n 'application/pdf',\n 'application/vnd.openxmlformats-officedocument.wordprocessingml.document',\n ];\n\n if (!allowedTypes.includes(selectedFile.type)) {\n setError(t('afterActions.ai.invalidFileType'));\n return;\n }\n\n // Validate file size (max 10MB for extraction)\n if (selectedFile.size > 10 * 1024 * 1024) {\n setError(t('afterActions.ai.fileTooLarge'));\n return;\n }\n\n setFile(selectedFile);\n setError(null);\n\n // Estimate processing time\n const estimated = estimateProcessingTime(selectedFile.size, language);\n setEstimatedTime(estimated);\n };\n\n const handleExtract = async () => {\n if (!file) return;\n\n setStatus('uploading');\n setError(null);\n\n try {\n const formData = new FormData();\n formData.append('file', file);\n formData.append('language', language);\n formData.append('mode', mode);\n\n const response = await fetch('/api/ai/extract', {\n method: 'POST',\n body: formData,\n });\n\n if (!response.ok) {\n throw new Error(t('afterActions.ai.extractionFailed'));\n }\n\n const data = await response.json();\n\n // Check if sync or async\n if (data.job_id) {\n // Async mode\n setJobId(data.job_id);\n setEstimatedTime(data.estimated_time);\n setStatus('processing');\n pollJobStatus(data.job_id);\n } else {\n // Sync mode - immediate result\n setStatus('completed');\n onExtract(data.result);\n setTimeout(() => {\n setOpen(false);\n resetState();\n }, 1500);\n }\n } catch (err) {\n setStatus('failed');\n setError(err instanceof Error ? err.message : t('afterActions.ai.extractionFailed'));\n }\n };\n\n const pollJobStatus = async (id: string) => {\n const poll = async () => {\n try {\n const response = await fetch(`/api/ai/extract/${id}`);\n const data = await response.json();\n\n if (data.status === 'completed') {\n setStatus('completed');\n setProgress(100);\n onExtract(data.result);\n setTimeout(() => {\n setOpen(false);\n resetState();\n }, 1500);\n } else if (data.status === 'failed') {\n setStatus('failed');\n setError(data.error || t('afterActions.ai.extractionFailed'));\n } else if (data.status === 'processing') {\n setProgress(data.progress || 0);\n setTimeout(poll, 2000); // Poll every 2 seconds\n }\n } catch (err) {\n setStatus('failed');\n setError(t('afterActions.ai.extractionFailed'));\n }\n };\n\n poll();\n };\n\n const resetState = () => {\n setFile(null);\n setStatus('idle');\n setProgress(0);\n setError(null);\n setJobId(null);\n setEstimatedTime(null);\n };\n\n const handleOpenChange = (isOpen: boolean) => {\n setOpen(isOpen);\n if (!isOpen) {\n resetState();\n }\n };\n\n return (\n <Dialog open={open} onOpenChange={handleOpenChange}>\n <DialogTrigger asChild>\n <Button\n type=\"button\"\n variant=\"outline\"\n disabled={disabled}\n className={cn('gap-2', className)}\n >\n <Sparkles className=\"size-4\" />\n {t('afterActions.ai.extractButton')}\n </Button>\n </DialogTrigger>\n <DialogContent className=\"sm:max-w-[500px]\" dir={isRTL ? 'rtl' : 'ltr'}>\n <DialogHeader>\n <DialogTitle className=\"flex items-center gap-2\">\n <Sparkles className=\"size-5 text-primary\" />\n {t('afterActions.ai.title')}\n </DialogTitle>\n <DialogDescription>\n {t('afterActions.ai.description')}\n </DialogDescription>\n </DialogHeader>\n\n <div className=\"space-y-4 py-4\">\n {/* File Upload */}\n <div className=\"space-y-2\">\n <Label htmlFor=\"file-upload\">{t('afterActions.ai.uploadFile')}</Label>\n <Input\n id=\"file-upload\"\n type=\"file\"\n accept=\".txt,.pdf,.docx\"\n onChange={handleFileChange}\n disabled={status === 'processing' || status === 'uploading'}\n />\n {file && (\n <p className=\"text-sm text-muted-foreground\">\n {file.name} ({(file.size / 1024).toFixed(2)} KB)\n {estimatedTime && (\n <span className=\"ms-2\">\n \" {t('afterActions.ai.estimatedTime')}: {estimatedTime}s\n </span>\n )}\n </p>\n )}\n </div>\n\n {/* Language Selection */}\n <div className=\"space-y-2\">\n <Label htmlFor=\"language\">{t('afterActions.ai.language')}</Label>\n <Select value={language} onValueChange={(v) => setLanguage(v as 'en' | 'ar')}>\n <SelectTrigger id=\"language\">\n <SelectValue />\n </SelectTrigger>\n <SelectContent>\n <SelectItem value=\"en\">{t('common.english')}</SelectItem>\n <SelectItem value=\"ar\">{t('common.arabic')}</SelectItem>\n </SelectContent>\n </Select>\n </div>\n\n {/* Processing Mode */}\n <div className=\"space-y-2\">\n <Label htmlFor=\"mode\">{t('afterActions.ai.mode')}</Label>\n <Select value={mode} onValueChange={(v) => setMode(v as ExtractionMode)}>\n <SelectTrigger id=\"mode\">\n <SelectValue />\n </SelectTrigger>\n <SelectContent>\n <SelectItem value=\"auto\">{t('afterActions.ai.modeAuto')}</SelectItem>\n <SelectItem value=\"sync\">{t('afterActions.ai.modeSync')}</SelectItem>\n <SelectItem value=\"async\">{t('afterActions.ai.modeAsync')}</SelectItem>\n </SelectContent>\n </Select>\n <p className=\"text-xs text-muted-foreground\">\n {mode === 'auto' && t('afterActions.ai.modeAutoDesc')}\n {mode === 'sync' && t('afterActions.ai.modeSyncDesc')}\n {mode === 'async' && t('afterActions.ai.modeAsyncDesc')}\n </p>\n </div>\n\n {/* Status Display */}\n {status !== 'idle' && (\n <div className=\"space-y-2\">\n {status === 'uploading' && (\n <Alert>\n <Loader2 className=\"size-4 animate-spin\" />\n <AlertDescription>{t('afterActions.ai.uploading')}</AlertDescription>\n </Alert>\n )}\n\n {status === 'processing' && (\n <Alert>\n <Loader2 className=\"size-4 animate-spin\" />\n <AlertDescription>\n {t('afterActions.ai.processing')} ({progress}%)\n {jobId && (\n <Badge variant=\"secondary\" className=\"ms-2\">\n Job: {jobId.substring(0, 8)}\n </Badge>\n )}\n </AlertDescription>\n </Alert>\n )}\n\n {status === 'completed' && (\n <Alert className=\"border-green-500\">\n <CheckCircle className=\"size-4 text-green-500\" />\n <AlertDescription className=\"text-green-700\">\n {t('afterActions.ai.completed')}\n </AlertDescription>\n </Alert>\n )}\n\n {status === 'failed' && (\n <Alert variant=\"destructive\">\n <AlertCircle className=\"size-4\" />\n <AlertDescription>{error}</AlertDescription>\n </Alert>\n )}\n </div>\n )}\n\n {/* Info Alert */}\n {status === 'idle' && (\n <Alert>\n <AlertCircle className=\"size-4\" />\n <AlertDescription>\n {t('afterActions.ai.info')}\n </AlertDescription>\n </Alert>\n )}\n </div>\n\n {/* Action Buttons */}\n <div className={cn('flex gap-2', isRTL && 'flex-row-reverse')}>\n <Button\n onClick={handleExtract}\n disabled={!file || status === 'processing' || status === 'uploading'}\n className=\"flex-1\"\n >\n {status === 'uploading' || status === 'processing' ? (\n <>\n <Loader2 className=\"me-2 size-4 animate-spin\" />\n {t('afterActions.ai.extracting')}\n </>\n ) : (\n <>\n <Upload className=\"me-2 size-4\" />\n {t('afterActions.ai.extract')}\n </>\n )}\n </Button>\n <Button\n type=\"button\"\n variant=\"outline\"\n onClick={() => handleOpenChange(false)}\n disabled={status === 'processing' || status === 'uploading'}\n >\n {t('common.cancel')}\n </Button>\n </div>\n </DialogContent>\n </Dialog>\n );\n}\n","import { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Textarea } from '@/components/ui/textarea';\nimport { Label } from '@/components/ui/label';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Checkbox } from '@/components/ui/checkbox';\nimport { Separator } from '@/components/ui/separator';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport { Save, Send, Loader2, AlertCircle, Shield } from 'lucide-react';\nimport { cn } from '@/lib/utils';\nimport { DecisionList, type Decision } from './DecisionList';\nimport { CommitmentEditor, type Commitment } from './CommitmentEditor';\nimport { RiskList, type Risk } from './RiskList';\nimport { FollowUpList } from './FollowUpList';\nimport { AttachmentUploader } from './AttachmentUploader';\nimport { AIExtractionButton } from './AIExtractionButton';\n\ninterface FollowUpAction {\n id?: string;\n description: string;\n assigned_to?: string;\n target_date?: Date;\n completed: boolean;\n}\n\nexport interface AfterActionFormData {\n id?: string;\n engagement_id: string;\n dossier_id: string;\n is_confidential: boolean;\n attendees: string[];\n decisions: Decision[];\n commitments: Commitment[];\n risks: Risk[];\n follow_ups: FollowUpAction[];\n notes?: string;\n version?: number;\n}\n\ninterface AfterActionFormProps {\n initialData?: Partial<AfterActionFormData>;\n engagementId: string;\n dossierId: string;\n onSave: (data: AfterActionFormData, isDraft: boolean) => Promise<void>;\n onPublish?: (data: AfterActionFormData) => Promise<void>;\n readOnly?: boolean;\n canPublish?: boolean;\n availableUsers?: Array<{ id: string; name: string }>;\n className?: string;\n}\n\nexport function AfterActionForm({\n initialData,\n engagementId,\n dossierId,\n onSave,\n onPublish,\n readOnly = false,\n canPublish = false,\n availableUsers = [],\n className,\n}: AfterActionFormProps) {\n const { t, i18n } = useTranslation();\n const isRTL = i18n.language === 'ar';\n\n // Form state\n const [formData, setFormData] = useState<AfterActionFormData>({\n engagement_id: engagementId,\n dossier_id: dossierId,\n is_confidential: initialData?.is_confidential || false,\n attendees: initialData?.attendees || [],\n decisions: initialData?.decisions || [],\n commitments: initialData?.commitments || [],\n risks: initialData?.risks || [],\n follow_ups: initialData?.follow_ups || [],\n notes: initialData?.notes || '',\n version: initialData?.version,\n ...(initialData?.id && { id: initialData.id }),\n });\n\n const [attendeesInput, setAttendeesInput] = useState(\n initialData?.attendees?.join(', ') || ''\n );\n const [saving, setSaving] = useState(false);\n const [publishing, setPublishing] = useState(false);\n const [error, setError] = useState<string | null>(null);\n const [isDirty, setIsDirty] = useState(false);\n\n // Update attendees array when input changes\n useEffect(() => {\n const attendeesList = attendeesInput\n .split(',')\n .map((name) => name.trim())\n .filter((name) => name.length > 0);\n\n setFormData((prev) => ({ ...prev, attendees: attendeesList }));\n }, [attendeesInput]);\n\n // Mark form as dirty when changes occur\n useEffect(() => {\n if (!initialData) return;\n setIsDirty(true);\n }, [formData, initialData]);\n\n const handleSaveDraft = async () => {\n setSaving(true);\n setError(null);\n\n try {\n await onSave(formData, true);\n setIsDirty(false);\n } catch (err) {\n setError(err instanceof Error ? err.message : t('afterActions.form.saveFailed'));\n } finally {\n setSaving(false);\n }\n };\n\n const handlePublish = async () => {\n if (!onPublish) return;\n\n // Validate form\n if (formData.attendees.length === 0) {\n setError(t('afterActions.form.attendeesRequired'));\n return;\n }\n\n if (formData.attendees.length > 100) {\n setError(t('afterActions.form.attendeesMax'));\n return;\n }\n\n setPublishing(true);\n setError(null);\n\n try {\n await onPublish(formData);\n setIsDirty(false);\n } catch (err) {\n setError(err instanceof Error ? err.message : t('afterActions.form.publishFailed'));\n } finally {\n setPublishing(false);\n }\n };\n\n const handleAIExtraction = (extractedData: {\n decisions?: Decision[];\n commitments?: Commitment[];\n risks?: Risk[];\n follow_ups?: FollowUpAction[];\n }) => {\n // Merge extracted data with existing form data\n setFormData((prev) => ({\n ...prev,\n decisions: [\n ...prev.decisions,\n ...(extractedData.decisions?.filter((d) => (d.ai_confidence || 0) >= 0.5) || []),\n ],\n commitments: [\n ...prev.commitments,\n ...(extractedData.commitments?.filter((c) => (c.ai_confidence || 0) >= 0.5) || []),\n ],\n risks: [\n ...prev.risks,\n ...(extractedData.risks?.filter((r) => (r.ai_confidence || 0) >= 0.5) || []),\n ],\n follow_ups: [...prev.follow_ups, ...(extractedData.follow_ups || [])],\n }));\n };\n\n const isFormValid = () => {\n return (\n formData.attendees.length > 0 &&\n formData.attendees.length <= 100 &&\n (formData.decisions.length > 0 ||\n formData.commitments.length > 0 ||\n formData.risks.length > 0 ||\n formData.follow_ups.length > 0)\n );\n };\n\n return (\n <form\n className={cn('space-y-6', className)}\n dir={isRTL ? 'rtl' : 'ltr'}\n onSubmit={(e) => {\n e.preventDefault();\n handleSaveDraft();\n }}\n >\n {/* Header with AI Extraction */}\n <Card>\n <CardHeader>\n <div className=\"flex items-center justify-between\">\n <CardTitle className=\"flex items-center gap-2\">\n {t('afterActions.form.title')}\n {formData.is_confidential && (\n <Shield className=\"size-5 text-amber-500\" />\n )}\n </CardTitle>\n {!readOnly && <AIExtractionButton onExtract={handleAIExtraction} />}\n </div>\n </CardHeader>\n </Card>\n\n {/* Error Display */}\n {error && (\n <Alert variant=\"destructive\">\n <AlertCircle className=\"size-4\" />\n <AlertDescription>{error}</AlertDescription>\n </Alert>\n )}\n\n {/* Basic Information */}\n <Card>\n <CardHeader>\n <CardTitle>{t('afterActions.form.basicInfo')}</CardTitle>\n </CardHeader>\n <CardContent className=\"space-y-4\">\n {/* Attendees */}\n <div className=\"space-y-2\">\n <Label htmlFor=\"attendees\">\n {t('afterActions.form.attendees')} *\n </Label>\n <Input\n id=\"attendees\"\n type=\"text\"\n value={attendeesInput}\n onChange={(e) => setAttendeesInput(e.target.value)}\n placeholder={t('afterActions.form.attendeesPlaceholder')}\n disabled={readOnly}\n dir={isRTL ? 'rtl' : 'ltr'}\n required\n />\n <p className=\"text-xs text-muted-foreground\">\n {t('afterActions.form.attendeesHelp')} ({formData.attendees.length}/100)\n </p>\n </div>\n\n {/* Confidential Flag */}\n <div className=\"flex items-center space-x-2\">\n <Checkbox\n id=\"confidential\"\n checked={formData.is_confidential}\n onCheckedChange={(checked) =>\n setFormData((prev) => ({ ...prev, is_confidential: !!checked }))\n }\n disabled={readOnly}\n />\n <Label\n htmlFor=\"confidential\"\n className=\"flex cursor-pointer items-center gap-2 text-sm font-normal\"\n >\n {formData.is_confidential && <Shield className=\"size-4 text-amber-500\" />}\n {t('afterActions.form.confidential')}\n </Label>\n </div>\n {formData.is_confidential && (\n <Alert className=\"border-amber-500\">\n <Shield className=\"size-4 text-amber-500\" />\n <AlertDescription className=\"text-amber-700\">\n {t('afterActions.form.confidentialWarning')}\n </AlertDescription>\n </Alert>\n )}\n\n {/* Notes */}\n <div className=\"space-y-2\">\n <Label htmlFor=\"notes\">{t('afterActions.form.notes')}</Label>\n <Textarea\n id=\"notes\"\n value={formData.notes}\n onChange={(e) =>\n setFormData((prev) => ({ ...prev, notes: e.target.value }))\n }\n placeholder={t('afterActions.form.notesPlaceholder')}\n rows={4}\n disabled={readOnly}\n dir={isRTL ? 'rtl' : 'ltr'}\n />\n </div>\n </CardContent>\n </Card>\n\n <Separator />\n\n {/* Decisions */}\n <DecisionList\n decisions={formData.decisions}\n onChange={(decisions) => setFormData((prev) => ({ ...prev, decisions }))}\n readOnly={readOnly}\n />\n\n <Separator />\n\n {/* Commitments */}\n <CommitmentEditor\n commitments={formData.commitments}\n onChange={(commitments) => setFormData((prev) => ({ ...prev, commitments }))}\n readOnly={readOnly}\n availableUsers={availableUsers}\n />\n\n <Separator />\n\n {/* Risks */}\n <RiskList\n risks={formData.risks}\n onChange={(risks) => setFormData((prev) => ({ ...prev, risks }))}\n readOnly={readOnly}\n />\n\n <Separator />\n\n {/* Follow-up Actions */}\n <FollowUpList\n followUpActions={formData.follow_ups}\n onChange={(follow_ups) => setFormData((prev) => ({ ...prev, follow_ups }))}\n readOnly={readOnly}\n />\n\n <Separator />\n\n {/* Attachments */}\n <AttachmentUploader\n attachmentIds={[]}\n onChange={() => {}}\n maxFiles={10}\n maxFileSize={100 * 1024 * 1024} // 100MB\n />\n\n {/* Action Buttons */}\n {!readOnly && (\n <Card>\n <CardContent className=\"pt-6\">\n <div className={cn('flex gap-4', isRTL && 'flex-row-reverse')}>\n <Button\n type=\"submit\"\n disabled={saving || publishing || !isDirty}\n className=\"flex-1\"\n variant=\"outline\"\n >\n {saving ? (\n <>\n <Loader2 className=\"me-2 size-4 animate-spin\" />\n {t('afterActions.form.saving')}\n </>\n ) : (\n <>\n <Save className=\"me-2 size-4\" />\n {t('afterActions.form.saveDraft')}\n </>\n )}\n </Button>\n\n {canPublish && onPublish && (\n <Button\n type=\"button\"\n onClick={handlePublish}\n disabled={saving || publishing || !isFormValid()}\n className=\"flex-1\"\n >\n {publishing ? (\n <>\n <Loader2 className=\"me-2 size-4 animate-spin\" />\n {t('afterActions.form.publishing')}\n </>\n ) : (\n <>\n <Send className=\"me-2 size-4\" />\n {t('afterActions.form.publish')}\n </>\n )}\n </Button>\n )}\n </div>\n\n {!isFormValid() && (\n <p className=\"mt-4 text-center text-sm text-muted-foreground\">\n {t('afterActions.form.publishRequirements')}\n </p>\n )}\n </CardContent>\n </Card>\n )}\n </form>\n );\n}\n","import { createFileRoute, useNavigate, Link } from '@tanstack/react-router';\nimport { useEngagement } from '@/hooks/useEngagement';\nimport { useCreateAfterAction } from '@/hooks/useAfterAction';\nimport { AfterActionForm } from '@/components/AfterActionForm';\nimport { useTranslation } from 'react-i18next';\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Skeleton } from '@/components/ui/skeleton';\nimport { Button } from '@/components/ui/button';\nimport { ArrowLeft } from 'lucide-react';\nimport { toast } from 'sonner';\n\nexport const Route = createFileRoute('/_protected/engagements/$engagementId/after-action')({\n component: AfterActionFormPage,\n});\n\nfunction AfterActionFormPage() {\n const { engagementId } = Route.useParams();\n const { t, i18n } = useTranslation();\n const isRTL = i18n.language === 'ar';\n const navigate = useNavigate();\n\n const { data: engagement, isLoading: loadingEngagement } = useEngagement(engagementId);\n const createAfterAction = useCreateAfterAction();\n\n if (loadingEngagement) {\n return (\n <div className=\"container mx-auto p-6 space-y-6\">\n <Skeleton className=\"h-8 w-64\" />\n <Skeleton className=\"h-screen w-full\" />\n </div>\n );\n }\n\n if (!engagement) {\n return (\n <div className=\"container mx-auto p-6\">\n <Card className=\"border-destructive\">\n <CardHeader>\n <CardTitle className=\"text-destructive\">{t('common.error')}</CardTitle>\n <CardDescription>{t('engagements.notFound')}</CardDescription>\n </CardHeader>\n </Card>\n </div>\n );\n }\n\n const handleSaveDraft = async (data: any) => {\n try {\n const afterAction = await createAfterAction.mutateAsync({\n engagement_id: engagementId,\n dossier_id: engagement.dossier_id,\n publication_status: 'draft',\n ...data,\n });\n\n toast.success(t('afterActions.draftSaved'));\n navigate({\n to: '/after-actions/$afterActionId',\n params: { afterActionId: afterAction.id },\n });\n } catch (error: any) {\n toast.error(error.message || t('afterActions.saveFailed'));\n }\n };\n\n return (\n <div className={`container mx-auto p-6 space-y-6 ${isRTL ? 'rtl' : 'ltr'}`}>\n {/* Header */}\n <div className=\"flex items-center gap-4\">\n <Button variant=\"ghost\" size=\"icon\" asChild>\n <Link\n to=\"/engagements/$engagementId\"\n params={{ engagementId }}\n >\n <ArrowLeft className={`h-4 w-4 ${isRTL ? 'rotate-180' : ''}`} />\n </Link>\n </Button>\n <div>\n <h1 className=\"text-3xl font-bold\">{t('afterActions.logAfterAction')}</h1>\n <p className=\"text-muted-foreground\">{engagement.title}</p>\n </div>\n </div>\n\n {/* Form Card */}\n <Card>\n <CardHeader>\n <CardTitle>{t('afterActions.formTitle')}</CardTitle>\n <CardDescription>{t('afterActions.formDescription')}</CardDescription>\n </CardHeader>\n <CardContent>\n <AfterActionForm\n engagementId={engagementId}\n dossierId={engagement.dossier_id}\n onSaveDraft={handleSaveDraft}\n isLoading={createAfterAction.isPending}\n />\n </CardContent>\n </Card>\n </div>\n );\n}\n"],"names":["useEngagement","engagementId","useQuery","data","error","supabase","DecisionList","decisions","onChange","readOnly","t","i18n","useTranslation","isRTL","addDecision","removeDecision","index","_","i","updateDecision","field","value","updated","jsxs","cn","jsx","Button","Plus","decision","Card","CardHeader","CardTitle","Badge","Trash2","CardContent","Label","Textarea","e","Input","Popover","PopoverTrigger","CalendarIcon","format","PopoverContent","Calendar","date","priorities","statuses","CommitmentEditor","commitments","availableUsers","addCommitment","removeCommitment","updateCommitment","commitment","RadioGroup","RadioGroupItem","User","Mail","Select","SelectTrigger","SelectValue","SelectContent","user","SelectItem","priority","status","severities","likelihoods","severityColors","RiskList","risks","addRisk","removeRisk","updateRisk","AlertTriangle","risk","severity","likelihood","FollowUpList","followUpActions","addFollowUp","removeFollowUp","updateFollowUp","ListTodo","action","Checkbox","checked","AIExtractionButton","onExtract","disabled","className","open","setOpen","useState","file","setFile","language","setLanguage","mode","setMode","setStatus","progress","setProgress","setError","jobId","setJobId","estimatedTime","setEstimatedTime","estimateProcessingTime","useCallback","fileSize","lang","baseTime","handleFileChange","selectedFile","estimated","handleExtract","formData","response","pollJobStatus","resetState","err","id","poll","handleOpenChange","isOpen","Dialog","DialogTrigger","Sparkles","DialogContent","DialogHeader","DialogTitle","DialogDescription","v","Alert","Loader2","AlertDescription","CheckCircle","AlertCircle","Fragment","Upload","AfterActionForm","initialData","dossierId","onSave","onPublish","canPublish","setFormData","attendeesInput","setAttendeesInput","saving","setSaving","publishing","setPublishing","isDirty","setIsDirty","useEffect","attendeesList","name","prev","handleSaveDraft","handlePublish","handleAIExtraction","extractedData","d","c","r","isFormValid","Shield","Separator","follow_ups","AttachmentUploader","Save","Send","AfterActionFormPage","Route","useParams","navigate","useNavigate","engagement","isLoading","loadingEngagement","createAfterAction","useCreateAfterAction","Skeleton","CardDescription","afterAction","mutateAsync","engagement_id","dossier_id","publication_status","toast","success","to","params","afterActionId","message","Link","ArrowLeft","title","isPending"],"mappings":"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"}