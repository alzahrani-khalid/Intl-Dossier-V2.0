{"version":3,"file":"versions-BvqaXXJZ.js","sources":["../../src/components/VersionComparison.tsx","../../src/routes/_protected/positions/$id/versions.tsx?tsr-split=component"],"sourcesContent":["import { useState } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { useQuery } from '@tanstack/react-query';\nimport { Button } from '@/components/ui/button';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport {\n Select,\n SelectContent,\n SelectItem,\n SelectTrigger,\n SelectValue,\n} from '@/components/ui/select';\nimport {\n Table,\n TableBody,\n TableCell,\n TableHead,\n TableHeader,\n TableRow,\n} from '@/components/ui/table';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport { Loader2, AlertCircle, ArrowRight } from 'lucide-react';\nimport { cn } from '@/lib/utils';\nimport { supabase } from '@/lib/supabase';\n\ninterface DiffItem {\n type: 'added' | 'removed' | 'unchanged';\n text: string;\n}\n\ninterface VersionDiff {\n from_version: number;\n to_version: number;\n english_diff: DiffItem[];\n arabic_diff: DiffItem[];\n metadata_changes: Record<string, { old: any; new: any }>;\n}\n\ninterface Version {\n version_number: number;\n created_at: string;\n created_by: string;\n change_summary?: string;\n}\n\ninterface VersionComparisonProps {\n positionId: string;\n availableVersions?: Version[];\n defaultFromVersion?: number;\n defaultToVersion?: number;\n className?: string;\n}\n\nexport function VersionComparison({\n positionId,\n availableVersions = [],\n defaultFromVersion,\n defaultToVersion,\n className,\n}: VersionComparisonProps) {\n const { t, i18n } = useTranslation();\n const isRTL = i18n.language === 'ar';\n\n const [fromVersion, setFromVersion] = useState<number | undefined>(defaultFromVersion);\n const [toVersion, setToVersion] = useState<number | undefined>(defaultToVersion);\n\n // Fetch version comparison data\n const {\n data: versionDiff,\n isLoading,\n error,\n refetch,\n } = useQuery<VersionDiff>({\n queryKey: ['positions', positionId, 'compare', fromVersion, toVersion],\n queryFn: async () => {\n if (!fromVersion || !toVersion) {\n throw new Error('Both versions must be selected');\n }\n\n const {\n data: { session },\n } = await supabase.auth.getSession();\n\n if (!session) {\n throw new Error('No active session');\n }\n\n const response = await fetch(\n `${import.meta.env.VITE_SUPABASE_URL}/functions/v1/positions-versions-compare`,\n {\n method: 'POST',\n headers: {\n 'Content-Type': 'application/json',\n Authorization: `Bearer ${session.access_token}`,\n },\n body: JSON.stringify({\n position_id: positionId,\n from_version: fromVersion,\n to_version: toVersion,\n }),\n }\n );\n\n if (!response.ok) {\n const errorData = await response.json();\n throw new Error(errorData.error || 'Failed to fetch version comparison');\n }\n\n return response.json();\n },\n enabled: !!fromVersion && !!toVersion && fromVersion !== toVersion,\n });\n\n const handleCompare = () => {\n if (fromVersion && toVersion && fromVersion !== toVersion) {\n refetch();\n }\n };\n\n const renderDiffText = (diff: DiffItem[], rtl: boolean = false) => {\n return (\n <div\n className={cn('text-sm leading-relaxed whitespace-pre-wrap', rtl && 'text-end')}\n dir={rtl ? 'rtl' : 'ltr'}\n >\n {diff.map((item, index) => {\n if (item.type === 'added') {\n return (\n <span\n key={index}\n className=\"rounded bg-green-100 px-0.5 text-green-900\"\n aria-label={t('positions.versionComparison.added')}\n >\n {item.text}\n </span>\n );\n }\n\n if (item.type === 'removed') {\n return (\n <span\n key={index}\n className=\"rounded bg-red-100 px-0.5 text-red-900 line-through\"\n aria-label={t('positions.versionComparison.removed')}\n >\n {item.text}\n </span>\n );\n }\n\n return (\n <span key={index} className=\"text-gray-700\">\n {item.text}\n </span>\n );\n })}\n </div>\n );\n };\n\n const renderMetadataValue = (value: any): string => {\n if (value === null || value === undefined) return t('common.none');\n if (typeof value === 'boolean') return value ? t('common.yes') : t('common.no');\n if (typeof value === 'object') return JSON.stringify(value);\n return String(value);\n };\n\n return (\n <div className={cn('space-y-6', className)}>\n {/* Version Selectors */}\n <Card>\n <CardHeader>\n <CardTitle className={cn('flex items-center gap-2', isRTL && 'flex-row-reverse')}>\n {t('positions.versionComparison.title')}\n </CardTitle>\n </CardHeader>\n <CardContent>\n <div className={cn('flex items-center gap-4', isRTL && 'flex-row-reverse')}>\n <div className=\"flex-1\">\n <label\n className={cn('block text-sm font-medium mb-2', isRTL && 'text-end')}\n htmlFor=\"from-version\"\n >\n {t('positions.versionComparison.fromVersion')}\n </label>\n <Select\n value={fromVersion?.toString()}\n onValueChange={(value) => setFromVersion(parseInt(value))}\n >\n <SelectTrigger id=\"from-version\" className=\"w-full\">\n <SelectValue placeholder={t('positions.versionComparison.selectVersion')} />\n </SelectTrigger>\n <SelectContent>\n {availableVersions.map((version) => (\n <SelectItem\n key={version.version_number}\n value={version.version_number.toString()}\n disabled={version.version_number === toVersion}\n >\n v{version.version_number}\n {version.change_summary && ` - ${version.change_summary}`}\n </SelectItem>\n ))}\n </SelectContent>\n </Select>\n </div>\n\n <ArrowRight className=\"mt-6 size-5 shrink-0 text-muted-foreground\" />\n\n <div className=\"flex-1\">\n <label\n className={cn('block text-sm font-medium mb-2', isRTL && 'text-end')}\n htmlFor=\"to-version\"\n >\n {t('positions.versionComparison.toVersion')}\n </label>\n <Select\n value={toVersion?.toString()}\n onValueChange={(value) => setToVersion(parseInt(value))}\n >\n <SelectTrigger id=\"to-version\" className=\"w-full\">\n <SelectValue placeholder={t('positions.versionComparison.selectVersion')} />\n </SelectTrigger>\n <SelectContent>\n {availableVersions.map((version) => (\n <SelectItem\n key={version.version_number}\n value={version.version_number.toString()}\n disabled={version.version_number === fromVersion}\n >\n v{version.version_number}\n {version.change_summary && ` - ${version.change_summary}`}\n </SelectItem>\n ))}\n </SelectContent>\n </Select>\n </div>\n\n <Button\n onClick={handleCompare}\n disabled={\n !fromVersion || !toVersion || fromVersion === toVersion || isLoading\n }\n className=\"mt-6\"\n >\n {isLoading ? (\n <Loader2 className=\"size-4 animate-spin\" />\n ) : (\n t('positions.versionComparison.compare')\n )}\n </Button>\n </div>\n\n {fromVersion === toVersion && fromVersion && (\n <Alert className=\"mt-4\">\n <AlertCircle className=\"size-4\" />\n <AlertDescription>\n {t('positions.versionComparison.sameVersionError')}\n </AlertDescription>\n </Alert>\n )}\n </CardContent>\n </Card>\n\n {/* Loading State */}\n {isLoading && (\n <div className=\"flex items-center justify-center py-12\">\n <Loader2 className=\"size-8 animate-spin text-primary\" />\n </div>\n )}\n\n {/* Error State */}\n {error && (\n <Alert variant=\"destructive\">\n <AlertCircle className=\"size-4\" />\n <AlertDescription>\n {error instanceof Error ? error.message : t('positions.versionComparison.error')}\n </AlertDescription>\n </Alert>\n )}\n\n {/* Diff Display */}\n {versionDiff && !isLoading && (\n <div className=\"space-y-6\">\n {/* Side-by-Side Content Comparison */}\n <Card>\n <CardHeader>\n <CardTitle className={cn('flex items-center gap-2', isRTL && 'flex-row-reverse')}>\n {t('positions.versionComparison.contentChanges')}\n </CardTitle>\n </CardHeader>\n <CardContent>\n <div className=\"grid grid-cols-1 gap-6 lg:grid-cols-2\">\n {/* English Diff (Left) */}\n <div className=\"space-y-2\">\n <div className=\"mb-3 flex items-center gap-2\">\n <h3 className=\"text-sm font-semibold\">\n {t('positions.versionComparison.englishVersion')}\n </h3>\n <div className=\"flex items-center gap-2 text-xs text-muted-foreground\">\n <span className=\"inline-flex items-center gap-1\">\n <span className=\"size-3 rounded border border-green-300 bg-green-100\" />\n {t('positions.versionComparison.added')}\n </span>\n <span className=\"inline-flex items-center gap-1\">\n <span className=\"size-3 rounded border border-red-300 bg-red-100\" />\n {t('positions.versionComparison.removed')}\n </span>\n </div>\n </div>\n <div className=\"min-h-[200px] rounded-md border bg-gray-50 p-4\">\n {versionDiff.english_diff.length > 0 ? (\n renderDiffText(versionDiff.english_diff, false)\n ) : (\n <p className=\"text-sm text-muted-foreground\">\n {t('positions.versionComparison.noChanges')}\n </p>\n )}\n </div>\n </div>\n\n {/* Arabic Diff (Right) */}\n <div className=\"space-y-2\">\n <div className=\"mb-3 flex items-center justify-end gap-2\">\n <div className=\"flex items-center gap-2 text-xs text-muted-foreground\">\n <span className=\"inline-flex items-center gap-1\">\n <span className=\"size-3 rounded border border-red-300 bg-red-100\" />\n {t('positions.versionComparison.removed')}\n </span>\n <span className=\"inline-flex items-center gap-1\">\n <span className=\"size-3 rounded border border-green-300 bg-green-100\" />\n {t('positions.versionComparison.added')}\n </span>\n </div>\n <h3 className=\"text-sm font-semibold\">\n {t('positions.versionComparison.arabicVersion')}\n </h3>\n </div>\n <div className=\"min-h-[200px] rounded-md border bg-gray-50 p-4\" dir=\"rtl\">\n {versionDiff.arabic_diff.length > 0 ? (\n renderDiffText(versionDiff.arabic_diff, true)\n ) : (\n <p className=\"text-end text-sm text-muted-foreground\">\n {t('positions.versionComparison.noChanges')}\n </p>\n )}\n </div>\n </div>\n </div>\n </CardContent>\n </Card>\n\n {/* Metadata Changes */}\n {Object.keys(versionDiff.metadata_changes).length > 0 && (\n <Card>\n <CardHeader>\n <CardTitle\n className={cn('flex items-center gap-2', isRTL && 'flex-row-reverse')}\n >\n {t('positions.versionComparison.metadataChanges')}\n </CardTitle>\n </CardHeader>\n <CardContent>\n <div className=\"rounded-md border\">\n <Table>\n <TableHeader>\n <TableRow>\n <TableHead className={cn(isRTL && 'text-end')}>\n {t('positions.versionComparison.field')}\n </TableHead>\n <TableHead className={cn(isRTL && 'text-end')}>\n {t('positions.versionComparison.oldValue')}\n </TableHead>\n <TableHead className={cn(isRTL && 'text-end')}>\n {t('positions.versionComparison.newValue')}\n </TableHead>\n </TableRow>\n </TableHeader>\n <TableBody>\n {Object.entries(versionDiff.metadata_changes).map(([field, change]) => (\n <TableRow key={field}>\n <TableCell className={cn('font-medium', isRTL && 'text-end')}>\n {t(`positions.fields.${field}`, field)}\n </TableCell>\n <TableCell className={cn(isRTL && 'text-end')}>\n <span className=\"text-red-600\">\n {renderMetadataValue(change.old)}\n </span>\n </TableCell>\n <TableCell className={cn(isRTL && 'text-end')}>\n <span className=\"text-green-600\">\n {renderMetadataValue(change.new)}\n </span>\n </TableCell>\n </TableRow>\n ))}\n </TableBody>\n </Table>\n </div>\n </CardContent>\n </Card>\n )}\n\n {/* No Changes Message */}\n {versionDiff.english_diff.length === 0 &&\n versionDiff.arabic_diff.length === 0 &&\n Object.keys(versionDiff.metadata_changes).length === 0 && (\n <Alert>\n <AlertCircle className=\"size-4\" />\n <AlertDescription>\n {t('positions.versionComparison.noChangesBetweenVersions')}\n </AlertDescription>\n </Alert>\n )}\n </div>\n )}\n </div>\n );\n}\n","/**\n * Route: /positions/:id/versions\n * Version history and comparison page\n */\n\nimport { createFileRoute, Link } from '@tanstack/react-router';\nimport { useState } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Card } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { useQuery } from '@tanstack/react-query';\nimport { supabase } from '@/lib/supabase';\nimport { ArrowLeft, GitCompare } from 'lucide-react';\nimport { VersionComparison } from '@/components/VersionComparison';\nimport { Skeleton } from '@/components/ui/skeleton';\n\nexport const Route = createFileRoute('/_protected/positions/$id/versions')({\n component: VersionHistoryPage,\n});\n\nconst API_BASE_URL = import.meta.env.VITE_SUPABASE_URL + '/functions/v1';\n\nasync function fetchVersions(positionId: string) {\n const { data: { session } } = await supabase.auth.getSession();\n const response = await fetch(`${API_BASE_URL}/positions-versions-list?id=${positionId}`, {\n headers: {\n 'Authorization': `Bearer ${session?.access_token}`,\n 'Content-Type': 'application/json',\n },\n });\n\n if (!response.ok) {\n throw new Error('Failed to fetch versions');\n }\n\n const data = await response.json();\n return data.versions || [];\n}\n\nfunction VersionHistoryPage() {\n const { id } = Route.useParams();\n const { t } = useTranslation();\n const [selectedVersions, setSelectedVersions] = useState<[number | null, number | null]>([null, null]);\n\n const { data: versions, isLoading } = useQuery({\n queryKey: ['positions', 'versions', id],\n queryFn: () => fetchVersions(id),\n });\n\n const handleVersionSelect = (versionNumber: number) => {\n if (selectedVersions[0] === null) {\n setSelectedVersions([versionNumber, null]);\n } else if (selectedVersions[1] === null && versionNumber !== selectedVersions[0]) {\n setSelectedVersions([selectedVersions[0], versionNumber]);\n } else {\n setSelectedVersions([versionNumber, null]);\n }\n };\n\n const canCompare = selectedVersions[0] !== null && selectedVersions[1] !== null;\n\n if (isLoading) {\n return (\n <div className=\"container mx-auto py-6 space-y-4\">\n <Skeleton className=\"h-8 w-64\" />\n <Skeleton className=\"h-96\" />\n </div>\n );\n }\n\n return (\n <div className=\"container mx-auto py-6 space-y-6\">\n {/* Header */}\n <div className=\"flex items-center justify-between\">\n <div className=\"flex items-center gap-4\">\n <Link to=\"/positions/$id\" params={{ id }}>\n <Button variant=\"outline\" size=\"sm\">\n <ArrowLeft className=\"me-2 h-4 w-4\" />\n {t('common.back', 'Back')}\n </Button>\n </Link>\n <h1 className=\"text-3xl font-bold\">\n {t('positions.versions.title', 'Version History')}\n </h1>\n </div>\n\n {canCompare && (\n <Button onClick={() => {}}>\n <GitCompare className=\"me-2 h-4 w-4\" />\n {t('positions.versions.compare', 'Compare Versions')}\n </Button>\n )}\n </div>\n\n {/* Version List */}\n {!canCompare && (\n <Card className=\"p-6\">\n <div className=\"space-y-4\">\n <p className=\"text-sm text-muted-foreground\">\n {t('positions.versions.selectTwo', 'Select two versions to compare')}\n </p>\n\n <div className=\"space-y-2\">\n {versions?.map((version: any) => (\n <div\n key={version.id}\n className={`p-4 border rounded-lg cursor-pointer transition-colors ${\n selectedVersions.includes(version.version_number)\n ? 'border-primary bg-primary/5'\n : 'hover:border-primary/50'\n }`}\n onClick={() => handleVersionSelect(version.version_number)}\n >\n <div className=\"flex items-center justify-between\">\n <div className=\"space-y-1\">\n <div className=\"flex items-center gap-2\">\n <span className=\"font-semibold\">\n {t('positions.versions.version', 'Version')} {version.version_number}\n </span>\n {!version.superseded && (\n <Badge variant=\"success\">\n {t('positions.versions.current', 'Current')}\n </Badge>\n )}\n </div>\n <p className=\"text-sm text-muted-foreground\">\n {new Date(version.created_at).toLocaleString()}\n </p>\n </div>\n </div>\n </div>\n ))}\n </div>\n </div>\n </Card>\n )}\n\n {/* Version Comparison */}\n {canCompare && (\n <Card className=\"p-6\">\n <div className=\"mb-4 flex items-center justify-between\">\n <div className=\"flex items-center gap-2\">\n <span className=\"text-sm text-muted-foreground\">\n {t('positions.versions.comparing', 'Comparing versions')}:\n </span>\n <Badge>{selectedVersions[0]}</Badge>\n <span className=\"text-sm text-muted-foreground\">vs</span>\n <Badge>{selectedVersions[1]}</Badge>\n </div>\n <Button variant=\"outline\" onClick={() => setSelectedVersions([null, null])}>\n {t('common.clear', 'Clear Selection')}\n </Button>\n </div>\n\n <VersionComparison\n positionId={id}\n fromVersion={Math.min(selectedVersions[0]!, selectedVersions[1]!)}\n toVersion={Math.max(selectedVersions[0]!, selectedVersions[1]!)}\n />\n </Card>\n )}\n </div>\n );\n}\n"],"names":["VersionComparison","positionId","availableVersions","defaultFromVersion","defaultToVersion","className","t","i18n","useTranslation","isRTL","fromVersion","setFromVersion","useState","toVersion","setToVersion","versionDiff","isLoading","error","refetch","useQuery","session","supabase","response","errorData","handleCompare","renderDiffText","diff","rtl","jsx","cn","item","index","renderMetadataValue","value","jsxs","Card","CardHeader","CardTitle","CardContent","Select","SelectTrigger","SelectValue","SelectContent","version","SelectItem","ArrowRight","Button","Loader2","Alert","AlertCircle","AlertDescription","Table","TableHeader","TableRow","TableHead","TableBody","field","change","TableCell","API_BASE_URL","import","fetchVersions","data","auth","getSession","fetch","headers","access_token","ok","Error","json","versions","VersionHistoryPage","id","Route","useParams","selectedVersions","setSelectedVersions","queryKey","queryFn","handleVersionSelect","versionNumber","canCompare","Skeleton","Link","ArrowLeft","GitCompare","map","includes","version_number","superseded","Badge","Date","created_at","toLocaleString","Math","min","max"],"mappings":"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"}