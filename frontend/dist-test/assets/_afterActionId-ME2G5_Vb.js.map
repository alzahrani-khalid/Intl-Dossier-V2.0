{"version":3,"file":"_afterActionId-ME2G5_Vb.js","sources":["../../src/hooks/usePublishAfterAction.ts","../../src/hooks/useEditWorkflow.ts","../../src/components/StepUpMFA.tsx","../../src/components/PDFGeneratorButton.tsx","../../src/components/EditApprovalFlow.tsx","../../src/routes/_protected/after-actions/$afterActionId.tsx?tsr-split=component"],"sourcesContent":["/**\n * usePublishAfterAction Hook\n *\n * Mutation hook for publishing after-action records\n */\n\nimport { useMutation, useQueryClient } from '@tanstack/react-query';\nimport { supabase } from '@/lib/supabase';\n\ninterface PublishParams {\n  afterActionId: string;\n  isConfidential: boolean;\n}\n\nexport function usePublishAfterAction() {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: async ({ afterActionId, isConfidential }: PublishParams) => {\n      const { data, error } = await supabase.functions.invoke(\n        'after-actions-publish',\n        {\n          body: { after_action_id: afterActionId, is_confidential: isConfidential },\n        }\n      );\n\n      if (error) throw error;\n      return data;\n    },\n    onSuccess: (_, { afterActionId }) => {\n      queryClient.invalidateQueries({ queryKey: ['after-action', afterActionId] });\n      queryClient.invalidateQueries({ queryKey: ['after-actions'] });\n    },\n  });\n}\n","/**\n * useEditWorkflow Hooks\n *\n * Hooks for managing edit approval workflow for after-actions\n */\n\nimport { useMutation, useQueryClient } from '@tanstack/react-query';\nimport { supabase } from '@/lib/supabase';\n\ninterface EditRequestParams {\n  afterActionId: string;\n  reason: string;\n}\n\nexport function useRequestEdit() {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: async ({ afterActionId, reason }: EditRequestParams) => {\n      const { data, error } = await supabase.functions.invoke(\n        'after-actions-request-edit',\n        {\n          body: { after_action_id: afterActionId, reason },\n        }\n      );\n\n      if (error) throw error;\n      return data;\n    },\n    onSuccess: (_, { afterActionId }) => {\n      queryClient.invalidateQueries({ queryKey: ['after-action', afterActionId] });\n    },\n  });\n}\n\nexport function useApproveEdit() {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: async ({ afterActionId }: { afterActionId: string }) => {\n      const { data, error } = await supabase.functions.invoke(\n        'after-actions-approve-edit',\n        {\n          body: { after_action_id: afterActionId },\n        }\n      );\n\n      if (error) throw error;\n      return data;\n    },\n    onSuccess: (_, { afterActionId }) => {\n      queryClient.invalidateQueries({ queryKey: ['after-action', afterActionId] });\n    },\n  });\n}\n\nexport function useRejectEdit() {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: async ({ afterActionId, reason }: EditRequestParams) => {\n      const { data, error } = await supabase.functions.invoke(\n        'after-actions-reject-edit',\n        {\n          body: { after_action_id: afterActionId, reason },\n        }\n      );\n\n      if (error) throw error;\n      return data;\n    },\n    onSuccess: (_, { afterActionId }) => {\n      queryClient.invalidateQueries({ queryKey: ['after-action', afterActionId] });\n    },\n  });\n}\n","/**\n * Step-Up MFA Component (T063)\n *\n * Purpose: Modal dialog for step-up authentication challenge before approval actions\n * Supports TOTP/SMS/Push challenge types with countdown timer and elevated token storage\n *\n * Features:\n * - Challenge type detection (TOTP/SMS/Push)\n * - 6-digit verification code input\n * - Countdown timer (10 minutes expiry)\n * - Resend code functionality\n * - Error handling with retry logic\n * - Elevated token storage\n * - Auto-trigger before approval actions\n * - Bilingual support (EN/AR)\n * - Full accessibility\n */\n\nimport React, { useState, useRef, useEffect, useCallback } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Shield, AlertTriangle, Clock, RefreshCw } from 'lucide-react';\nimport {\n Dialog,\n DialogContent,\n DialogDescription,\n DialogFooter,\n DialogHeader,\n DialogTitle,\n} from './ui/dialog';\nimport { Button } from './ui/button';\nimport { Input } from './ui/input';\nimport { supabase } from '@/lib/supabase';\n\ninterface StepUpMFAProps {\n /** Whether the dialog is open */\n open: boolean;\n /** Action being performed (e.g., 'approve') */\n action: string;\n /** Position ID for the approval action */\n positionId: string;\n /** Callback when verification succeeds, receives elevated token */\n onSuccess: (elevatedToken: string, validUntil: string) => void;\n /** Callback when dialog is closed/cancelled */\n onCancel: () => void;\n /** Optional custom reason for step-up */\n reason?: string;\n}\n\ntype ChallengeType = 'totp' | 'sms' | 'push';\n\ninterface ChallengeData {\n challenge_id: string;\n challenge_type: ChallengeType;\n expires_at: string;\n}\n\ninterface VerificationResponse {\n elevated_token: string;\n valid_until: string;\n}\n\nexport function StepUpMFA({\n open,\n action,\n positionId,\n onSuccess,\n onCancel,\n reason,\n}: StepUpMFAProps) {\n const { t, i18n } = useTranslation('positions');\n const isRTL = i18n.language === 'ar';\n\n // State\n const [challengeData, setChallengeData] = useState<ChallengeData | null>(null);\n const [verificationCode, setVerificationCode] = useState('');\n const [isInitiating, setIsInitiating] = useState(false);\n const [isVerifying, setIsVerifying] = useState(false);\n const [isResending, setIsResending] = useState(false);\n const [error, setError] = useState<string | null>(null);\n const [timeRemaining, setTimeRemaining] = useState(0);\n const [canResend, setCanResend] = useState(false);\n\n const inputRef = useRef<HTMLInputElement>(null);\n const timerRef = useRef<NodeJS.Timeout | null>(null);\n\n /**\n * Format time remaining as MM:SS\n */\n const formatTime = (seconds: number): string => {\n const mins = Math.floor(seconds / 60);\n const secs = seconds % 60;\n return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;\n };\n\n /**\n * Start countdown timer\n */\n const startTimer = useCallback((expiresAt: string) => {\n // Clear existing timer\n if (timerRef.current) {\n clearInterval(timerRef.current);\n }\n\n const updateTimer = () => {\n const now = Date.now();\n const expiry = new Date(expiresAt).getTime();\n const remaining = Math.max(0, Math.floor((expiry - now) / 1000));\n\n setTimeRemaining(remaining);\n\n // Enable resend button after 30 seconds for SMS/Push\n if (remaining < 570 && (challengeData?.challenge_type === 'sms' || challengeData?.challenge_type === 'push')) {\n setCanResend(true);\n }\n\n // Timer expired\n if (remaining === 0) {\n if (timerRef.current) {\n clearInterval(timerRef.current);\n }\n setError(t('stepUp.errors.expired'));\n }\n };\n\n // Initial update\n updateTimer();\n\n // Update every second\n timerRef.current = setInterval(updateTimer, 1000);\n }, [challengeData?.challenge_type, t]);\n\n /**\n * Initiate step-up challenge\n */\n const initiateChallenge = useCallback(async () => {\n setIsInitiating(true);\n setError(null);\n\n try {\n const { data: { session } } = await supabase.auth.getSession();\n\n if (!session) {\n throw new Error('No active session');\n }\n\n const response = await fetch(\n `${import.meta.env.VITE_SUPABASE_URL}/functions/v1/auth-step-up-initiate`,\n {\n method: 'POST',\n headers: {\n 'Content-Type': 'application/json',\n 'Authorization': `Bearer ${session.access_token}`,\n },\n body: JSON.stringify({\n action,\n position_id: positionId,\n }),\n }\n );\n\n if (!response.ok) {\n const errorData = await response.json();\n throw new Error(errorData.message || 'Failed to initiate step-up challenge');\n }\n\n const data: ChallengeData = await response.json();\n setChallengeData(data);\n startTimer(data.expires_at);\n\n // Focus input after challenge is initiated\n setTimeout(() => {\n inputRef.current?.focus();\n }, 100);\n } catch (err) {\n console.error('Failed to initiate step-up challenge:', err);\n setError(err instanceof Error ? err.message : t('stepUp.errors.networkError'));\n } finally {\n setIsInitiating(false);\n }\n }, [action, positionId, startTimer, t]);\n\n /**\n * Verify step-up code\n */\n const verifyCode = async (e: React.FormEvent) => {\n e.preventDefault();\n\n if (!challengeData) {\n setError(t('stepUp.errors.noChallengeActive'));\n return;\n }\n\n // Validate code format\n if (verificationCode.length !== 6 || !/^\\d{6}$/.test(verificationCode)) {\n setError(t('stepUp.errors.invalidFormat'));\n return;\n }\n\n setIsVerifying(true);\n setError(null);\n\n try {\n const { data: { session } } = await supabase.auth.getSession();\n\n if (!session) {\n throw new Error('No active session');\n }\n\n const response = await fetch(\n `${import.meta.env.VITE_SUPABASE_URL}/functions/v1/auth-step-up-complete`,\n {\n method: 'POST',\n headers: {\n 'Content-Type': 'application/json',\n 'Authorization': `Bearer ${session.access_token}`,\n },\n body: JSON.stringify({\n challenge_id: challengeData.challenge_id,\n verification_code: verificationCode,\n }),\n }\n );\n\n if (!response.ok) {\n const errorData = await response.json();\n if (response.status === 401) {\n throw new Error(t('stepUp.errors.invalidCode'));\n }\n throw new Error(errorData.message || 'Verification failed');\n }\n\n const data: VerificationResponse = await response.json();\n\n // Store elevated token in sessionStorage for this session only\n sessionStorage.setItem('elevated_token', data.elevated_token);\n sessionStorage.setItem('elevated_token_valid_until', data.valid_until);\n\n // Call success callback\n onSuccess(data.elevated_token, data.valid_until);\n\n // Reset state\n resetState();\n } catch (err) {\n console.error('Failed to verify step-up code:', err);\n setError(err instanceof Error ? err.message : t('stepUp.errors.verificationFailed'));\n setVerificationCode('');\n } finally {\n setIsVerifying(false);\n }\n };\n\n /**\n * Resend challenge code (for SMS/Push)\n */\n const resendCode = async () => {\n if (!canResend || !challengeData) return;\n\n setIsResending(true);\n setError(null);\n setCanResend(false);\n\n try {\n // Re-initiate challenge to get a new code\n await initiateChallenge();\n setVerificationCode('');\n } catch (err) {\n console.error('Failed to resend code:', err);\n setError(t('stepUp.errors.resendFailed'));\n } finally {\n setIsResending(false);\n }\n };\n\n /**\n * Reset component state\n */\n const resetState = () => {\n setChallengeData(null);\n setVerificationCode('');\n setError(null);\n setTimeRemaining(0);\n setCanResend(false);\n\n if (timerRef.current) {\n clearInterval(timerRef.current);\n timerRef.current = null;\n }\n };\n\n /**\n * Handle dialog close\n */\n const handleCancel = () => {\n resetState();\n onCancel();\n };\n\n /**\n * Effect: Initiate challenge when dialog opens\n */\n useEffect(() => {\n if (open && !challengeData) {\n initiateChallenge();\n } else if (!open) {\n resetState();\n }\n }, [open, challengeData, initiateChallenge]);\n\n /**\n * Effect: Cleanup timer on unmount\n */\n useEffect(() => {\n return () => {\n if (timerRef.current) {\n clearInterval(timerRef.current);\n }\n };\n }, []);\n\n /**\n * Get challenge type label\n */\n const getChallengeTypeLabel = (): string => {\n if (!challengeData) return '';\n\n switch (challengeData.challenge_type) {\n case 'totp':\n return t('stepUp.challengeTypes.totp');\n case 'sms':\n return t('stepUp.challengeTypes.sms');\n case 'push':\n return t('stepUp.challengeTypes.push');\n default:\n return '';\n }\n };\n\n /**\n * Get placeholder text based on challenge type\n */\n const getPlaceholder = (): string => {\n if (!challengeData) return '000000';\n\n switch (challengeData.challenge_type) {\n case 'totp':\n return t('stepUp.placeholders.totp');\n case 'sms':\n return t('stepUp.placeholders.sms');\n case 'push':\n return t('stepUp.placeholders.push');\n default:\n return '000000';\n }\n };\n\n return (\n <Dialog open={open} onOpenChange={(isOpen) => !isOpen && handleCancel()}>\n <DialogContent\n className=\"max-w-md\"\n aria-describedby=\"step-up-description\"\n >\n <DialogHeader>\n <DialogTitle className=\"flex items-center gap-2\">\n <Shield className=\"size-5 text-orange-500\" aria-hidden=\"true\" />\n <span>{t('stepUp.title')}</span>\n </DialogTitle>\n <DialogDescription id=\"step-up-description\">\n {t('stepUp.description')}\n </DialogDescription>\n </DialogHeader>\n\n {/* Reason for step-up */}\n {reason && (\n <div className=\"rounded-md border border-amber-200 bg-amber-50 p-3\">\n <div className=\"flex items-start gap-2\">\n <AlertTriangle className=\"mt-0.5 size-4 shrink-0 text-amber-600\" aria-hidden=\"true\" />\n <p className=\"text-sm text-amber-900\">{reason}</p>\n </div>\n </div>\n )}\n\n {/* Loading state */}\n {isInitiating && (\n <div className=\"flex items-center justify-center py-8\">\n <div className=\"size-8 animate-spin rounded-full border-b-2 border-primary\"></div>\n <span className=\"ms-3 text-sm text-muted-foreground\">\n {t('stepUp.initiating')}\n </span>\n </div>\n )}\n\n {/* Challenge form */}\n {challengeData && !isInitiating && (\n <form onSubmit={verifyCode} className=\"space-y-4\">\n {/* Challenge type info */}\n <div className=\"flex items-center justify-between rounded-md bg-muted p-3\">\n <div className=\"flex items-center gap-2\">\n <Shield className=\"size-4 text-muted-foreground\" aria-hidden=\"true\" />\n <span className=\"text-sm font-medium\">\n {getChallengeTypeLabel()}\n </span>\n </div>\n <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\n <Clock className=\"size-4\" aria-hidden=\"true\" />\n <span\n aria-live=\"polite\"\n aria-atomic=\"true\"\n className={timeRemaining < 60 ? 'font-medium text-destructive' : ''}\n >\n {formatTime(timeRemaining)}\n </span>\n </div>\n </div>\n\n {/* Verification code input */}\n <div className=\"space-y-2\">\n <label\n htmlFor=\"verification-code\"\n className=\"text-sm font-medium\"\n >\n {t('stepUp.codeLabel')}\n </label>\n <Input\n ref={inputRef}\n id=\"verification-code\"\n type=\"text\"\n inputMode=\"numeric\"\n pattern=\"\\d{6}\"\n maxLength={6}\n value={verificationCode}\n onChange={(e) => {\n const value = e.target.value.replace(/\\D/g, '');\n setVerificationCode(value);\n setError(null); // Clear error on input\n }}\n placeholder={getPlaceholder()}\n disabled={isVerifying || timeRemaining === 0}\n className=\"text-center font-mono text-2xl tracking-widest\"\n aria-invalid={!!error}\n aria-describedby={error ? 'verification-error' : undefined}\n autoComplete=\"one-time-code\"\n />\n </div>\n\n {/* Error message */}\n {error && (\n <div\n id=\"verification-error\"\n className=\"rounded-md border border-destructive/20 bg-destructive/10 p-3\"\n role=\"alert\"\n >\n <p className=\"text-sm text-destructive\">{error}</p>\n </div>\n )}\n\n {/* Resend code button (for SMS/Push only) */}\n {(challengeData.challenge_type === 'sms' || challengeData.challenge_type === 'push') && (\n <Button\n type=\"button\"\n variant=\"ghost\"\n size=\"sm\"\n onClick={resendCode}\n disabled={!canResend || isResending || timeRemaining === 0}\n className=\"w-full\"\n >\n <RefreshCw className={`me-2 size-4 ${isResending ? 'animate-spin' : ''}`} aria-hidden=\"true\" />\n {isResending ? t('stepUp.resending') : t('stepUp.resendCode')}\n </Button>\n )}\n\n {/* Actions */}\n <DialogFooter className=\"flex-col gap-2 sm:flex-row\">\n <Button\n type=\"button\"\n variant=\"outline\"\n onClick={handleCancel}\n disabled={isVerifying}\n className=\"w-full sm:w-auto\"\n >\n {t('stepUp.cancel')}\n </Button>\n <Button\n type=\"submit\"\n disabled={\n isVerifying ||\n verificationCode.length !== 6 ||\n timeRemaining === 0\n }\n className=\"w-full sm:w-auto\"\n >\n {isVerifying ? (\n <>\n <div className=\"me-2 size-4 animate-spin rounded-full border-b-2 border-white\"></div>\n {t('stepUp.verifying')}\n </>\n ) : (\n t('stepUp.verify')\n )}\n </Button>\n </DialogFooter>\n </form>\n )}\n\n {/* Help text */}\n <div className=\"border-t pt-4\">\n <p className=\"text-center text-xs text-muted-foreground\">\n {t('stepUp.helpText')}\n </p>\n </div>\n </DialogContent>\n </Dialog>\n );\n}\n\n/**\n * Hook to get elevated token from storage\n */\nexport function useElevatedToken(): {\n token: string | null;\n isValid: boolean;\n validUntil: string | null;\n} {\n const token = sessionStorage.getItem('elevated_token');\n const validUntil = sessionStorage.getItem('elevated_token_valid_until');\n\n const isValid = token && validUntil\n ? new Date(validUntil).getTime() > Date.now()\n : false;\n\n return {\n token,\n isValid,\n validUntil,\n };\n}\n\n/**\n * Hook to clear elevated token\n */\nexport function clearElevatedToken(): void {\n sessionStorage.removeItem('elevated_token');\n sessionStorage.removeItem('elevated_token_valid_until');\n}\n","import { useState } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Button } from '@/components/ui/button';\nimport { Label } from '@/components/ui/label';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport {\n Dialog,\n DialogContent,\n DialogDescription,\n DialogHeader,\n DialogTitle,\n DialogTrigger,\n} from '@/components/ui/dialog';\nimport { RadioGroup, RadioGroupItem } from '@/components/ui/radio-group';\nimport { FileText, Download, Loader2, AlertCircle, CheckCircle, Shield } from 'lucide-react';\nimport { cn } from '@/lib/utils';\nimport { StepUpMFA } from './StepUpMFA';\n\ninterface PDFGeneratorButtonProps {\n afterActionId: string;\n isConfidential: boolean;\n disabled?: boolean;\n className?: string;\n}\n\ntype PDFLanguage = 'en' | 'ar' | 'both';\ntype GenerationStatus = 'idle' | 'verifying' | 'generating' | 'completed' | 'failed';\n\nexport function PDFGeneratorButton({\n afterActionId,\n isConfidential,\n disabled = false,\n className,\n}: PDFGeneratorButtonProps) {\n const { t, i18n } = useTranslation();\n const isRTL = i18n.language === 'ar';\n\n const [open, setOpen] = useState(false);\n const [language, setLanguage] = useState<PDFLanguage>('both');\n const [status, setStatus] = useState<GenerationStatus>('idle');\n const [error, setError] = useState<string | null>(null);\n const [pdfUrl, setPdfUrl] = useState<string | null>(null);\n const [expiresAt, setExpiresAt] = useState<Date | null>(null);\n const [showMFA, setShowMFA] = useState(false);\n const [mfaToken, setMfaToken] = useState<string | null>(null);\n\n const handleGenerate = async () => {\n // Check if confidential record requires step-up auth\n if (isConfidential && !mfaToken) {\n setShowMFA(true);\n return;\n }\n\n setStatus('generating');\n setError(null);\n\n try {\n const response = await fetch(`/api/after-actions/${afterActionId}/pdf`, {\n method: 'POST',\n headers: {\n 'Content-Type': 'application/json',\n ...(mfaToken && { 'X-MFA-Token': mfaToken }),\n },\n body: JSON.stringify({ language }),\n });\n\n if (!response.ok) {\n const data = await response.json();\n\n if (response.status === 403 && data.error === 'step_up_required') {\n setShowMFA(true);\n setStatus('verifying');\n return;\n }\n\n throw new Error(data.error || t('afterActions.pdf.generationFailed'));\n }\n\n const data = await response.json();\n\n setStatus('completed');\n setPdfUrl(data.pdf_url);\n setExpiresAt(new Date(Date.now() + 24 * 60 * 60 * 1000)); // 24 hours from now\n } catch (err) {\n setStatus('failed');\n setError(err instanceof Error ? err.message : t('afterActions.pdf.generationFailed'));\n }\n };\n\n const handleMFASuccess = (token: string) => {\n setMfaToken(token);\n setShowMFA(false);\n // Retry generation with MFA token\n handleGenerate();\n };\n\n const handleDownload = () => {\n if (pdfUrl) {\n window.open(pdfUrl, '_blank');\n }\n };\n\n const resetState = () => {\n setStatus('idle');\n setError(null);\n setPdfUrl(null);\n setExpiresAt(null);\n setMfaToken(null);\n setShowMFA(false);\n };\n\n const handleOpenChange = (isOpen: boolean) => {\n setOpen(isOpen);\n if (!isOpen) {\n resetState();\n }\n };\n\n const getTimeRemaining = () => {\n if (!expiresAt) return '';\n\n const now = new Date();\n const diff = expiresAt.getTime() - now.getTime();\n const hours = Math.floor(diff / (1000 * 60 * 60));\n const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));\n\n return t('afterActions.pdf.expiresIn', { hours, minutes });\n };\n\n if (showMFA) {\n return (\n <StepUpMFA\n open={showMFA}\n onClose={() => {\n setShowMFA(false);\n setStatus('idle');\n }}\n onSuccess={handleMFASuccess}\n reason={t('afterActions.pdf.mfaReason')}\n />\n );\n }\n\n return (\n <Dialog open={open} onOpenChange={handleOpenChange}>\n <DialogTrigger asChild>\n <Button\n type=\"button\"\n variant=\"outline\"\n disabled={disabled}\n className={cn('gap-2', className)}\n >\n <FileText className=\"size-4\" />\n {t('afterActions.pdf.generateButton')}\n </Button>\n </DialogTrigger>\n <DialogContent className=\"sm:max-w-[450px]\" dir={isRTL ? 'rtl' : 'ltr'}>\n <DialogHeader>\n <DialogTitle className=\"flex items-center gap-2\">\n <FileText className=\"size-5\" />\n {t('afterActions.pdf.title')}\n {isConfidential && (\n <Shield className=\"size-4 text-amber-500\" />\n )}\n </DialogTitle>\n <DialogDescription>\n {t('afterActions.pdf.description')}\n </DialogDescription>\n </DialogHeader>\n\n <div className=\"space-y-4 py-4\">\n {/* Confidential Warning */}\n {isConfidential && status === 'idle' && (\n <Alert className=\"border-amber-500\">\n <Shield className=\"size-4 text-amber-500\" />\n <AlertDescription className=\"text-amber-700\">\n {t('afterActions.pdf.confidentialWarning')}\n </AlertDescription>\n </Alert>\n )}\n\n {/* Language Selection */}\n {status === 'idle' && (\n <div className=\"space-y-3\">\n <Label>{t('afterActions.pdf.selectLanguage')}</Label>\n <RadioGroup value={language} onValueChange={(v) => setLanguage(v as PDFLanguage)}>\n <div className=\"flex items-center space-x-2\">\n <RadioGroupItem value=\"en\" id=\"lang-en\" />\n <Label htmlFor=\"lang-en\" className=\"cursor-pointer font-normal\">\n {t('afterActions.pdf.englishOnly')}\n </Label>\n </div>\n <div className=\"flex items-center space-x-2\">\n <RadioGroupItem value=\"ar\" id=\"lang-ar\" />\n <Label htmlFor=\"lang-ar\" className=\"cursor-pointer font-normal\">\n {t('afterActions.pdf.arabicOnly')}\n </Label>\n </div>\n <div className=\"flex items-center space-x-2\">\n <RadioGroupItem value=\"both\" id=\"lang-both\" />\n <Label htmlFor=\"lang-both\" className=\"cursor-pointer font-normal\">\n {t('afterActions.pdf.both')} {t('common.recommended')}\n </Label>\n </div>\n </RadioGroup>\n </div>\n )}\n\n {/* Status Display */}\n {status === 'verifying' && (\n <Alert>\n <Loader2 className=\"size-4 animate-spin\" />\n <AlertDescription>{t('afterActions.pdf.verifying')}</AlertDescription>\n </Alert>\n )}\n\n {status === 'generating' && (\n <Alert>\n <Loader2 className=\"size-4 animate-spin\" />\n <AlertDescription>\n {t('afterActions.pdf.generating')}\n <span className=\"mt-1 block text-xs text-muted-foreground\">\n {t('afterActions.pdf.estimatedTime')}\n </span>\n </AlertDescription>\n </Alert>\n )}\n\n {status === 'completed' && pdfUrl && (\n <Alert className=\"border-green-500\">\n <CheckCircle className=\"size-4 text-green-500\" />\n <AlertDescription className=\"text-green-700\">\n <div className=\"space-y-2\">\n <p>{t('afterActions.pdf.completed')}</p>\n <p className=\"text-xs text-muted-foreground\">\n {getTimeRemaining()}\n </p>\n </div>\n </AlertDescription>\n </Alert>\n )}\n\n {status === 'failed' && (\n <Alert variant=\"destructive\">\n <AlertCircle className=\"size-4\" />\n <AlertDescription>{error}</AlertDescription>\n </Alert>\n )}\n\n {/* Info Alert */}\n {status === 'idle' && (\n <Alert>\n <AlertCircle className=\"size-4\" />\n <AlertDescription>\n {t('afterActions.pdf.info')}\n </AlertDescription>\n </Alert>\n )}\n </div>\n\n {/* Action Buttons */}\n <div className={cn('flex gap-2', isRTL && 'flex-row-reverse')}>\n {status === 'completed' && pdfUrl ? (\n <>\n <Button onClick={handleDownload} className=\"flex-1\">\n <Download className=\"me-2 size-4\" />\n {t('afterActions.pdf.download')}\n </Button>\n <Button\n type=\"button\"\n variant=\"outline\"\n onClick={() => handleOpenChange(false)}\n >\n {t('common.close')}\n </Button>\n </>\n ) : (\n <>\n <Button\n onClick={handleGenerate}\n disabled={status === 'generating' || status === 'verifying'}\n className=\"flex-1\"\n >\n {status === 'generating' || status === 'verifying' ? (\n <>\n <Loader2 className=\"me-2 size-4 animate-spin\" />\n {t('afterActions.pdf.generating')}\n </>\n ) : (\n <>\n <FileText className=\"me-2 size-4\" />\n {t('afterActions.pdf.generate')}\n </>\n )}\n </Button>\n <Button\n type=\"button\"\n variant=\"outline\"\n onClick={() => handleOpenChange(false)}\n disabled={status === 'generating' || status === 'verifying'}\n >\n {t('common.cancel')}\n </Button>\n </>\n )}\n </div>\n </DialogContent>\n </Dialog>\n );\n}\n","import { useState } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Button } from '@/components/ui/button';\nimport { Textarea } from '@/components/ui/textarea';\nimport { Label } from '@/components/ui/label';\nimport { Badge } from '@/components/ui/badge';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport { CheckCircle, XCircle, Loader2, AlertCircle, Eye } from 'lucide-react';\nimport { cn } from '@/lib/utils';\nimport { format } from 'date-fns';\nimport * as diff from 'deep-diff';\n\ninterface EditRequest {\n id: string;\n after_action_id: string;\n requested_by: {\n id: string;\n name: string;\n email: string;\n };\n requested_at: Date;\n reason: string;\n proposed_changes: Record<string, any>;\n current_content: Record<string, any>;\n}\n\ninterface EditApprovalFlowProps {\n editRequest: EditRequest;\n onApprove: (approvalNotes?: string) => Promise<void>;\n onReject: (rejectionReason: string) => Promise<void>;\n disabled?: boolean;\n className?: string;\n}\n\ntype DiffKind = 'N' | 'D' | 'E' | 'A';\n\ninterface DiffItem {\n kind: DiffKind;\n path: (string | number)[];\n lhs?: any;\n rhs?: any;\n}\n\nexport function EditApprovalFlow({\n editRequest,\n onApprove,\n onReject,\n disabled = false,\n className,\n}: EditApprovalFlowProps) {\n const { t, i18n } = useTranslation();\n const isRTL = i18n.language === 'ar';\n\n const [action, setAction] = useState<'approve' | 'reject' | null>(null);\n const [approvalNotes, setApprovalNotes] = useState('');\n const [rejectionReason, setRejectionReason] = useState('');\n const [loading, setLoading] = useState(false);\n const [error, setError] = useState<string | null>(null);\n const [showDiff, setShowDiff] = useState(true);\n\n const changes = (diff.diff(\n editRequest.current_content,\n editRequest.proposed_changes\n ) || []) as DiffItem[];\n\n const handleApprove = async () => {\n setLoading(true);\n setError(null);\n\n try {\n await onApprove(approvalNotes || undefined);\n } catch (err) {\n setError(err instanceof Error ? err.message : t('afterActions.editFlow.approveFailed'));\n } finally {\n setLoading(false);\n }\n };\n\n const handleReject = async () => {\n if (rejectionReason.length < 10) {\n setError(t('afterActions.editFlow.rejectionReasonTooShort'));\n return;\n }\n\n if (rejectionReason.length > 500) {\n setError(t('afterActions.editFlow.rejectionReasonTooLong'));\n return;\n }\n\n setLoading(true);\n setError(null);\n\n try {\n await onReject(rejectionReason);\n } catch (err) {\n setError(err instanceof Error ? err.message : t('afterActions.editFlow.rejectFailed'));\n } finally {\n setLoading(false);\n }\n };\n\n const renderDiffValue = (value: any): string => {\n if (value === null || value === undefined) return 'null';\n if (typeof value === 'object') return JSON.stringify(value, null, 2);\n return String(value);\n };\n\n const getDiffColor = (kind: DiffKind) => {\n switch (kind) {\n case 'N':\n return 'border-green-500 bg-green-50';\n case 'D':\n return 'border-red-500 bg-red-50';\n case 'E':\n return 'border-yellow-500 bg-yellow-50';\n case 'A':\n return 'border-blue-500 bg-blue-50';\n default:\n return '';\n }\n };\n\n const getDiffLabel = (kind: DiffKind) => {\n switch (kind) {\n case 'N':\n return t('afterActions.editFlow.added');\n case 'D':\n return t('afterActions.editFlow.deleted');\n case 'E':\n return t('afterActions.editFlow.modified');\n case 'A':\n return t('afterActions.editFlow.arrayChange');\n default:\n return '';\n }\n };\n\n const getDiffBadgeVariant = (kind: DiffKind) => {\n switch (kind) {\n case 'N':\n return 'default';\n case 'D':\n return 'destructive';\n case 'E':\n return 'secondary';\n case 'A':\n return 'outline';\n default:\n return 'outline';\n }\n };\n\n const formatPath = (path: (string | number)[]): string => {\n return path.join(' ï¿½ ');\n };\n\n return (\n <div className={cn('space-y-6', className)} dir={isRTL ? 'rtl' : 'ltr'}>\n {/* Edit Request Info */}\n <Card>\n <CardHeader>\n <CardTitle>{t('afterActions.editFlow.title')}</CardTitle>\n </CardHeader>\n <CardContent className=\"space-y-3\">\n <div>\n <Label>{t('afterActions.editFlow.requestedBy')}</Label>\n <div className=\"mt-1\">\n <p className=\"font-medium\">{editRequest.requested_by.name}</p>\n <p className=\"text-sm text-muted-foreground\">{editRequest.requested_by.email}</p>\n </div>\n </div>\n\n <div>\n <Label>{t('afterActions.editFlow.requestedAt')}</Label>\n <p className=\"mt-1\">{format(new Date(editRequest.requested_at), 'PPp')}</p>\n </div>\n\n <div>\n <Label>{t('afterActions.editFlow.reason')}</Label>\n <Card className=\"mt-1 border-l-4 border-l-blue-500\">\n <CardContent className=\"pt-4\">\n <p className=\"text-sm\">{editRequest.reason}</p>\n </CardContent>\n </Card>\n </div>\n </CardContent>\n </Card>\n\n {/* Changes Diff */}\n <Card>\n <CardHeader>\n <div className=\"flex items-center justify-between\">\n <CardTitle>{t('afterActions.editFlow.proposedChanges')}</CardTitle>\n <Button\n variant=\"ghost\"\n size=\"sm\"\n onClick={() => setShowDiff(!showDiff)}\n >\n <Eye className=\"me-2 size-4\" />\n {showDiff ? t('common.hide') : t('common.show')}\n </Button>\n </div>\n </CardHeader>\n {showDiff && (\n <CardContent className=\"space-y-3\">\n {changes.length === 0 ? (\n <Alert>\n <AlertCircle className=\"size-4\" />\n <AlertDescription>\n {t('afterActions.editFlow.noChanges')}\n </AlertDescription>\n </Alert>\n ) : (\n changes.map((change, index) => (\n <Card key={index} className={cn('border-l-4', getDiffColor(change.kind))}>\n <CardHeader className=\"pb-3\">\n <div className=\"flex items-center justify-between\">\n <Badge variant={getDiffBadgeVariant(change.kind)}>\n {getDiffLabel(change.kind)}\n </Badge>\n <code className=\"text-xs text-muted-foreground\">\n {formatPath(change.path)}\n </code>\n </div>\n </CardHeader>\n <CardContent className=\"text-sm\">\n <div className=\"grid grid-cols-1 gap-4 md:grid-cols-2\">\n {change.kind !== 'N' && (\n <div>\n <p className=\"mb-1 font-semibold text-red-600\">\n {t('afterActions.editFlow.currentVersion')}:\n </p>\n <pre className=\"overflow-x-auto rounded border border-red-200 bg-red-50 p-2 text-xs\">\n {renderDiffValue(change.lhs)}\n </pre>\n </div>\n )}\n {change.kind !== 'D' && (\n <div>\n <p className=\"mb-1 font-semibold text-green-600\">\n {t('afterActions.editFlow.proposedVersion')}:\n </p>\n <pre className=\"overflow-x-auto rounded border border-green-200 bg-green-50 p-2 text-xs\">\n {renderDiffValue(change.rhs)}\n </pre>\n </div>\n )}\n </div>\n </CardContent>\n </Card>\n ))\n )}\n </CardContent>\n )}\n </Card>\n\n {/* Error Display */}\n {error && (\n <Alert variant=\"destructive\">\n <AlertCircle className=\"size-4\" />\n <AlertDescription>{error}</AlertDescription>\n </Alert>\n )}\n\n {/* Action Selection */}\n {!action && (\n <Card>\n <CardContent className=\"pt-6\">\n <div className={cn('flex gap-4', isRTL && 'flex-row-reverse')}>\n <Button\n onClick={() => setAction('approve')}\n disabled={disabled || loading}\n className=\"flex-1\"\n variant=\"default\"\n >\n <CheckCircle className=\"me-2 size-4\" />\n {t('afterActions.editFlow.approve')}\n </Button>\n <Button\n onClick={() => setAction('reject')}\n disabled={disabled || loading}\n className=\"flex-1\"\n variant=\"destructive\"\n >\n <XCircle className=\"me-2 size-4\" />\n {t('afterActions.editFlow.reject')}\n </Button>\n </div>\n </CardContent>\n </Card>\n )}\n\n {/* Approval Form */}\n {action === 'approve' && (\n <Card className=\"border-green-500\">\n <CardHeader>\n <CardTitle className=\"text-green-700\">\n {t('afterActions.editFlow.approveTitle')}\n </CardTitle>\n </CardHeader>\n <CardContent className=\"space-y-4\">\n <div className=\"space-y-2\">\n <Label htmlFor=\"approval-notes\">\n {t('afterActions.editFlow.approvalNotes')} ({t('common.optional')})\n </Label>\n <Textarea\n id=\"approval-notes\"\n value={approvalNotes}\n onChange={(e) => setApprovalNotes(e.target.value)}\n placeholder={t('afterActions.editFlow.approvalNotesPlaceholder')}\n rows={3}\n disabled={loading}\n dir={isRTL ? 'rtl' : 'ltr'}\n />\n </div>\n\n <Alert>\n <AlertCircle className=\"size-4\" />\n <AlertDescription>\n {t('afterActions.editFlow.approvalWarning')}\n </AlertDescription>\n </Alert>\n\n <div className={cn('flex gap-2', isRTL && 'flex-row-reverse')}>\n <Button\n onClick={handleApprove}\n disabled={loading}\n className=\"flex-1\"\n >\n {loading ? (\n <>\n <Loader2 className=\"me-2 size-4 animate-spin\" />\n {t('afterActions.editFlow.approving')}\n </>\n ) : (\n <>\n <CheckCircle className=\"me-2 size-4\" />\n {t('afterActions.editFlow.confirmApprove')}\n </>\n )}\n </Button>\n <Button\n variant=\"outline\"\n onClick={() => setAction(null)}\n disabled={loading}\n >\n {t('common.cancel')}\n </Button>\n </div>\n </CardContent>\n </Card>\n )}\n\n {/* Rejection Form */}\n {action === 'reject' && (\n <Card className=\"border-red-500\">\n <CardHeader>\n <CardTitle className=\"text-red-700\">\n {t('afterActions.editFlow.rejectTitle')}\n </CardTitle>\n </CardHeader>\n <CardContent className=\"space-y-4\">\n <div className=\"space-y-2\">\n <Label htmlFor=\"rejection-reason\">\n {t('afterActions.editFlow.rejectionReason')} *\n </Label>\n <Textarea\n id=\"rejection-reason\"\n value={rejectionReason}\n onChange={(e) => setRejectionReason(e.target.value)}\n placeholder={t('afterActions.editFlow.rejectionReasonPlaceholder')}\n rows={4}\n maxLength={500}\n required\n disabled={loading}\n dir={isRTL ? 'rtl' : 'ltr'}\n />\n <p className=\"text-xs text-muted-foreground\">\n {rejectionReason.length} / 500 ({t('afterActions.editFlow.minChars', { count: 10 })})\n </p>\n </div>\n\n <Alert variant=\"destructive\">\n <AlertCircle className=\"size-4\" />\n <AlertDescription>\n {t('afterActions.editFlow.rejectionWarning')}\n </AlertDescription>\n </Alert>\n\n <div className={cn('flex gap-2', isRTL && 'flex-row-reverse')}>\n <Button\n onClick={handleReject}\n disabled={loading || rejectionReason.length < 10}\n variant=\"destructive\"\n className=\"flex-1\"\n >\n {loading ? (\n <>\n <Loader2 className=\"me-2 size-4 animate-spin\" />\n {t('afterActions.editFlow.rejecting')}\n </>\n ) : (\n <>\n <XCircle className=\"me-2 size-4\" />\n {t('afterActions.editFlow.confirmReject')}\n </>\n )}\n </Button>\n <Button\n variant=\"outline\"\n onClick={() => setAction(null)}\n disabled={loading}\n >\n {t('common.cancel')}\n </Button>\n </div>\n </CardContent>\n </Card>\n )}\n </div>\n );\n}\n","import { createFileRoute, Link } from '@tanstack/react-router';\nimport { useAfterAction } from '@/hooks/useAfterAction';\nimport { usePublishAfterAction } from '@/hooks/usePublishAfterAction';\nimport { useRequestEdit } from '@/hooks/useEditWorkflow';\nimport { useTranslation } from 'react-i18next';\nimport { Button } from '@/components/ui/button';\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { Skeleton } from '@/components/ui/skeleton';\nimport { Separator } from '@/components/ui/separator';\nimport { PDFGeneratorButton } from '@/components/PDFGeneratorButton';\nimport { EditApprovalFlow } from '@/components/EditApprovalFlow';\nimport {\n Calendar,\n FileText,\n Users,\n ArrowLeft,\n CheckCircle,\n AlertCircle,\n Lock,\n Edit,\n History\n} from 'lucide-react';\nimport { format } from 'date-fns';\nimport { ar, enUS } from 'date-fns/locale';\nimport { toast } from 'sonner';\nimport { useAuth } from '@/hooks/useAuth';\n\nexport const Route = createFileRoute('/_protected/after-actions/$afterActionId')({\n component: AfterActionDetailPage,\n});\n\nfunction AfterActionDetailPage() {\n const { afterActionId } = Route.useParams();\n const { t, i18n } = useTranslation();\n const isRTL = i18n.language === 'ar';\n const locale = isRTL ? ar : enUS;\n const { user } = useAuth();\n\n const { data: afterAction, isLoading, error } = useAfterAction(afterActionId);\n const publishMutation = usePublishAfterAction();\n const requestEditMutation = useRequestEdit();\n\n if (isLoading) {\n return (\n <div className=\"container mx-auto p-6 space-y-6\">\n <Skeleton className=\"h-8 w-64\" />\n <Skeleton className=\"h-screen w-full\" />\n </div>\n );\n }\n\n if (error) {\n return (\n <div className=\"container mx-auto p-6\">\n <Card className=\"border-destructive\">\n <CardHeader>\n <CardTitle className=\"text-destructive\">{t('common.error')}</CardTitle>\n <CardDescription>{t('afterActions.loadError')}</CardDescription>\n </CardHeader>\n </Card>\n </div>\n );\n }\n\n if (!afterAction) {\n return (\n <div className=\"container mx-auto p-6\">\n <Card>\n <CardHeader>\n <CardTitle>{t('afterActions.notFound')}</CardTitle>\n <CardDescription>{t('afterActions.notFoundDescription')}</CardDescription>\n </CardHeader>\n </Card>\n </div>\n );\n }\n\n const canPublish = ['supervisor', 'admin'].includes(user?.role || '');\n const canEdit = afterAction.publication_status === 'draft' ||\n (afterAction.publication_status === 'published' &&\n (user?.id === afterAction.created_by || canPublish));\n\n const isReadOnly = afterAction.publication_status === 'published';\n const isEditRequested = afterAction.publication_status === 'edit_requested';\n\n const handlePublish = async () => {\n try {\n await publishMutation.mutateAsync({\n afterActionId,\n isConfidential: afterAction.is_confidential,\n });\n toast.success(t('afterActions.publishSuccess'));\n } catch (error: any) {\n toast.error(error.message || t('afterActions.publishFailed'));\n }\n };\n\n const handleRequestEdit = async () => {\n // This will open a modal in practice\n toast.info(t('afterActions.editRequestFeature'));\n };\n\n const statusMap: Record<string, { label: string; variant: any }> = {\n draft: { label: t('afterActions.status.draft'), variant: 'secondary' },\n published: { label: t('afterActions.status.published'), variant: 'default' },\n edit_requested: { label: t('afterActions.status.editRequested'), variant: 'warning' },\n };\n\n const statusConfig = statusMap[afterAction.publication_status] || {\n label: afterAction.publication_status,\n variant: 'secondary'\n };\n\n return (\n <div className={`container mx-auto p-6 space-y-6 ${isRTL ? 'rtl' : 'ltr'}`}>\n {/* Header */}\n <div className=\"flex items-center justify-between\">\n <div className=\"flex items-center gap-4\">\n <Button variant=\"ghost\" size=\"icon\" asChild>\n <Link\n to=\"/dossiers/$dossierId\"\n params={{ dossierId: afterAction.dossier_id }}\n >\n <ArrowLeft className={`h-4 w-4 ${isRTL ? 'rotate-180' : ''}`} />\n </Link>\n </Button>\n <div>\n <h1 className=\"text-3xl font-bold\">{t('afterActions.detail')}</h1>\n <p className=\"text-muted-foreground\">\n {format(new Date(afterAction.created_at), 'PPP', { locale })}\n </p>\n </div>\n </div>\n <div className=\"flex items-center gap-2\">\n <Badge variant={statusConfig.variant as any}>\n {statusConfig.label}\n </Badge>\n {afterAction.is_confidential && (\n <Badge variant=\"destructive\">\n <Lock className=\"h-3 w-3 me-1\" />\n {t('afterActions.confidential')}\n </Badge>\n )}\n </div>\n </div>\n\n {/* Actions */}\n <div className=\"flex items-center gap-2 justify-end flex-wrap\">\n {afterAction.publication_status === 'draft' && canPublish && (\n <Button\n onClick={handlePublish}\n disabled={publishMutation.isPending}\n >\n <CheckCircle className=\"h-4 w-4 me-2\" />\n {t('afterActions.publish')}\n </Button>\n )}\n\n {isReadOnly && canEdit && (\n <Button\n variant=\"outline\"\n onClick={handleRequestEdit}\n disabled={requestEditMutation.isPending}\n >\n <Edit className=\"h-4 w-4 me-2\" />\n {t('afterActions.requestEdit')}\n </Button>\n )}\n\n <Button variant=\"outline\" asChild>\n <Link\n to=\"/after-actions/$afterActionId/versions\"\n params={{ afterActionId }}\n >\n <History className=\"h-4 w-4 me-2\" />\n {t('afterActions.versionHistory')}\n </Link>\n </Button>\n\n <PDFGeneratorButton\n afterActionId={afterActionId}\n isConfidential={afterAction.is_confidential}\n />\n </div>\n\n {/* Edit Approval Flow (for supervisors) */}\n {isEditRequested && canPublish && (\n <EditApprovalFlow afterActionId={afterActionId} />\n )}\n\n {/* Main Content */}\n <div className=\"grid gap-6\">\n {/* Attendees */}\n <Card>\n <CardHeader>\n <CardTitle className=\"flex items-center gap-2\">\n <Users className=\"h-5 w-5\" />\n {t('afterActions.attendees')}\n </CardTitle>\n </CardHeader>\n <CardContent>\n <div className=\"flex flex-wrap gap-2\">\n {afterAction.attendees && afterAction.attendees.length > 0 ? (\n afterAction.attendees.map((attendee, index) => (\n <Badge key={index} variant=\"outline\">\n {attendee}\n </Badge>\n ))\n ) : (\n <p className=\"text-sm text-muted-foreground\">\n {t('afterActions.noAttendees')}\n </p>\n )}\n </div>\n </CardContent>\n </Card>\n\n {/* Decisions */}\n {afterAction.decisions && afterAction.decisions.length > 0 && (\n <Card>\n <CardHeader>\n <CardTitle>{t('afterActions.decisions')}</CardTitle>\n <CardDescription>\n {t('afterActions.decisionsCount', { count: afterAction.decisions.length })}\n </CardDescription>\n </CardHeader>\n <CardContent className=\"space-y-4\">\n {afterAction.decisions.map((decision, index) => (\n <div key={decision.id} className=\"space-y-2\">\n {index > 0 && <Separator />}\n <div className=\"pt-2\">\n <p className=\"font-medium\">{decision.description}</p>\n {decision.rationale && (\n <p className=\"text-sm text-muted-foreground mt-1\">\n {t('afterActions.rationale')}: {decision.rationale}\n </p>\n )}\n <div className=\"flex items-center gap-4 mt-2 text-sm text-muted-foreground\">\n <span>{t('afterActions.decisionMaker')}: {decision.decision_maker}</span>\n <span>\n {format(new Date(decision.decision_date), 'PP', { locale })}\n </span>\n </div>\n </div>\n </div>\n ))}\n </CardContent>\n </Card>\n )}\n\n {/* Commitments */}\n {afterAction.commitments && afterAction.commitments.length > 0 && (\n <Card>\n <CardHeader>\n <CardTitle>{t('afterActions.commitments')}</CardTitle>\n <CardDescription>\n {t('afterActions.commitmentsCount', { count: afterAction.commitments.length })}\n </CardDescription>\n </CardHeader>\n <CardContent className=\"space-y-4\">\n {afterAction.commitments.map((commitment, index) => (\n <div key={commitment.id} className=\"space-y-2\">\n {index > 0 && <Separator />}\n <div className=\"pt-2\">\n <div className=\"flex items-start justify-between gap-4\">\n <div className=\"flex-1\">\n <p className=\"font-medium\">{commitment.description}</p>\n <div className=\"flex items-center gap-4 mt-2 text-sm text-muted-foreground flex-wrap\">\n <span>\n {t('afterActions.owner')}: {\n commitment.owner_type === 'internal'\n ? commitment.owner_user_id\n : commitment.owner_contact_id\n }\n </span>\n <span>\n {t('afterActions.dueDate')}: {format(new Date(commitment.due_date), 'PP', { locale })}\n </span>\n <Badge variant=\"outline\">{commitment.priority}</Badge>\n <Badge>{commitment.status}</Badge>\n </div>\n </div>\n </div>\n </div>\n </div>\n ))}\n </CardContent>\n </Card>\n )}\n\n {/* Risks */}\n {afterAction.risks && afterAction.risks.length > 0 && (\n <Card>\n <CardHeader>\n <CardTitle className=\"flex items-center gap-2\">\n <AlertCircle className=\"h-5 w-5\" />\n {t('afterActions.risks')}\n </CardTitle>\n <CardDescription>\n {t('afterActions.risksCount', { count: afterAction.risks.length })}\n </CardDescription>\n </CardHeader>\n <CardContent className=\"space-y-4\">\n {afterAction.risks.map((risk, index) => (\n <div key={risk.id} className=\"space-y-2\">\n {index > 0 && <Separator />}\n <div className=\"pt-2\">\n <p className=\"font-medium\">{risk.description}</p>\n <div className=\"flex items-center gap-2 mt-2 flex-wrap\">\n <Badge variant={risk.severity === 'critical' || risk.severity === 'high' ? 'destructive' : 'outline'}>\n {t('afterActions.severity')}: {risk.severity}\n </Badge>\n <Badge variant=\"outline\">\n {t('afterActions.likelihood')}: {risk.likelihood}\n </Badge>\n </div>\n {risk.mitigation_strategy && (\n <p className=\"text-sm text-muted-foreground mt-2\">\n {t('afterActions.mitigation')}: {risk.mitigation_strategy}\n </p>\n )}\n </div>\n </div>\n ))}\n </CardContent>\n </Card>\n )}\n\n {/* Follow-up Actions */}\n {afterAction.follow_up_actions && afterAction.follow_up_actions.length > 0 && (\n <Card>\n <CardHeader>\n <CardTitle>{t('afterActions.followUps')}</CardTitle>\n <CardDescription>\n {t('afterActions.followUpsCount', { count: afterAction.follow_up_actions.length })}\n </CardDescription>\n </CardHeader>\n <CardContent className=\"space-y-4\">\n {afterAction.follow_up_actions.map((action, index) => (\n <div key={action.id} className=\"space-y-2\">\n {index > 0 && <Separator />}\n <div className=\"pt-2\">\n <div className=\"flex items-start gap-2\">\n {action.completed ? (\n <CheckCircle className=\"h-5 w-5 text-green-600 mt-0.5\" />\n ) : (\n <div className=\"h-5 w-5 rounded-full border-2 border-muted-foreground mt-0.5\" />\n )}\n <div className=\"flex-1\">\n <p className={action.completed ? 'line-through text-muted-foreground' : ''}>\n {action.description}\n </p>\n {action.assigned_to || action.target_date ? (\n <div className=\"flex items-center gap-4 mt-1 text-sm text-muted-foreground\">\n {action.assigned_to && <span>{action.assigned_to}</span>}\n {action.target_date && (\n <span>{format(new Date(action.target_date), 'PP', { locale })}</span>\n )}\n </div>\n ) : null}\n </div>\n </div>\n </div>\n </div>\n ))}\n </CardContent>\n </Card>\n )}\n\n {/* Notes */}\n {afterAction.notes && (\n <Card>\n <CardHeader>\n <CardTitle className=\"flex items-center gap-2\">\n <FileText className=\"h-5 w-5\" />\n {t('afterActions.notes')}\n </CardTitle>\n </CardHeader>\n <CardContent>\n <p className=\"text-sm whitespace-pre-wrap\">{afterAction.notes}</p>\n </CardContent>\n </Card>\n )}\n\n {/* Metadata */}\n <Card>\n <CardHeader>\n <CardTitle>{t('afterActions.metadata')}</CardTitle>\n </CardHeader>\n <CardContent className=\"space-y-2 text-sm\">\n <div className=\"flex items-center justify-between\">\n <span className=\"text-muted-foreground\">{t('afterActions.createdAt')}</span>\n <span>{format(new Date(afterAction.created_at), 'PPp', { locale })}</span>\n </div>\n {afterAction.updated_at && (\n <div className=\"flex items-center justify-between\">\n <span className=\"text-muted-foreground\">{t('afterActions.updatedAt')}</span>\n <span>{format(new Date(afterAction.updated_at), 'PPp', { locale })}</span>\n </div>\n )}\n {afterAction.published_at && (\n <div className=\"flex items-center justify-between\">\n <span className=\"text-muted-foreground\">{t('afterActions.publishedAt')}</span>\n <span>{format(new Date(afterAction.published_at), 'PPp', { locale })}</span>\n </div>\n )}\n <div className=\"flex items-center justify-between\">\n <span className=\"text-muted-foreground\">{t('afterActions.version')}</span>\n <span>v{afterAction.version}</span>\n </div>\n </CardContent>\n </Card>\n </div>\n </div>\n );\n}\n"],"names":["usePublishAfterAction","queryClient","useQueryClient","useMutation","afterActionId","isConfidential","data","error","supabase","_","useRequestEdit","reason","StepUpMFA","open","action","positionId","onSuccess","onCancel","t","i18n","useTranslation","challengeData","setChallengeData","useState","verificationCode","setVerificationCode","isInitiating","setIsInitiating","isVerifying","setIsVerifying","isResending","setIsResending","setError","timeRemaining","setTimeRemaining","canResend","setCanResend","inputRef","useRef","timerRef","formatTime","seconds","mins","secs","startTimer","useCallback","expiresAt","updateTimer","now","expiry","remaining","initiateChallenge","session","response","errorData","err","verifyCode","e","resetState","resendCode","handleCancel","useEffect","getChallengeTypeLabel","getPlaceholder","jsx","Dialog","isOpen","jsxs","DialogContent","DialogHeader","DialogTitle","Shield","DialogDescription","AlertTriangle","Clock","Input","value","Button","RefreshCw","DialogFooter","Fragment","PDFGeneratorButton","disabled","className","isRTL","setOpen","language","setLanguage","status","setStatus","pdfUrl","setPdfUrl","setExpiresAt","showMFA","setShowMFA","mfaToken","setMfaToken","handleGenerate","handleMFASuccess","token","handleDownload","handleOpenChange","getTimeRemaining","diff","hours","minutes","DialogTrigger","cn","FileText","Alert","AlertDescription","Label","RadioGroup","v","RadioGroupItem","Loader2","CheckCircle","AlertCircle","Download","EditApprovalFlow","editRequest","onApprove","onReject","setAction","approvalNotes","setApprovalNotes","rejectionReason","setRejectionReason","loading","setLoading","showDiff","setShowDiff","changes","diff.diff","handleApprove","handleReject","renderDiffValue","getDiffColor","kind","getDiffLabel","getDiffBadgeVariant","formatPath","path","Card","CardHeader","CardTitle","CardContent","format","Eye","change","index","Badge","XCircle","Textarea","AfterActionDetailPage","Route","useParams","locale","ar","enUS","user","useAuth","afterAction","isLoading","useAfterAction","publishMutation","requestEditMutation","Skeleton","CardDescription","canPublish","includes","role","canEdit","publication_status","id","created_by","isReadOnly","isEditRequested","handlePublish","mutateAsync","is_confidential","toast","success","message","handleRequestEdit","info","statusConfig","draft","label","variant","published","edit_requested","Link","dossierId","dossier_id","ArrowLeft","Date","created_at","Lock","isPending","Edit","History","Users","attendees","length","map","attendee","decisions","count","decision","Separator","description","rationale","decision_maker","decision_date","commitments","commitment","owner_type","owner_user_id","owner_contact_id","due_date","priority","risks","risk","severity","likelihood","mitigation_strategy","follow_up_actions","completed","assigned_to","target_date","notes","updated_at","published_at","version"],"mappings":"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"}