{"version":3,"file":"usePosition-ChrBL0hW.js","sources":["../../src/hooks/usePosition.ts"],"sourcesContent":["/**\n * TanStack Query hook for fetching a single position\n *\n * Query key: ['positions', 'detail', id]\n * Cache: staleTime 5min, refetchOnWindowFocus: false\n */\n\nimport { useQuery } from '@tanstack/react-query';\nimport { supabase } from '../lib/supabase';\nimport type { Position } from '../types/position';\n\n// API base URL\nconst API_BASE_URL = import.meta.env.VITE_SUPABASE_URL + '/functions/v1';\n\n// Query keys\nexport const positionKeys = {\n  all: ['positions'] as const,\n  lists: () => [...positionKeys.all, 'list'] as const,\n  details: () => [...positionKeys.all, 'detail'] as const,\n  detail: (id: string) => [...positionKeys.details(), id] as const,\n};\n\n// Helper to get auth headers\nconst getAuthHeaders = async () => {\n  const { data: { session } } = await supabase.auth.getSession();\n  return {\n    'Content-Type': 'application/json',\n    'Authorization': `Bearer ${session?.access_token}`,\n  };\n};\n\n/**\n * Hook to fetch a single position by ID\n */\nexport const usePosition = (id: string | undefined, options?: { enabled?: boolean }) => {\n  return useQuery({\n    queryKey: positionKeys.detail(id || ''),\n    queryFn: async (): Promise<Position> => {\n      if (!id) {\n        throw new Error('Position ID is required');\n      }\n\n      const headers = await getAuthHeaders();\n      const response = await fetch(`${API_BASE_URL}/positions-get?position_id=${id}`, {\n        method: 'GET',\n        headers,\n      });\n\n      if (!response.ok) {\n        const error = await response.json().catch(() => ({ message: response.statusText }));\n        throw new Error(error.message || `Failed to fetch position: ${response.status}`);\n      }\n\n      return response.json();\n    },\n    enabled: options?.enabled !== false && !!id,\n    staleTime: 5 * 60 * 1000, // 5 minutes\n    refetchOnWindowFocus: false, // Don't refetch on window focus\n  });\n};\n"],"names":["API_BASE_URL","positionKeys","id","getAuthHeaders","session","supabase","usePosition","options","useQuery","headers","response","error"],"mappings":"0FAYA,MAAMA,EAAe,wDAGRC,EAAe,CAC1B,IAAK,CAAC,WAAW,EACjB,MAAO,IAAM,CAAC,GAAGA,EAAa,IAAK,MAAM,EACzC,QAAS,IAAM,CAAC,GAAGA,EAAa,IAAK,QAAQ,EAC7C,OAASC,GAAe,CAAC,GAAGD,EAAa,QAAA,EAAWC,CAAE,CACxD,EAGMC,EAAiB,SAAY,CACjC,KAAM,CAAE,KAAM,CAAE,QAAAC,CAAA,GAAc,MAAMC,EAAS,KAAK,WAAA,EAClD,MAAO,CACL,eAAgB,mBAChB,cAAiB,UAAUD,GAAS,YAAY,EAAA,CAEpD,EAKaE,EAAc,CAACJ,EAAwBK,IAC3CC,EAAS,CACd,SAAUP,EAAa,OAAOC,GAAM,EAAE,EACtC,QAAS,SAA+B,CACtC,GAAI,CAACA,EACH,MAAM,IAAI,MAAM,yBAAyB,EAG3C,MAAMO,EAAU,MAAMN,EAAA,EAChBO,EAAW,MAAM,MAAM,GAAGV,CAAY,8BAA8BE,CAAE,GAAI,CAC9E,OAAQ,MACR,QAAAO,CAAA,CACD,EAED,GAAI,CAACC,EAAS,GAAI,CAChB,MAAMC,EAAQ,MAAMD,EAAS,OAAO,MAAM,KAAO,CAAE,QAASA,EAAS,UAAA,EAAa,EAClF,MAAM,IAAI,MAAMC,EAAM,SAAW,6BAA6BD,EAAS,MAAM,EAAE,CACjF,CAEA,OAAOA,EAAS,KAAA,CAClB,EACA,QAAuC,CAAC,CAACR,EACzC,UAAW,EAAI,GAAK,IACpB,qBAAsB,EAAA,CACvB"}