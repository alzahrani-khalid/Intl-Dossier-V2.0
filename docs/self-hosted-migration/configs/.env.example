# Supabase Self-Hosted Environment Configuration
# Copy this file to .env and update with your values
#
# SECURITY WARNING: Never commit .env to version control!
# Add .env to .gitignore

############
# Secrets
############
# Generate strong secrets using:
# openssl rand -base64 32

POSTGRES_PASSWORD=your-super-secret-postgres-password-here
JWT_SECRET=your-jwt-secret-at-least-32-characters-long
ANON_KEY=your-anon-key-eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
SERVICE_ROLE_KEY=your-service-role-key-eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...

############
# Dashboard
############
STUDIO_DEFAULT_ORGANIZATION="Intl-Dossier"
STUDIO_DEFAULT_PROJECT="Intl-Dossier V2.0"
DASHBOARD_USERNAME=admin
DASHBOARD_PASSWORD=your-dashboard-password-here

############
# Database
############
POSTGRES_HOST=db
POSTGRES_PORT=5432
POSTGRES_DB=postgres

# Connection pooler (if using)
POSTGRES_POOLER_PORT=6543

############
# API
############
# Your domain (update with your actual domain)
API_EXTERNAL_URL=https://supabase.yourdomain.com
SUPABASE_PUBLIC_URL=https://supabase.yourdomain.com

# Internal URLs (for container-to-container communication)
KONG_HTTP_PORT=8000
KONG_HTTPS_PORT=8443

############
# Auth (GoTrue)
############
# Your application URL
SITE_URL=https://yourdomain.com

# Additional redirect URLs (comma-separated)
ADDITIONAL_REDIRECT_URLS=http://localhost:5173,http://localhost:3000,https://yourdomain.com

# Disable public signups (set to true in production)
DISABLE_SIGNUP=false

# JWT expiry in seconds (default 3600 = 1 hour)
JWT_EXPIRY=3600

# Enable email signup
ENABLE_EMAIL_SIGNUP=true
ENABLE_EMAIL_AUTOCONFIRM=false

############
# Email (SMTP)
############
SMTP_ADMIN_EMAIL=admin@yourdomain.com
SMTP_HOST=smtp.yourdomain.com
SMTP_PORT=587
SMTP_USER=noreply@yourdomain.com
SMTP_PASS=your-smtp-password
SMTP_SENDER_NAME=Intl-Dossier

# Email template URL paths
MAILER_URLPATHS_INVITE=/auth/v1/verify
MAILER_URLPATHS_CONFIRMATION=/auth/v1/verify
MAILER_URLPATHS_RECOVERY=/auth/v1/verify
MAILER_URLPATHS_EMAIL_CHANGE=/auth/v1/verify

############
# OAuth Providers (Optional - uncomment and configure as needed)
############

# Google OAuth
# GOTRUE_EXTERNAL_GOOGLE_ENABLED=true
# GOTRUE_EXTERNAL_GOOGLE_CLIENT_ID=your-google-client-id
# GOTRUE_EXTERNAL_GOOGLE_SECRET=your-google-client-secret
# GOTRUE_EXTERNAL_GOOGLE_REDIRECT_URI=https://supabase.yourdomain.com/auth/v1/callback

# GitHub OAuth
# GOTRUE_EXTERNAL_GITHUB_ENABLED=true
# GOTRUE_EXTERNAL_GITHUB_CLIENT_ID=your-github-client-id
# GOTRUE_EXTERNAL_GITHUB_SECRET=your-github-client-secret
# GOTRUE_EXTERNAL_GITHUB_REDIRECT_URI=https://supabase.yourdomain.com/auth/v1/callback

# Microsoft Azure AD
# GOTRUE_EXTERNAL_AZURE_ENABLED=true
# GOTRUE_EXTERNAL_AZURE_CLIENT_ID=your-azure-client-id
# GOTRUE_EXTERNAL_AZURE_SECRET=your-azure-client-secret
# GOTRUE_EXTERNAL_AZURE_URL=https://login.microsoftonline.com/your-tenant-id/oauth2/v2.0/authorize

############
# Studio
############
STUDIO_PORT=3000
PUBLIC_REST_URL=https://supabase.yourdomain.com/rest/v1/

############
# Storage
############
STORAGE_BACKEND=file
FILE_SIZE_LIMIT=52428800  # 50MB in bytes

# For S3-compatible storage (optional):
# STORAGE_BACKEND=s3
# STORAGE_S3_ENDPOINT=https://s3.amazonaws.com
# STORAGE_S3_REGION=us-east-1
# AWS_ACCESS_KEY_ID=your-aws-access-key
# AWS_SECRET_ACCESS_KEY=your-aws-secret-key
# GLOBAL_S3_BUCKET=your-bucket-name

############
# Edge Functions
############
FUNCTIONS_VERIFY_JWT=true

############
# Realtime
############
REALTIME_MAX_CONNECTIONS=100

############
# PostgREST
############
PGRST_DB_SCHEMAS=public,storage,graphql_public

############
# Analytics (Optional - can be disabled)
############
LOGFLARE_API_KEY=your-logflare-api-key-or-generate-random

############
# Rate Limiting (Optional)
############
# RATE_LIMIT_EMAIL_SENT=100
# RATE_LIMIT_SMS_SENT=100

############
# Security
############
# Set to true in production
# GOTRUE_EXTERNAL_PHONE_ENABLED=false
# GOTRUE_SMS_AUTOCONFIRM=false

############
# Monitoring (Optional - if using separate monitoring stack)
############
# POSTGRES_EXPORTER_ENABLED=true
# PROMETHEUS_ENDPOINT=http://prometheus:9090

############
# Backups
############
# Configure automated backup schedule
# BACKUP_SCHEDULE="0 2 * * *"  # Daily at 2 AM
# BACKUP_RETENTION_DAYS=30

############
# Development/Debug (Set to false in production)
############
LOG_LEVEL=info  # Options: debug, info, warn, error
ENABLE_DEBUG=false

############
# Custom Configuration for Intl-Dossier V2.0
############

# Redis (if using for caching)
REDIS_URL=redis://localhost:6379

# AnythingLLM (AI service)
ANYTHINGLLM_API_URL=http://localhost:3001/api
ANYTHINGLLM_API_KEY=your-anythingllm-api-key

# Application-specific
APP_NAME="Intl-Dossier V2.0"
APP_URL=https://yourdomain.com
APP_ENV=production  # Options: development, staging, production

# Feature flags
ENABLE_AI_FEATURES=true
ENABLE_MOBILE_SYNC=true
ENABLE_REALTIME=true
ENABLE_NOTIFICATIONS=true

############
# Notes
############
# 1. Generate secure passwords: openssl rand -base64 32
# 2. JWT keys must be at least 32 characters
# 3. Update all yourdomain.com references with your actual domain
# 4. Never commit this file with real secrets to version control
# 5. Restart services after changing this file: docker compose restart
